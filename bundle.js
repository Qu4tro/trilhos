var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function l(){return h(" ")}function f(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let d;function v(t){d=t}function g(t){(function(){if(!d)throw new Error("Function called outside component initialization");return d})().$$.on_mount.push(t)}const y=[],m=[],_=[],b=[],w=Promise.resolve();let E=!1;function I(t){_.push(t)}let T=!1;const C=new Set;function S(){if(!T){T=!0;do{for(let t=0;t<y.length;t+=1){const e=y[t];v(e),x(e.$$)}for(v(null),y.length=0;m.length;)m.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];C.has(e)||(C.add(e),e())}_.length=0}while(y.length);for(;b.length;)b.pop()();E=!1,T=!1,C.clear()}}function x(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const O=new Set;function P(t,e){t&&t.i&&(O.delete(t),t.i(e))}function A(t,e,n,r){if(t&&t.o){if(O.has(t))return;O.add(t),undefined.c.push((()=>{O.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function R(t){t&&t.c()}function k(t,n,o){const{fragment:s,on_mount:a,on_destroy:u,after_update:c}=t.$$;s&&s.m(n,o),I((()=>{const n=a.map(e).filter(i);u?u.push(...n):r(n),t.$$.on_mount=[]})),c.forEach(I)}function N(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function D(t,e){-1===t.$$.dirty[0]&&(y.push(t),E||(E=!0,w.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function L(e,i,o,s,a,c,h=[-1]){const l=d;v(e);const f=i.props||{},p=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:n(),dirty:h,skip_bound:!1};let g=!1;if(p.ctx=o?o(e,f,((t,n,...r)=>{const i=r.length?r[0]:n;return p.ctx&&a(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),g&&D(e,t)),n})):[],p.update(),g=!0,r(p.before_update),p.fragment=!!s&&s(p.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();i.intro&&P(e.$$.fragment),k(e,i.target,i.anchor),S()}v(l)}class M{$destroy(){N(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const F=[];function j(e,n=t){let r;const i=[];function s(t){if(o(e,t)&&(e=t,r)){const t=!F.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),F.push(n,e)}if(t){for(let t=0;t<F.length;t+=2)F[t][0](F[t+1]);F.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(o,a=t){const u=[o,a];return i.push(u),1===i.length&&(r=n(s)||t),o(e),()=>{const t=i.indexOf(u);-1!==t&&i.splice(t,1),0===i.length&&(r(),r=null)}}}}function U(){return function(){throw new Error("Unimplemented abstract method.")}()}var V=0;function q(t){return t.ol_uid||(t.ol_uid=String(++V))}var B=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),z=function(t){function e(e){var n=this,r="Assertion failed. See https://openlayers.org/en/"+("v"+"6.5.0".split("-")[0])+"/doc/errors/#"+e+" for details.";return(n=t.call(this,r)||this).code=e,n.name="AssertionError",n.message=r,n}return B(e,t),e}(Error),W=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),K="propertychange",G=function(){function t(){this.disposed=!1}return t.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function H(t,e){return t>e?1:t<e?-1:0}function X(t,e,n){var r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;var i=void 0;if(n>0){for(i=1;i<r;++i)if(t[i]<e)return i-1}else if(n<0){for(i=1;i<r;++i)if(t[i]<=e)return i}else for(i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function Y(t,e,n){for(;e<n;){var r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function Q(t,e){for(var n=Array.isArray(e)?e:[e],r=n.length,i=0;i<r;i++)t[t.length]=n[i]}function J(t,e){var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function Z(){return!0}function $(){return!1}function tt(){}var et="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,i=arguments.length;r<i;++r){var o=arguments[r];if(null!=o)for(var s in o)o.hasOwnProperty(s)&&(n[s]=o[s])}return n};function nt(t){for(var e in t)delete t[e]}var rt="function"==typeof Object.values?Object.values:function(t){var e=[];for(var n in t)e.push(t[n]);return e};function it(t){var e;for(e in t)return!1;return!e}var ot=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),st=function(t){function e(e){var n=t.call(this)||this;return n.eventTarget_=e,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return ot(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);-1===r.indexOf(e)&&r.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new W(t):t,n=e.type;e.target||(e.target=this.eventTarget_||this);var r,i=this.listeners_&&this.listeners_[n];if(i){var o=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,s[n]=0),++o[n];for(var a=0,u=i.length;a<u;++a)if(!1===(r="handleEvent"in i[a]?i[a].handleEvent(e):i[a].call(this,e))||e.propagationStopped){r=!1;break}if(--o[n],0===o[n]){var c=s[n];for(delete s[n];c--;)this.removeEventListener(n,tt);delete o[n]}return r}},e.prototype.disposeInternal=function(){this.listeners_&&nt(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)},e.prototype.removeEventListener=function(t,e){var n=this.listeners_&&this.listeners_[t];if(n){var r=n.indexOf(e);-1!==r&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=tt,++this.pendingRemovals_[t]):(n.splice(r,1),0===n.length&&delete this.listeners_[t]))}},e}(G),at="change",ut="error",ct="contextmenu",ht="click",lt="dblclick",ft="keydown",pt="keypress",dt="load",vt="resize",gt="touchmove",yt="wheel";function mt(t,e,n,r,i){if(r&&r!==t&&(n=n.bind(r)),i){var o=n;n=function(){t.removeEventListener(e,n),o.apply(this,arguments)}}var s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function _t(t,e,n,r){return mt(t,e,n,r,!0)}function bt(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),nt(t))}var wt=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(t){function e(){var e=t.call(this)||this;return e.revision_=0,e}return wt(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(at)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=mt(this,t[i],e);return r}return mt(this,t,e)},e.prototype.once=function(t,e){var n;if(Array.isArray(t)){var r=t.length;n=new Array(r);for(var i=0;i<r;++i)n[i]=_t(this,t[i],e)}else n=_t(this,t,e);return e.ol_key=n,n},e.prototype.un=function(t,e){var n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)bt(t[e]);else bt(t)}(n);else if(Array.isArray(t))for(var r=0,i=t.length;r<i;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)},e}(st);var It=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tt=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.key=n,i.oldValue=r,i}return It(e,t),e}(W),Ct=function(t){function e(e){var n=t.call(this)||this;return q(n),n.values_=null,void 0!==e&&n.setProperties(e),n}return It(e,t),e.prototype.get=function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&et({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,e){var n;n=xt(t),this.dispatchEvent(new Tt(n,t,e)),n=K,this.dispatchEvent(new Tt(n,t,e))},e.prototype.set=function(t,e,n){var r=this.values_||(this.values_={});if(n)r[t]=e;else{var i=r[t];r[t]=e,i!==e&&this.notify(t,i)}},e.prototype.setProperties=function(t,e){for(var n in t)this.set(n,t[n],e)},e.prototype.applyProperties=function(t){t.values_&&et(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,e){if(this.values_&&t in this.values_){var n=this.values_[t];delete this.values_[t],it(this.values_)&&(this.values_=null),e||this.notify(t,n)}},e}(Et),St={};function xt(t){return St.hasOwnProperty(t)?St[t]:St[t]="change:"+t}var Ot="add",Pt="remove",At=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt="length",kt=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.element=n,i.index=r,i}return At(e,t),e}(W),Nt=function(t){function e(e,n){var r=t.call(this)||this,i=n||{};if(r.unique_=!!i.unique,r.array_=e||[],r.unique_)for(var o=0,s=r.array_.length;o<s;++o)r.assertUnique_(r.array_[o],o);return r.updateLength_(),r}return At(e,t),e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,n=0,r=e.length;n<r;++n)t(e[n],n,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Rt)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new kt(Ot,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new kt(Pt,e,t)),e},e.prototype.setAt=function(t,e){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(e,t);var r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new kt(Pt,r,t)),this.dispatchEvent(new kt(Ot,e,t))}else{for(var i=n;i<t;++i)this.insertAt(i,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(Rt,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new z(58)},e}(Ct);function Dt(t,e){if(!t)throw new z(e)}var Lt=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=function(t){function e(e){var n=t.call(this)||this;if(n.id_=void 0,n.geometryName_="geometry",n.style_=null,n.styleFunction_=void 0,n.geometryChangeKey_=null,n.addEventListener(xt(n.geometryName_),n.handleGeometryChanged_),e)if("function"==typeof e.getSimplifiedGeometry){var r=e;n.setGeometry(r)}else{var i=e;n.setProperties(i)}return n}return Lt(e,t),e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var n=this.getGeometry();n&&t.setGeometry(n.clone());var r=this.getStyle();return r&&t.setStyle(r),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(bt(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=mt(t,at,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:(Dt("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeEventListener(xt(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=t,this.addEventListener(xt(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Ct);var Ft="XY",jt="XYZ",Ut="XYM",Vt="XYZM",qt="Point",Bt="LineString",zt="LinearRing",Wt="Polygon",Kt="MultiPoint",Gt="MultiLineString",Ht="MultiPolygon",Xt="GeometryCollection",Yt="Circle",Qt="degrees",Jt="ft",Zt="m",$t="tile-pixels",te="us-ft",ee={};ee[Qt]=2*Math.PI*6370997/360,ee[Jt]=.3048,ee[Zt]=1,ee[te]=1200/3937;new Array(6);function ne(t,e){var n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function re(t,e,n,r,i,o,s,a){var u=Math.sin(o),c=Math.cos(o);return t[0]=r*c,t[1]=i*u,t[2]=-r*u,t[3]=i*c,t[4]=s*r*c-a*r*u+e,t[5]=s*i*u+a*i*c+n,t}function ie(t,e){var n,r=(n=e)[0]*n[3]-n[1]*n[2];Dt(0!==r,32);var i=e[0],o=e[1],s=e[2],a=e[3],u=e[4],c=e[5];return t[0]=a/r,t[1]=-o/r,t[2]=-s/r,t[3]=i/r,t[4]=(s*c-a*u)/r,t[5]=-(i*c-o*u)/r,t}function oe(t){return"matrix("+t.join(", ")+")"}var se="bottom-left",ae="bottom-right",ue="top-left",ce="top-right",he=0,le=1,fe=2,pe=4,de=8,ve=16;function ge(t){for(var e=Te(),n=0,r=t.length;n<r;++n)Pe(e,t[n]);return e}function ye(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function me(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function _e(t,e,n){var r,i;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(i=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*i}function be(t,e){return Ee(t,e[0],e[1])}function we(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Ee(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function Ie(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1],u=he;return s<n?u|=ve:s>i&&(u|=pe),a<r?u|=de:a>o&&(u|=fe),u===he&&(u=le),u}function Te(){return[1/0,1/0,-1/0,-1/0]}function Ce(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function Se(t){return Ce(1/0,1/0,-1/0,-1/0,t)}function xe(t,e){return function(t,e){for(var n=0,r=e.length;n<r;++n)Pe(t,e[n]);return t}(Se(e),t)}function Oe(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Pe(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Ae(t,e,n,r,i){for(;n<r;n+=i)Re(t,e[n],e[n+1]);return t}function Re(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function ke(t,e){var n;return(n=e(De(t)))||(n=e(Le(t)))||(n=e(Be(t)))?n:(n=e(qe(t)))||!1}function Ne(t){var e=0;return Ke(t)||(e=ze(t)*Ue(t)),e}function De(t){return[t[0],t[1]]}function Le(t){return[t[2],t[1]]}function Me(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Fe(t,e){var n;return e===se?n=De(t):e===ae?n=Le(t):e===ue?n=qe(t):e===ce?n=Be(t):Dt(!1,13),n}function je(t,e,n,r,i){var o=e*r[0]/2,s=e*r[1]/2,a=Math.cos(n),u=Math.sin(n),c=o*a,h=o*u,l=s*a,f=s*u,p=t[0],d=t[1],v=p-c+f,g=p-c-f,y=p+c-f,m=p+c+f,_=d-h-l,b=d-h+l,w=d+h+l,E=d+h-l;return Ce(Math.min(v,g,y,m),Math.min(_,b,w,E),Math.max(v,g,y,m),Math.max(_,b,w,E),i)}function Ue(t){return t[3]-t[1]}function Ve(t,e,n){var r=n||[1/0,1/0,-1/0,-1/0];return We(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):Se(r),r}function qe(t){return[t[0],t[3]]}function Be(t){return[t[2],t[3]]}function ze(t){return t[2]-t[0]}function We(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Ke(t){return t[2]<t[0]||t[3]<t[1]}var Ge=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ee[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}();function He(t,e,n){return Math.min(Math.max(t,e),n)}var Xe="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2},Ye="log2"in Math?Math.log2:function(t){return Math.log(t)*Math.LOG2E};function Qe(t,e,n,r,i,o){var s=i-n,a=o-r;if(0!==s||0!==a){var u=((t-n)*s+(e-r)*a)/(s*s+a*a);u>1?(n=i,r=o):u>0&&(n+=s*u,r+=a*u)}return Je(t,e,n,r)}function Je(t,e,n,r){var i=n-t,o=r-e;return i*i+o*o}function Ze(t){return 180*t/Math.PI}function $e(t){return t*Math.PI/180}function tn(t,e){var n=t%e;return n*e<0?n+e:n}function en(t,e,n){return t+n*(e-t)}var nn=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rn=6378137,on=Math.PI*rn,sn=[-on,-on,on,on],an=[-180,-85,180,85],un=rn*Math.log(Math.tan(Math.PI/2)),cn=function(t){function e(e){return t.call(this,{code:e,units:Zt,extent:sn,global:!0,worldExtent:an,getPointResolution:function(t,e){return t/Xe(e[1]/rn)}})||this}return nn(e,t),e}(Ge),hn=[new cn("EPSG:3857"),new cn("EPSG:102100"),new cn("EPSG:102113"),new cn("EPSG:900913"),new cn("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ln(t,e,n){var r=t.length,i=n>1?n:2,o=e;void 0===o&&(o=i>2?t.slice():new Array(r));for(var s=0;s<r;s+=i){o[s]=on*t[s]/180;var a=rn*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));a>un?a=un:a<-un&&(a=-un),o[s+1]=a}return o}function fn(t,e,n){var r=t.length,i=n>1?n:2,o=e;void 0===o&&(o=i>2?t.slice():new Array(r));for(var s=0;s<r;s+=i)o[s]=180*t[s]/on,o[s+1]=360*Math.atan(Math.exp(t[s+1]/rn))/Math.PI-90;return o}var pn=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dn=[-180,-90,180,90],vn=6378137*Math.PI/180,gn=function(t){function e(e,n){return t.call(this,{code:e,units:Qt,extent:dn,axisOrientation:n,global:!0,metersPerUnit:vn,worldExtent:dn})||this}return pn(e,t),e}(Ge),yn=[new gn("CRS:84"),new gn("EPSG:4326","neu"),new gn("urn:ogc:def:crs:OGC:1.3:CRS84"),new gn("urn:ogc:def:crs:OGC:2:84"),new gn("http://www.opengis.net/gml/srs/epsg.xml#4326","neu")],mn={};var _n={};function bn(t,e,n){var r=t.getCode(),i=e.getCode();r in _n||(_n[r]={}),_n[r][i]=n}var wn=6371008.8;function En(t,e,n){var r=n||wn,i=$e(t[1]),o=$e(e[1]),s=(o-i)/2,a=$e(e[0]-t[0])/2,u=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(i)*Math.cos(o);return 2*r*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}function In(t,e,n,r){var i=r||wn,o=$e(t[1]),s=$e(t[0]),a=e/i,u=Math.asin(Math.sin(o)*Math.cos(a)+Math.cos(o)*Math.sin(a)*Math.cos(n));return[Ze(s+Math.atan2(Math.sin(n)*Math.sin(a)*Math.cos(o),Math.cos(a)-Math.sin(o)*Math.sin(u))),Ze(u)]}function Tn(t,e){for(var n=!0,r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function Cn(t,e){var n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,o=t[1]*n+t[0]*r;return t[0]=i,t[1]=o,t}function Sn(t,e){if(e.canWrapX()){var n=ze(e.getExtent()),r=function(t,e,n){var r=e.getExtent(),i=0;if(e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])){var o=n||ze(r);i=Math.floor((t[0]-r[0])/o)}return i}(t,e,n);r&&(t[0]-=r*n)}return t}function xn(t,e,n){var r;if(void 0!==e){for(var i=0,o=t.length;i<o;++i)e[i]=t[i];r=e}else r=t.slice();return r}function On(t,e,n){if(void 0!==e&&t!==e){for(var r=0,i=t.length;r<i;++r)e[r]=t[r];t=e}return t}function Pn(t){!function(t,e){mn[t]=e}(t.getCode(),t),bn(t,t,xn)}function An(t){return"string"==typeof t?mn[e=t]||mn[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Rn(t,e,n,r){var i,o=(t=An(t)).getPointResolutionFunc();if(o){if(i=o(e,n),r&&r!==t.getUnits())(a=t.getMetersPerUnit())&&(i=i*a/ee[r])}else{var s=t.getUnits();if(s==Qt&&!r||r==Qt)i=e;else{var a,u=Ln(t,An("EPSG:4326"));if(u===On&&s!==Qt)i=e*t.getMetersPerUnit();else{var c=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];i=(En((c=u(c,c,2)).slice(0,2),c.slice(2,4))+En(c.slice(4,6),c.slice(6,8)))/2}void 0!==(a=r?ee[r]:t.getMetersPerUnit())&&(i/=a)}}return i}function kn(t){!function(t){t.forEach(Pn)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&bn(e,t,xn)}))}))}function Nn(t,e){return t?"string"==typeof t?An(t):t:An(e)}function Dn(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Ln(t,e)===xn)&&n}function Ln(t,e){var n=function(t,e){var n;return t in _n&&e in _n[t]&&(n=_n[t][e]),n}(t.getCode(),e.getCode());return n||(n=On),n}function Mn(t,e){return Ln(An(t),An(e))}var Fn,jn,Un;function Vn(t,e){return t}function qn(t,e){return t}function Bn(t,e){return t}function zn(t,e){return t}function Wn(t,e,n,r,i,o){for(var s=o||[],a=0,u=e;u<n;u+=r){var c=t[u],h=t[u+1];s[a++]=i[0]*c+i[2]*h+i[4],s[a++]=i[1]*c+i[3]*h+i[5]}return o&&s.length!=a&&(s.length=a),s}function Kn(t,e,n,r,i,o,s){for(var a=s||[],u=Math.cos(i),c=Math.sin(i),h=o[0],l=o[1],f=0,p=e;p<n;p+=r){var d=t[p]-h,v=t[p+1]-l;a[f++]=h+d*u-v*c,a[f++]=l+d*c+v*u;for(var g=p+2;g<p+r;++g)a[f++]=t[g]}return s&&a.length!=f&&(a.length=f),a}kn(hn),kn(yn),Fn=hn,jn=ln,Un=fn,yn.forEach((function(t){Fn.forEach((function(e){bn(t,e,jn),bn(e,t,Un)}))}));var Gn=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hn=[1,0,0,1,0,0],Xn=function(t){function e(){var e=t.call(this)||this;return e.extent_=[1/0,1/0,-1/0,-1/0],e.extentRevision_=-1,e.simplifiedGeometryMaxMinSquaredTolerance=0,e.simplifiedGeometryRevision=0,e.simplifyTransformedInternal=function(t){var e,n,r,i=!1;return function(){var o=Array.prototype.slice.call(arguments);return i&&this===r&&J(o,n)||(i=!0,r=this,n=o,e=t.apply(this,arguments)),e}}((function(t,e,n){if(!n)return this.getSimplifiedGeometry(e);var r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)})),e}return Gn(e,t),e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},e.prototype.clone=function(){return U()},e.prototype.closestPointXY=function(t,e,n,r){return U()},e.prototype.containsXY=function(t,e){var n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e},e.prototype.getClosestPoint=function(t,e){var n=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,1/0),n},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return U()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Se(e),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){U()},e.prototype.scale=function(t,e,n){U()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return U()},e.prototype.getType=function(){return U()},e.prototype.applyTransform=function(t){U()},e.prototype.intersectsExtent=function(t){return U()},e.prototype.translate=function(t,e){U()},e.prototype.transform=function(t,e){var n=An(t),r=n.getUnits()==$t?function(t,r,i){var o=n.getExtent(),s=n.getWorldExtent(),a=Ue(s)/Ue(o);return re(Hn,s[0],s[3],a,-a,0,0,0),Wn(t,0,t.length,i,Hn,r),Mn(n,e)(t,r,i)}:Mn(n,e);return this.applyTransform(r),this},e}(Ct),Yn=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qn=function(t){function e(){var e=t.call(this)||this;return e.layout=Ft,e.stride=2,e.flatCoordinates=null,e}return Yn(e,t),e.prototype.computeExtent=function(t){return function(t,e,n,r,i){return Ae(Se(i),t,e,n,r)}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return U()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=Jn(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){U()},e.prototype.setLayout=function(t,e,n){var r;if(t)r=Jn(t);else{for(var i=0;i<n;++i){if(0===e.length)return this.layout=Ft,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=Ft:3==t?e=jt:4==t&&(e=Vt);return e}(r=e.length)}this.layout=t,this.stride=r},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var n=this.getFlatCoordinates();if(n){var r=this.getStride();Kn(n,0,n.length,r,t,e,n),this.changed()}},e.prototype.scale=function(t,e,n){var r=e;void 0===r&&(r=t);var i=n;i||(i=Me(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,n,r,i,o,s,a){for(var u=a||[],c=s[0],h=s[1],l=0,f=e;f<n;f+=r){var p=t[f]-c,d=t[f+1]-h;u[l++]=c+i*p,u[l++]=h+o*d;for(var v=f+2;v<f+r;++v)u[l++]=t[v]}a&&u.length!=l&&(u.length=l)}(o,0,o.length,s,t,r,i,o),this.changed()}},e.prototype.translate=function(t,e){var n=this.getFlatCoordinates();if(n){var r=this.getStride();!function(t,e,n,r,i,o,s){for(var a=s||[],u=0,c=e;c<n;c+=r){a[u++]=t[c]+i,a[u++]=t[c+1]+o;for(var h=c+2;h<c+r;++h)a[u++]=t[h]}s&&a.length!=u&&(a.length=u)}(n,0,n.length,r,t,e,n),this.changed()}},e}(Xn);function Jn(t){var e;return t==Ft?e=2:t==jt||t==Ut?e=3:t==Vt&&(e=4),e}function Zn(t,e,n,r,i,o,s){var a,u=t[e],c=t[e+1],h=t[n]-u,l=t[n+1]-c;if(0===h&&0===l)a=e;else{var f=((i-u)*h+(o-c)*l)/(h*h+l*l);if(f>1)a=n;else{if(f>0){for(var p=0;p<r;++p)s[p]=en(t[e+p],t[n+p],f);return void(s.length=r)}a=e}}for(p=0;p<r;++p)s[p]=t[a+p];s.length=r}function $n(t,e,n,r,i){var o=t[e],s=t[e+1];for(e+=r;e<n;e+=r){var a=t[e],u=t[e+1],c=Je(o,s,a,u);c>i&&(i=c),o=a,s=u}return i}function tr(t,e,n,r,i,o,s,a,u,c,h){if(e==n)return c;var l,f;if(0===i){if((f=Je(s,a,t[e],t[e+1]))<c){for(l=0;l<r;++l)u[l]=t[e+l];return u.length=r,f}return c}for(var p=h||[NaN,NaN],d=e+r;d<n;)if(Zn(t,d-r,d,r,s,a,p),(f=Je(s,a,p[0],p[1]))<c){for(c=f,l=0;l<r;++l)u[l]=p[l];u.length=r,d+=r}else d+=r*Math.max((Math.sqrt(f)-Math.sqrt(c))/i|0,1);if(o&&(Zn(t,n-r,e,r,s,a,p),(f=Je(s,a,p[0],p[1]))<c)){for(c=f,l=0;l<r;++l)u[l]=p[l];u.length=r}return c}function er(t,e,n,r){for(var i=0,o=n.length;i<o;++i)for(var s=n[i],a=0;a<r;++a)t[e++]=s[a];return e}function nr(t,e,n,r,i,o,s){var a=(n-e)/r;if(a<3){for(;e<n;e+=r)o[s++]=t[e],o[s++]=t[e+1];return s}var u=new Array(a);u[0]=1,u[a-1]=1;for(var c=[e,n-r],h=0;c.length>0;){for(var l=c.pop(),f=c.pop(),p=0,d=t[f],v=t[f+1],g=t[l],y=t[l+1],m=f+r;m<l;m+=r){var _=Qe(t[m],t[m+1],d,v,g,y);_>p&&(h=m,p=_)}p>i&&(u[(h-e)/r]=1,f+r<h&&c.push(f,h),h+r<l&&c.push(h,l))}for(m=0;m<a;++m)u[m]&&(o[s++]=t[e+m*r],o[s++]=t[e+m*r+1]);return s}function rr(t,e){return e*Math.round(t/e)}function ir(t,e,n,r,i,o,s){if(e==n)return s;var a,u,c=rr(t[e],i),h=rr(t[e+1],i);e+=r,o[s++]=c,o[s++]=h;do{if(a=rr(t[e],i),u=rr(t[e+1],i),(e+=r)==n)return o[s++]=a,o[s++]=u,s}while(a==c&&u==h);for(;e<n;){var l=rr(t[e],i),f=rr(t[e+1],i);if(e+=r,l!=a||f!=u){var p=a-c,d=u-h,v=l-c,g=f-h;p*g==d*v&&(p<0&&v<p||p==v||p>0&&v>p)&&(d<0&&g<d||d==g||d>0&&g>d)?(a=l,u=f):(o[s++]=a,o[s++]=u,c=a,h=u,a=l,u=f)}}return o[s++]=a,o[s++]=u,s}function or(t,e,n,r,i){for(var o=void 0!==i?i:[],s=0,a=e;a<n;a+=r)o[s++]=t.slice(a,a+r);return o.length=s,o}function sr(t,e,n,r,i){for(var o=void 0!==i?i:[],s=0,a=0,u=n.length;a<u;++a){var c=n[a];o[s++]=or(t,e,c,r,o[s]),e=c}return o.length=s,o}function ar(t,e,n,r,i){for(var o=void 0!==i?i:[],s=0,a=0,u=n.length;a<u;++a){var c=n[a];o[s++]=sr(t,e,c,r,o[s]),e=c[c.length-1]}return o.length=s,o}function ur(t,e,n,r){for(var i=0,o=t[n-r],s=t[n-r+1];e<n;e+=r){var a=t[e],u=t[e+1];i+=s*a-o*u,o=a,s=u}return i/2}var cr=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hr=function(t){function e(e,n){var r=t.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===n||Array.isArray(e[0])?r.setCoordinates(e,n):r.setFlatCoordinates(n,e),r}return cr(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,n,r){return r<_e(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($n(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),tr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))},e.prototype.getArea=function(){return ur(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return or(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=nr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,Ft)},e.prototype.getType=function(){return zt},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=er(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Qn),lr=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fr=function(t){function e(e,n){var r=t.call(this)||this;return r.setCoordinates(e,n),r}return lr(e,t),e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,n,r){var i=this.flatCoordinates,o=Je(t,e,i[0],i[1]);if(o<r){for(var s=this.stride,a=0;a<s;++a)n[a]=i[a];return n.length=s,o}return r},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return function(t,e){var n=t[0],r=t[1];return Ce(n,r,n,r,e)}(this.flatCoordinates,t)},e.prototype.getType=function(){return qt},e.prototype.intersectsExtent=function(t){return Ee(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n,r){for(var i=0,o=n.length;i<o;++i)t[e++]=n[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Qn);function pr(t,e,n,r,i){return!ke(i,(function(i){return!dr(t,e,n,r,i[0],i[1])}))}function dr(t,e,n,r,i,o){for(var s=0,a=t[n-r],u=t[n-r+1];e<n;e+=r){var c=t[e],h=t[e+1];u<=o?h>o&&(c-a)*(o-u)-(i-a)*(h-u)>0&&s++:h<=o&&(c-a)*(o-u)-(i-a)*(h-u)<0&&s--,a=c,u=h}return 0!==s}function vr(t,e,n,r,i,o){if(0===n.length)return!1;if(!dr(t,e,n[0],r,i,o))return!1;for(var s=1,a=n.length;s<a;++s)if(dr(t,n[s-1],n[s],r,i,o))return!1;return!0}function gr(t,e,n,r,i){for(var o,s=[t[e],t[e+1]],a=[];e+r<n;e+=r){if(a[0]=t[e+r],a[1]=t[e+r+1],o=i(s,a))return o;s[0]=a[0],s[1]=a[1]}return!1}function yr(t,e,n,r,i){var o=Ae([1/0,1/0,-1/0,-1/0],t,e,n,r);return!!We(i,o)&&(!!we(i,o)||(o[0]>=i[0]&&o[2]<=i[2]||(o[1]>=i[1]&&o[3]<=i[3]||gr(t,e,n,r,(function(t,e){return function(t,e,n){var r=!1,i=Ie(t,e),o=Ie(t,n);if(i===le||o===le)r=!0;else{var s=t[0],a=t[1],u=t[2],c=t[3],h=e[0],l=e[1],f=n[0],p=n[1],d=(p-l)/(f-h),v=void 0,g=void 0;o&fe&&!(i&fe)&&(r=(v=f-(p-c)/d)>=s&&v<=u),r||!(o&pe)||i&pe||(r=(g=p-(f-u)*d)>=a&&g<=c),r||!(o&de)||i&de||(r=(v=f-(p-a)/d)>=s&&v<=u),r||!(o&ve)||i&ve||(r=(g=p-(f-s)*d)>=a&&g<=c)}return r}(i,t,e)})))))}function mr(t,e,n,r,i){if(!function(t,e,n,r,i){return!!(yr(t,e,n,r,i)||dr(t,e,n,r,i[0],i[1])||dr(t,e,n,r,i[0],i[3])||dr(t,e,n,r,i[2],i[1])||dr(t,e,n,r,i[2],i[3]))}(t,e,n[0],r,i))return!1;if(1===n.length)return!0;for(var o=1,s=n.length;o<s;++o)if(pr(t,n[o-1],n[o],r,i)&&!yr(t,n[o-1],n[o],r,i))return!1;return!0}function _r(t,e,n,r){for(;e<n-r;){for(var i=0;i<r;++i){var o=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=o}e+=r,n-=r}}function br(t,e,n,r){for(var i=0,o=t[n-r],s=t[n-r+1];e<n;e+=r){var a=t[e],u=t[e+1];i+=(a-o)*(u+s),o=a,s=u}return 0===i?void 0:i>0}function wr(t,e,n,r,i){for(var o=void 0!==i&&i,s=0,a=n.length;s<a;++s){var u=n[s],c=br(t,e,u,r);(0===s?o&&c||!o&&!c:o&&!c||!o&&c)&&_r(t,e,u,r),e=u}return e}var Er=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ir=function(t){function e(e,n,r){var i=t.call(this)||this;return i.ends_=[],i.flatInteriorPointRevision_=-1,i.flatInteriorPoint_=null,i.maxDelta_=-1,i.maxDeltaRevision_=-1,i.orientedRevision_=-1,i.orientedFlatCoordinates_=null,void 0!==n&&r?(i.setFlatCoordinates(n,e),i.ends_=r):i.setCoordinates(e,n),i}return Er(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?Q(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,n,r){return r<_e(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,r,i){for(var o=0,s=n.length;o<s;++o){var a=n[o];i=$n(t,e,a,r,i),e=a}return i}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,r,i,o,s,a,u,c,h){for(var l=h||[NaN,NaN],f=0,p=n.length;f<p;++f){var d=n[f];c=tr(t,e,d,r,i,o,s,a,u,c,l),e=d}return c}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))},e.prototype.containsXY=function(t,e){return vr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,n,r){for(var i=0,o=0,s=n.length;o<s;++o){var a=n[o];i+=ur(t,e,a,r),e=a}return i}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?wr(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,sr(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Me(this.getExtent());this.flatInteriorPoint_=function(t,e,n,r,i,o,s){for(var a,u,c,h,l,f,p,d=i[o+1],v=[],g=0,y=n.length;g<y;++g){var m=n[g];for(h=t[m-r],f=t[m-r+1],a=e;a<m;a+=r)l=t[a],p=t[a+1],(d<=f&&p<=d||f<=d&&d<=p)&&(c=(d-f)/(p-f)*(l-h)+h,v.push(c)),h=l,f=p}var _=NaN,b=-1/0;for(v.sort(H),h=v[0],a=1,u=v.length;a<u;++a){l=v[a];var w=Math.abs(l-h);w>b&&vr(t,e,n,r,c=(h+l)/2,d)&&(_=c,b=w),h=l}return isNaN(_)&&(_=i[o]),s?(s.push(_,d,b),s):[_,d,b]}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new fr(this.getFlatInteriorPoint(),Ut)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new hr(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[],i=0,o=0,s=n.length;o<s;++o){var a=n[o],u=new hr(e.slice(i,a),t);r.push(u),i=a}return r},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,n,r,i){for(var o=void 0!==i&&i,s=0,a=n.length;s<a;++s){var u=n[s],c=br(t,e,u,r);if(0===s){if(o&&c||!o&&!c)return!1}else if(o&&!c||!o&&c)return!1;e=u}return!0}(t,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=wr(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],r=[];return n.length=function(t,e,n,r,i,o,s,a){for(var u=0,c=n.length;u<c;++u){var h=n[u];s=ir(t,e,h,r,i,o,s),a.push(s),e=h}return s}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,r),new e(n,Ft,r)},e.prototype.getType=function(){return Wt},e.prototype.intersectsExtent=function(t){return mr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=function(t,e,n,r,i){for(var o=i||[],s=0,a=0,u=n.length;a<u;++a){var c=er(t,e,n[a],r);o[s++]=c,e=c}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()},e}(Qn);function Tr(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=[e,n,e,i,r,i,r,n,e,n];return new Ir(o,Ft,[o.length])}var Cr=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sr="accuracy",xr="accuracyGeometry",Or="altitude",Pr="altitudeAccuracy",Ar="heading",Rr="position",kr="projection",Nr="speed",Dr="tracking",Lr="trackingOptions",Mr=function(t){function e(e){var n=t.call(this,ut)||this;return n.code=e.code,n.message=e.message,n}return Cr(e,t),e}(W),Fr=function(t){function e(e){var n=t.call(this)||this,r=e||{};return n.position_=null,n.transform_=On,n.watchId_=void 0,n.addEventListener(xt(kr),n.handleProjectionChanged_),n.addEventListener(xt(Dr),n.handleTrackingChanged_),void 0!==r.projection&&n.setProjection(r.projection),void 0!==r.trackingOptions&&n.setTrackingOptions(r.trackingOptions),n.setTracking(void 0!==r.tracking&&r.tracking),n}return Cr(e,t),e.prototype.disposeInternal=function(){this.setTracking(!1),t.prototype.disposeInternal.call(this)},e.prototype.handleProjectionChanged_=function(){var t=this.getProjection();t&&(this.transform_=Ln(An("EPSG:4326"),t),this.position_&&this.set(Rr,this.transform_(this.position_)))},e.prototype.handleTrackingChanged_=function(){if("geolocation"in navigator){var t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},e.prototype.positionChange_=function(t){var e=t.coords;this.set(Sr,e.accuracy),this.set(Or,null===e.altitude?void 0:e.altitude),this.set(Pr,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(Ar,null===e.heading?void 0:$e(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];var n=this.transform_(this.position_);this.set(Rr,n),this.set(Nr,null===e.speed?void 0:e.speed);var r=function(t,e,n,r){for(var i=n||32,o=[],s=0;s<i;++s)Q(o,In(t,e,2*Math.PI*s/i,r));return o.push(o[0],o[1]),new Ir(o,Ft,[o.length])}(this.position_,e.accuracy);r.applyTransform(this.transform_),this.set(xr,r),this.changed()},e.prototype.positionError_=function(t){this.dispatchEvent(new Mr(t))},e.prototype.getAccuracy=function(){return this.get(Sr)},e.prototype.getAccuracyGeometry=function(){return this.get(xr)||null},e.prototype.getAltitude=function(){return this.get(Or)},e.prototype.getAltitudeAccuracy=function(){return this.get(Pr)},e.prototype.getHeading=function(){return this.get(Ar)},e.prototype.getPosition=function(){return this.get(Rr)},e.prototype.getProjection=function(){return this.get(kr)},e.prototype.getSpeed=function(){return this.get(Nr)},e.prototype.getTracking=function(){return this.get(Dr)},e.prototype.getTrackingOptions=function(){return this.get(Lr)},e.prototype.setProjection=function(t){this.set(kr,An(t))},e.prototype.setTracking=function(t){this.set(Dr,t)},e.prototype.setTrackingOptions=function(t){this.set(Lr,t)},e}(Ct),jr="prerender",Ur="postrender",Vr="precompose",qr="postcompose",Br="rendercomplete",zr=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}();function Wr(t,e,n,r,i,o,s){var a,u,c=(n-e)/r;if(1===c)a=e;else if(2===c)a=e,u=i;else if(0!==c){for(var h=t[e],l=t[e+1],f=0,p=[0],d=e+r;d<n;d+=r){var v=t[d],g=t[d+1];f+=Math.sqrt((v-h)*(v-h)+(g-l)*(g-l)),p.push(f),h=v,l=g}var y=i*f,m=function(t,e,n){for(var r,i,o=n||H,s=0,a=t.length,u=!1;s<a;)(i=+o(t[r=s+(a-s>>1)],e))<0?s=r+1:(a=r,u=!i);return u?s:~s}(p,y);m<0?(u=(y-p[-m-2])/(p[-m-1]-p[-m-2]),a=e+(-m-2)*r):a=e+m*r}var _=s>1?s:2,b=o||new Array(_);for(d=0;d<_;++d)b[d]=void 0===a?NaN:void 0===u?t[a+d]:en(t[a+d],t[a+r+d],u);return b}function Kr(t,e,n,r){for(var i=t[e],o=t[e+1],s=0,a=e+r;a<n;a+=r){var u=t[a],c=t[a+1];s+=Math.sqrt((u-i)*(u-i)+(c-o)*(c-o)),i=u,o=c}return s}var Gr=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hr=function(t){function e(e,n){var r=t.call(this)||this;return r.flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===n||Array.isArray(e[0])?r.setCoordinates(e,n):r.setFlatCoordinates(n,e),r}return Gr(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?Q(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,n,r){return r<_e(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($n(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),tr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,r))},e.prototype.forEachSegment=function(t){return gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=Ut&&this.layout!=Vt)return null;var n=void 0!==e&&e;return function(t,e,n,r,i,o){if(n==e)return null;var s;if(i<t[e+r-1])return o?((s=t.slice(e,e+r))[r-1]=i,s):null;if(t[n-1]<i)return o?((s=t.slice(n-r,n))[r-1]=i,s):null;if(i==t[e+r-1])return t.slice(e,e+r);for(var a=e/r,u=n/r;a<u;){var c=a+u>>1;i<t[(c+1)*r-1]?u=c:a=c+1}var h=t[a*r-1];if(i==h)return t.slice((a-1)*r,(a-1)*r+r);var l=(i-h)/(t[(a+1)*r-1]-h);s=[];for(var f=0;f<r-1;++f)s.push(en(t[(a-1)*r+f],t[a*r+f],l));return s.push(i),s}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n)},e.prototype.getCoordinates=function(){return or(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Wr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)},e.prototype.getLength=function(){return Kr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=nr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,Ft)},e.prototype.getType=function(){return Bt},e.prototype.intersectsExtent=function(t){return yr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=er(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Qn),Xr=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}(),Yr=0,Qr=1,Jr=2,Zr=3;function $r(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}var ti=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=$r(t.scale),this.displacement_=t.displacement}return t.prototype.clone=function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getScaleArray=function(){return this.scaleArray_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return U()},t.prototype.getImage=function(t){return U()},t.prototype.getHitDetectionImage=function(){return U()},t.prototype.getPixelRatio=function(t){return 1},t.prototype.getImageState=function(){return U()},t.prototype.getImageSize=function(){return U()},t.prototype.getHitDetectionImageSize=function(){return U()},t.prototype.getOrigin=function(){return U()},t.prototype.getSize=function(){return U()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=$r(t)},t.prototype.listenImageChange=function(t){U()},t.prototype.load=function(){U()},t.prototype.unlistenImageChange=function(t){U()},t}(),ei=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,ni=/^([a-z]*)$|^hsla?\(.*\)$/i;function ri(t){return"string"==typeof t?t:ai(t)}var ii=function(){var t={},e=0;return function(n){var r;if(t.hasOwnProperty(n))r=t[n];else{if(e>=1024){var i=0;for(var o in t)0==(3&i++)&&(delete t[o],--e)}r=function(t){var e,n,r,i,o;ni.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var n=getComputedStyle(e).color;return document.body.removeChild(e),n}return""}(t));if(ei.exec(t)){var s=t.length-1,a=void 0;a=s<=4?1:2;var u=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),n=parseInt(t.substr(1+1*a,a),16),r=parseInt(t.substr(1+2*a,a),16),i=u?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,n=(n<<4)+n,r=(r<<4)+r,u&&(i=(i<<4)+i)),o=[e,n,r,i/255]}else 0==t.indexOf("rgba(")?si(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),si(o)):Dt(!1,14);return o}(n),t[n]=r,++e}return r}}();function oi(t){return Array.isArray(t)?t:ii(t)}function si(t){return t[0]=He(t[0]+.5|0,0,255),t[1]=He(t[1]+.5|0,0,255),t[2]=He(t[2]+.5|0,0,255),t[3]=He(t[3],0,1),t}function ai(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+e+","+n+","+r+","+(void 0===t[3]?1:t[3])+")"}function ui(t){return Array.isArray(t)?ai(t):t}var ci="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",hi=-1!==ci.indexOf("firefox"),li=(-1!==ci.indexOf("safari")&&ci.indexOf("chrom"),-1!==ci.indexOf("webkit")&&-1==ci.indexOf("edge")),fi=-1!==ci.indexOf("macintosh"),pi="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,di="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,vi="undefined"!=typeof Image&&Image.prototype.decode,gi=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function yi(t,e,n){var r=n&&n.length?n.shift():di?new OffscreenCanvas(t||300,e||300):document.createElement("canvas");return t&&(r.width=t),e&&(r.height=e),r.getContext("2d")}function mi(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function _i(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var bi="ol-hidden",wi="ol-control",Ei="ol-collapsed",Ii=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),Ti=["style","variant","weight","size","lineHeight","family"],Ci=function(t){var e=t.match(Ii);if(!e)return null;for(var n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},r=0,i=Ti.length;r<i;++r){var o=e[r+1];void 0!==o&&(n[Ti[r]]=o)}return n.families=n.family.split(/,\s?/),n},Si="10px sans-serif",xi="#000",Oi="round",Pi=[],Ai="round",Ri="#000",ki="center",Ni="middle",Di=[0,0,0,0],Li=new Ct;(new st).setSize=function(){console.warn("labelCache is deprecated.")};var Mi,Fi,ji=null,Ui={},Vi=function(){var t,e,n="32px ",r=["monospace","serif"],i=r.length,o="wmytzilWMYTZIL@#/&?$%10";function s(t,s,a){for(var u=!0,c=0;c<i;++c){var h=r[c];if(e=zi(t+" "+s+" "+n+h,o),a!=h){var l=zi(t+" "+s+" "+n+a+","+h,o);u=u&&l!=e}}return!!u}function a(){for(var e=!0,n=Li.getKeys(),r=0,i=n.length;r<i;++r){var o=n[r];Li.get(o)<100&&(s.apply(this,o.split("\n"))?(nt(Ui),ji=null,Mi=void 0,Li.set(o,100)):(Li.set(o,Li.get(o)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var n=Ci(e);if(n)for(var r=n.families,i=0,o=r.length;i<o;++i){var u=r[i],c=n.style+"\n"+n.weight+"\n"+u;void 0===Li.get(c)&&(Li.set(c,100,!0),s(n.style,n.weight,u)||(Li.set(c,0,!0),void 0===t&&(t=setInterval(a,32))))}}}(),qi=function(t){var e=Ui[t];if(null==e){if(di){var n=Ci(t),r=Bi(t,"Žg");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else Fi||((Fi=document.createElement("div")).innerHTML="M",Fi.style.margin="0 !important",Fi.style.padding="0 !important",Fi.style.position="absolute !important",Fi.style.left="-99999px !important"),Fi.style.font=t,document.body.appendChild(Fi),e=Fi.offsetHeight,document.body.removeChild(Fi);Ui[t]=e}return e};function Bi(t,e){return ji||(ji=yi(1,1)),t!=Mi&&(ji.font=t,Mi=ji.font),ji.measureText(e)}function zi(t,e){return Bi(t,e).width}function Wi(t,e,n){if(e in n)return n[e];var r=zi(t,e);return n[e]=r,r}function Ki(t,e,n,r){0!==e&&(t.translate(n,r),t.rotate(e),t.translate(-n,-r))}function Gi(t,e,n,r,i,o,s,a,u,c,h){t.save(),1!==n&&(t.globalAlpha*=n),e&&t.setTransform.apply(t,e),r.contextInstructions?(t.translate(u,c),t.scale(h[0],h[1]),function(t,e){for(var n=t.contextInstructions,r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}(r,t)):h[0]<0||h[1]<0?(t.translate(u,c),t.scale(h[0],h[1]),t.drawImage(r,i,o,s,a,0,0,s,a)):t.drawImage(r,i,o,s,a,u,c,s*h[0],a*h[1]),t.restore()}var Hi=null;var Xi=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yi=function(t){function e(e){var n=this,r=void 0!==e.rotateWithView&&e.rotateWithView;return(n=t.call(this,{opacity:1,rotateWithView:r,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0]})||this).canvas_={},n.hitDetectionCanvas_=null,n.fill_=void 0!==e.fill?e.fill:null,n.origin_=[0,0],n.points_=e.points,n.radius_=void 0!==e.radius?e.radius:e.radius1,n.radius2_=e.radius2,n.angle_=void 0!==e.angle?e.angle:0,n.stroke_=void 0!==e.stroke?e.stroke:null,n.anchor_=null,n.size_=null,n.imageSize_=null,n.hitDetectionImageSize_=null,n.render(),n}return Xi(e,t),e.prototype.clone=function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return n.setOpacity(this.getOpacity()),n},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionCanvas_){var t=this.createRenderOptions();this.createHitDetectionCanvas_(t)}return this.hitDetectionCanvas_},e.prototype.getImage=function(t){if(!this.canvas_[t||1]){var e=this.createRenderOptions(),n=yi(e.size*t||1,e.size*t||1);this.draw_(e,n,0,0,t||1),this.canvas_[t||1]=n.canvas}return this.canvas_[t||1]},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return Jr},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.createRenderOptions=function(){var t,e=Oi,n=Ai,r=0,i=null,o=0,s=0;return this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=Ri),t=ui(t),void 0===(s=this.stroke_.getWidth())&&(s=1),i=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset(),void 0===(n=this.stroke_.getLineJoin())&&(n=Ai),void 0===(e=this.stroke_.getLineCap())&&(e=Oi),void 0===(r=this.stroke_.getMiterLimit())&&(r=10)),{strokeStyle:t,strokeWidth:s,size:2*(this.radius_+s)+1,lineCap:e,lineDash:i,lineDashOffset:o,lineJoin:n,miterLimit:r}},e.prototype.render=function(){var t=this.createRenderOptions(),e=yi(t.size,t.size);this.draw_(t,e,0,0,1),this.canvas_={},this.canvas_[1]=e.canvas;var n=e.canvas.width,r=n,i=this.getDisplacement();this.hitDetectionImageSize_=[t.size,t.size],this.createHitDetectionCanvas_(t),this.anchor_=[n/2-i[0],n/2+i[1]],this.size_=[n,n],this.imageSize_=[r,r]},e.prototype.draw_=function(t,e,n,r,i){var o,s,a;e.setTransform(i,0,0,i,0,0),e.translate(n,r),e.beginPath();var u=this.points_;if(u===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var c=void 0!==this.radius2_?this.radius2_:this.radius_;for(c!==this.radius_&&(u*=2),o=0;o<=u;o++)s=2*o*Math.PI/u-Math.PI/2+this.angle_,a=o%2==0?this.radius_:c,e.lineTo(t.size/2+a*Math.cos(s),t.size/2+a*Math.sin(s))}if(this.fill_){var h=this.fill_.getColor();null===h&&(h=xi),e.fillStyle=ui(h),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionCanvas_=this.getImage(1),this.fill_){var e=this.fill_.getColor(),n=0;if("string"==typeof e&&(e=oi(e)),null===e?n=1:Array.isArray(e)&&(n=4===e.length?e[3]:1),0===n){var r=yi(t.size,t.size);this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(t,r,0,0)}}},e.prototype.drawHitDetectionCanvas_=function(t,e,n,r){e.translate(n,r),e.beginPath();var i=this.points_;if(i===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o=void 0!==this.radius2_?this.radius2_:this.radius_;o!==this.radius_&&(i*=2);var s=void 0,a=void 0,u=void 0;for(s=0;s<=i;s++)u=2*s*Math.PI/i-Math.PI/2+this.angle_,a=s%2==0?this.radius_:o,e.lineTo(t.size/2+a*Math.cos(u),t.size/2+a*Math.sin(u))}e.fillStyle=xi,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e}(ti),Qi=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ji=function(t){function e(e){var n=e||{};return t.call(this,{points:1/0,fill:n.fill,radius:n.radius,stroke:n.stroke,scale:void 0!==n.scale?n.scale:1,rotation:void 0!==n.rotation?n.rotation:0,rotateWithView:void 0!==n.rotateWithView&&n.rotateWithView,displacement:void 0!==n.displacement?n.displacement:[0,0]})||this}return Qi(e,t),e.prototype.clone=function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return n.setOpacity(this.getOpacity()),n},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(Yi),Zi=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=eo,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=eo,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();var $i=null;function to(t,e){if(!$i){var n=new zr({color:"rgba(255,255,255,0.4)"}),r=new Xr({color:"#3399CC",width:1.25});$i=[new Zi({image:new Ji({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return $i}function eo(t){return t.getGeometry()}var no="line",ro="opacity",io="visible",oo="extent",so="zIndex",ao="maxResolution",uo="minResolution",co="maxZoom",ho="minZoom",lo="source",fo=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),po=function(t){function e(e){var n=t.call(this)||this,r=et({},e);return r[ro]=void 0!==e.opacity?e.opacity:1,Dt("number"==typeof r[ro],64),r[io]=void 0===e.visible||e.visible,r[so]=e.zIndex,r[ao]=void 0!==e.maxResolution?e.maxResolution:1/0,r[uo]=void 0!==e.minResolution?e.minResolution:0,r[ho]=void 0!==e.minZoom?e.minZoom:-1/0,r[co]=void 0!==e.maxZoom?e.maxZoom:1/0,n.className_=void 0!==r.className?e.className:"ol-layer",delete r.className,n.setProperties(r),n.state_=null,n}return fo(e,t),e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=He(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n?n:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return U()},e.prototype.getLayerStatesArray=function(t){return U()},e.prototype.getExtent=function(){return this.get(oo)},e.prototype.getMaxResolution=function(){return this.get(ao)},e.prototype.getMinResolution=function(){return this.get(uo)},e.prototype.getMinZoom=function(){return this.get(ho)},e.prototype.getMaxZoom=function(){return this.get(co)},e.prototype.getOpacity=function(){return this.get(ro)},e.prototype.getSourceState=function(){return U()},e.prototype.getVisible=function(){return this.get(io)},e.prototype.getZIndex=function(){return this.get(so)},e.prototype.setExtent=function(t){this.set(oo,t)},e.prototype.setMaxResolution=function(t){this.set(ao,t)},e.prototype.setMinResolution=function(t){this.set(uo,t)},e.prototype.setMaxZoom=function(t){this.set(co,t)},e.prototype.setMinZoom=function(t){this.set(ho,t)},e.prototype.setOpacity=function(t){Dt("number"==typeof t,64),this.set(ro,t)},e.prototype.setVisible=function(t){this.set(io,t)},e.prototype.setZIndex=function(t){this.set(so,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},e}(Ct),vo="undefined",go="ready",yo=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mo=function(t){function e(e){var n=this,r=et({},e);delete r.source,(n=t.call(this,r)||this).mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,e.render&&(n.render=e.render),e.map&&n.setMap(e.map),n.addEventListener(xt(lo),n.handleSourcePropertyChange_);var i=e.source?e.source:null;return n.setSource(i),n}return yo(e,t),e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(lo)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():vo},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(bt(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=mt(t,at,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},e.prototype.render=function(t,e){var n=this.getRenderer();if(n.prepareFrame(t))return n.renderFrame(t,e)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(bt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(bt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=mt(t,Vr,(function(t){var e=t.frameState.layerStatesArray,n=this.getLayerState(!1);Dt(!e.some((function(t){return t.layer===n.layer})),67),e.push(n)}),this),this.mapRenderKey_=mt(this,at,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(lo,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.setSource(null),t.prototype.disposeInternal.call(this)},e}(po);function _o(t,e){if(!t.visible)return!1;var n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;var r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function bo(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}var wo=bo((function(t,e){t.exports=function(){function t(t,r,i,o,s){!function t(n,r,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,u=r-i+1,c=Math.log(a),h=.5*Math.exp(2*c/3),l=.5*Math.sqrt(c*h*(a-h)/a)*(u-a/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-u*h/a+l)),Math.min(o,Math.floor(r+(a-u)*h/a+l)),s)}var f=n[r],p=i,d=o;for(e(n,i,r),s(n[o],f)>0&&e(n,i,o);p<d;){for(e(n,p,d),p++,d--;s(n[p],f)<0;)p++;for(;s(n[d],f)>0;)d--}0===s(n[i],f)?e(n,i,d):e(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(t,r,i||0,o||t.length-1,s||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];a(i,t.leaf?r(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,n,r,i,o){for(var s=[n,r];s.length;)if(!((r=s.pop())-(n=s.pop())<=i)){var a=n+Math.ceil((r-n)/i/2)*i;t(e,a,n,r,o),s.push(n,a,a,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?r(s):s;p(t,a)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):i.push(s))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(p(t,o)){if(e.leaf||f(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=d([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,s=this.data,a=this.toBBox(t),u=[],c=[];s||u.length;){if(s||(s=u.pop(),r=u[u.length-1],n=c.pop(),o=!0),s.leaf){var h=i(t,s.children,e);if(-1!==h)return s.children.splice(h,1),u.push(s),this._condense(u),this}o||s.leaf||!f(s,a)?r?(n++,s=r.children[n],o=!1):s=null:(u.push(s),c.push(n),n=0,r=s,s=s.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,s=n-e+1,a=this._maxEntries;if(s<=a)return o(i=d(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(i=d([])).leaf=!1,i.height=r;var u=Math.ceil(s/a),c=u*Math.ceil(Math.sqrt(a));v(t,e,n,c,this.compareMinX);for(var h=e;h<=n;h+=c){var l=Math.min(h+c-1,n);v(t,h,l,u,this.compareMinY);for(var f=h;f<=l;f+=u){var p=Math.min(f+u-1,l);i.children.push(this._build(t,f,p,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var u=e.children[a],c=h(u),l=(f=t,p=u,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-c);l<o?(o=l,i=c<i?c:i,s=u):l===o&&c<i&&(i=c,s=u)}e=s||e.children[0]}var f,p;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),a(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),a=d(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},r.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,a,u,c,l,f=1/0,p=1/0,d=e;d<=n-e;d++){var v=s(t,0,d,this.toBBox),g=s(t,d,n,this.toBBox),y=(i=v,o=g,a=void 0,u=void 0,c=void 0,l=void 0,a=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),c=Math.min(i.maxX,o.maxX),l=Math.min(i.maxY,o.maxY),Math.max(0,c-a)*Math.max(0,l-u)),m=h(v)+h(g);y<f?(f=y,r=d,p=m<p?m:p):y===f&&m<p&&(p=m,r=d)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=s(t,0,e,i),u=s(t,n-e,n,i),c=l(o)+l(u),h=e;h<n-e;h++){var f=t.children[h];a(o,t.leaf?i(f):f),c+=l(o)}for(var p=n-e-1;p>=e;p--){var d=t.children[p];a(u,t.leaf?i(d):d),c+=l(u)}return c},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)a(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()})),Eo=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Io="renderOrder",To=function(t){function e(e){var n=this,r=e||{},i=et({},r);return delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,(n=t.call(this,i)||this).declutter_=void 0!==r.declutter&&r.declutter,n.renderBuffer_=void 0!==r.renderBuffer?r.renderBuffer:100,n.style_=null,n.styleFunction_=void 0,n.setStyle(r.style),n.updateWhileAnimating_=void 0!==r.updateWhileAnimating&&r.updateWhileAnimating,n.updateWhileInteracting_=void 0!==r.updateWhileInteracting&&r.updateWhileInteracting,n}return Eo(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Io)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new wo(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(Io,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:to,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var n;Array.isArray(t)?n=t:(Dt("function"==typeof t.getZIndex,41),n=[t]),e=function(){return n}}return e}(this.style_),this.changed()},e}(mo),Co=0,So=1,xo=2,Oo=3,Po=4,Ao=5,Ro=6,ko=7,No=8,Do=9,Lo=10,Mo=11,Fo=12,jo=[No],Uo=[Fo],Vo=[So],qo=[Oo],Bo=function(){function t(){}return t.prototype.drawCustom=function(t,e,n){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,e){},t.prototype.drawFeature=function(t,e){},t.prototype.drawGeometryCollection=function(t,e){},t.prototype.drawLineString=function(t,e){},t.prototype.drawMultiLineString=function(t,e){},t.prototype.drawMultiPoint=function(t,e){},t.prototype.drawMultiPolygon=function(t,e){},t.prototype.drawPoint=function(t,e){},t.prototype.drawPolygon=function(t,e){},t.prototype.drawText=function(t,e){},t.prototype.setFillStrokeStyle=function(t,e){},t.prototype.setImageStyle=function(t,e){},t.prototype.setTextStyle=function(t,e){},t}(),zo=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wo=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.tolerance=e,o.maxExtent=n,o.pixelRatio=i,o.maxLineWidth=0,o.resolution=r,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return zo(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatPointCoordinates=function(t,e){for(var n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,i=this.coordinates,o=i.length,s=0,a=t.length;s<a;s+=e)r[0]=t[s],r[1]=t[s+1],be(n,r)&&(i[o++]=r[0],i[o++]=r[1]);return o},e.prototype.appendFlatLineCoordinates=function(t,e,n,r,i,o){var s=this.coordinates,a=s.length,u=this.getBufferedMaxExtent();o&&(e+=r);var c,h,l,f=t[e],p=t[e+1],d=this.tmpCoordinate_,v=!0;for(c=e+r;c<n;c+=r)d[0]=t[c],d[1]=t[c+1],(l=Ie(u,d))!==h?(v&&(s[a++]=f,s[a++]=p,v=!1),s[a++]=d[0],s[a++]=d[1]):l===le?(s[a++]=d[0],s[a++]=d[1],v=!1):v=!0,f=d[0],p=d[1],h=l;return(i&&v||c===e+r)&&(s[a++]=f,s[a++]=p),a},e.prototype.drawCustomCoordinates_=function(t,e,n,r,i){for(var o=0,s=n.length;o<s;++o){var a=n[o],u=this.appendFlatLineCoordinates(t,e,a,r,!1,!1);i.push(u),e=a}return e},e.prototype.drawCustom=function(t,e,n){this.beginGeometry(t,e);var r,i,o,s,a,u=t.getType(),c=t.getStride(),h=this.coordinates.length;if(u==Ht){r=t.getOrientedFlatCoordinates(),s=[];var l=t.getEndss();a=0;for(var f=0,p=l.length;f<p;++f){var d=[];a=this.drawCustomCoordinates_(r,a,l[f],c,d),s.push(d)}this.instructions.push([Po,h,s,t,n,ar])}else u==Wt||u==Gt?(o=[],r=u==Wt?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(r,0,t.getEnds(),c,o),this.instructions.push([Po,h,o,t,n,sr])):u==Bt||u==Yt?(r=t.getFlatCoordinates(),i=this.appendFlatLineCoordinates(r,0,r.length,c,!1,!1),this.instructions.push([Po,h,i,t,n,or])):u==Kt?(r=t.getFlatCoordinates(),(i=this.appendFlatPointCoordinates(r,c))>h&&this.instructions.push([Po,h,i,t,n,or])):u==qt&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),i=this.coordinates.length,this.instructions.push([Po,h,i,t,n]));this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[Co,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Co,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var n,r,i=e.length,o=-1;for(t=0;t<i;++t)(r=(n=e[t])[0])==ko?o=t:r==Co&&(n[2]=t,Y(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var n=this.state;if(t){var r=t.getColor();n.fillStyle=ui(r||xi)}else n.fillStyle=void 0;if(e){var i=e.getColor();n.strokeStyle=ui(i||Ri);var o=e.getLineCap();n.lineCap=void 0!==o?o:Oi;var s=e.getLineDash();n.lineDash=s?s.slice():Pi;var a=e.getLineDashOffset();n.lineDashOffset=a||0;var u=e.getLineJoin();n.lineJoin=void 0!==u?u:Ai;var c=e.getWidth();n.lineWidth=void 0!==c?c:1;var h=e.getMiterLimit();n.miterLimit=void 0!==h?h:10,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,n=[Lo,e];return"string"!=typeof e&&n.push(!0),n},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[Mo,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)},e.prototype.updateStrokeStyle=function(t,e){var n=t.strokeStyle,r=t.lineCap,i=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=r||i!=t.currentLineDash&&!J(t.currentLineDash,i)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=u)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=r,t.currentLineDash=i,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=u)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[ko,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=me(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;ye(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(Bo),Ko=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Go=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r,i)||this;return o.hitDetectionImage_=null,o.image_=null,o.imagePixelRatio_=void 0,o.anchorX_=void 0,o.anchorY_=void 0,o.height_=void 0,o.opacity_=void 0,o.originX_=void 0,o.originY_=void 0,o.rotateWithView_=void 0,o.rotation_=void 0,o.scale_=void 0,o.width_=void 0,o.declutterImageWithText_=void 0,o}return Ko(e,t),e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),r=t.getStride(),i=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([Ro,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ro,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),r=t.getStride(),i=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([Ro,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ro,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(e)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,e){var n=t.getAnchor(),r=t.getSize(),i=t.getHitDetectionImage(),o=t.getImage(this.pixelRatio),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=i,this.image_=o,this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterImageWithText_=e},e}(Wo),Ho=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xo=function(t){function e(e,n,r,i){return t.call(this,e,n,r,i)||this}return Ho(e,t),e.prototype.drawFlatCoordinates_=function(t,e,n,r){var i=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,r,!1,!1),s=[Do,i,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),n},e.prototype.drawLineString=function(t,e){var n=this.state,r=n.strokeStyle,i=n.lineWidth;if(void 0!==r&&void 0!==i){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Mo,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],Vo);var o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push(Uo),this.endGeometry(e)}},e.prototype.drawMultiLineString=function(t,e){var n=this.state,r=n.strokeStyle,i=n.lineWidth;if(void 0!==r&&void 0!==i){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Mo,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],Vo);for(var o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),u=0,c=0,h=o.length;c<h;++c)u=this.drawFlatCoordinates_(s,u,o[c],a);this.hitDetectionInstructions.push(Uo),this.endGeometry(e)}},e.prototype.finish=function(){var e=this.state;return null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Uo),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Uo),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(Vo)},e}(Wo),Yo=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qo=function(t){function e(e,n,r,i){return t.call(this,e,n,r,i)||this}return Yo(e,t),e.prototype.drawFlatCoordinatess_=function(t,e,n,r){var i=this.state,o=void 0!==i.fillStyle,s=void 0!==i.strokeStyle,a=n.length;this.instructions.push(Vo),this.hitDetectionInstructions.push(Vo);for(var u=0;u<a;++u){var c=n[u],h=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,c,r,!0,!s),f=[Do,h,l];this.instructions.push(f),this.hitDetectionInstructions.push(f),s&&(this.instructions.push(qo),this.hitDetectionInstructions.push(qo)),e=c}return o&&(this.instructions.push(jo),this.hitDetectionInstructions.push(jo)),s&&(this.instructions.push(Uo),this.hitDetectionInstructions.push(Uo)),e},e.prototype.drawCircle=function(t,e){var n=this.state,r=n.fillStyle,i=n.strokeStyle;if(void 0!==r||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Lo,xi]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Mo,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,s,!1,!1);var u=[xo,a];this.instructions.push(Vo,u),this.hitDetectionInstructions.push(Vo,u),void 0!==n.fillStyle&&(this.instructions.push(jo),this.hitDetectionInstructions.push(jo)),void 0!==n.strokeStyle&&(this.instructions.push(Uo),this.hitDetectionInstructions.push(Uo)),this.endGeometry(e)}},e.prototype.drawPolygon=function(t,e){var n=this.state,r=n.fillStyle,i=n.strokeStyle;if(void 0!==r||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Lo,xi]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Mo,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(e)}},e.prototype.drawMultiPolygon=function(t,e){var n=this.state,r=n.fillStyle,i=n.strokeStyle;if(void 0!==r||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Lo,xi]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Mo,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);for(var o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),u=0,c=0,h=o.length;c<h;++c)u=this.drawFlatCoordinatess_(s,u,o[c],a);this.endGeometry(e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var n=this.coordinates,r=0,i=n.length;r<i;++r)n[r]=rr(n[r],e);return t.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},e}(Wo);function Jo(t,e,n,r,i){var o,s,a,u,c,h,l,f,p,d=n,v=n,g=0,y=0,m=n;for(o=n;o<r;o+=i){var _=e[o],b=e[o+1];void 0!==u&&(f=_-u,p=b-c,a=Math.sqrt(f*f+p*p),void 0!==h&&(y+=s,Math.acos((h*f+l*p)/(s*a))>t&&(y>g&&(g=y,d=m,v=o),y=0,m=o-i)),s=a,h=f,l=p),u=_,c=b}return(y+=a)>g?[m,o]:[d,v]}var Zo=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$o={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},ts={Circle:Qo,Default:Wo,Image:Go,LineString:Xo,Polygon:Qo,Text:function(t){function e(e,n,r,i){var o=t.call(this,e,n,r,i)||this;return o.labels_=null,o.text_="",o.textOffsetX_=0,o.textOffsetY_=0,o.textRotateWithView_=void 0,o.textRotation_=0,o.textFillState_=null,o.fillStates={},o.textStrokeState_=null,o.strokeStates={},o.textState_={},o.textStates={},o.textKey_="",o.fillKey_="",o.strokeKey_="",o.declutterImageWithText_=void 0,o}return Zo(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var n=this.textFillState_,r=this.textStrokeState_,i=this.textState_;if(""!==this.text_&&i&&(n||r)){var o=this.coordinates,s=o.length,a=t.getType(),u=null,c=t.getStride();if(i.placement!==no||a!=Bt&&a!=Gt&&a!=Wt&&a!=Ht){var h=i.overflow?null:[];switch(a){case qt:case Kt:u=t.getFlatCoordinates();break;case Bt:u=t.getFlatMidpoint();break;case Yt:u=t.getCenter();break;case Gt:u=t.getFlatMidpoints(),c=2;break;case Wt:u=t.getFlatInteriorPoint(),i.overflow||h.push(u[2]/this.resolution),c=3;break;case Ht:var l=t.getFlatInteriorPoints();u=[];for(w=0,E=l.length;w<E;w+=3)i.overflow||h.push(l[w+2]/this.resolution),u.push(l[w],l[w+1]);if(0===u.length)return;c=2}if((P=this.appendFlatPointCoordinates(u,c))===s)return;this.saveTextStates_(),(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),i.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var f=i.padding;if(f!=Di&&(i.scale[0]<0||i.scale[1]<0)){var p=i.padding[0],d=i.padding[1],v=i.padding[2],g=i.padding[3];i.scale[0]<0&&(d=-d,g=-g),i.scale[1]<0&&(p=-p,v=-v),f=[p,d,v,g]}var y=this.pixelRatio;this.instructions.push([Ro,s,P,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,f==Di?Di:f.map((function(t){return t*y})),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);var m=1/y;this.hitDetectionInstructions.push([Ro,s,P,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[m,m],NaN,this.declutterImageWithText_,f,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]),this.endGeometry(e)}else{if(!We(this.getBufferedMaxExtent(),t.getExtent()))return;var _=void 0;if(u=t.getFlatCoordinates(),a==Bt)_=[u.length];else if(a==Gt)_=t.getEnds();else if(a==Wt)_=t.getEnds().slice(0,1);else if(a==Ht){var b=t.getEndss();_=[];for(var w=0,E=b.length;w<E;++w)_.push(b[w][0])}this.beginGeometry(t,e);for(var I=i.textAlign,T=0,C=void 0,S=0,x=_.length;S<x;++S){if(null==I){var O=Jo(i.maxAngle,u,T,_[S],c);T=O[0],C=O[1]}else C=_[S];for(var w=T;w<C;w+=c)o.push(u[w],u[w+1]);var P=o.length;T=_[S],this.drawChars_(s,P),s=P}this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var i=this.textKey_;i in this.textStates||(this.textStates[i]={font:e.font,textAlign:e.textAlign||ki,textBaseline:e.textBaseline||Ni,scale:e.scale});var o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))},e.prototype.drawChars_=function(t,e){var n=this.textStrokeState_,r=this.textState_,i=this.strokeKey_,o=this.textKey_,s=this.fillKey_;this.saveTextStates_();var a=this.pixelRatio,u=$o[r.textBaseline],c=this.textOffsetY_*a,h=this.text_,l=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ao,t,e,u,r.overflow,s,r.maxAngle,a,c,i,l*a,h,o,1]),this.hitDetectionInstructions.push([Ao,t,e,u,r.overflow,s,r.maxAngle,1,c,i,l,h,o,1/a])},e.prototype.setTextStyle=function(t,e){var n,r,i;if(t){var o=t.getFill();o?((r=this.textFillState_)||(r={},this.textFillState_=r),r.fillStyle=ui(o.getColor()||xi)):(r=null,this.textFillState_=r);var s=t.getStroke();if(s){(i=this.textStrokeState_)||(i={},this.textStrokeState_=i);var a=s.getLineDash(),u=s.getLineDashOffset(),c=s.getWidth(),h=s.getMiterLimit();i.lineCap=s.getLineCap()||Oi,i.lineDash=a?a.slice():Pi,i.lineDashOffset=void 0===u?0:u,i.lineJoin=s.getLineJoin()||Ai,i.lineWidth=void 0===c?1:c,i.miterLimit=void 0===h?10:h,i.strokeStyle=ui(s.getColor()||Ri)}else i=null,this.textStrokeState_=i;n=this.textState_;var l=t.getFont()||Si;Vi(l);var f=t.getScaleArray();n.overflow=t.getOverflow(),n.font=l,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.textBaseline=t.getTextBaseline()||Ni,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||Di,n.scale=void 0===f?[1,1]:f;var p=t.getOffsetX(),d=t.getOffsetY(),v=t.getRotateWithView(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===p?0:p,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==v&&v,this.textRotation_=void 0===g?0:g,this.strokeKey_=i?("string"==typeof i.strokeStyle?i.strokeStyle:q(i.strokeStyle))+i.lineCap+i.lineDashOffset+"|"+i.lineWidth+i.lineJoin+i.miterLimit+"["+i.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.textBaseline||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+q(r.fillStyle):""}else this.text_="";this.declutterImageWithText_=e},e}(Wo)},es=function(){function t(t,e,n,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}return t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var n=this.buildersByZIndex_[e];for(var r in n){var i=n[r].finish();t[e][r]=i}}return t},t.prototype.getBuilder=function(t,e){var n=void 0!==t?t.toString():"0",r=this.buildersByZIndex_[n];void 0===r&&(r={},this.buildersByZIndex_[n]=r);var i=r[e];void 0===i&&(i=new(0,ts[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=i);return i},t}(),ns=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rs=function(t){function e(e){var n=t.call(this)||this;return n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=e,n.declutterExecutorGroup=null,n}return ns(e,t),e.prototype.getFeatures=function(t){return U()},e.prototype.prepareFrame=function(t){return U()},e.prototype.renderFrame=function(t,e){return U()},e.prototype.loadedTileCallback=function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n},e.prototype.createLoadedTileFinder=function(t,e,n){return function(r,i){var o=this.loadedTileCallback.bind(this,n,r);return t.forEachLoadedTile(e,r,i,o)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,n,r,i){},e.prototype.getDataAtPixel=function(t,e,n){return U()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===Jr&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=Jr&&e!=Zr&&t.addEventListener(at,this.boundHandleImageChange_),e==Yr&&(t.load(),e=t.getState()),e==Jr},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==go&&t.changed()},e}(Et),is=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),os=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.inversePixelTransform=n,o.frameState=r,o.context=i,o}return is(e,t),e}(W),ss=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),as=function(t){function e(e){var n=t.call(this,e)||this;return n.container=null,n.renderedResolution,n.tempTransform=[1,0,0,1,0,0],n.pixelTransform=[1,0,0,1,0,0],n.inversePixelTransform=[1,0,0,1,0,0],n.context=null,n.containerReused=!1,n}return ss(e,t),e.prototype.useContainer=function(t,e,n){var r,i,o=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===o&&((a=t.firstElementChild)instanceof HTMLCanvasElement&&(i=a.getContext("2d")));if(!i||0!==i.canvas.width&&i.canvas.style.transform!==e?this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1):(this.container=t,this.context=i,this.containerReused=!0),!this.container){(r=document.createElement("div")).className=o;var s=r.style;s.position="absolute",s.width="100%",s.height="100%";var a=(i=yi()).canvas;r.appendChild(a),(s=a.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=r,this.context=i}},e.prototype.clip=function(t,e,n){var r=e.pixelRatio,i=e.size[0]*r/2,o=e.size[1]*r/2,s=e.viewState.rotation,a=qe(n),u=Be(n),c=Le(n),h=De(n);ne(e.coordinateToPixelTransform,a),ne(e.coordinateToPixelTransform,u),ne(e.coordinateToPixelTransform,c),ne(e.coordinateToPixelTransform,h),t.save(),Ki(t,-s,i,o),t.beginPath(),t.moveTo(a[0]*r,a[1]*r),t.lineTo(u[0]*r,u[1]*r),t.lineTo(c[0]*r,c[1]*r),t.lineTo(h[0]*r,h[1]*r),t.clip(),Ki(t,s,i,o)},e.prototype.clipUnrotated=function(t,e,n){var r=qe(n),i=Be(n),o=Le(n),s=De(n);ne(e.coordinateToPixelTransform,r),ne(e.coordinateToPixelTransform,i),ne(e.coordinateToPixelTransform,o),ne(e.coordinateToPixelTransform,s);var a=this.inversePixelTransform;ne(a,r),ne(a,i),ne(a,o),ne(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,n){var r=this.getLayer();if(r.hasListener(t)){var i=new os(t,this.inversePixelTransform,n,e);r.dispatchEvent(i)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(jr,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(Ur,t,e)},e.prototype.getRenderTransform=function(t,e,n,r,i,o,s){var a=i/2,u=o/2,c=r/e,h=-c,l=-t[0]+s,f=-t[1];return re(this.tempTransform,a,u,c,h,-n,l,f)},e.prototype.getDataAtPixel=function(t,e,n){var r,i=ne(this.inversePixelTransform,t.slice()),o=this.context,s=this.getLayer().getExtent();if(s&&!be(s,ne(e.pixelToCoordinateTransform,t.slice())))return null;try{var a=Math.round(i[0]),u=Math.round(i[1]),c=document.createElement("canvas"),h=c.getContext("2d");c.width=1,c.height=1,h.clearRect(0,0,1,1),h.drawImage(o.canvas,a,u,1,1,0,0,1,1),r=h.getImageData(0,0,1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:r}return 0===r[3]?null:r},e}(rs),us="Circle",cs="Default",hs="Image",ls="LineString",fs="Polygon",ps="Text";function ds(t,e,n,r,i,o,s,a,u,c,h,l){var f=t[e],p=t[e+1],d=0,v=0,g=0,y=0;function m(){d=f,v=p,f=t[e+=r],p=t[e+1],y+=g,g=Math.sqrt((f-d)*(f-d)+(p-v)*(p-v))}do{m()}while(e<n-r&&y+g<o);for(var _=(o-y)/g,b=en(d,f,_),w=en(v,p,_),E=e-r,I=y,T=o+a*u(c,i,h);e<n-r&&y+g<T;)m();var C,S=en(d,f,_=(T-y)/g),x=en(v,p,_);if(l){var O=[b,w,S,x];Kn(O,0,4,2,l,O,O),C=O[0]>O[2]}else C=b>S;var P,A=Math.PI,R=[],k=E+r===e;if(g=0,y=I,f=t[e=E],p=t[e+1],k){m();var N=Math.atan2(p-v,f-d);C&&(N+=N>0?-A:A);var D=(S+b)/2,L=(x+w)/2;return R[0]=[D,L,(T-o)/2,N,i],R}for(var M=0,F=i.length;M<F;){m();var j=Math.atan2(p-v,f-d);if(C&&(j+=j>0?-A:A),void 0!==P){var U=j-P;if(U+=U>A?-2*A:U<-A?2*A:0,Math.abs(U)>s)return null}P=j;for(var V=M,q=0;M<F;++M){var B=a*u(c,i[C?F-M-1:M],h);if(e+r<n&&y+g<o+q+B/2)break;q+=B}if(M!==V){var z=C?i.substring(F-V,F-M):i.substring(V,M);D=en(d,f,_=(o+q/2-y)/g),L=en(v,p,_);R.push([D,L,q/2,j,z]),o+=q}}return R}var vs=[1/0,1/0,-1/0,-1/0],gs=[],ys=[],ms=[],_s=[];function bs(t){return t[3].declutterBox}var ws=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Es(t,e){return"start"!==e&&"end"!==e||ws.test(t)||(e="start"===e?"left":"right"),$o[e]}var Is=function(){function t(t,e,n,r,i){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderBuffer_=i,this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,e,n,r){var i=t+e+n+r;if(this.labels_[i])return this.labels_[i];var o=r?this.strokeStates[r]:null,s=n?this.fillStates[n]:null,a=this.textStates[e],u=this.pixelRatio,c=[a.scale[0]*u,a.scale[1]*u],h=Es(t,a.textAlign||ki),l=r&&o.lineWidth?o.lineWidth:0,f=t.split("\n"),p=f.length,d=[],v=function(t,e,n){for(var r=e.length,i=0,o=0;o<r;++o){var s=zi(t,e[o]);i=Math.max(i,s),n.push(s)}return i}(a.font,f,d),g=qi(a.font),y=v+l,m=[],_=(y+2)*c[0],b=(g*p+l)*c[1],w={width:_<0?Math.floor(_):Math.ceil(_),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:m};(1==c[0]&&1==c[1]||m.push("scale",c),m.push("font",a.font),r)&&(m.push("strokeStyle",o.strokeStyle),m.push("lineWidth",l),m.push("lineCap",o.lineCap),m.push("lineJoin",o.lineJoin),m.push("miterLimit",o.miterLimit),(di?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(m.push("setLineDash",[o.lineDash]),m.push("lineDashOffset",o.lineDashOffset)));n&&m.push("fillStyle",s.fillStyle),m.push("textBaseline","middle"),m.push("textAlign","center");var E,I=.5-h,T=h*y+I*l;if(r)for(E=0;E<p;++E)m.push("strokeText",[f[E],T+I*d[E],.5*(l+g)+E*g]);if(n)for(E=0;E<p;++E)m.push("fillText",[f[E],T+I*d[E],.5*(l+g)+E*g]);return this.labels_[i]=w,w},t.prototype.replayTextBackground_=function(t,e,n,r,i,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,i),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},t.prototype.calculateImageOrLabelDimensions_=function(t,e,n,r,i,o,s,a,u,c,h,l,f,p,d,v){var g,y=n-(s*=l[0]),m=r-(a*=l[1]),_=i+u>t?t-u:i,b=o+c>e?e-c:o,w=p[3]+_*l[0]+p[1],E=p[0]+b*l[1]+p[2],I=y-p[3],T=m-p[0];return(d||0!==h)&&(gs[0]=I,_s[0]=I,gs[1]=T,ys[1]=T,ys[0]=I+w,ms[0]=ys[0],ms[1]=T+E,_s[1]=ms[1]),0!==h?(ne(g=re([1,0,0,1,0,0],n,r,1,1,h,-n,-r),gs),ne(g,ys),ne(g,ms),ne(g,_s),Ce(Math.min(gs[0],ys[0],ms[0],_s[0]),Math.min(gs[1],ys[1],ms[1],_s[1]),Math.max(gs[0],ys[0],ms[0],_s[0]),Math.max(gs[1],ys[1],ms[1],_s[1]),vs)):Ce(Math.min(I,I+w),Math.min(T,T+E),Math.max(I,I+w),Math.max(T,T+E),vs),f&&(y=Math.round(y),m=Math.round(m)),{drawImageX:y,drawImageY:m,drawImageW:_,drawImageH:b,originX:u,originY:c,declutterBox:{minX:vs[0],minY:vs[1],maxX:vs[2],maxY:vs[3],value:v},canvasTransform:g,scale:l}},t.prototype.replayImageOrLabel_=function(t,e,n,r,i,o,s){var a=!(!o&&!s),u=r.declutterBox,c=t.canvas,h=s?s[2]*r.scale[0]/2:0;return u.minX-h<=c.width/e&&u.maxX+h>=0&&u.minY-h<=c.height/e&&u.maxY+h>=0&&(a&&this.replayTextBackground_(t,gs,ys,ms,_s,o,s),Gi(t,r.canvasTransform,i,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0},t.prototype.fill_=function(t){if(this.alignFill_){var e=ne(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(e[0]%n,e[1]%n),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},t.prototype.drawLabelWithPointPlacement_=function(t,e,n,r){var i=this.textStates[e],o=this.createLabel(t,e,r,n),s=this.strokeStates[n],a=this.pixelRatio,u=Es(t,i.textAlign||ki),c=$o[i.textBaseline||Ni],h=s&&s.lineWidth?s.lineWidth:0;return{label:o,anchorX:u*(o.width/a-2*i.scale[0])+2*(.5-u)*h,anchorY:c*o.height/a+2*(.5-c)*h}},t.prototype.execute_=function(t,e,n,r,i,o,s,a){var u,c,h;this.pixelCoordinates_&&J(n,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=Wn(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),c=this.renderedTransform_,h=n,c[0]=h[0],c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5]);for(var l,f,p,d,v,g,y,m,_,b,w,E,I,T,C,S,x=0,O=r.length,P=0,A=0,R=0,k=null,N=null,D=this.coordinateCache_,L=this.viewRotation_,M=Math.round(1e12*Math.atan2(-n[1],n[0]))/1e12,F={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:L},j=this.instructions!=r||this.overlaps?0:200;x<O;){var U=r[x];switch(U[0]){case Co:I=U[1],S=U[3],I.getGeometry()?void 0===s||We(s,S.getExtent())?++x:x=U[2]+1:x=U[2];break;case So:A>j&&(this.fill_(t),A=0),R>j&&(t.stroke(),R=0),A||R||(t.beginPath(),d=NaN,v=NaN),++x;break;case xo:var V=u[P=U[1]],q=u[P+1],B=u[P+2]-V,z=u[P+3]-q,W=Math.sqrt(B*B+z*z);t.moveTo(V+W,q),t.arc(V,q,W,0,2*Math.PI,!0),++x;break;case Oo:t.closePath(),++x;break;case Po:P=U[1],l=U[2];var K=U[3],G=U[4],H=6==U.length?U[5]:void 0;F.geometry=K,F.feature=I,x in D||(D[x]=[]);var X=D[x];H?H(u,P,l,2,X):(X[0]=u[P],X[1]=u[P+1],X.length=2),G(X,F),++x;break;case Ro:P=U[1],l=U[2],m=U[3],f=U[4],p=U[5];var Y=U[6],Q=U[7],Z=U[8],$=U[9],tt=U[10],et=U[11],nt=U[12],rt=U[13],it=U[14];if(!m&&U.length>=19){_=U[18],b=U[19],w=U[20],E=U[21];var ot=this.drawLabelWithPointPlacement_(_,b,w,E);m=ot.label,U[3]=m;var st=U[22];f=(ot.anchorX-st)*this.pixelRatio,U[4]=f;var at=U[23];p=(ot.anchorY-at)*this.pixelRatio,U[5]=p,Y=m.height,U[6]=Y,rt=m.width,U[13]=rt}var ut=void 0;U.length>24&&(ut=U[24]);var ct=void 0,ht=void 0,lt=void 0;U.length>16?(ct=U[15],ht=U[16],lt=U[17]):(ct=Di,ht=!1,lt=!1),tt&&M?et+=L:tt||M||(et-=L);for(var ft=0;P<l;P+=2)if(!(ut&&ut[ft++]<rt/this.pixelRatio)){var pt=[t,e,m,Ut=this.calculateImageOrLabelDimensions_(m.width,m.height,u[P],u[P+1],rt,Y,f,p,Z,$,et,nt,i,ct,ht||lt,I),Q,ht?k:null,lt?N:null],dt=void 0,vt=void 0;if(a&&it){if(!it[P]){it[P]=pt;continue}if(dt=it[P],delete it[P],vt=bs(dt),a.collides(vt))continue}a&&a.collides(Ut.declutterBox)||(dt&&(a&&a.insert(vt),this.replayImageOrLabel_.apply(this,dt)),a&&a.insert(Ut.declutterBox),this.replayImageOrLabel_.apply(this,pt))}++x;break;case Ao:var gt=U[1],yt=U[2],mt=U[3],_t=U[4];E=U[5];var bt=U[6],wt=U[7],Et=U[8];w=U[9];var It=U[10];_=U[11],b=U[12];var Tt=[U[13],U[13]],Ct=this.textStates[b],St=Ct.font,xt=[Ct.scale[0]*wt,Ct.scale[1]*wt],Ot=void 0;St in this.widths_?Ot=this.widths_[St]:(Ot={},this.widths_[St]=Ot);var Pt=Kr(u,gt,yt,2),At=Math.abs(xt[0])*Wi(St,_,Ot);if(_t||At<=Pt){var Rt=this.textStates[b].textAlign,kt=ds(u,gt,yt,2,_,(Pt-At)*$o[Rt],bt,Math.abs(xt[0]),Wi,St,Ot,M?0:this.viewRotation_);t:if(kt){var Nt=[],Dt=void 0,Lt=void 0,Mt=void 0,Ft=void 0,jt=void 0;if(w)for(Dt=0,Lt=kt.length;Dt<Lt;++Dt){Mt=(jt=kt[Dt])[4],Ft=this.createLabel(Mt,b,"",w),f=jt[2]+(xt[0]<0?-It:It),p=mt*Ft.height+2*(.5-mt)*It*xt[1]/xt[0]-Et;var Ut=this.calculateImageOrLabelDimensions_(Ft.width,Ft.height,jt[0],jt[1],Ft.width,Ft.height,f,p,0,0,jt[3],Tt,!1,Di,!1,I);if(a&&a.collides(Ut.declutterBox))break t;Nt.push([t,e,Ft,Ut,1,null,null])}if(E)for(Dt=0,Lt=kt.length;Dt<Lt;++Dt){Mt=(jt=kt[Dt])[4],Ft=this.createLabel(Mt,b,E,""),f=jt[2],p=mt*Ft.height-Et;Ut=this.calculateImageOrLabelDimensions_(Ft.width,Ft.height,jt[0],jt[1],Ft.width,Ft.height,f,p,0,0,jt[3],Tt,!1,Di,!1,I);if(a&&a.collides(Ut.declutterBox))break t;Nt.push([t,e,Ft,Ut,1,null,null])}a&&a.load(Nt.map(bs));for(var Vt=0,qt=Nt.length;Vt<qt;++Vt)this.replayImageOrLabel_.apply(this,Nt[Vt])}}++x;break;case ko:if(void 0!==o){var Bt=o(I=U[1],S);if(Bt)return Bt}++x;break;case No:j?A++:this.fill_(t),++x;break;case Do:for(P=U[1],l=U[2],T=u[P],y=(C=u[P+1])+.5|0,(g=T+.5|0)===d&&y===v||(t.moveTo(T,C),d=g,v=y),P+=2;P<l;P+=2)g=(T=u[P])+.5|0,y=(C=u[P+1])+.5|0,P!=l-2&&g===d&&y===v||(t.lineTo(T,C),d=g,v=y);++x;break;case Lo:k=U,this.alignFill_=U[2],A&&(this.fill_(t),A=0,R&&(t.stroke(),R=0)),t.fillStyle=U[1],++x;break;case Mo:N=U,R&&(t.stroke(),R=0),this.setStrokeStyle_(t,U),++x;break;case Fo:j?R++:t.stroke(),++x;break;default:++x}}A&&this.fill_(t),R&&t.stroke()},t.prototype.execute=function(t,e,n,r,i,o){this.viewRotation_=r,this.execute_(t,e,n,this.instructions,i,void 0,void 0,o)},t.prototype.executeHitDetection=function(t,e,n,r,i){return this.viewRotation_=n,this.execute_(t,1,e,this.hitDetectionInstructions,!0,r,i)},t}(),Ts=[fs,us,ls,hs,ps,cs],Cs=function(){function t(t,e,n,r,i,o){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(i)}return t.prototype.clip=function(t,e){var n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()},t.prototype.createExecutors_=function(t){for(var e in t){var n=this.executorsByZIndex_[e];void 0===n&&(n={},this.executorsByZIndex_[e]=n);var r=t[e],i=[this.renderBuffer_||0,this.renderBuffer_||0];for(var o in r){var s=r[o];n[o]=new Is(this.resolution_,this.pixelRatio_,this.overlaps_,s,i)}}},t.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[e],r=0,i=t.length;r<i;++r)if(t[r]in n)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(t,e,n,r,i,o){var s=2*(r=Math.round(r))+1,a=re(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-n,-t[0],-t[1]),u=!this.hitDetectionContext_;u&&(this.hitDetectionContext_=yi(s,s));var c,h=this.hitDetectionContext_;h.canvas.width!==s||h.canvas.height!==s?(h.canvas.width=s,h.canvas.height=s):u||h.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(Pe(c=[1/0,1/0,-1/0,-1/0],t),ye(c,e*(this.renderBuffer_+r),c));var l,f=function(t){if(void 0!==Ss[t])return Ss[t];for(var e=2*t+1,n=t*t,r=new Array(n+1),i=0;i<=t;++i)for(var o=0;o<=t;++o){var s=i*i+o*o;if(s>n)break;var a=r[s];a||(a=[],r[s]=a),a.push(4*((t+i)*e+(t+o))+3),i>0&&a.push(4*((t-i)*e+(t+o))+3),o>0&&(a.push(4*((t+i)*e+(t-o))+3),i>0&&a.push(4*((t-i)*e+(t-o))+3))}for(var u=[],c=(i=0,r.length);i<c;++i)r[i]&&u.push.apply(u,r[i]);return Ss[t]=u,u}(r);function p(t,e){for(var n=h.getImageData(0,0,s,s).data,a=0,u=f.length;a<u;a++)if(n[f[a]]>0){if(!o||l!==hs&&l!==ps||-1!==o.indexOf(t)){var c=(f[a]-3)/4,p=r-c%s,d=r-(c/s|0),v=i(t,e,p*p+d*d);if(v)return v}h.clearRect(0,0,s,s);break}}var d,v,g,y,m,_=Object.keys(this.executorsByZIndex_).map(Number);for(_.sort(H),d=_.length-1;d>=0;--d){var b=_[d].toString();for(g=this.executorsByZIndex_[b],v=Ts.length-1;v>=0;--v)if(void 0!==(y=g[l=Ts[v]])&&(m=y.executeHitDetection(h,a,n,p,c)))return m}},t.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var n=e[0],r=e[1],i=e[2],o=e[3],s=[n,r,n,o,i,o,i,r];return Wn(s,0,8,2,t,s),s},t.prototype.isEmpty=function(){return it(this.executorsByZIndex_)},t.prototype.execute=function(t,e,n,r,i,o,s){var a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(H),this.maxExtent_&&(t.save(),this.clip(t,n));var u,c,h,l,f,p,d=o||Ts;for(s&&a.reverse(),u=0,c=a.length;u<c;++u){var v=a[u].toString();for(f=this.executorsByZIndex_[v],h=0,l=d.length;h<l;++h){void 0!==(p=f[d[h]])&&p.execute(t,e,n,r,i,s)}}this.maxExtent_&&t.restore()},t}(),Ss={};var xs=0,Os=1,Ps=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),As=function(t){function e(e,n,r,i,o,s,a){var u=t.call(this)||this;return u.context_=e,u.pixelRatio_=n,u.extent_=r,u.transform_=i,u.viewRotation_=o,u.squaredTolerance_=s,u.userTransform_=a,u.contextFillState_=null,u.contextStrokeState_=null,u.contextTextState_=null,u.fillState_=null,u.strokeState_=null,u.image_=null,u.imageAnchorX_=0,u.imageAnchorY_=0,u.imageHeight_=0,u.imageOpacity_=0,u.imageOriginX_=0,u.imageOriginY_=0,u.imageRotateWithView_=!1,u.imageRotation_=0,u.imageScale_=[0,0],u.imageWidth_=0,u.text_="",u.textOffsetX_=0,u.textOffsetY_=0,u.textRotateWithView_=!1,u.textRotation_=0,u.textScale_=[0,0],u.textFillState_=null,u.textStrokeState_=null,u.textState_=null,u.pixelCoordinates_=[],u.tmpLocalTransform_=[1,0,0,1,0,0],u}return Ps(e,t),e.prototype.drawImages_=function(t,e,n,r){if(this.image_){var i=Wn(t,e,n,2,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);var u=this.imageRotation_;this.imageRotateWithView_&&(u+=this.viewRotation_);for(var c=0,h=i.length;c<h;c+=2){var l=i[c]-this.imageAnchorX_,f=i[c+1]-this.imageAnchorY_;if(0!==u||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var p=l+this.imageAnchorX_,d=f+this.imageAnchorY_;re(s,p,d,1,1,u,-p,-d),o.setTransform.apply(o,s),o.translate(p,d),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,l,f,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=a)}},e.prototype.drawText_=function(t,e,n,r){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var i=Wn(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<n;e+=r){var a=i[e]+this.textOffsetX_,u=i[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_[0]||1!=this.textScale_[1]){var c=re(this.tmpLocalTransform_,a,u,1,1,s,-a,-u);o.setTransform.apply(o,c),o.translate(a,u),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&o.strokeText(this.text_,a,u),this.textFillState_&&o.fillText(this.text_,a,u)}}},e.prototype.moveToLineTo_=function(t,e,n,r,i){var o=this.context_,s=Wn(t,e,n,r,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);var a=s.length;i&&(a-=2);for(var u=2;u<a;u+=2)o.lineTo(s[u],s[u+1]);return i&&o.closePath(),n},e.prototype.drawRings_=function(t,e,n,r){for(var i=0,o=n.length;i<o;++i)e=this.moveToLineTo_(t,e,n[i],r,!0);return e},e.prototype.drawCircle=function(t){if(We(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,n){var r=t.getFlatCoordinates();if(r){var i=t.getStride();return Wn(r,0,r.length,i,e,n)}return null}(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],r=e[3]-e[1],i=Math.sqrt(n*n+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],i,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case qt:this.drawPoint(t);break;case Bt:this.drawLineString(t);break;case Wt:this.drawPolygon(t);break;case Kt:this.drawMultiPoint(t);break;case Gt:this.drawMultiLineString(t);break;case Ht:this.drawMultiPolygon(t);break;case Xt:this.drawGeometryCollection(t);break;case Yt:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var n=e.getGeometryFunction()(t);n&&We(this.extent_,n.getExtent())&&(this.setStyle(e),this.drawGeometry(n))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),n=0,r=e.length;n<r;++n)this.drawGeometry(e[n])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),We(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var r=t.getFlatMidpoint();this.drawText_(r,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(We(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,r=t.getFlatCoordinates(),i=0,o=t.getEnds(),s=t.getStride();n.beginPath();for(var a=0,u=o.length;a<u;++a)i=this.moveToLineTo_(r,i,o[a],s,!1);n.stroke()}if(""!==this.text_){var c=t.getFlatMidpoints();this.drawText_(c,0,c.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),We(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var n=t.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),We(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getOrientedFlatCoordinates(),r=0,i=t.getEndss(),o=t.getStride();e.beginPath();for(var s=0,a=i.length;s<a;++s){var u=i[s];r=this.drawRings_(n,r,u,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var c=t.getFlatInteriorPoints();this.drawText_(c,0,c.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(J(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,n=this.contextTextState_,r=t.textAlign?t.textAlign:ki;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=r&&(n.textAlign=r,e.textAlign=r),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var n=t.getColor();this.fillState_={fillStyle:ui(n||xi)}}else this.fillState_=null;if(e){var r=e.getColor(),i=e.getLineCap(),o=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),u=e.getWidth(),c=e.getMiterLimit();this.strokeState_={lineCap:void 0!==i?i:Oi,lineDash:o||Pi,lineDashOffset:s||0,lineJoin:void 0!==a?a:Ai,lineWidth:this.pixelRatio_*(void 0!==u?u:1),miterLimit:void 0!==c?c:10,strokeStyle:ui(r||Ri)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getSize();if(e){var n=t.getAnchor(),r=t.getImage(1),i=t.getOrigin(),o=t.getScaleArray();this.imageAnchorX_=n[0],this.imageAnchorY_=n[1],this.imageHeight_=e[1],this.image_=r,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=i[0],this.imageOriginY_=i[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=[this.pixelRatio_*o[0],this.pixelRatio_*o[1]],this.imageWidth_=e[0]}else this.image_=null}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var n=e.getColor();this.textFillState_={fillStyle:ui(n||xi)}}else this.textFillState_=null;var r=t.getStroke();if(r){var i=r.getColor(),o=r.getLineCap(),s=r.getLineDash(),a=r.getLineDashOffset(),u=r.getLineJoin(),c=r.getWidth(),h=r.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:Oi,lineDash:s||Pi,lineDashOffset:a||0,lineJoin:void 0!==u?u:Ai,lineWidth:void 0!==c?c:1,miterLimit:void 0!==h?h:10,strokeStyle:ui(i||Ri)}}else this.textStrokeState_=null;var l=t.getFont(),f=t.getOffsetX(),p=t.getOffsetY(),d=t.getRotateWithView(),v=t.getRotation(),g=t.getScaleArray(),y=t.getText(),m=t.getTextAlign(),_=t.getTextBaseline();this.textState_={font:void 0!==l?l:Si,textAlign:void 0!==m?m:ki,textBaseline:void 0!==_?_:Ni},this.text_=void 0!==y?y:"",this.textOffsetX_=void 0!==f?this.pixelRatio_*f:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0!==v?v:0,this.textScale_=[this.pixelRatio_*g[0],this.pixelRatio_*g[1]]}else this.text_=""},e}(Bo),Rs="fraction",ks="pixels",Ns="bottom-left",Ds="bottom-right",Ls="top-left",Ms="top-right";function Fs(t,e,n){return e+":"+t+":"+(n?ri(n):"null")}var js=new(function(){function t(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},t.prototype.get=function(t,e,n){var r=Fs(t,e,n);return r in this.cache_?this.cache_[r]:null},t.prototype.set=function(t,e,n,r){var i=Fs(t,e,n);this.cache_[i]=r,++this.cacheSize_},t.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},t}()),Us=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vs=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.extent=e,o.pixelRatio_=r,o.resolution=n,o.state=i,o}return Us(e,t),e.prototype.changed=function(){this.dispatchEvent(at)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return U()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){U()},e}(st),qs=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){function e(e,n,r,i,o,s){var a=t.call(this,e,n,r,Yr)||this;return a.src_=i,a.image_=new Image,null!==o&&(a.image_.crossOrigin=o),a.unlisten_=null,a.state=Yr,a.imageLoadFunction_=s,a}qs(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=Zr,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Ue(this.extent)/this.image_.height),this.state=Jr,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=Yr&&this.state!=Zr||(this.state=Qr,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=Bs(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}(Vs);function Bs(t,e,n){var r=t;if(r.src&&vi){var i=r.decode(),o=!0;return i.then((function(){o&&e()})).catch((function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():n())})),function(){o=!1}}var s=[_t(r,dt,e),_t(r,ut,n)];return function(){s.forEach(bt)}}var zs=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ws=null,Ks=function(t){function e(e,n,r,i,o,s){var a=t.call(this)||this;return a.hitDetectionImage_=null,a.image_=e||new Image,null!==i&&(a.image_.crossOrigin=i),a.canvas_={},a.color_=s,a.unlisten_=null,a.imageState_=o,a.size_=r,a.src_=n,a.tainted_,a}return zs(e,t),e.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===Jr){Ws||(Ws=yi(1,1)),Ws.drawImage(this.image_,0,0);try{Ws.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Ws=null,this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(at)},e.prototype.handleImageError_=function(){this.imageState_=Zr,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=Jr,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],n=yi(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==Yr){this.imageState_=Qr;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=Bs(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(this.color_&&!this.canvas_[t]){var e=document.createElement("canvas");this.canvas_[t]=e,e.width=Math.ceil(this.image_.width*t),e.height=Math.ceil(this.image_.height*t);var n=e.getContext("2d");if(n.scale(t,t),n.drawImage(this.image_,0,0),n.globalCompositeOperation="multiply","multiply"===n.globalCompositeOperation||this.isTainted_())n.fillStyle=ri(this.color_),n.fillRect(0,0,e.width,e.height),n.globalCompositeOperation="destination-in",n.drawImage(this.image_,0,0);else{for(var r=n.getImageData(0,0,e.width,e.height),i=r.data,o=this.color_[0]/255,s=this.color_[1]/255,a=this.color_[2]/255,u=this.color_[3],c=0,h=i.length;c<h;c+=4)i[c]*=o,i[c+1]*=s,i[c+2]*=a,i[c+3]*=u;n.putImageData(r,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(st);var Gs=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hs=function(t){function e(e){var n=this,r=e||{},i=void 0!==r.opacity?r.opacity:1,o=void 0!==r.rotation?r.rotation:0,s=void 0!==r.scale?r.scale:1,a=void 0!==r.rotateWithView&&r.rotateWithView;(n=t.call(this,{opacity:i,rotation:o,scale:s,displacement:void 0!==r.displacement?r.displacement:[0,0],rotateWithView:a})||this).anchor_=void 0!==r.anchor?r.anchor:[.5,.5],n.normalizedAnchor_=null,n.anchorOrigin_=void 0!==r.anchorOrigin?r.anchorOrigin:Ls,n.anchorXUnits_=void 0!==r.anchorXUnits?r.anchorXUnits:Rs,n.anchorYUnits_=void 0!==r.anchorYUnits?r.anchorYUnits:Rs,n.crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null;var u=void 0!==r.img?r.img:null,c=void 0!==r.imgSize?r.imgSize:null,h=r.src;Dt(!(void 0!==h&&u),4),Dt(!u||u&&c,5),void 0!==h&&0!==h.length||!u||(h=u.src||q(u)),Dt(void 0!==h&&h.length>0,6);var l=void 0!==r.src?Yr:Jr;return n.color_=void 0!==r.color?oi(r.color):null,n.iconImage_=function(t,e,n,r,i,o){var s=js.get(e,r,o);return s||(s=new Ks(t,e,n,r,i,o),js.set(e,r,o,s)),s}(u,h,c,n.crossOrigin_,l,n.color_),n.offset_=void 0!==r.offset?r.offset:[0,0],n.offsetOrigin_=void 0!==r.offsetOrigin?r.offsetOrigin:Ls,n.origin_=null,n.size_=void 0!==r.size?r.size:null,n}return Gs(e,t),e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==Rs||this.anchorYUnits_==Rs){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==Rs&&(t[0]*=e[0]),this.anchorYUnits_==Rs&&(t[1]*=e[1])}if(this.anchorOrigin_!=Ls){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=Ms&&this.anchorOrigin_!=Ds||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=Ns&&this.anchorOrigin_!=Ds||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_,e=this.getDisplacement();if(this.offsetOrigin_!=Ls){var n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;t=t.slice(),this.offsetOrigin_!=Ms&&this.offsetOrigin_!=Ds||(t[0]=r[0]-n[0]-t[0]),this.offsetOrigin_!=Ns&&this.offsetOrigin_!=Ds||(t[1]=r[1]-n[1]-t[1])}return t[0]+=e[0],t[1]+=e[1],this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(at,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(at,t)},e}(ti);var Xs={Point:function(t,e,n,r,i){var o,s=n.getImage(),a=n.getText();i&&(t=i,o=s&&a&&a.getText()?{}:void 0);if(s){if(s.getImageState()!=Jr)return;var u=t.getBuilder(n.getZIndex(),hs);u.setImageStyle(s,o),u.drawPoint(e,r)}if(a&&a.getText()){var c=t.getBuilder(n.getZIndex(),ps);c.setTextStyle(a,o),c.drawText(e,r)}},LineString:function(t,e,n,r,i){var o=n.getStroke();if(o){var s=t.getBuilder(n.getZIndex(),ls);s.setFillStrokeStyle(null,o),s.drawLineString(e,r)}var a=n.getText();if(a&&a.getText()){var u=(i||t).getBuilder(n.getZIndex(),ps);u.setTextStyle(a),u.drawText(e,r)}},Polygon:function(t,e,n,r,i){var o=n.getFill(),s=n.getStroke();if(o||s){var a=t.getBuilder(n.getZIndex(),fs);a.setFillStrokeStyle(o,s),a.drawPolygon(e,r)}var u=n.getText();if(u&&u.getText()){var c=(i||t).getBuilder(n.getZIndex(),ps);c.setTextStyle(u),c.drawText(e,r)}},MultiPoint:function(t,e,n,r,i){var o,s=n.getImage(),a=n.getText();i&&(t=i,o=s&&a&&a.getText()?{}:void 0);if(s){if(s.getImageState()!=Jr)return;var u=t.getBuilder(n.getZIndex(),hs);u.setImageStyle(s,o),u.drawMultiPoint(e,r)}if(a&&a.getText()){var c=(i||t).getBuilder(n.getZIndex(),ps);c.setTextStyle(a,o),c.drawText(e,r)}},MultiLineString:function(t,e,n,r,i){var o=n.getStroke();if(o){var s=t.getBuilder(n.getZIndex(),ls);s.setFillStrokeStyle(null,o),s.drawMultiLineString(e,r)}var a=n.getText();if(a&&a.getText()){var u=(i||t).getBuilder(n.getZIndex(),ps);u.setTextStyle(a),u.drawText(e,r)}},MultiPolygon:function(t,e,n,r,i){var o=n.getFill(),s=n.getStroke();if(s||o){var a=t.getBuilder(n.getZIndex(),fs);a.setFillStrokeStyle(o,s),a.drawMultiPolygon(e,r)}var u=n.getText();if(u&&u.getText()){var c=(i||t).getBuilder(n.getZIndex(),ps);c.setTextStyle(u),c.drawText(e,r)}},GeometryCollection:function(t,e,n,r,i){var o,s,a=e.getGeometriesArray();for(o=0,s=a.length;o<s;++o){(0,Xs[a[o].getType()])(t,a[o],n,r,i)}},Circle:function(t,e,n,r,i){var o=n.getFill(),s=n.getStroke();if(o||s){var a=t.getBuilder(n.getZIndex(),us);a.setFillStrokeStyle(o,s),a.drawCircle(e,r)}var u=n.getText();if(u&&u.getText()){var c=(i||t).getBuilder(n.getZIndex(),ps);c.setTextStyle(u),c.drawText(e,r)}}};function Ys(t,e){return parseInt(q(t),10)-parseInt(q(e),10)}function Qs(t,e){return.5*t/e}function Js(t,e,n,r,i,o,s){var a=!1,u=n.getImage();if(u){var c=u.getImageState();c==Jr||c==Zr?u.unlistenImageChange(i):(c==Yr&&u.load(),c=u.getImageState(),u.listenImageChange(i),a=!0)}return function(t,e,n,r,i,o){var s=n.getGeometryFunction()(e);if(!s)return;var a=s.simplifyTransformed(r,i);if(n.getRenderer())Zs(t,a,n,e);else{(0,Xs[a.getType()])(t,a,n,e,o)}}(t,e,n,r,o,s),a}function Zs(t,e,n,r){if(e.getType()!=Xt)t.getBuilder(n.getZIndex(),cs).drawCustom(e,r,n.getRenderer());else for(var i=e.getGeometries(),o=0,s=i.length;o<s;++o)Zs(t,i[o],n,r)}var $s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ta=function(t){function e(e){var n=t.call(this,e)||this;return n.boundHandleStyleImageChange_=n.handleStyleImageChange_.bind(n),n.animatingOrInteracting_,n.dirty_=!1,n.hitDetectionImageData_=null,n.renderedFeatures_=null,n.renderedRevision_=-1,n.renderedResolution_=NaN,n.renderedExtent_=[1/0,1/0,-1/0,-1/0],n.renderedRotation_,n.renderedCenter_=null,n.renderedProjection_=null,n.renderedRenderOrder_=null,n.replayGroup_=null,n.replayGroupChanged=!0,n.declutterExecutorGroup=null,n.clipping=!0,n}return $s(e,t),e.prototype.useContainer=function(e,n,r){r<1&&(e=null),t.prototype.useContainer.call(this,e,n,r)},e.prototype.renderWorlds=function(t,e,n){var r=e.extent,i=e.viewState,o=i.center,s=i.resolution,a=i.projection,u=i.rotation,c=a.getExtent(),h=this.getLayer().getSource(),l=e.pixelRatio,f=e.viewHints,p=!(f[xs]||f[Os]),d=this.context,v=Math.round(e.size[0]*l),g=Math.round(e.size[1]*l),y=h.getWrapX()&&a.canWrapX(),m=y?ze(c):null,_=y?Math.ceil((r[2]-c[2])/m)+1:1,b=y?Math.floor((r[0]-c[0])/m):0;do{var w=this.getRenderTransform(o,s,u,l,v,g,b*m);t.execute(d,1,w,u,p,void 0,n)}while(++b<_)},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},e.prototype.renderFrame=function(t,e){var n=t.pixelRatio,r=t.layerStatesArray[t.layerIndex];!function(t,e,n){(function(t,e,n,r,i,o,s){t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s})(t,e,0,0,n,0,0)}(this.pixelTransform,1/n,1/n),ie(this.inversePixelTransform,this.pixelTransform);var i=oe(this.pixelTransform);this.useContainer(e,i,r.opacity);var o=this.context,s=o.canvas,a=this.replayGroup_,u=this.declutterExecutorGroup;if((!a||a.isEmpty())&&(!u||u.isEmpty()))return!this.containerReused&&s.width>0&&(s.width=0),this.container;var c=Math.round(t.size[0]*n),h=Math.round(t.size[1]*n);s.width!=c||s.height!=h?(s.width=c,s.height=h,s.style.transform!==i&&(s.style.transform=i)):this.containerReused||o.clearRect(0,0,c,h),this.preRender(o,t);var l=t.viewState,f=(l.projection,!1);if(r.extent&&this.clipping){var p=zn(r.extent);(f=!we(p,t.extent)&&We(p,t.extent))&&this.clipUnrotated(o,t,p)}this.renderWorlds(a,t),f&&o.restore(),this.postRender(o,t);var d=r.opacity,v=this.container;return d!==parseFloat(v.style.opacity)&&(v.style.opacity=1===d?"":String(d)),this.renderedRotation_!==l.rotation&&(this.renderedRotation_=l.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(e){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var n=[this.context.canvas.width,this.context.canvas.height];ne(this.pixelTransform,n);var r=this.renderedCenter_,i=this.renderedResolution_,o=this.renderedRotation_,s=this.renderedProjection_,a=this.renderedExtent_,u=this.getLayer(),c=[],h=n[0]/2,l=n[1]/2;c.push(this.getRenderTransform(r,i,o,.5,h,l,0).slice());var f=u.getSource(),p=s.getExtent();if(f.getWrapX()&&s.canWrapX()&&!we(p,a)){for(var d=a[0],v=ze(p),g=0,y=void 0;d<p[0];)y=v*--g,c.push(this.getRenderTransform(r,i,o,.5,h,l,y).slice()),d+=v;for(g=0,d=a[2];d>p[2];)y=v*++g,c.push(this.getRenderTransform(r,i,o,.5,h,l,y).slice()),d-=v}this.hitDetectionImageData_=function(t,e,n,r,i,o,s){var a=yi(t[0]/2,t[1]/2);a.imageSmoothingEnabled=!1;for(var u=a.canvas,c=new As(a,.5,i,null,s),h=n.length,l=Math.floor(16777215/h),f={},p=1;p<=h;++p){var d=n[p-1],v=d.getStyleFunction()||r;if(r){var g=v(d,o);if(g){Array.isArray(g)||(g=[g]);for(var y="#"+("000000"+(p*l).toString(16)).slice(-6),m=0,_=g.length;m<_;++m){var b=g[m],w=b.clone(),E=w.getFill();E&&E.setColor(y);var I=w.getStroke();I&&I.setColor(y),w.setText(void 0);var T=b.getImage();if(T){var C=T.getImageSize();if(!C)continue;var S=document.createElement("canvas");S.width=C[0],S.height=C[1];var x=S.getContext("2d",{alpha:!1});x.fillStyle=y;var O=x.canvas;x.fillRect(0,0,O.width,O.height),yi(C?C[0]:O.width,C?C[1]:O.height).drawImage(O,0,0),w.setImage(new Hs({img:O,imgSize:C,anchor:T.getAnchor(),anchorXUnits:ks,anchorYUnits:ks,offset:T.getOrigin(),size:T.getSize(),opacity:T.getOpacity(),scale:T.getScale(),rotation:T.getRotation(),rotateWithView:T.getRotateWithView()}))}var P=Number(w.getZIndex());(N=f[P])||(N={},f[P]=N,N[Wt]=[],N[Yt]=[],N[Bt]=[],N[qt]=[]);var A=w.getGeometryFunction()(d);A&&We(i,A.getExtent())&&N[A.getType().replace("Multi","")].push(A,w)}}}}for(var R=Object.keys(f).map(Number).sort(H),k=(p=0,R.length);p<k;++p){var N=f[R[p]];for(var D in N){var L=N[D];for(m=0,_=L.length;m<_;m+=2){c.setStyle(L[m+1]);for(var M=0,F=e.length;M<F;++M)c.setTransform(e[M]),c.drawGeometry(L[m])}}}return a.getImageData(0,0,u.width,u.height)}(n,c,this.renderedFeatures_,u.getStyleFunction(),a,i,o)}e(function(t,e,n){var r=[];if(n){var i=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*n.width),o=n.data[i],s=n.data[i+1],a=n.data[i+2]+256*(s+256*o),u=Math.floor(16777215/e.length);a&&a%u==0&&r.push(e[a/u-1])}return r}(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,e,n,r,i){var o=this;if(this.replayGroup_){var s,a=e.viewState.resolution,u=e.viewState.rotation,c=this.getLayer(),h={},l=function(t,e,n){var o=q(t),s=h[o];if(s){if(!0!==s&&n<s.distanceSq){if(0===n)return h[o]=!0,i.splice(i.lastIndexOf(s),1),r(t,c,e);s.geometry=e,s.distanceSq=n}}else{if(0===n)return h[o]=!0,r(t,c,e);i.push(h[o]={feature:t,layer:c,geometry:e,distanceSq:n,callback:r})}},f=[this.replayGroup_];return this.declutterExecutorGroup&&f.push(this.declutterExecutorGroup),f.some((function(r){return s=r.forEachFeatureAtCoordinate(t,a,u,n,l,r===o.declutterExecutorGroup?e.declutterTree.all().map((function(t){return t.value})):null)})),s}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var e=this.getLayer(),n=e.getSource();if(!n)return!1;var r=t.viewHints[xs],i=t.viewHints[Os],o=e.getUpdateWhileAnimating(),s=e.getUpdateWhileInteracting();if(!this.dirty_&&!o&&r||!s&&i)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var a=t.extent,u=t.viewState,c=u.projection,h=u.resolution,l=t.pixelRatio,f=e.getRevision(),p=e.getRenderBuffer(),d=e.getRenderOrder();void 0===d&&(d=Ys);var v=u.center.slice(),g=ye(a,p*h),y=[g.slice()],m=c.getExtent();if(n.getWrapX()&&c.canWrapX()&&!we(m,t.extent)){var _=ze(m),b=Math.max(ze(g)/2,_);g[0]=m[0]-b,g[2]=m[2]+b,Sn(v,c);var w=function(t,e){var n=e.getExtent(),r=Me(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){var i=ze(n),o=Math.floor((r[0]-n[0])/i)*i;t[0]-=o,t[2]-=o}return t}(y[0],c);w[0]<m[0]&&w[2]<m[2]?y.push([w[0]+_,w[1],w[2]+_,w[3]]):w[0]>m[0]&&w[2]>m[2]&&y.push([w[0]-_,w[1],w[2]-_,w[3]])}if(!this.dirty_&&this.renderedResolution_==h&&this.renderedRevision_==f&&this.renderedRenderOrder_==d&&we(this.renderedExtent_,g))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var E,I=new es(Qs(h,l),g,h,l);this.getLayer().getDeclutter()&&(E=new es(Qs(h,l),g,h,l));for(var T=0,C=y.length;T<C;++T)n.loadFeatures(y[T],h,c);var S=function(t,e){var n=Qs(t,e);return n*n}(h,l),x=function(t){var n,r=t.getStyleFunction()||e.getStyleFunction();if(r&&(n=r(t,h)),n){var i=this.renderFeature(t,S,n,I,undefined,E);this.dirty_=this.dirty_||i}}.bind(this),O=Bn(g),P=n.getFeaturesInExtent(O);d&&P.sort(d);for(T=0,C=P.length;T<C;++T)x(P[T]);this.renderedFeatures_=P;var A=I.finish(),R=new Cs(g,h,l,n.getOverlaps(),A,e.getRenderBuffer());return E&&(this.declutterExecutorGroup=new Cs(g,h,l,n.getOverlaps(),E.finish(),e.getRenderBuffer())),this.renderedResolution_=h,this.renderedRevision_=f,this.renderedRenderOrder_=d,this.renderedExtent_=g,this.renderedCenter_=v,this.renderedProjection_=c,this.replayGroup_=R,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,n,r,i,o){if(!n)return!1;var s=!1;if(Array.isArray(n))for(var a=0,u=n.length;a<u;++a)s=Js(r,t,n[a],e,this.boundHandleStyleImageChange_,i,o)||s;else s=Js(r,t,n,e,this.boundHandleStyleImageChange_,i,o);return s},e}(as),ea=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),na=function(t){function e(e){return t.call(this,e)||this}return ea(e,t),e.prototype.createRenderer=function(){return new ta(this)},e}(To),ra=function(){function t(t){this.rbush_=new wo(t),this.items_={}}return t.prototype.insert=function(t,e){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[q(e)]=n},t.prototype.load=function(t,e){for(var n=new Array(e.length),r=0,i=e.length;r<i;r++){var o=t[r],s=e[r],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};n[r]=a,this.items_[q(s)]=a}this.rbush_.load(n)},t.prototype.remove=function(t){var e=q(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)},t.prototype.update=function(t,e){var n=this.items_[q(e)];Oe([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))},t.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},t.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)},t.prototype.forEach_=function(t,e){for(var n,r=0,i=t.length;r<i;r++)if(n=e(t[r]))return n;return n},t.prototype.isEmpty=function(){return it(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return Ce(e.minX,e.minY,e.maxX,e.maxY,t)},t.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]},t}(),ia=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oa=function(t){function e(e){var n=t.call(this)||this;return n.projection_=An(e.projection),n.attributions_=sa(e.attributions),n.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,n.loading=!1,n.state_=void 0!==e.state?e.state:go,n.wrapX_=void 0!==e.wrapX&&e.wrapX,n}return ia(e,t),e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return U()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getContextOptions=function(){},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=sa(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(Ct);function sa(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var aa="addfeature",ua="changefeature",ca="clear",ha="removefeature",la="featuresloadstart",fa="featuresloadend",pa="featuresloaderror";function da(t,e){return[[-1/0,-1/0,1/0,1/0]]}var va="arraybuffer",ga="json",ya="text",ma="xml";function _a(t,e){return function(n,r,i,o,s){var a=this;!function(t,e,n,r,i,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(n,r,i):t,!0),e.getType()==va&&(a.responseType="arraybuffer"),a.withCredentials=!1,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r=e.getType(),u=void 0;r==ga||r==ya?u=a.responseText:r==ma?(u=a.responseXML)||(u=(new DOMParser).parseFromString(a.responseText,"application/xml")):r==va&&(u=a.response),u?o(e.readFeatures(u,{extent:n,featureProjection:i}),e.readProjection(u)):s()}else s()},a.onerror=s,a.send()}(t,e,n,r,i,(function(t,e){void 0!==o&&o(t),a.addFeatures(t)}),s||tt)}}var ba=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wa=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.feature=n,i.features=r,i}return ba(e,t),e}(W),Ea=function(t){function e(e){var n=this,r=e||{};(n=t.call(this,{attributions:r.attributions,projection:void 0,state:go,wrapX:void 0===r.wrapX||r.wrapX})||this).loader_=tt,n.format_=r.format,n.overlaps_=void 0===r.overlaps||r.overlaps,n.url_=r.url,void 0!==r.loader?n.loader_=r.loader:void 0!==n.url_&&(Dt(n.format_,7),n.loader_=_a(n.url_,n.format_)),n.strategy_=void 0!==r.strategy?r.strategy:da;var i,o,s=void 0===r.useSpatialIndex||r.useSpatialIndex;return n.featuresRtree_=s?new ra:null,n.loadedExtentsRtree_=new ra,n.nullGeometryFeatures_={},n.idIndex_={},n.uidIndex_={},n.featureChangeKeys_={},n.featuresCollection_=null,Array.isArray(r.features)?o=r.features:r.features&&(o=(i=r.features).getArray()),s||void 0!==i||(i=new Nt(o)),void 0!==o&&n.addFeaturesInternal(o),void 0!==i&&n.bindFeaturesCollection_(i),n}return ba(e,t),e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=q(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var n=t.getGeometry();if(n){var r=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new wa(aa,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[mt(e,at,this.handleFeatureChange_,this),mt(e,K,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var n=!0,r=e.getId();return void 0!==r&&(r.toString()in this.idIndex_?n=!1:this.idIndex_[r.toString()]=e),n&&(Dt(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),n},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],n=[],r=[],i=0,o=t.length;i<o;i++){var s=q(u=t[i]);this.addToIndex_(s,u)&&n.push(u)}i=0;for(var a=n.length;i<a;i++){var u;s=q(u=n[i]);this.setupChangeEvents_(s,u);var c=u.getGeometry();if(c){var h=c.getExtent();e.push(h),r.push(u)}else this.nullGeometryFeatures_[s]=u}this.featuresRtree_&&this.featuresRtree_.load(e,r);i=0;for(var l=n.length;i<l;i++)this.dispatchEvent(new wa(aa,n[i]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;this.addEventListener(aa,(function(n){e||(e=!0,t.push(n.feature),e=!1)})),this.addEventListener(ha,(function(n){e||(e=!0,t.remove(n.feature),e=!1)})),t.addEventListener(Ot,function(t){e||(e=!0,this.addFeature(t.element),e=!1)}.bind(this)),t.addEventListener(Pt,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(bt)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var n in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var r=new wa(ca);this.dispatchEvent(r),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,(function(n){return n.getGeometry().intersectsCoordinate(t)?e(n):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(n){if(n.getGeometry().intersectsExtent(t)){var r=e(n);if(r)return r}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),it(this.nullGeometryFeatures_)||Q(t,rt(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray():[]},e.prototype.getClosestFeatureToCoordinate=function(t,e){var n=t[0],r=t[1],i=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],u=e||Z;return this.featuresRtree_.forEachInExtent(a,(function(t){if(u(t)){var e=t.getGeometry(),c=s;if((s=e.closestPointXY(n,r,o,s))<c){i=t;var h=Math.sqrt(s);a[0]=n-h,a[1]=r-h,a[2]=n+h,a[3]=r+h}}})),i},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,n=q(e),r=e.getGeometry();if(r){var i=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(i,e)):this.featuresRtree_&&this.featuresRtree_.update(i,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);var o=e.getId();if(void 0!==o){var s=o.toString();this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new wa(ua,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:q(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&it(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,n){var r=this.loadedExtentsRtree_,i=this.strategy_(t,e);this.loading=!1;for(var o=function(t,o){var a=i[t];r.forEachInExtent(a,(function(t){return we(t.extent,a)}))||(s.dispatchEvent(new wa(la)),s.loader_.call(s,a,e,n,function(t){this.dispatchEvent(new wa(fa,void 0,t))}.bind(s),function(){this.dispatchEvent(new wa(pa))}.bind(s)),r.insert(a,{extent:a.slice()}),s.loading=s.loader_!==tt)},s=this,a=0,u=i.length;a<u;++a)o(a)},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),t.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var e,n=this.loadedExtentsRtree_;n.forEachInExtent(t,(function(n){if(Oe(n.extent,t))return e=n,!0})),e&&n.remove(e)},e.prototype.removeFeature=function(t){var e=q(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=q(t);this.featureChangeKeys_[e].forEach(bt),delete this.featureChangeKeys_[e];var n=t.getId();void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new wa(ha,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){Dt(this.format_,7),this.setLoader(_a(t,this.format_))},e}(oa),Ia=0,Ta=1,Ca=2,Sa=3,xa=4;function Oa(t){return Math.pow(t,3)}function Pa(t){return 1-Oa(1-t)}function Aa(t){return 3*t*t-2*t*t*t}function Ra(t){return t}var ka=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Na=function(t){function e(e,n,r){var i=t.call(this)||this,o=r||{};return i.tileCoord=e,i.state=n,i.interimTile=null,i.hifi=!0,i.key="",i.transition_=void 0===o.transition?250:o.transition,i.transitionStarts_={},i}return ka(e,t),e.prototype.changed=function(){this.dispatchEvent(at)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==Ca)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==Ca){t.interimTile=null;break}t.getState()==Ta?e=t:t.getState()==Ia?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==Sa&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){U()},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;var r=e-n+1e3/60;return r>=this.transition_?1:Oa(r/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(st),Da=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),La=function(t){function e(e,n,r,i,o,s){var a=t.call(this,e,n,s)||this;return a.crossOrigin_=i,a.src_=r,a.key=r,a.image_=new Image,null!==i&&(a.image_.crossOrigin=i),a.unlisten_=null,a.tileLoadFunction_=o,a}return Da(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){var t;this.state=Sa,this.unlistenImage_(),this.image_=((t=yi(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=Ca:this.state=xa,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==Sa&&(this.state=Ia,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ia&&(this.state=Ta,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Bs(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Na);var Ma=function(){function t(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;var i=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,i),this.initialVelocity_=Math.sqrt(i*i+o*o)/r,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}(),Fa=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ja=function(t){function e(e){var n=t.call(this)||this;return n.map_=e,n}return Fa(e,t),e.prototype.dispatchRenderEvent=function(t,e){U()},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;re(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),ie(r,n)},e.prototype.forEachFeatureAtCoordinate=function(t,e,n,r,i,o,s,a){var u,c=e.viewState;function h(t,e,n,r){return i.call(o,e,t?n:null,r)}var l=c.projection,f=Sn(t.slice(),l),p=[[0,0]];if(l.canWrapX()&&r){var d=ze(l.getExtent());p.push([-d,0],[d,0])}for(var v=e.layerStatesArray,g=v.length,y=[],m=[],_=0;_<p.length;_++)for(var b=g-1;b>=0;--b){var w=v[b],E=w.layer;if(E.hasRenderer()&&_o(w,c)&&s.call(a,E)){var I=E.getRenderer(),T=E.getSource();if(I&&T){var C=T.getWrapX()?f:t,S=h.bind(null,w.managed);m[0]=C[0]+p[_][0],m[1]=C[1]+p[_][1],u=I.forEachFeatureAtCoordinate(m,e,n,S,y)}if(u)return u}}if(0!==y.length){var x=1/y.length;return y.forEach((function(t,e){return t.distanceSq+=e*x})),y.sort((function(t,e){return t.distanceSq-e.distanceSq})),y.some((function(t){return u=t.callback(t.feature,t.layer,t.geometry)})),u}},e.prototype.forEachLayerAtPixel=function(t,e,n,r,i){return U()},e.prototype.hasFeatureAtCoordinate=function(t,e,n,r,i,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,r,Z,this,i,o)},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){U()},e.prototype.scheduleExpireIconCache=function(t){js.canExpireCache()&&t.postRenderFunctions.push(Ua)},e}(G);function Ua(t,e){js.expire()}var Va=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qa=function(t){function e(e){var n=t.call(this,e)||this;n.fontChangeListenerKey_=mt(Li,K,e.redrawText.bind(e)),n.element_=document.createElement("div");var r=n.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",n.element_.className="ol-unselectable ol-layers";var i=e.getViewport();return i.insertBefore(n.element_,i.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return Va(e,t),e.prototype.dispatchRenderEvent=function(t,e){var n=this.getMap();if(n.hasListener(t)){var r=new os(t,void 0,e);n.dispatchEvent(r)}},e.prototype.disposeInternal=function(){bt(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),t.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(Vr,t);var e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),n=t.viewState;this.children_.length=0;for(var r=[],i=null,o=0,s=e.length;o<s;++o){var a=e[o];if(t.layerIndex=o,_o(a,n)&&(a.sourceState==go||a.sourceState==vo)){var u=a.layer,c=u.render(t,i);c&&(c!==i&&(this.children_.push(c),i=c),"getDeclutter"in u&&r.push(u))}}for(o=r.length-1;o>=0;--o)r[o].renderDeclutter(t);!function(t,e){for(var n=t.childNodes,r=0;;++r){var i=n[r],o=e[r];if(!i&&!o)break;i!==o&&(i?o?t.insertBefore(o,i):(t.removeChild(i),--r):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent(qr,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,n,r,i){for(var o=e.viewState,s=e.layerStatesArray,a=s.length-1;a>=0;--a){var u=s[a],c=u.layer;if(c.hasRenderer()&&_o(u,o)&&i(c)){var h=c.getRenderer().getDataAtPixel(t,e,n);if(h){var l=r(c,h);if(l)return l}}}},e}(ja),Ba=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),za="layers",Wa=function(t){function e(e){var n=this,r=e||{},i=et({},r);delete i.layers;var o=r.layers;return(n=t.call(this,i)||this).layersListenerKeys_=[],n.listenerKeys_={},n.addEventListener(xt(za),n.handleLayersChanged_),o?Array.isArray(o)?o=new Nt(o.slice(),{unique:!0}):Dt("function"==typeof o.getArray,43):o=new Nt(void 0,{unique:!0}),n.setLayers(o),n}return Ba(e,t),e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(bt),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(mt(t,Ot,this.handleLayersAdd_,this),mt(t,Pt,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(bt);nt(this.listenerKeys_);for(var n=t.getArray(),r=0,i=n.length;r<i;r++){var o=n[r];this.listenerKeys_[q(o)]=[mt(o,K,this.handleLayerChange_,this),mt(o,at,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[q(e)]=[mt(e,K,this.handleLayerChange_,this),mt(e,at,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=q(t.element);this.listenerKeys_[e].forEach(bt),delete this.listenerKeys_[e],this.changed()},e.prototype.getLayers=function(){return this.get(za)},e.prototype.setLayers=function(t){this.set(za,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var r=this.getLayerState(),i=n,o=e.length;i<o;i++){var s=e[i];s.opacity*=r.opacity,s.visible=s.visible&&r.visible,s.maxResolution=Math.min(s.maxResolution,r.maxResolution),s.minResolution=Math.max(s.minResolution,r.minResolution),s.minZoom=Math.max(s.minZoom,r.minZoom),s.maxZoom=Math.min(s.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==s.extent?s.extent=Ve(s.extent,r.extent):s.extent=r.extent)}return e},e.prototype.getSourceState=function(){return go},e}(po),Ka=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ga=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.map=n,i.frameState=void 0!==r?r:null,i}return Ka(e,t),e}(W),Ha=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xa=function(t){function e(e,n,r,i,o){var s=t.call(this,e,n,o)||this;return s.originalEvent=r,s.pixel_=null,s.coordinate_=null,s.dragging=void 0!==i&&i,s}return Ha(e,t),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Ga),Ya={SINGLECLICK:"singleclick",CLICK:ht,DBLCLICK:lt,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Qa="pointermove",Ja="pointerdown",Za=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$a=function(t){function e(e,n){var r=t.call(this,e)||this;r.map_=e,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=n?n*pi:pi,r.down_=null;var i=r.map_.getViewport();return r.activePointers_=0,r.trackedTouches_={},r.element_=i,r.pointerdownListenerKey_=mt(i,Ja,r.handlePointerDown_,r),r.originalPointerMoveEvent_,r.relayedListenerKey_=mt(i,Qa,r.relayEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener(gt,r.boundHandleTouchMove_,!!gi&&{passive:!1}),r}return Za(e,t),e.prototype.emulateClick_=function(t){var e=new Xa(Ya.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Xa(Ya.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new Xa(Ya.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==Ya.POINTERUP||e.type==Ya.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==Ya.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Xa(Ya.POINTERUP,this.map_,t);this.dispatchEvent(e),this.emulateClicks_&&!e.propagationStopped&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(bt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=0===this.activePointers_,this.updateActivePointers_(t);var e=new Xa(Ya.POINTERDOWN,this.map_,t);if(this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length){var n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(mt(n,Ya.POINTERMOVE,this.handlePointerMove_,this),mt(n,Ya.POINTERUP,this.handlePointerUp_,this),mt(this.element_,Ya.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(mt(this.element_.getRootNode(),Ya.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Xa(Ya.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Xa(t.type,this.map_,t,e))},e.prototype.handleTouchMove_=function(t){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(bt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(gt,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(bt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(bt),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},e}(st),tu="postrender",eu="movestart",nu="moveend",ru="layergroup",iu="size",ou="target",su="view",au=1/0,uu=function(){function t(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,nt(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var r=this.keyFunction_(n);return delete this.queuedElements_[r],n},t.prototype.enqueue=function(t){Dt(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=au&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var e=this.elements_,n=this.priorities_,r=e.length,i=e[t],o=n[t],s=t;t<r>>1;){var a=this.getLeftChildIndex_(t),u=this.getRightChildIndex_(t),c=u<r&&n[u]<n[a]?u:a;e[t]=e[c],n[t]=n[c],t=c}e[t]=i,n[t]=o,this.siftDown_(s,t)},t.prototype.siftDown_=function(t,e){for(var n=this.elements_,r=this.priorities_,i=n[e],o=r[e];e>t;){var s=this.getParentIndex_(e);if(!(r[s]>o))break;n[e]=n[s],r[e]=r[s],e=s}n[e]=i,r[e]=o},t.prototype.reprioritize=function(){var t,e,n,r=this.priorityFunction_,i=this.elements_,o=this.priorities_,s=0,a=i.length;for(e=0;e<a;++e)(n=r(t=i[e]))==au?delete this.queuedElements_[this.keyFunction_(t)]:(o[s]=n,i[s++]=t);i.length=s,o.length=s,this.heapify_()},t}(),cu=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hu=function(t){function e(e,n){var r=t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()}))||this;return r.boundHandleTileChange_=r.handleTileChange.bind(r),r.tileChangeCallback_=n,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return cu(e,t),e.prototype.enqueue=function(e){var n=t.prototype.enqueue.call(this,e);n&&e[0].addEventListener(at,this.boundHandleTileChange_);return n},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,n=e.getState();if(e.hifi&&n===Ca||n===Sa||n===xa){e.removeEventListener(at,this.boundHandleTileChange_);var r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var n,r,i=0;this.tilesLoading_<t&&i<e&&this.getCount()>0;)r=(n=this.dequeue()[0]).getKey(),n.getState()!==Ia||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++i,n.load())},e}(uu);var lu="center",fu="resolution",pu="rotation",du=256;function vu(t,e,n){return function(r,i,o,s,a){if(r){var u=e?0:o[0]*i,c=e?0:o[1]*i,h=a?a[0]:0,l=a?a[1]:0,f=t[0]+u/2+h,p=t[2]-u/2+h,d=t[1]+c/2+l,v=t[3]-c/2+l;f>p&&(p=f=(p+f)/2),d>v&&(v=d=(v+d)/2);var g=He(r[0],f,p),y=He(r[1],d,v),m=30*i;return s&&n&&(g+=-m*Math.log(1+Math.max(0,f-r[0])/m)+m*Math.log(1+Math.max(0,r[0]-p)/m),y+=-m*Math.log(1+Math.max(0,d-r[1])/m)+m*Math.log(1+Math.max(0,r[1]-v)/m)),[g,y]}}}function gu(t){return t}function yu(t,e,n,r){var i=ze(e)/n[0],o=Ue(e)/n[1];return r?Math.min(t,Math.max(i,o)):Math.min(t,Math.min(i,o))}function mu(t,e,n){var r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(r=Math.max(r,n),r/=Math.log(1+50*Math.max(0,n/t-1))/50+1),He(r,n/2,2*e)}function _u(t,e,n,r,i){return function(o,s,a,u){if(void 0!==o){var c=r?yu(t,r,a,i):t;return(void 0===n||n)&&u?mu(o,c,e):He(o,e,c)}}}function bu(t){return void 0!==t?0:void 0}function wu(t){return void 0!==t?t:void 0}var Eu=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Iu=function(t){function e(e){var n=t.call(this)||this,r=et({},e);return n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=Nn(r.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.cancelAnchor_=void 0,r.center&&(r.center=qn(r.center,n.projection_)),r.extent&&(r.extent=zn(r.extent,n.projection_)),n.applyOptions_(r),n}return Eu(e,t),e.prototype.applyOptions_=function(t){var e=function(t){var e,n,r,i=28,o=2,s=void 0!==t.minZoom?t.minZoom:0,a=void 0!==t.maxZoom?t.maxZoom:i,u=void 0!==t.zoomFactor?t.zoomFactor:o,c=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,l=void 0!==t.showFullExtent&&t.showFullExtent,f=Nn(t.projection,"EPSG:3857"),p=f.getExtent(),d=t.constrainOnlyCenter,v=t.extent;c||v||!f.isGlobal()||(d=!1,v=p);if(void 0!==t.resolutions){var g=t.resolutions;n=g[s],r=void 0!==g[a]?g[a]:g[g.length-1],e=t.constrainResolution?function(t,e,n,r){return function(i,o,s,a){if(void 0!==i){var u=t[0],c=t[t.length-1],h=n?yu(u,n,s,r):u;if(a)return void 0===e||e?mu(i,h,c):He(i,c,h);var l=Math.min(h,i),f=Math.floor(X(t,l,o));return t[f]>h&&f<t.length-1?t[f+1]:t[f]}}}(g,h,!d&&v,l):_u(n,r,h,!d&&v,l)}else{var y=(p?Math.max(ze(p),Ue(p)):360*ee[Qt]/f.getMetersPerUnit())/du/Math.pow(o,0),m=y/Math.pow(o,i-0);void 0!==(n=t.maxResolution)?s=0:n=y/Math.pow(u,s),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(u,a):y/Math.pow(u,a):m),a=s+Math.floor(Math.log(n/r)/Math.log(u)),r=n/Math.pow(u,a-s),e=t.constrainResolution?function(t,e,n,r,i,o){return function(s,a,u,c){if(void 0!==s){var h=i?yu(e,i,u,o):e,l=void 0!==n?n:0;if(c)return void 0===r||r?mu(s,h,l):He(s,l,h);var f=Math.ceil(Math.log(e/h)/Math.log(t)-1e-9),p=-a*(.5-1e-9)+.5,d=Math.min(h,s),v=Math.floor(Math.log(e/d)/Math.log(t)+p),g=Math.max(f,v);return He(e/Math.pow(t,g),l,h)}}}(u,n,r,h,!d&&v,l):_u(n,r,h,!d&&v,l)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:s,zoomFactor:u}}(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.padding=t.padding,this.minZoom_=e.minZoom;var n=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return vu(t.extent,t.constrainOnlyCenter,e)}var n=Nn(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var r=n.getExtent().slice();return r[0]=-1/0,r[2]=1/0,vu(r,!1,!1)}return gu}(t),r=e.constraint,i=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(r=n||$e(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=r?0:t:void 0}):!1===e?wu:"number"==typeof e?function(t){var e=2*Math.PI/t;return function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):wu}return bu;var n,r}(t);this.constraints_={center:n,resolution:r,rotation:i},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=et({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),et({},e,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),n=0;n<e.length;++n){var r=arguments[n];r.center&&((r=et({},r)).center=qn(r.center,this.getProjection())),r.anchor&&((r=et({},r)).anchor=qn(r.anchor,this.getProjection())),e[n]=r}this.animateInternal.apply(this,e)},e.prototype.animateInternal=function(t){var e,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var r=arguments[n-1];return r.center&&this.setCenterInternal(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(e&&Tu(e,!0))}for(var i=Date.now(),o=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_,u=[],c=0;c<n;++c){var h=arguments[c],l={start:i,complete:!1,anchor:h.anchor,duration:void 0!==h.duration?h.duration:1e3,easing:h.easing||Aa,callback:e};if(h.center&&(l.sourceCenter=o,l.targetCenter=h.center.slice(),o=l.targetCenter),void 0!==h.zoom?(l.sourceResolution=s,l.targetResolution=this.getResolutionForZoom(h.zoom),s=l.targetResolution):h.resolution&&(l.sourceResolution=s,l.targetResolution=h.resolution,s=l.targetResolution),void 0!==h.rotation){l.sourceRotation=a;var f=tn(h.rotation-a+Math.PI,2*Math.PI)-Math.PI;l.targetRotation=a+f,a=l.targetRotation}Cu(l)?l.complete=!0:i+=l.duration,u.push(l)}this.animations_.push(u),this.setHint(xs,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[xs]>0},e.prototype.getInteracting=function(){return this.hints_[Os]>0},e.prototype.cancelAnimations=function(){var t;this.setHint(xs,-this.hints_[xs]);for(var e=0,n=this.animations_.length;e<n;++e){var r=this.animations_[e];if(r[0].callback&&Tu(r[0].callback,!1),!t)for(var i=0,o=r.length;i<o;++i){var s=r[i];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var r=this.animations_[n],i=!0,o=0,s=r.length;o<s;++o){var a=r[o];if(!a.complete){var u=t-a.start,c=a.duration>0?u/a.duration:1;c>=1?(a.complete=!0,c=1):i=!1;var h=a.easing(c);if(a.sourceCenter){var l=a.sourceCenter[0],f=a.sourceCenter[1],p=l+h*(a.targetCenter[0]-l),d=f+h*(a.targetCenter[1]-f);this.targetCenter_=[p,d]}if(a.sourceResolution&&a.targetResolution){var v=1===h?a.targetResolution:a.sourceResolution+h*(a.targetResolution-a.sourceResolution);if(a.anchor){var g=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(v,0,g,!0);this.targetCenter_=this.calculateCenterZoom(y,a.anchor)}this.targetResolution_=v,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var m=1===h?tn(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+h*(a.targetRotation-a.sourceRotation);if(a.anchor){var _=this.constraints_.rotation(m,!0);this.targetCenter_=this.calculateCenterRotate(_,a.anchor)}this.targetRotation_=m}if(this.applyTargetState_(!0),e=!0,!a.complete)break}}if(i){this.animations_[n]=null,this.setHint(xs,-1);var b=r[0].callback;b&&Tu(b,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,e){var n,r,i,o=this.getCenterInternal();return void 0!==o&&(Cn(n=[o[0]-e[0],o[1]-e[1]],t-this.getRotation()),i=e,(r=n)[0]+=+i[0],r[1]+=+i[1]),n},e.prototype.calculateCenterZoom=function(t,e){var n,r=this.getCenterInternal(),i=this.getResolution();void 0!==r&&void 0!==i&&(n=[e[0]-t*(e[0]-r[0])/i,e[1]-t*(e[1]-r[1])/i]);return n},e.prototype.getViewportSize_=function(t){var e=this.viewportSize_;if(t){var n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t?Vn(t,this.getProjection()):t},e.prototype.getCenterInternal=function(){return this.get(lu)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){return Bn(this.calculateExtentInternal(t),this.getProjection())},e.prototype.calculateExtentInternal=function(t){var e=t||this.getViewportSize_(),n=this.getCenterInternal();Dt(n,1);var r=this.getResolution();Dt(void 0!==r,2);var i=this.getRotation();return Dt(void 0!==i,3),je(n,r,i,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(fu)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(zn(t,this.getProjection()),e)},e.prototype.getResolutionForExtentInternal=function(t,e){var n=e||this.getViewportSize_(),r=ze(t)/n[0],i=Ue(t)/n[1];return Math.max(r,i)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return function(t){return n/Math.pow(e,t*i)}},e.prototype.getRotation=function(){return this.get(pu)},e.prototype.getValueForResolutionFunction=function(t){var e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/e;return function(t){return Math.log(n/t)/e/i}},e.prototype.getViewportSizeMinusPadding_=function(t){var e=this.getViewportSize_(t),n=this.padding;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e},e.prototype.getState=function(){var t=this.getProjection(),e=this.getResolution(),n=this.getRotation(),r=this.getCenterInternal(),i=this.padding;if(i){var o=this.getViewportSizeMinusPadding_();r=Su(r,this.getViewportSize_(),[o[0]/2+i[3],o[1]/2+i[0]],e,n)}return{center:r.slice(0),projection:void 0!==t?t:null,resolution:e,rotation:n,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,n,r=this.minZoom_||0;if(this.resolutions_){var i=X(this.resolutions_,t,1);r=i,e=this.resolutions_[i],n=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,n=this.zoomFactor_;return r+Math.log(e/t)/Math.log(n)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=He(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,He(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,e){var n;if(Dt(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))Dt(!Ke(t),25),n=Tr(r=zn(t,this.getProjection()));else if(t.getType()===Yt){var r;(n=Tr(r=zn(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),Me(r))}else{n=t}this.fitInternal(n,e)},e.prototype.fitInternal=function(t,e){var n=e||{},r=n.size;r||(r=this.getViewportSizeMinusPadding_());var i,o=void 0!==n.padding?n.padding:[0,0,0,0],s=void 0!==n.nearest&&n.nearest;i=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.getResolutionForZoom(n.maxZoom):0;for(var a=t.getFlatCoordinates(),u=this.getRotation(),c=Math.cos(-u),h=Math.sin(-u),l=1/0,f=1/0,p=-1/0,d=-1/0,v=t.getStride(),g=0,y=a.length;g<y;g+=v){var m=a[g]*c-a[g+1]*h,_=a[g]*h+a[g+1]*c;l=Math.min(l,m),f=Math.min(f,_),p=Math.max(p,m),d=Math.max(d,_)}var b=this.getResolutionForExtentInternal([l,f,p,d],[r[0]-o[1]-o[3],r[1]-o[0]-o[2]]);b=isNaN(b)?i:Math.max(b,i),b=this.getConstrainedResolution(b,s?0:1),h=-h;var w=(l+p)/2,E=(f+d)/2,I=(w+=(o[1]-o[3])/2*b)*c-(E+=(o[0]-o[2])/2*b)*h,T=E*c+w*h,C=this.getConstrainedCenter([I,T],b),S=n.callback?n.callback:tt;void 0!==n.duration?this.animateInternal({resolution:b,center:C,duration:n.duration,easing:n.easing},S):(this.targetResolution_=b,this.targetCenter_=C,this.applyTargetState_(!1,!0),Tu(S,!0))},e.prototype.centerOn=function(t,e,n){this.centerOnInternal(qn(t,this.getProjection()),e,n)},e.prototype.centerOnInternal=function(t,e,n){this.setCenterInternal(Su(t,e,n,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,e,n,r){var i,o=this.padding;if(o&&t){var s=this.getViewportSizeMinusPadding_(-n),a=Su(t,r,[s[0]/2+o[3],s[1]/2+o[0]],e,n);i=[t[0]-a[0],t[1]-a[1]]}return i},e.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},e.prototype.adjustCenter=function(t){var e=Vn(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustResolution=function(t,e){var n=e&&qn(e,this.getProjection());this.adjustResolutionInternal(t,n)},e.prototype.adjustResolutionInternal=function(t,e){var n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)},e.prototype.adjustRotation=function(t,e){e&&(e=qn(e,this.getProjection())),this.adjustRotationInternal(t,e)},e.prototype.adjustRotationInternal=function(t,e){var n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(qn(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,e){var n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),i=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,i,n),s=this.constraints_.center(this.targetCenter_,o,i,n,this.calculateCenterShift(this.targetCenter_,o,r,i));this.get(pu)!==r&&this.set(pu,r),this.get(fu)!==o&&this.set(fu,o),this.get(lu)&&Tn(this.get(lu),s)||this.set(lu,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,e,n){var r=void 0!==t?t:200,i=e||0,o=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(o),a=this.constraints_.resolution(this.targetResolution_,i,s),u=this.constraints_.center(this.targetCenter_,a,s,!1,this.calculateCenterShift(this.targetCenter_,a,o,s));if(0===r&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=o,this.targetCenter_=u,void this.applyTargetState_();var c=n||(0===r?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===o&&this.getCenterInternal()&&Tn(this.getCenterInternal(),u)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:u,resolution:a,duration:r,easing:Pa,anchor:c}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Os,1)},e.prototype.endInteraction=function(t,e,n){var r=n&&qn(n,this.getProjection());this.endInteractionInternal(t,e,r)},e.prototype.endInteractionInternal=function(t,e,n){this.setHint(Os,-1),this.resolveConstraints(t,e,n)},e.prototype.getConstrainedCenter=function(t,e){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)},e.prototype.getConstrainedZoom=function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))},e.prototype.getConstrainedResolution=function(t,e){var n=e||0,r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,n,r)},e}(Ct);function Tu(t,e){setTimeout((function(){t(e)}),0)}function Cu(t){return!(t.sourceCenter&&t.targetCenter&&!Tn(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function Su(t,e,n,r,i){var o=Math.cos(-i),s=Math.sin(-i),a=t[0]*o-t[1]*s,u=t[1]*o+t[0]*s;return[(a+=(e[0]/2-n[0])*r)*o-(u+=(n[1]-e[1]/2)*r)*(s=-s),u*o+a*s]}var xu=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ou=function(t){function e(e){var n=t.call(this)||this,r=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var n,r,i,o={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Wa({layers:t.layers});o[ru]=s,o[ou]=t.target,o[su]=void 0!==t.view?t.view:new Iu,void 0!==t.controls&&(Array.isArray(t.controls)?n=new Nt(t.controls.slice()):(Dt("function"==typeof t.controls.getArray,47),n=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new Nt(t.interactions.slice()):(Dt("function"==typeof t.interactions.getArray,48),r=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?i=new Nt(t.overlays.slice()):(Dt("function"==typeof t.overlays.getArray,49),i=t.overlays):i=new Nt;return{controls:n,interactions:r,keyboardEventTarget:e,overlays:i,values:o}}(e);return n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,n.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:pi,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=[1,0,0,1,0,0],n.pixelToCoordinateTransform_=[1,0,0,1,0,0],n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.style.pointerEvents="none",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.style.pointerEvents="none",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=null,n.moveTolerance_=e.moveTolerance,n.keyboardEventTarget_=r.keyboardEventTarget,n.keyHandlerKeys_=null,n.controls=r.controls||new Nt,n.interactions=r.interactions||new Nt,n.overlays_=r.overlays,n.overlayIdIndex_={},n.renderer_=null,n.handleResize_,n.postRenderFunctions_=[],n.tileQueue_=new hu(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addEventListener(xt(ru),n.handleLayerGroupChanged_),n.addEventListener(xt(su),n.handleViewChanged_),n.addEventListener(xt(iu),n.handleSizeChanged_),n.addEventListener(xt(ou),n.handleTargetChanged_),n.setProperties(r.values),n.controls.forEach(function(t){t.setMap(this)}.bind(n)),n.controls.addEventListener(Ot,function(t){t.element.setMap(this)}.bind(n)),n.controls.addEventListener(Pt,function(t){t.element.setMap(null)}.bind(n)),n.interactions.forEach(function(t){t.setMap(this)}.bind(n)),n.interactions.addEventListener(Ot,function(t){t.element.setMap(this)}.bind(n)),n.interactions.addEventListener(Pt,function(t){t.element.setMap(null)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n.overlays_.addEventListener(Ot,function(t){this.addOverlayInternal_(t.element)}.bind(n)),n.overlays_.addEventListener(Pt,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(n)),n}return xu(e,t),e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,n){if(this.frameState_){var r=this.getCoordinateFromPixelInternal(t),i=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,o=void 0!==n.layerFilter?n.layerFilter:Z,s=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,i,s,e,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n},e.prototype.forEachLayerAtPixel=function(t,e,n){if(this.frameState_){var r=n||{},i=void 0!==r.hitTolerance?r.hitTolerance:0,o=r.layerFilter||Z;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,i,e,o)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var n=this.getCoordinateFromPixelInternal(t),r=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:Z,i=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,i,o,r,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),n="changedTouches"in t?t.changedTouches[0]:t;return[n.clientX-e.left,n.clientY-e.top]},e.prototype.getTarget=function(){return this.get(ou)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return Vn(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;return e?ne(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(ru)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var r=t[e].layer.getSource();if(r&&r.loading)return!0}return!1},e.prototype.getPixelFromCoordinate=function(t){var e=qn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},e.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;return e?ne(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(iu)},e.prototype.getView=function(){return this.get(su)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){return this.getTargetElement()?this.getTargetElement().ownerDocument:document},e.prototype.getTilePriority=function(t,e,n,r){return function(t,e,n,r,i){if(!t||!(n in t.wantedTiles))return au;if(!t.wantedTiles[n][e.getKey()])return au;var o=t.viewState.center,s=r[0]-o[0],a=r[1]-o[1];return 65536*Math.log(i)+Math.sqrt(s*s+a*a)/i}(this.frameState_,t,e,n,r)},e.prototype.handleBrowserEvent=function(t,e){var n=e||t.type,r=new Xa(n,this,t);this.handleMapBrowserEvent(r)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){var e=t.originalEvent,n=e.type;if(n===Ja||n===yt||n===ft){var r=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o="host"in i?i.elementFromPoint(e.clientX,e.clientY):e.target;if(this.overlayContainerStopEvent_.contains(o)||!(i===r?r.documentElement:i).contains(o))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t))for(var s=this.getInteractions().getArray().slice(),a=s.length-1;a>=0;a--){var u=s[a];if(u.getMap()===this&&u.getActive()&&this.getTargetElement())if(!u.handleEvent(t)||t.propagationStopped)break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var n=this.maxTilesLoading_,r=n;if(t){var i=t.viewHints;if(i[xs]||i[Os]){var o=!vi&&Date.now()-t.time>8;n=o?0:8,r=o?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,r))}!t||!this.hasListener(Br)||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(Br,t);for(var s=this.postRenderFunctions_,a=0,u=s.length;a<u;++a)s[a](this,t);s.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.mapBrowserEventHandler_){for(var e=0,n=this.keyHandlerKeys_.length;e<n;++e)bt(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null,this.viewport_.removeEventListener(ct,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(yt,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(vt,this.handleResize_,!1),this.handleResize_=void 0),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,_i(this.viewport_)}if(t){for(var r in t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new $a(this,this.moveTolerance_),Ya)this.mapBrowserEventHandler_.addEventListener(Ya[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ct,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(yt,this.boundHandleBrowserEvent_,!!gi&&{passive:!1});var i=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[mt(i,ft,this.handleBrowserEvent,this),mt(i,pt,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(vt,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(bt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(bt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=mt(t,K,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=mt(t,at,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(bt),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[mt(t,K,this.render,this),mt(t,at,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e=this,n=this.getSize(),r=this.getView(),i=this.frameState_,o=null;if(void 0!==n&&function(t){return t[0]>0&&t[1]>0}(n)&&r&&r.isDef()){var s=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=r.getState();o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:je(a.center,a.resolution,a.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:s,wantedTiles:{}}}if(this.frameState_=o,this.renderer_.renderFrame(o),o){if(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),i)(!this.previousExtent_||!Ke(this.previousExtent_)&&!Oe(o.extent,this.previousExtent_))&&(this.dispatchEvent(new Ga(eu,this,i)),this.previousExtent_=Se(this.previousExtent_));this.previousExtent_&&!o.viewHints[xs]&&!o.viewHints[Os]&&!Oe(o.extent,this.previousExtent_)&&(this.dispatchEvent(new Ga(nu,this,o)),me(o.extent,this.previousExtent_))}this.dispatchEvent(new Ga(tu,this,o)),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((function(){e.postRenderTimeoutHandle_=void 0,e.handlePostRender()}),0))},e.prototype.setLayerGroup=function(t){this.set(ru,t)},e.prototype.setSize=function(t){this.set(iu,t)},e.prototype.setTarget=function(t){this.set(ou,t)},e.prototype.setView=function(t){this.set(su,t)},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0);this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var e=void 0,n=getComputedStyle(this.viewport_);n.width&&n.height&&(e=[parseInt(n.width,10),parseInt(n.height,10)]),t.setViewportSize(e)}},e}(Ct);var Pu=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Au=function(t){function e(e){var n=t.call(this)||this,r=e.element;return!r||e.target||r.style.pointerEvents||(r.style.pointerEvents="auto"),n.element=r||null,n.target_=null,n.map_=null,n.listenerKeys=[],e.render&&(n.render=e.render),e.target&&n.setTarget(e.target),n}return Pu(e,t),e.prototype.disposeInternal=function(){_i(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&_i(this.element);for(var e=0,n=this.listenerKeys.length;e<n;++e)bt(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==tt&&this.listenerKeys.push(mt(t,tu,this.render,this)),t.render())},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(Ct),Ru=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ku=function(t){function e(e){var n=this,r=e||{};(n=t.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this).ulElement_=document.createElement("ul"),n.collapsed_=void 0===r.collapsed||r.collapsed,n.userCollapsed_=n.collapsed_,n.overrideCollapsible_=void 0!==r.collapsible,n.collapsible_=void 0===r.collapsible||r.collapsible,n.collapsible_||(n.collapsed_=!1);var i=void 0!==r.className?r.className:"ol-attribution",o=void 0!==r.tipLabel?r.tipLabel:"Attributions",s=void 0!==r.expandClassName?r.expandClassName:i+"-expand",a=void 0!==r.collapseLabel?r.collapseLabel:"»",u=void 0!==r.collapseClassName?r.collapseClassName:i+"-collpase";"string"==typeof a?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=a,n.collapseLabel_.className=u):n.collapseLabel_=a;var c=void 0!==r.label?r.label:"i";"string"==typeof c?(n.label_=document.createElement("span"),n.label_.textContent=c,n.label_.className=s):n.label_=c;var h=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=o,l.appendChild(h),l.addEventListener(ht,n.handleClick_.bind(n),!1);var f=i+" "+"ol-unselectable "+wi+(n.collapsed_&&n.collapsible_?" ol-collapsed":"")+(n.collapsible_?"":" ol-uncollapsible"),p=n.element;return p.className=f,p.appendChild(n.ulElement_),p.appendChild(l),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return Ru(e,t),e.prototype.collectSourceAttributions_=function(t){for(var e={},n=[],r=!0,i=t.layerStatesArray,o=0,s=i.length;o<s;++o){var a=i[o];if(_o(a,t.viewState)){var u=a.layer.getSource();if(u){var c=u.getAttributions();if(c){var h=c(t);if(h)if(r=r&&!1!==u.getAttributionsCollapsible(),Array.isArray(h))for(var l=0,f=h.length;l<f;++l)h[l]in e||(n.push(h[l]),e[h[l]]=!0);else h in e||(n.push(h),e[h]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(r),n},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!J(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(var r=0,i=e.length;r<i;++r){var o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(Ei),this.collapsed_?mi(this.collapseLabel_,this.label_):mi(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(Au),Nu=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Du=function(t){function e(e){var n=this,r=e||{};n=t.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this;var i=void 0!==r.className?r.className:"ol-rotate",o=void 0!==r.label?r.label:"⇧",s=void 0!==r.compassClassName?r.compassClassName:"ol-compass";n.label_=null,"string"==typeof o?(n.label_=document.createElement("span"),n.label_.className=s,n.label_.textContent=o):(n.label_=o,n.label_.classList.add(s));var a=r.tipLabel?r.tipLabel:"Reset rotation",u=document.createElement("button");u.className=i+"-reset",u.setAttribute("type","button"),u.title=a,u.appendChild(n.label_),u.addEventListener(ht,n.handleClick_.bind(n),!1);var c=i+" "+"ol-unselectable "+wi,h=n.element;return h.className=c,h.appendChild(u),n.callResetNorth_=r.resetNorth?r.resetNorth:void 0,n.duration_=void 0!==r.duration?r.duration:250,n.autoHide_=void 0===r.autoHide||r.autoHide,n.rotation_=void 0,n.autoHide_&&n.element.classList.add(bi),n}return Nu(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Pa}):t.setRotation(0))}},e.prototype.render=function(t){var e=t.frameState;if(e){var n=e.viewState.rotation;if(n!=this.rotation_){var r="rotate("+n+"rad)";if(this.autoHide_){var i=this.element.classList.contains(bi);i||0!==n?i&&0!==n&&this.element.classList.remove(bi):this.element.classList.add(bi)}this.label_.style.transform=r}this.rotation_=n}},e}(Au),Lu=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mu=function(t){function e(e){var n=this,r=e||{};n=t.call(this,{element:document.createElement("div"),target:r.target})||this;var i=void 0!==r.className?r.className:"ol-zoom",o=void 0!==r.delta?r.delta:1,s=void 0!==r.zoomInClassName?r.zoomInClassName:i+"-in",a=void 0!==r.zoomOutClassName?r.zoomOutClassName:i+"-out",u=void 0!==r.zoomInLabel?r.zoomInLabel:"+",c=void 0!==r.zoomOutLabel?r.zoomOutLabel:"−",h=void 0!==r.zoomInTipLabel?r.zoomInTipLabel:"Zoom in",l=void 0!==r.zoomOutTipLabel?r.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=h,f.appendChild("string"==typeof u?document.createTextNode(u):u),f.addEventListener(ht,n.handleClick_.bind(n,o),!1);var p=document.createElement("button");p.className=a,p.setAttribute("type","button"),p.title=l,p.appendChild("string"==typeof c?document.createTextNode(c):c),p.addEventListener(ht,n.handleClick_.bind(n,-o),!1);var d=i+" "+"ol-unselectable "+wi,v=n.element;return v.className=d,v.appendChild(f),v.appendChild(p),n.duration_=void 0!==r.duration?r.duration:250,n}return Lu(e,t),e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var n=e.getZoom();if(void 0!==n){var r=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:r,duration:this.duration_,easing:Pa})):e.setZoom(r)}}},e}(Au);var Fu="active",ju=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Uu=function(t){function e(e){var n=t.call(this)||this;return e&&e.handleEvent&&(n.handleEvent=e.handleEvent),n.map_=null,n.setActive(!0),n}return ju(e,t),e.prototype.getActive=function(){return this.get(Fu)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(Fu,t)},e.prototype.setMap=function(t){this.map_=t},e}(Ct);function Vu(t,e,n,r){var i=t.getZoom();if(void 0!==i){var o=t.getConstrainedZoom(i+e),s=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:s,anchor:n,duration:void 0!==r?r:250,easing:Pa})}}var qu=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bu=function(t){function e(e){var n=t.call(this)||this,r=e||{};return n.delta_=r.delta?r.delta:1,n.duration_=void 0!==r.duration?r.duration:250,n}return qu(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==Ya.DBLCLICK){var n=t.originalEvent,r=t.map,i=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_;Vu(r.getView(),o,i,this.duration_),n.preventDefault(),e=!0}return!e},e}(Uu),zu=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wu=function(t){function e(e){var n=this,r=e||{};return n=t.call(this,r)||this,r.handleDownEvent&&(n.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(n.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(n.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(n.handleUpEvent=r.handleUpEvent),r.stopDown&&(n.stopDown=r.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return zu(e,t),e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Ya.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Ya.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==Ya.POINTERDOWN){var r=this.handleDownEvent(t);this.handlingDownUpSequence=r,e=this.stopDown(r)}else t.type==Ya.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===Ya.POINTERDOWN||e===Ya.POINTERDRAG||e===Ya.POINTERUP}(t)){var e=t.originalEvent,n=e.pointerId.toString();t.type==Ya.POINTERUP?delete this.trackedPointers_[n]:(t.type==Ya.POINTERDOWN||n in this.trackedPointers_)&&(this.trackedPointers_[n]=e),this.targetPointers=rt(this.trackedPointers_)}},e}(Uu);function Ku(t){for(var e=t.length,n=0,r=0,i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return[n/e,r/e]}function Gu(t){var e=arguments;return function(t){for(var n=!0,r=0,i=e.length;r<i&&(n=n&&e[r](t));++r);return n}}var Hu=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Xu=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){return t.target.getTargetElement().contains(document.activeElement)}(t)},Yu=Z,Qu=function(t){var e=t.originalEvent;return 0==e.button&&!(li&&fi&&e.ctrlKey)},Ju=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Zu=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},$u=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},tc=function(t){var e=t.originalEvent;return Dt(void 0!==e,56),"mouse"==e.pointerType},ec=function(t){var e=t.originalEvent;return Dt(void 0!==e,56),e.isPrimary&&0===e.button},nc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rc=function(t){function e(e){var n=t.call(this,{stopDown:$})||this,r=e||{};n.kinetic_=r.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var i=r.condition?r.condition:Gu(Ju,ec);return n.condition_=r.onFocusOnly?Gu(Xu,i):i,n.noKinetic_=!1,n}return nc(e,t),e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e=this.targetPointers,n=Ku(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){var r=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();!function(t,e){t[0]*=e,t[1]*=e}(r,i.getResolution()),Cn(r,i.getRotation()),i.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=e.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=n.getCenterInternal(),s=e.getPixelFromCoordinateInternal(o),a=e.getCoordinateFromPixelInternal([s[0]-r*Math.cos(i),s[1]-r*Math.sin(i)]);n.animateInternal({center:n.getConstrainedCenter(a),duration:500,easing:Pa})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(Wu),ic=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oc=function(t){function e(e){var n=this,r=e||{};return(n=t.call(this,{stopDown:$})||this).condition_=r.condition?r.condition:Hu,n.lastAngle_=void 0,n.duration_=void 0!==r.duration?r.duration:250,n}return ic(e,t),e.prototype.handleDragEvent=function(t){if(tc(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==bu){var r=e.getSize(),i=t.pixel,o=Math.atan2(r[1]/2-i[1],i[0]-r[0]/2);if(void 0!==this.lastAngle_){var s=o-this.lastAngle_;n.adjustRotationInternal(-s)}this.lastAngle_=o}}},e.prototype.handleUpEvent=function(t){return!tc(t)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){return!!tc(t)&&(!(!Qu(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))},e}(Wu),sc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ac=function(t){function e(e){var n=t.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.style.pointerEvents="auto",n.element_.className="ol-box "+e,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return sc(e,t),e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+n,r.top=Math.min(t[1],e[1])+n,r.width=Math.abs(e[0]-t[0])+n,r.height=Math.abs(e[1]-t[1])+n},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new Ir([n])},e.prototype.getGeometry=function(){return this.geometry_},e}(G),uc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),cc="boxstart",hc="boxdrag",lc="boxend",fc="boxcancel",pc=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.coordinate=n,i.mapBrowserEvent=r,i}return uc(e,t),e}(W),dc=function(t){function e(e){var n=t.call(this)||this,r=e||{};return n.box_=new ac(r.className||"ol-dragbox"),n.minArea_=void 0!==r.minArea?r.minArea:64,r.onBoxEnd&&(n.onBoxEnd=r.onBoxEnd),n.startPixel_=null,n.condition_=r.condition?r.condition:Qu,n.boxEndCondition_=r.boxEndCondition?r.boxEndCondition:n.defaultBoxEndCondition,n}return uc(e,t),e.prototype.defaultBoxEndCondition=function(t,e,n){var r=n[0]-e[0],i=n[1]-e[1];return r*r+i*i>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new pc(hc,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new pc(e?lc:fc,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new pc(cc,t.coordinate,t)),!0)},e.prototype.onBoxEnd=function(t){},e}(Wu),vc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gc=function(t){function e(e){var n=this,r=e||{},i=r.condition?r.condition:Zu;return(n=t.call(this,{condition:i,className:r.className||"ol-dragzoom",minArea:r.minArea})||this).duration_=void 0!==r.duration?r.duration:200,n.out_=void 0!==r.out&&r.out,n}return vc(e,t),e.prototype.onBoxEnd=function(t){var e=this.getMap(),n=e.getView(),r=e.getSize(),i=this.getGeometry().getExtent();if(this.out_){var o=n.calculateExtentInternal(r),s=xe([e.getPixelFromCoordinateInternal(De(i)),e.getPixelFromCoordinateInternal(Be(i))]);!function(t,e){var n=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=r,t[3]+=r}(o,1/n.getResolutionForExtentInternal(s,r)),i=o}var a=n.getConstrainedResolution(n.getResolutionForExtentInternal(i,r)),u=n.getConstrainedCenter(Me(i),a);n.animateInternal({resolution:a,center:u,duration:this.duration_,easing:Pa})},e}(dc),yc=37,mc=38,_c=39,bc=40,wc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ec=function(t){function e(e){var n=t.call(this)||this,r=e||{};return n.defaultCondition_=function(t){return Ju(t)&&$u(t)},n.condition_=void 0!==r.condition?r.condition:n.defaultCondition_,n.duration_=void 0!==r.duration?r.duration:100,n.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,n}return wc(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==ft){var n=t.originalEvent,r=n.keyCode;if(this.condition_(t)&&(r==bc||r==yc||r==_c||r==mc)){var i=t.map.getView(),o=i.getResolution()*this.pixelDelta_,s=0,a=0;r==bc?a=-o:r==yc?s=-o:r==_c?s=o:a=o;var u=[s,a];Cn(u,i.getRotation()),function(t,e,n){var r=t.getCenterInternal();if(r){var i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:Ra,center:t.getConstrainedCenter(i)})}}(i,u,this.duration_),n.preventDefault(),e=!0}}return!e},e}(Uu),Ic=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tc=function(t){function e(e){var n=t.call(this)||this,r=e||{};return n.condition_=r.condition?r.condition:$u,n.delta_=r.delta?r.delta:1,n.duration_=void 0!==r.duration?r.duration:100,n}return Ic(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==ft||t.type==pt){var n=t.originalEvent,r=n.charCode;if(this.condition_(t)&&(r=="+".charCodeAt(0)||r=="-".charCodeAt(0))){var i=t.map,o=r=="+".charCodeAt(0)?this.delta_:-this.delta_;Vu(i.getView(),o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e},e}(Uu),Cc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sc="trackpad",xc="wheel",Oc=function(t){function e(e){var n=this,r=e||{};(n=t.call(this,r)||this).totalDelta_=0,n.lastDelta_=0,n.maxDelta_=void 0!==r.maxDelta?r.maxDelta:1,n.duration_=void 0!==r.duration?r.duration:250,n.timeout_=void 0!==r.timeout?r.timeout:80,n.useAnchor_=void 0===r.useAnchor||r.useAnchor,n.constrainResolution_=void 0!==r.constrainResolution&&r.constrainResolution;var i=r.condition?r.condition:Yu;return n.condition_=r.onFocusOnly?Gu(Xu,i):i,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.deltaPerZoom_=300,n}return Cc(e,t),e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if(t.type!==yt)return!0;var e,n=t.map,r=t.originalEvent;if(r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==yt&&(e=r.deltaY,hi&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=pi),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var i=Date.now();void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?Sc:xc);var o=n.getView();if(this.mode_===Sc&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1;this.totalDelta_+=e;var s=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),s),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var n=-He(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Vu(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Uu),Pc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ac=function(t){function e(e){var n=this,r=e||{},i=r;return i.stopDown||(i.stopDown=$),(n=t.call(this,i)||this).anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=void 0!==r.threshold?r.threshold:.3,n.duration_=void 0!==r.duration?r.duration:250,n}return Pc(e,t),e.prototype.handleDragEvent=function(t){var e=0,n=this.targetPointers[0],r=this.targetPointers[1],i=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(void 0!==this.lastAngle_){var o=i-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=i;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==bu){var u=s.getViewport().getBoundingClientRect(),c=Ku(this.targetPointers);c[0]-=u.left,c[1]-=u.top,this.anchor_=s.getCoordinateFromPixelInternal(c),this.rotating_&&(s.render(),a.adjustRotationInternal(e,this.anchor_))}},e.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(Wu),Rc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kc=function(t){function e(e){var n=this,r=e||{},i=r;return i.stopDown||(i.stopDown=$),(n=t.call(this,i)||this).anchor_=null,n.duration_=void 0!==r.duration?r.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return Rc(e,t),e.prototype.handleDragEvent=function(t){var e=1,n=this.targetPointers[0],r=this.targetPointers[1],i=n.clientX-r.clientX,o=n.clientY-r.clientY,s=Math.sqrt(i*i+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,u=a.getView();1!=e&&(this.lastScaleDelta_=e);var c=a.getViewport().getBoundingClientRect(),h=Ku(this.targetPointers);h[0]-=c.left,h[1]-=c.top,this.anchor_=a.getCoordinateFromPixelInternal(h),a.render(),u.adjustResolutionInternal(e,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(Wu);var Nc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dc=function(t){function e(e){return(e=et({},e)).controls||(e.controls=function(t){var e=t||{},n=new Nt;return(void 0===e.zoom||e.zoom)&&n.push(new Mu(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&n.push(new Du(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&n.push(new ku(e.attributionOptions)),n}()),e.interactions||(e.interactions=function(t){var e=t||{},n=new Nt,r=new Ma(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&n.push(new oc),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&n.push(new Bu({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&n.push(new rc({onFocusOnly:e.onFocusOnly,kinetic:r})),(void 0===e.pinchRotate||e.pinchRotate)&&n.push(new Ac),(void 0===e.pinchZoom||e.pinchZoom)&&n.push(new kc({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(n.push(new Ec),n.push(new Tc({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&n.push(new Oc({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&n.push(new gc({duration:e.zoomDuration})),n}({onFocusOnly:!0})),t.call(this,e)||this}return Nc(e,t),e.prototype.createRenderer=function(){return new qa(this)},e}(Ou),Lc=function(){function t(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},t.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},t.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},t.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},t.prototype.get=function(t,e){var n=this.entries_[t];return Dt(void 0!==n,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_},t.prototype.remove=function(t){var e=this.entries_[t];return Dt(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},t.prototype.getCount=function(){return this.count_},t.prototype.getKeys=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e},t.prototype.getValues=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e},t.prototype.peekLast=function(){return this.oldest_.value_},t.prototype.peekLastKey=function(){return this.oldest_.key_},t.prototype.peekFirstKey=function(){return this.newest_.key_},t.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},t.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},t.prototype.set=function(t,e){Dt(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_},t.prototype.setSize=function(t){this.highWaterMark=t},t}();function Mc(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function Fc(t,e,n){return t+"/"+e+"/"+n}function jc(t){return Fc(t[0],t[1],t[2])}var Uc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Uc(e,t),e.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(jc(e.tileCoord)),e.release())}.bind(this))}},e}(Lc),qc=function(){function t(t,e,n,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=r}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function Bc(t,e,n,r,i){return void 0!==i?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new qc(t,e,n,r)}var zc,Wc=function(){function t(t,e,n,r,i,o){this.sourceProj_=t,this.targetProj_=e;var s={},a=Mn(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return s[e]||(s[e]=a(t)),s[e]},this.maxSourceExtent_=r,this.errorThresholdSquared_=i*i,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ze(r)==ze(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ze(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ze(this.targetProj_.getExtent()):null;var u=qe(n),c=Be(n),h=Le(n),l=De(n),f=this.transformInv_(u),p=this.transformInv_(c),d=this.transformInv_(h),v=this.transformInv_(l),g=10+(o?Math.max(0,Math.ceil(Ye(Ne(n)/(o*o*256*256)))):0);if(this.addQuad_(u,c,h,l,f,p,d,v,g),this.wrapsXInSource_){var y=1/0;this.triangles_.forEach((function(t,e,n){y=Math.min(y,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-y>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-y>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-y>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-y>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var n=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-n<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}s={}}return t.prototype.addTriangle_=function(t,e,n,r,i,o){this.triangles_.push({source:[r,i,o],target:[t,e,n]})},t.prototype.addQuad_=function(t,e,n,r,i,o,s,a,u){var c=ge([i,o,s,a]),h=this.sourceWorldWidth_?ze(c)/this.sourceWorldWidth_:null,l=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&h>.5&&h<1,p=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)p=ze(ge([t,e,n,r]))/this.targetWorldWidth_>.25||p;!f&&this.sourceProj_.isGlobal()&&h&&(p=h>.25||p)}if(!(!p&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3]))||We(c,this.maxSourceExtent_)){var d=0;if(!(p||isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(u>0)p=!0;else if(1!=(d=(isFinite(i[0])&&isFinite(i[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1))&&2!=d&&4!=d&&8!=d)return;if(u>0){if(!p){var v=[(t[0]+n[0])/2,(t[1]+n[1])/2],g=this.transformInv_(v),y=void 0;if(f)y=(tn(i[0],l)+tn(s[0],l))/2-tn(g[0],l);else y=(i[0]+s[0])/2-g[0];var m=(i[1]+s[1])/2-g[1];p=y*y+m*m>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var _=[(e[0]+n[0])/2,(e[1]+n[1])/2],b=this.transformInv_(_),w=[(r[0]+t[0])/2,(r[1]+t[1])/2],E=this.transformInv_(w);this.addQuad_(t,e,_,w,i,o,b,E,u-1),this.addQuad_(w,_,n,r,E,b,s,a,u-1)}else{var I=[(t[0]+e[0])/2,(t[1]+e[1])/2],T=this.transformInv_(I),C=[(n[0]+r[0])/2,(n[1]+r[1])/2],S=this.transformInv_(C);this.addQuad_(t,I,C,r,i,T,S,a,u-1),this.addQuad_(I,e,n,C,T,o,s,S,u-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&d)&&this.addTriangle_(t,n,r,i,s,a),0==(14&d)&&this.addTriangle_(t,n,e,i,s,o),d&&(0==(13&d)&&this.addTriangle_(e,r,t,o,a,i),0==(7&d)&&this.addTriangle_(e,r,n,o,a,s))}},t.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,r){var i=e.source;Pe(t,i[0]),Pe(t,i[1]),Pe(t,i[2])})),t},t.prototype.getTriangles=function(){return this.triangles_},t}(),Kc={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1};function Gc(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function Hc(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function Xc(t,e,n,r){var i,o=(i=n,Mn(e,t)(i,void 0,i.length)),s=Rn(e,r,n),a=e.getMetersPerUnit();void 0!==a&&(s*=a);var u=t.getMetersPerUnit();void 0!==u&&(s/=u);var c=t.getExtent();if(!c||be(c,o)){var h=Rn(t,s,o)/s;isFinite(h)&&h>0&&(s/=h)}return s}function Yc(t,e,n,r,i,o,s,a,u,c,h,l){var f=yi(Math.round(n*t),Math.round(n*e));if(et(f,l),0===u.length)return f.canvas;function p(t){return Math.round(t*n)/n}f.scale(n,n),f.globalCompositeOperation="lighter";var d=[1/0,1/0,-1/0,-1/0];u.forEach((function(t,e,n){var r,i;r=d,(i=t.extent)[0]<r[0]&&(r[0]=i[0]),i[2]>r[2]&&(r[2]=i[2]),i[1]<r[1]&&(r[1]=i[1]),i[3]>r[3]&&(r[3]=i[3])}));var v=ze(d),g=Ue(d),y=yi(Math.round(n*v/r),Math.round(n*g/r));et(y,l);var m=n/r;u.forEach((function(t,e,n){var r=t.extent[0]-d[0],i=-(t.extent[3]-d[3]),o=ze(t.extent),s=Ue(t.extent);t.image.width>0&&t.image.height>0&&y.drawImage(t.image,c,c,t.image.width-2*c,t.image.height-2*c,r*m,i*m,o*m,s*m)}));var _=qe(s);return a.getTriangles().forEach((function(t,e,i){var s=t.source,a=t.target,u=s[0][0],c=s[0][1],h=s[1][0],v=s[1][1],g=s[2][0],m=s[2][1],b=p((a[0][0]-_[0])/o),w=p(-(a[0][1]-_[1])/o),E=p((a[1][0]-_[0])/o),I=p(-(a[1][1]-_[1])/o),T=p((a[2][0]-_[0])/o),C=p(-(a[2][1]-_[1])/o),S=u,x=c;u=0,c=0;var O=function(t){for(var e=t.length,n=0;n<e;n++){for(var r=n,i=Math.abs(t[n][n]),o=n+1;o<e;o++){var s=Math.abs(t[o][n]);s>i&&(i=s,r=o)}if(0===i)return null;var a=t[r];t[r]=t[n],t[n]=a;for(var u=n+1;u<e;u++)for(var c=-t[u][n]/t[n][n],h=n;h<e+1;h++)n==h?t[u][h]=0:t[u][h]+=c*t[n][h]}for(var l=new Array(e),f=e-1;f>=0;f--){l[f]=t[f][e]/t[f][f];for(var p=f-1;p>=0;p--)t[p][e]-=t[p][f]*l[f]}return l}([[h-=S,v-=x,0,0,E-b],[g-=S,m-=x,0,0,T-b],[0,0,h,v,I-w],[0,0,g,m,C-w]]);if(O){if(f.save(),f.beginPath(),function(){if(void 0===zc){var t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",Gc(t,4,5,4,0),Gc(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;zc=Hc(e,0)||Hc(e,4)||Hc(e,8)}return zc}()||l===Kc){f.moveTo(E,I);for(var P=b-E,A=w-I,R=0;R<4;R++)f.lineTo(E+p((R+1)*P/4),I+p(R*A/3)),3!=R&&f.lineTo(E+p((R+1)*P/4),I+p((R+1)*A/3));f.lineTo(T,C)}else f.moveTo(E,I),f.lineTo(b,w),f.lineTo(T,C);f.clip(),f.transform(O[0],O[2],O[1],O[3],b,w),f.translate(d[0]-S,d[3]-x),f.scale(r/n,-r/n),f.drawImage(y.canvas,0,0),f.restore()}})),h&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach((function(t,e,n){var r=t.target,i=(r[0][0]-_[0])/o,s=-(r[0][1]-_[1])/o,a=(r[1][0]-_[0])/o,u=-(r[1][1]-_[1])/o,c=(r[2][0]-_[0])/o,h=-(r[2][1]-_[1])/o;f.beginPath(),f.moveTo(a,u),f.lineTo(i,s),f.lineTo(c,h),f.closePath(),f.stroke()})),f.restore()),f.canvas}var Qc=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jc=function(t){function e(e,n,r,i,o,s,a,u,c,h,l,f){var p=t.call(this,o,Ia)||this;p.renderEdges_=void 0!==l&&l,p.contextOptions_=f,p.pixelRatio_=a,p.gutter_=u,p.canvas_=null,p.sourceTileGrid_=n,p.targetTileGrid_=i,p.wrappedTileCoord_=s||o,p.sourceTiles_=[],p.sourcesListenerKeys_=null,p.sourceZ_=0;var d=i.getTileCoordExtent(p.wrappedTileCoord_),v=p.targetTileGrid_.getExtent(),g=p.sourceTileGrid_.getExtent(),y=v?Ve(d,v):d;if(0===Ne(y))return p.state=xa,p;var m=e.getExtent();m&&(g=g?Ve(g,m):m);var _=i.getResolution(p.wrappedTileCoord_[0]),b=function(t,e,n,r){var i=Me(n),o=Xc(t,e,i,r);return(!isFinite(o)||o<=0)&&ke(n,(function(n){return o=Xc(t,e,n,r),isFinite(o)&&o>0})),o}(e,r,y,_);if(!isFinite(b)||b<=0)return p.state=xa,p;var w=void 0!==h?h:.5;if(p.triangulation_=new Wc(e,r,y,g,b*w,_),0===p.triangulation_.getTriangles().length)return p.state=xa,p;p.sourceZ_=n.getZForResolution(b);var E=p.triangulation_.calculateSourceExtent();if(g&&(e.canWrapX()?(E[1]=He(E[1],g[1],g[3]),E[3]=He(E[3],g[1],g[3])):E=Ve(E,g)),Ne(E)){for(var I=n.getTileRangeForExtentAndZ(E,p.sourceZ_),T=I.minX;T<=I.maxX;T++)for(var C=I.minY;C<=I.maxY;C++){var S=c(p.sourceZ_,T,C,a);S&&p.sourceTiles_.push(S)}0===p.sourceTiles_.length&&(p.state=xa)}else p.state=xa;return p}return Qc(e,t),e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,n,r){e&&e.getState()==Ca&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=Sa;else{var e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),r="number"==typeof n?n:n[0],i="number"==typeof n?n:n[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Yc(r,i,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.contextOptions_),this.state=Ca}this.changed()},e.prototype.load=function(){if(this.state==Ia){this.state=Ta,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,n,r){var i=e.getState();if(i==Ia||i==Ta){t++;var o=mt(e,at,(function(n){var r=e.getState();r!=Ca&&r!=Sa&&r!=xa||(bt(o),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(o)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,n){t.getState()==Ia&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(bt),this.sourcesListenerKeys_=null},e}(Na),Zc="tileloadstart",$c="tileloadend",th="tileloaderror",eh=[0,0,0],nh=function(){function t(t){var e,n,r,i;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Dt((e=this.resolutions_,n=!0,r=function(t,e){return e-t}||H,e.every((function(t,i){if(0===i)return!0;var o=r(e[i-1],t);return!(o>0||n&&0===o)}))),17),!t.origins)for(var o=0,s=this.resolutions_.length-1;o<s;++o)if(i){if(this.resolutions_[o]/this.resolutions_[o+1]!==i){i=void 0;break}}else i=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Dt(this.origins_.length==this.resolutions_.length,20));var a=t.extent;void 0===a||this.origin_||this.origins_||(this.origin_=qe(a)),Dt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Dt(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:du,Dt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==a?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){var n=new qc(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(a){var r=this.getTileRangeForExtentAndZ(a,e);n.minX=Math.max(r.minX,n.minX),n.maxX=Math.min(r.maxX,n.maxX),n.minY=Math.max(r.minY,n.minY),n.maxY=Math.min(r.maxY,n.maxY)}return n}),this):a&&this.calculateTileRanges_(a)}return t.prototype.forEachTileCoord=function(t,e,n){for(var r=this.getTileRangeForExtentAndZ(t,e),i=r.minX,o=r.maxX;i<=o;++i)for(var s=r.minY,a=r.maxY;s<=a;++s)n([e,i,s])},t.prototype.forEachTileCoordParentTileRange=function(t,e,n,r){var i,o,s=null,a=t[0]-1;for(2===this.zoomFactor_?(i=t[1],o=t[2]):s=this.getTileCoordExtent(t,r);a>=this.minZoom;){if(e(a,2===this.zoomFactor_?Bc(i=Math.floor(i/2),i,o=Math.floor(o/2),o,n):this.getTileRangeForExtentAndZ(s,a,n)))return!0;--a}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*t[1],i=2*t[2];return Bc(r,r+1,i,i+1,e)}var o=this.getTileCoordExtent(t,n);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},t.prototype.getTileRangeExtent=function(t,e,n){var r=this.getOrigin(t),i=this.getResolution(t),o=$r(this.getTileSize(t),this.tmpSize_),s=r[0]+e.minX*o[0]*i,a=r[0]+(e.maxX+1)*o[0]*i;return Ce(s,r[1]+e.minY*o[1]*i,a,r[1]+(e.maxY+1)*o[1]*i,n)},t.prototype.getTileRangeForExtentAndZ=function(t,e,n){var r=eh;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,r);var i=r[1],o=r[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,r),Bc(i,r[1],o,r[2],n)},t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=$r(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]},t.prototype.getTileCoordExtent=function(t,e){var n=this.getOrigin(t[0]),r=this.getResolution(t[0]),i=$r(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*i[0]*r,s=n[1]-(t[2]+1)*i[1]*r;return Ce(o,s,o+i[0]*r,s+i[1]*r,e)},t.prototype.getTileCoordForCoordAndResolution=function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)},t.prototype.getTileCoordForXYAndResolution_=function(t,e,n,r,i){var o=this.getZForResolution(n),s=n/this.getResolution(o),a=this.getOrigin(o),u=$r(this.getTileSize(o),this.tmpSize_),c=r?.5:0,h=r?.5:0,l=Math.floor((t-a[0])/n+c),f=Math.floor((a[1]-e)/n+h),p=s*l/u[0],d=s*f/u[1];return r?(p=Math.ceil(p)-1,d=Math.ceil(d)-1):(p=Math.floor(p),d=Math.floor(d)),Mc(o,p,d,i)},t.prototype.getTileCoordForXYAndZ_=function(t,e,n,r,i){var o=this.getOrigin(n),s=this.getResolution(n),a=$r(this.getTileSize(n),this.tmpSize_),u=r?.5:0,c=r?.5:0,h=Math.floor((t-o[0])/s+u),l=Math.floor((o[1]-e)/s+c),f=h/a[0],p=l/a[1];return r?(f=Math.ceil(f)-1,p=Math.ceil(p)-1):(f=Math.floor(f),p=Math.floor(p)),Mc(n,f,p,i)},t.prototype.getTileCoordForCoordAndZ=function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null},t.prototype.getZForResolution=function(t,e){return He(X(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,n=new Array(e),r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n},t}();function rh(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,n,r){return function(t,e,n,r){var i=void 0!==r?r:ue,o=ih(t,e,n);return new nh({extent:t,origin:Fe(t,i),resolutions:o,tileSize:n})}(oh(t),e,n,r)}(t),t.setDefaultTileGrid(e)),e}function ih(t,e,n,r){for(var i=void 0!==e?e:42,o=Ue(t),s=ze(t),a=$r(void 0!==n?n:du),u=r>0?r:Math.max(s/a[0],o/a[1]),c=i+1,h=new Array(c),l=0;l<c;++l)h[l]=u/Math.pow(2,l);return h}function oh(t){var e=(t=An(t)).getExtent();if(!e){var n=180*ee[Qt]/t.getMetersPerUnit();e=Ce(-n,-n,n,n)}return e}var sh=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ah=function(t){function e(e){var n=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX})||this;n.opaque_=void 0!==e.opaque&&e.opaque,n.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,n.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;var r=e.tileGrid;return r&&$r(r.getTileSize(r.getMinZoom()),[256,256]),n.tileCache=new Vc(e.cacheSize||0),n.tmpSize=[0,0],n.key_=e.key||"",n.tileOptions={transition:e.transition},n.zDirection=e.zDirection?e.zDirection:0,n}return sh(e,t),e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);n&&n.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,n,r){var i=this.getTileCacheForProjection(t);if(!i)return!1;for(var o,s,a,u=!0,c=n.minX;c<=n.maxX;++c)for(var h=n.minY;h<=n.maxY;++h)s=Fc(e,c,h),a=!1,i.containsKey(s)&&(a=(o=i.get(s)).getState()===Ca)&&(a=!1!==r(o)),a||(u=!1);return u},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,n,r,i){return U()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:rh(t)},e.prototype.getTileCacheForProjection=function(t){return Dt(Dn(this.getProjection(),t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,n){var r,i,o,s=this.getTileGridForProjection(n),a=this.getTilePixelRatio(e),u=$r(s.getTileSize(t),this.tmpSize);return 1==a?u:(r=u,i=a,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=r[0]*i+.5|0,o[1]=r[1]*i+.5|0,o)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var n=void 0!==e?e:this.getProjection(),r=this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=function(t,e,n){var r=e[0],i=t.getTileCoordCenter(e),o=oh(n);if(be(o,i))return e;var s=ze(o),a=Math.ceil((o[0]-i[0])/s);return i[0]+=s*a,t.getTileCoordForCoordAndZ(i,r)}(r,t,n)),function(t,e){var n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;var o=e.getFullTileRange(n);return!o||o.containsXY(r,i)}(t,r)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,e){var n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)},e.prototype.useTile=function(t,e,n,r){},e}(oa),uh=function(t){function e(e,n){var r=t.call(this,e)||this;return r.tile=n,r}return sh(e,t),e}(W);function ch(t,e){var n=/\{z\}/g,r=/\{x\}/g,i=/\{y\}/g,o=/\{-y\}/g;return function(s,a,u){return s?t.replace(n,s[0].toString()).replace(r,s[1].toString()).replace(i,s[2].toString()).replace(o,(function(){var t=s[0],n=e.getFullTileRange(t);return Dt(n,55),(n.getHeight()-s[2]-1).toString()})):void 0}}function hh(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=ch(t[i],e);return function(t){if(1===t.length)return t[0];return function(e,n,r){if(e){var i=tn(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[i](e,n,r)}}}(r)}var lh=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fh=function(t){function e(n){var r=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,opaque:n.opaque,projection:n.projection,state:n.state,tileGrid:n.tileGrid,tilePixelRatio:n.tilePixelRatio,wrapX:n.wrapX,transition:n.transition,key:n.key,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this;return r.generateTileUrlFunction_=r.tileUrlFunction===e.prototype.tileUrlFunction,r.tileLoadFunction=n.tileLoadFunction,n.tileUrlFunction&&(r.tileUrlFunction=n.tileUrlFunction),r.urls=null,n.urls?r.setUrls(n.urls):n.url&&r.setUrl(n.url),r.tileLoadingKeys_={},r}return lh(e,t),e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,n=t.target,r=q(n),i=n.getState();i==Ta?(this.tileLoadingKeys_[r]=!0,e=Zc):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],e=i==Sa?th:i==Ca?$c:void 0),null!=e&&this.dispatchEvent(new uh(e,n))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=function(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var r=n[1].charCodeAt(0),i=n[2].charCodeAt(0),o=void 0;for(o=r;o<=i;++o)e.push(t.replace(n[0],String.fromCharCode(o)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(n[2],10),a=parseInt(n[1],10);a<=s;a++)e.push(t.replace(n[0],a.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(hh(t,this.tileGrid),e):this.setKey(e)},e.prototype.tileUrlFunction=function(t,e,n){},e.prototype.useTile=function(t,e,n){var r=Fc(t,e,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)},e}(ah),ph=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dh=function(t){function e(e){var n=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:vh,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return n.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,n.tileClass=void 0!==e.tileClass?e.tileClass:La,n.tileCacheForProjection={},n.tileGridForProjection={},n.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,n.contextOptions_=!1===e.imageSmoothing?Kc:void 0,n.renderReprojectionEdges_=!1,n}return ph(e,t),e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);for(var r in this.tileCache.expireCache(this.tileCache==n?e:{}),this.tileCacheForProjection){var i=this.tileCacheForProjection[r];i.expireCache(i==n?e:{})}},e.prototype.getContextOptions=function(){return this.contextOptions_},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!Dn(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getKey=function(){return t.prototype.getKey.call(this)+(this.contextOptions_?"\n"+JSON.stringify(this.contextOptions_):"")},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!Dn(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!Dn(e,t)){var n=q(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=rh(t)),this.tileGridForProjection[n]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||Dn(e,t))return this.tileCache;var n=q(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Vc(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]},e.prototype.createTile_=function(t,e,n,r,i,o){var s=[t,e,n],a=this.getTileCoordForTileUrlFunction(s,i),u=a?this.tileUrlFunction(a,r,i):void 0,c=new this.tileClass(s,void 0!==u?Ia:xa,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(at,this.handleTileChange.bind(this)),c},e.prototype.getTile=function(t,e,n,r,i){var o=this.getProjection();if(o&&i&&!Dn(o,i)){var s=this.getTileCacheForProjection(i),a=[t,e,n],u=void 0,c=jc(a);s.containsKey(c)&&(u=s.get(c));var h=this.getKey();if(u&&u.key==h)return u;var l=this.getTileGridForProjection(o),f=this.getTileGridForProjection(i),p=this.getTileCoordForTileUrlFunction(a,i),d=new Jc(o,l,i,f,a,p,this.getTilePixelRatio(r),this.getGutter(),function(t,e,n,r){return this.getTileInternal(t,e,n,r,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.contextOptions_);return d.key=h,u?(d.interimTile=u,d.refreshInterimChain(),s.replace(c,d)):s.set(c,d),d}return this.getTileInternal(t,e,n,r,o||i)},e.prototype.getTileInternal=function(t,e,n,r,i){var o=null,s=Fc(t,e,n),a=this.getKey();if(this.tileCache.containsKey(s)){if((o=this.tileCache.get(s)).key!=a){var u=o;o=this.createTile_(t,e,n,r,i,a),u.getState()==Ia?o.interimTile=u.interimTile:o.interimTile=u,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,n,r,i,a),this.tileCache.set(s,o);return o},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var n=An(t);if(n){var r=q(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}},e}(fh);function vh(t,e){t.getImage().src=e}var gh=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yh=function(t){function e(e){var n=e||{},r=void 0!==n.projection?n.projection:"EPSG:3857",i=void 0!==n.tileGrid?n.tileGrid:function(t){var e=t||{},n=e.extent||An("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:ih(n,e.maxZoom,e.tileSize,e.maxResolution)};return new nh(r)}({extent:oh(r),maxResolution:n.maxResolution,maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});return t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,imageSmoothing:n.imageSmoothing,opaque:n.opaque,projection:r,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this}return gh(e,t),e}(dh),mh=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_h=function(t){function e(e){var n,r=e||{};n=void 0!==r.attributions?r.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];var i=void 0!==r.crossOrigin?r.crossOrigin:"anonymous",o=void 0!==r.url?r.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return t.call(this,{attributions:n,attributionsCollapsible:!1,cacheSize:r.cacheSize,crossOrigin:i,imageSmoothing:r.imageSmoothing,maxZoom:void 0!==r.maxZoom?r.maxZoom:19,opaque:void 0===r.opaque||r.opaque,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileLoadFunction:r.tileLoadFunction,transition:r.transition,url:o,wrapX:r.wrapX})||this}return mh(e,t),e}(yh),bh="preload",wh="useInterimTilesOnError",Eh=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ih=function(t){function e(e){var n=this,r=e||{},i=et({},r);return delete i.preload,delete i.useInterimTilesOnError,(n=t.call(this,i)||this).setPreload(void 0!==r.preload?r.preload:0),n.setUseInterimTilesOnError(void 0===r.useInterimTilesOnError||r.useInterimTilesOnError),n}return Eh(e,t),e.prototype.getPreload=function(){return this.get(bh)},e.prototype.setPreload=function(t){this.set(bh,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(wh)},e.prototype.setUseInterimTilesOnError=function(t){this.set(wh,t)},e}(mo),Th=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ch=function(t){function e(e){var n=t.call(this,e)||this;return n.extentChanged=!0,n.renderedExtent_=null,n.renderedPixelRatio,n.renderedProjection=null,n.renderedRevision,n.renderedTiles=[],n.newTiles_=!1,n.tmpExtent=[1/0,1/0,-1/0,-1/0],n.tmpTileRange_=new qc(0,0,0,0),n}return Th(e,t),e.prototype.isDrawableTile=function(t){var e=this.getLayer(),n=t.getState(),r=e.getUseInterimTilesOnError();return n==Ca||n==xa||n==Sa&&!r},e.prototype.getTile=function(t,e,n,r){var i=r.pixelRatio,o=r.viewState.projection,s=this.getLayer(),a=s.getSource().getTile(t,e,n,i,o);return a.getState()==Sa&&(s.getUseInterimTilesOnError()?s.getPreload()>0&&(this.newTiles_=!0):a.setState(Ca)),this.isDrawableTile(a)||(a=a.getInterimTile()),a},e.prototype.loadedTileCallback=function(e,n,r){return!!this.isDrawableTile(r)&&t.prototype.loadedTileCallback.call(this,e,n,r)},e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},e.prototype.renderFrame=function(t,e){var n=t.layerStatesArray[t.layerIndex],r=t.viewState,i=r.projection,o=r.resolution,s=r.center,a=r.rotation,u=t.pixelRatio,c=this.getLayer(),h=c.getSource(),l=h.getRevision(),f=h.getTileGridForProjection(i),p=f.getZForResolution(o,h.zDirection),d=f.getResolution(p),v=t.extent,g=n.extent&&zn(n.extent);g&&(v=Ve(v,zn(n.extent)));var y=h.getTilePixelRatio(u),m=Math.round(t.size[0]*y),_=Math.round(t.size[1]*y);if(a){var b=Math.round(Math.sqrt(m*m+_*_));m=b,_=b}var w=d*m/2/y,E=d*_/2/y,I=[s[0]-w,s[1]-E,s[0]+w,s[1]+E],T=f.getTileRangeForExtentAndZ(v,p),C={};C[p]={};var S=this.createLoadedTileFinder(h,i,C),x=this.tmpExtent,O=this.tmpTileRange_;this.newTiles_=!1;for(var P=T.minX;P<=T.maxX;++P)for(var A=T.minY;A<=T.maxY;++A){var R=this.getTile(p,P,A,t);if(this.isDrawableTile(R)){var k=q(this);if(R.getState()==Ca){C[p][R.tileCoord.toString()]=R;var N=R.inTransition(k);this.newTiles_||!N&&-1!==this.renderedTiles.indexOf(R)||(this.newTiles_=!0)}if(1===R.getAlpha(k,t.time))continue}var D=f.getTileCoordChildTileRange(R.tileCoord,O,x),L=!1;D&&(L=S(p+1,D)),L||f.forEachTileCoordParentTileRange(R.tileCoord,S,O,x)}var M=d/o;re(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/y,1/y,a,-m/2,-_/2);var F=function(t){return di?oe(t):(Hi||(Hi=yi(1,1).canvas),Hi.style.transform=oe(t),Hi.style.transform)}(this.pixelTransform);this.useContainer(e,F,n.opacity);var j=this.context,U=j.canvas;ie(this.inversePixelTransform,this.pixelTransform),re(this.tempTransform,m/2,_/2,M,M,0,-m/2,-_/2),U.width!=m||U.height!=_?(U.width=m,U.height=_):this.containerReused||j.clearRect(0,0,m,_),g&&this.clipUnrotated(j,t,g),et(j,h.getContextOptions()),this.preRender(j,t),this.renderedTiles.length=0;var V,B,z,W=Object.keys(C).map(Number);W.sort(H),1!==n.opacity||this.containerReused&&!h.getOpaque(t.viewState.projection)?(V=[],B=[]):W=W.reverse();for(var K=W.length-1;K>=0;--K){var G=W[K],X=h.getTilePixelSize(G,u,i),Y=f.getResolution(G)/d,Q=X[0]*Y*M,J=X[1]*Y*M,Z=f.getTileCoordForCoordAndZ(qe(I),G),$=f.getTileCoordExtent(Z),tt=ne(this.tempTransform,[y*($[0]-I[0])/d,y*(I[3]-$[3])/d]),nt=y*h.getGutterForProjection(i),rt=C[G];for(var it in rt){var ot=(R=rt[it]).tileCoord,st=tt[0]-(Z[1]-ot[1])*Q,at=Math.round(st+Q),ut=tt[1]-(Z[2]-ot[2])*J,ct=Math.round(ut+J),ht=at-(P=Math.round(st)),lt=ct-(A=Math.round(ut)),ft=p===G;if(!(N=ft&&1!==R.getAlpha(q(this),t.time)))if(V){j.save(),z=[P,A,P+ht,A,P+ht,A+lt,P,A+lt];for(var pt=0,dt=V.length;pt<dt;++pt)if(p!==G&&G<B[pt]){var vt=V[pt];j.beginPath(),j.moveTo(z[0],z[1]),j.lineTo(z[2],z[3]),j.lineTo(z[4],z[5]),j.lineTo(z[6],z[7]),j.moveTo(vt[6],vt[7]),j.lineTo(vt[4],vt[5]),j.lineTo(vt[2],vt[3]),j.lineTo(vt[0],vt[1]),j.clip()}V.push(z),B.push(G)}else j.clearRect(P,A,ht,lt);this.drawTileImage(R,t,P,A,ht,lt,nt,ft,n.opacity),V&&!N&&j.restore(),this.renderedTiles.push(R),this.updateUsedTiles(t.usedTiles,h,R)}}return this.renderedRevision=l,this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!Oe(this.renderedExtent_,I),this.renderedExtent_=I,this.renderedPixelRatio=u,this.renderedProjection=i,this.manageTilePyramid(t,h,f,u,i,v,p,c.getPreload()),this.scheduleExpireCache(t,h),this.postRender(j,t),n.extent&&j.restore(),F!==U.style.transform&&(U.style.transform=F),this.container},e.prototype.drawTileImage=function(t,e,n,r,i,o,s,a,u){var c=this.getTileImage(t);if(c){var h=q(this),l=a?t.getAlpha(h,e.time):1,f=u*l,p=f!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=f),this.context.drawImage(c,s,s,c.width-2*s,c.height-2*s,n,r,i,o),p&&this.context.restore(),1!==l?e.animate=!0:a&&t.endTransition(h)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getTileImage=function(t){return t.getImage()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var n=function(t,e,n){var r=q(t);r in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[r])}.bind(null,e);t.postRenderFunctions.push(n)}},e.prototype.updateUsedTiles=function(t,e,n){var r=q(e);r in t||(t[r]={}),t[r][n.getKey()]=!0},e.prototype.manageTilePyramid=function(t,e,n,r,i,o,s,a,u){var c=q(e);c in t.wantedTiles||(t.wantedTiles[c]={});var h,l,f,p,d,v,g=t.wantedTiles[c],y=t.tileQueue,m=0;for(v=n.getMinZoom();v<=s;++v)for(l=n.getTileRangeForExtentAndZ(o,v,l),f=n.getResolution(v),p=l.minX;p<=l.maxX;++p)for(d=l.minY;d<=l.maxY;++d)s-v<=a?(++m,(h=e.getTile(v,p,d,r,i)).getState()==Ia&&(g[h.getKey()]=!0,y.isKeyQueued(h.getKey())||y.enqueue([h,c,n.getTileCoordCenter(h.tileCoord),f])),void 0!==u&&u(h)):e.useTile(v,p,d,i);e.updateCacheSize(m,i)},e}(as);Ch.prototype.getLayer;var Sh,xh=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oh=function(t){function e(e){return t.call(this,e)||this}return xh(e,t),e.prototype.createRenderer=function(){return new Ch(this)},e}(Ih),Ph=new Uint8Array(16);function Ah(){if(!Sh&&!(Sh="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Sh(Ph)}var Rh=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function kh(t){return"string"==typeof t&&Rh.test(t)}for(var Nh=[],Dh=0;Dh<256;++Dh)Nh.push((Dh+256).toString(16).substr(1));function Lh(t,e,n){var r=(t=t||{}).random||(t.rng||Ah)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Nh[t[e+0]]+Nh[t[e+1]]+Nh[t[e+2]]+Nh[t[e+3]]+"-"+Nh[t[e+4]]+Nh[t[e+5]]+"-"+Nh[t[e+6]]+Nh[t[e+7]]+"-"+Nh[t[e+8]]+Nh[t[e+9]]+"-"+Nh[t[e+10]]+Nh[t[e+11]]+Nh[t[e+12]]+Nh[t[e+13]]+Nh[t[e+14]]+Nh[t[e+15]]).toLowerCase();if(!kh(n))throw TypeError("Stringified UUID is invalid");return n}(r)}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Mh=function(t,e){return(Mh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Fh(t,e){function n(){this.constructor=t}Mh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var jh=function(){return(jh=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Uh(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Vh(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function qh(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bh(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function zh(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Bh(arguments[e]));return t}function Wh(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Kh=!1,Gh="${JSCORE_VERSION}",Hh=function(t,e){if(!t)throw Xh(e)},Xh=function(t){return new Error("Firebase Database ("+Gh+") INTERNAL ASSERT FAILED: "+t)},Yh=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},Qh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Yh(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Jh=function(t){try{return Qh.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Zh(t){return $h(void 0,t)}function $h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=$h(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var tl=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function el(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function nl(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(el())}function rl(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}function il(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function ol(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function sl(){return!0===Kh}function al(){return"indexedDB"in self&&null!=indexedDB}function ul(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function cl(){return!(!navigator||!navigator.cookieEnabled)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var hl=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,ll.prototype.create),o}return Fh(e,t),e}(Error),ll=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?fl(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new hl(i,a,r);return u},t}();function fl(t,e){return t.replace(pl,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var pl=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function dl(t){return JSON.parse(t)}function vl(t){return JSON.stringify(t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var gl=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=dl(Jh(o[0])||""),n=dl(Jh(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function yl(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ml(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function _l(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bl(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var wl=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),s=1518500249):(o=u^c^h,s=1859775393):r<60?(o=u&c|h&(u|c),s=2400959708):(o=u^c^h,s=3395469782);i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function El(t,e){var n=new Il(t,e);return n.subscribe.bind(n)}var Il=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=Tl),void 0===r.error&&(r.error=Tl),void 0===r.complete&&(r.complete=Tl);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function Tl(){}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Cl=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function Sl(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}function xl(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(Sl(t,e,r)+"must be a valid function.")}function Ol(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(Sl(t,e,r)+"must be a valid context object.")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Pl=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};function Al(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}var Rl=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),kl="[DEFAULT]",Nl=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=kl);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new tl;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=jh({identifier:kl,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService(kl)}catch(t){}try{for(var r=qh(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Bh(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService(u);a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=kl),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Uh(this,void 0,void 0,(function(){var t;return Vh(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(zh(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===kl?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:kl:t},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Dl,Ll=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new Nl(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function Ml(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Fl,jl=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Fl||(Fl={}));var Ul,Vl={debug:Fl.DEBUG,verbose:Fl.VERBOSE,info:Fl.INFO,warn:Fl.WARN,error:Fl.ERROR,silent:Fl.SILENT},ql=Fl.INFO,Bl=((Dl={})[Fl.DEBUG]="log",Dl[Fl.VERBOSE]="log",Dl[Fl.INFO]="info",Dl[Fl.WARN]="warn",Dl[Fl.ERROR]="error",Dl),zl=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=Bl[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,Ml(["["+i+"]  "+t.name+":"],n))}},Wl=function(){function t(t){this.name=t,this._logLevel=ql,this._logHandler=zl,this._userLogHandler=null,jl.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in Fl))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?Vl[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ml([this,Fl.DEBUG],t)),this._logHandler.apply(this,Ml([this,Fl.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ml([this,Fl.VERBOSE],t)),this._logHandler.apply(this,Ml([this,Fl.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ml([this,Fl.INFO],t)),this._logHandler.apply(this,Ml([this,Fl.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ml([this,Fl.WARN],t)),this._logHandler.apply(this,Ml([this,Fl.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ml([this,Fl.ERROR],t)),this._logHandler.apply(this,Ml([this,Fl.ERROR],t))},t}();function Kl(t){jl.forEach((function(e){e.setLogLevel(t)}))}var Gl,Hl=((Ul={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Ul["bad-app-name"]="Illegal App name: '{$appName}",Ul["duplicate-app"]="Firebase App named '{$appName}' already exists",Ul["app-deleted"]="Firebase App named '{$appName}' already deleted",Ul["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Ul["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Ul),Xl=new ll("app","Firebase",Hl),Yl="@firebase/app",Ql="[DEFAULT]",Jl=((Gl={})[Yl]="fire-core",Gl["@firebase/analytics"]="fire-analytics",Gl["@firebase/auth"]="fire-auth",Gl["@firebase/database"]="fire-rtdb",Gl["@firebase/functions"]="fire-fn",Gl["@firebase/installations"]="fire-iid",Gl["@firebase/messaging"]="fire-fcm",Gl["@firebase/performance"]="fire-perf",Gl["@firebase/remote-config"]="fire-rc",Gl["@firebase/storage"]="fire-gcs",Gl["@firebase/firestore"]="fire-fst",Gl["fire-js"]="fire-js",Gl["firebase-wrapper"]="fire-js-all",Gl),Zl=new Wl("@firebase/app"),$l=function(){function t(t,e,n){var r,i,o=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Zh(t),this.container=new Ll(e.name),this._addComponent(new Rl("app",(function(){return o}),"PUBLIC"));try{for(var s=qh(this.firebase_.INTERNAL.components.values()),a=s.next();!a.done;a=s.next()){var u=a.value;this._addComponent(u)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=Ql),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Ql),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){Zl.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Xl.create("app-deleted",{appName:this.name_})},t}();$l.prototype.name&&$l.prototype.options||$l.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function tf(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=Ql);var s=o.name;if("string"!=typeof s||!s)throw Xl.create("bad-app-name",{appName:String(s)});if(yl(e,s))throw Xl.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=Jl[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void Zl.warn(u.join(" "))}o(new Rl(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:Kl,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw Xl.create("invalid-log-argument",{appName:name});!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=Vl[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:Fl[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=jl;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.0.1",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!yl(e,t=t||Ql))throw Xl.create("no-app",{appName:t});return e[t]}function o(o){var s,a,u=o.name;if(n.has(u))return Zl.debug("There were multiple attempts to register component "+u+"."),"PUBLIC"===o.type?r[u]:null;if(n.set(u,o),"PUBLIC"===o.type){var c=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[u])throw Xl.create("invalid-app-argument",{appName:u});return t[u]()};void 0!==o.serviceProps&&$h(c,o.serviceProps),r[u]=c,t.prototype[u]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,u);return n.apply(this,o.multipleInstances?t:[])}}try{for(var h=qh(Object.keys(e)),l=h.next();!l.done;l=h.next()){var f=l.value;e[f]._addComponent(o)}}catch(t){s={error:t}}finally{try{l&&!l.done&&(a=h.return)&&a.call(h)}finally{if(s)throw s.error}}return"PUBLIC"===o.type?r[u]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ef=function t(){var e=tf($l);return e.INTERNAL=jh(jh({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){$h(e,t)},createSubscribe:El,ErrorFactory:ll,deepExtend:$h}),e}(),nf=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Zl.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var rf=self.firebase.SDK_VERSION;rf&&rf.indexOf("LITE")>=0&&Zl.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var of=ef.initializeApp;ef.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return rl()&&Zl.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),of.apply(void 0,t)};var sf=ef;!function(t,e){t.INTERNAL.registerComponent(new Rl("platform-logger",(function(t){return new nf(t)}),"PRIVATE")),t.registerVersion(Yl,"0.6.13",e),t.registerVersion("fire-js","")}(sf),function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var n=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function r(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function i(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:r(t)}}!function(t,r){if(r){var i=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var s=t[o];s in i||(i[s]={}),i=i[s]}(r=r(o=i[t=t[t.length-1]]))!=o&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function r(){this.a=null}function o(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var s=n.setTimeout;r.prototype.c=function(t){s(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},r.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.v),reject:t(this.g)}},e.prototype.v=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.m(t):this.i(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.i(t)},e.prototype.g=function(t){this.h(2,t)},e.prototype.i=function(t){this.h(1,t)},e.prototype.h=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)a.b(this.a[t]);this.a=null}};var a=new r;return e.prototype.s=function(t){var e=this.f();t.Pa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,s=new e((function(t,e){i=t,o=e}));return this.Pa(r(t,i),r(n,o)),s},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Pa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n)},e.resolve=o,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=i(t),s=r.next();!s.done;s=r.next())o(s.value).Pa(e,n)}))},e.all=function(t){var n=i(t),r=n.next();return r.done?o([]):new e((function(t,e){function i(e){return function(n){s[e]=n,0==--a&&t(s)}}var s=[],a=0;do{s.push(void 0),a++,o(r.value).Pa(i(s.length-1),e),r=n.next()}while(!r.done)}))},e}));var o=o||{},s=this||self,a=/^[\w+/_-]+[=]{0,2}$/,u=null;function c(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&a.test(t)?t:""}function h(){}function l(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function f(t){var e=l(t);return"array"==e||"object"==e&&"number"==typeof t.length}function p(t){return"function"==l(t)}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),g=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:m).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var w=Date.now;function E(t,e){function n(){}n.prototype=e.prototype,t.$a=e.prototype,t.prototype=new n,t.prototype.constructor=t}function I(t){return t}function T(t,e,n){this.code=x+t,this.message=e||O[t]||"",this.a=n||null}function C(t){var e=t&&t.code;return e?new T(e.substring(x.length),t.message,t.serverResponse):null}E(T,Error),T.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},T.prototype.toJSON=function(){return this.w()};var S,x="auth/",O={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},P={kd:{Sa:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},rd:{Sa:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://securetoken.googleapis.com/v1/token",Va:"https://identitytoolkit.googleapis.com/v2/",id:"p"},td:{Sa:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},ud:{Sa:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Ya:"https://test-securetoken.sandbox.googleapis.com/v1/token",Va:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function A(t){for(var e in P)if(P[e].id===t)return{firebaseEndpoint:(t=P[e]).Sa,secureTokenEndpoint:t.Ya,identityPlatformEndpoint:t.Va};return null}function R(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function k(t){if(Error.captureStackTrace)Error.captureStackTrace(this,k);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function N(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");k.call(this,n+t[r])}function D(t,e){throw new N("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function L(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function M(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function F(){this.b=this.a=null}S=A("__EID__")?"__EID__":void 0,E(k,Error),k.prototype.name="CustomError",E(N,k),N.prototype.name="AssertionError",L.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var j=new L((function(){return new V}),(function(t){t.reset()}));function U(){var t=me,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function V(){this.next=this.b=this.a=null}F.prototype.add=function(t,e){var n=j.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},V.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},V.prototype.reset=function(){this.next=this.b=this.a=null};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var z=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,s=0;s<n;s++)if(s in o){var a=o[s];e.call(void 0,a,s,t)&&(r[i++]=a)}return r},W=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},K=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function G(t,e){return 0<=q(t,e)}function H(t,e){var n;return(n=0<=(e=q(t,e)))&&Array.prototype.splice.call(t,e,1),n}function X(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function Y(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var J,Z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},$=/&/g,tt=/</g,et=/>/g,nt=/"/g,rt=/'/g,it=/\x00/g,ot=/[\x00&<>"']/;function st(t,e){return-1!=t.indexOf(e)}function at(t,e){return t<e?-1:t>e?1:0}t:{var ut=s.navigator;if(ut){var ct=ut.userAgent;if(ct){J=ct;break t}}J=""}function ht(t){return st(J,t)}function lt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function ft(t){for(var e in t)return!1;return!0}function pt(t){var e,n={};for(e in t)n[e]=t[e];return n}var dt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function vt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<dt.length;o++)n=dt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function gt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||s).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(d(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;D("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function yt(t,e){this.a=t===wt&&e||"",this.b=bt}function mt(t){return t instanceof yt&&t.constructor===yt&&t.b===bt?t.a:(D("expected object of type Const, got '"+t+"'"),"type_error:Const")}yt.prototype.sa=!0,yt.prototype.ra=function(){return this.a},yt.prototype.toString=function(){return"Const{"+this.a+"}"};var _t,bt={},wt={};function Et(){if(void 0===_t){var t=null,e=s.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:I,createScript:I,createScriptURL:I})}catch(t){s.console&&s.console.error(t.message)}_t=t}else _t=t}return _t}function It(t,e){this.a=e===Ot?t:""}function Tt(t){return t instanceof It&&t.constructor===It?t.a:(D("expected object of type TrustedResourceUrl, got '"+t+"' of type "+l(t)),"type_error:TrustedResourceUrl")}function Ct(t,e){var n=mt(t);if(!xt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=Et();return new It(t=e?e.createScriptURL(t):t,Ot)}(t=n.replace(St,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof yt?mt(t):encodeURIComponent(String(t))})))}It.prototype.sa=!0,It.prototype.ra=function(){return this.a.toString()},It.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var St=/%{(\w+)}/g,xt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Ot={};function Pt(t,e){this.a=e===Mt?t:""}function At(t){return t instanceof Pt&&t.constructor===Pt?t.a:(D("expected object of type SafeUrl, got '"+t+"' of type "+l(t)),"type_error:SafeUrl")}Pt.prototype.sa=!0,Pt.prototype.ra=function(){return this.a.toString()},Pt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Rt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,kt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Nt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Dt(t){if(t instanceof Pt)return t;if(t="object"==typeof t&&t.sa?t.ra():String(t),Nt.test(t))t=new Pt(t,Mt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(kt);t=e&&Rt.test(e[1])?new Pt(t,Mt):null}return t}function Lt(t){return t instanceof Pt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Nt.test(t)||(t="about:invalid#zClosurez"),new Pt(t,Mt))}var Mt={},Ft=new Pt("about:invalid#zClosurez",Mt);function jt(t,e,n){this.a=n===Ut?t:""}jt.prototype.sa=!0,jt.prototype.ra=function(){return this.a.toString()},jt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ut={};function Vt(t,e,n,r){return t=t instanceof Pt?t:Lt(t),e=e||s,n=n instanceof yt?mt(n):n||"",e.open(At(t),n,r,void 0)}function qt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Bt(t){return ot.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace($,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(tt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(et,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(nt,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(rt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(it,"&#0;"))),t}function zt(t){return zt[" "](t),t}zt[" "]=h;var Wt,Kt,Gt=ht("Opera"),Ht=ht("Trident")||ht("MSIE"),Xt=ht("Edge"),Yt=Xt||Ht,Qt=ht("Gecko")&&!(st(J.toLowerCase(),"webkit")&&!ht("Edge"))&&!(ht("Trident")||ht("MSIE"))&&!ht("Edge"),Jt=st(J.toLowerCase(),"webkit")&&!ht("Edge");function Zt(){var t=s.document;return t?t.documentMode:void 0}t:{var $t="",te=(Kt=J,Qt?/rv:([^\);]+)(\)|;)/.exec(Kt):Xt?/Edge\/([\d\.]+)/.exec(Kt):Ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Kt):Jt?/WebKit\/(\S+)/.exec(Kt):Gt?/(?:Version)[ \/]?(\S+)/.exec(Kt):void 0);if(te&&($t=te?te[1]:""),Ht){var ee=Zt();if(null!=ee&&ee>parseFloat($t)){Wt=String(ee);break t}}Wt=$t}var ne,re={};function ie(t){return function(t,e){var n=re;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=Z(String(Wt)).split("."),r=Z(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=at(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||at(0==s[2].length,0==a[2].length)||at(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}if(s.document&&Ht){var oe=Zt();ne=oe||(parseInt(Wt,10)||void 0)}else ne=void 0;var se=ne;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Kt){}var ae=!Ht||9<=Number(se);function ue(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function ce(t,e){lt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:fe.hasOwnProperty(n)?t.setAttribute(fe[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var he,le,fe={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function pe(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!f(o)||d(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(d(o)){var s="function"==typeof o.item||"string"==typeof o.item;break t}if(p(o)){s="function"==typeof o.item;break t}}s=!1}B(s?Q(o):o,r)}}}function de(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function ve(t){s.setTimeout((function(){throw t}),0)}function ge(t,e){le||function(){if(s.Promise&&s.Promise.resolve){var t=s.Promise.resolve(void 0);le=function(){t.then(_e)}}else le=function(){var t=_e;!p(s.setImmediate)||s.Window&&s.Window.prototype&&!ht("Edge")&&s.Window.prototype.setImmediate==s.setImmediate?(he||(he=function(){var t=s.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ht("Presto")&&(t=function(){var t=de(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=_((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!ht("Trident")&&!ht("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Fb;n.Fb=null,t()}},function(t){r.next={Fb:t},r=r.next,e.port2.postMessage(0)}}return function(t){s.setTimeout(t,0)}}()),he(t)):s.setImmediate(t)}}(),ye||(le(),ye=!0),me.add(t,e)}var ye=!1,me=new F;function _e(){for(var t;t=U();){try{t.a.call(t.b)}catch(t){ve(t)}M(j,t)}ye=!1}function be(t,e){if(this.a=we,this.h=void 0,this.f=this.b=this.c=null,this.g=this.i=!1,t!=h)try{var n=this;t.call(e,(function(t){De(n,Ee,t)}),(function(t){if(!(t instanceof qe))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}De(n,Ie,t)}))}catch(t){De(this,Ie,t)}}var we=0,Ee=2,Ie=3;function Te(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Te.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ce=new L((function(){return new Te}),(function(t){t.reset()}));function Se(t,e,n){var r=Ce.get();return r.g=t,r.b=e,r.f=n,r}function xe(t){if(t instanceof be)return t;var e=new be(h);return De(e,Ee,t),e}function Oe(t){return new be((function(e,n){n(t)}))}function Pe(t,e,n){Le(t,e,n,null)||ge(b(e,t))}function Ae(t){return new be((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Ob:!0,value:o}:{Ob:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Pe(t[o],b(i,o,!0),b(i,o,!1));else e(r)}))}function Re(t,e){if(t.a==we)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,s=n.b;s&&(s.c||(r++,s.a==t&&(i=s),!(i&&1<r)));s=s.next)i||(o=s);i&&(n.a==we&&1==r?Re(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):Fe(n),je(n,i,Ie,e)))}t.c=null}else De(t,Ie,e)}function ke(t,e){t.b||t.a!=Ee&&t.a!=Ie||Me(t),t.f?t.f.next=e:t.b=e,t.f=e}function Ne(t,e,n,r){var i=Se(null,null,null);return i.a=new be((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof qe?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,ke(t,i),i.a}function De(t,e,n){t.a==we&&(t===n&&(e=Ie,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Le(n,t.Zc,t.$c,t)||(t.h=n,t.a=e,t.c=null,Me(t),e!=Ie||n instanceof qe||function(t,e){t.g=!0,ge((function(){t.g&&Ve.call(null,e)}))}(t,n)))}function Le(t,e,n,r){if(t instanceof be)return ke(t,Se(e||h,n||null,r)),!0;if(R(t))return t.then(e,n,r),!0;if(d(t))try{var i=t.then;if(p(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}function s(t){a||(a=!0,n.call(i,t))}var a=!1;try{e.call(t,s,o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function Me(t){t.i||(t.i=!0,ge(t.fc,t))}function Fe(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function je(t,e,n,r){if(n==Ie&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ue(e,n,r);else try{e.c?e.g.call(e.f):Ue(e,n,r)}catch(t){Ve.call(null,t)}M(Ce,e)}function Ue(t,e,n){e==Ee?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}be.prototype.then=function(t,e,n){return Ne(this,p(t)?t:null,p(e)?e:null,n)},be.prototype.$goog_Thenable=!0,(t=be.prototype).na=function(t,e){return(t=Se(t,t,e)).c=!0,ke(this,t),this},t.o=function(t,e){return Ne(this,null,t,e)},t.cancel=function(t){if(this.a==we){var e=new qe(t);ge((function(){Re(this,e)}),this)}},t.Zc=function(t){this.a=we,De(this,Ee,t)},t.$c=function(t){this.a=we,De(this,Ie,t)},t.fc=function(){for(var t;t=Fe(this);)je(this,t,this.a,this.h);this.i=!1};var Ve=ve;function qe(t){k.call(this,t)}function Be(){this.xa=this.xa,this.oa=this.oa}E(qe,k),qe.prototype.name="cancel";function ze(t){if(!t.xa&&(t.xa=!0,t.Da(),0))(function(t){Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++g)})(t)}Be.prototype.xa=!1,Be.prototype.Da=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};var We=Object.freeze||function(t){return t},Ke=!Ht||9<=Number(se),Ge=Ht&&!ie("9"),He=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",h,e),s.removeEventListener("test",h,e)}catch(t){}return t}();function Xe(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Ye(t,e){if(Xe.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Qt){t:{try{zt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Qe[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Xe.prototype.preventDefault=function(){this.defaultPrevented=!0},E(Ye,Xe);var Qe=We({2:"touch",3:"pen",4:"mouse"});Ye.prototype.preventDefault=function(){Ye.$a.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ge)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},Ye.prototype.g=function(){return this.a};var Je="closure_listenable_"+(1e6*Math.random()|0),Ze=0;function $e(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Ua=i,this.key=++Ze,this.va=this.Oa=!1}function tn(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Ua=null}function en(t){this.src=t,this.a={},this.b=0}function nn(t,e){var n=e.type;n in t.a&&H(t.a[n],e)&&(tn(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function rn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Ua==r)return i}return-1}en.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=rn(t,e,r,i);return-1<s?(e=t[s],n||(e.Oa=!1)):((e=new $e(e,this.src,o,!!r,i)).Oa=n,t.push(e)),e};var on="closure_lm_"+(1e6*Math.random()|0),sn={};function an(t,e,n,r,i){if(r&&r.once)cn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)an(t,e[o],n,r,i);else n=mn(n),t&&t[Je]?bn(t,e,n,d(r)?!!r.capture:!!r,i):un(t,e,n,!1,r,i)}function un(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=d(i)?!!i.capture:!!i,a=gn(t);if(a||(t[on]=a=new en(t)),!(n=a.add(e,n,r,s,o)).proxy)if(r=function(){var t=vn,e=Ke?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)He||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(fn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function cn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)cn(t,e[o],n,r,i);else n=mn(n),t&&t[Je]?wn(t,e,n,d(r)?!!r.capture:!!r,i):un(t,e,n,!0,r,i)}function hn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)hn(t,e[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=mn(n),t&&t[Je]?(t=t.v,(e=String(e).toString())in t.a&&(-1<(n=rn(o=t.a[e],n,r,i))&&(tn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=gn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=rn(e,n,r,i)),(n=-1<t?e[t]:null)&&ln(n))}function ln(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[Je])nn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(fn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=gn(e))?(nn(n,t),0==n.b&&(n.src=null,e[on]=null)):tn(t)}}}function fn(t){return t in sn?sn[t]:sn[t]="on"+t}function pn(t,e,n,r){var i=!0;if((t=gn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=dn(o,r),i=i&&!1!==o)}return i}function dn(t,e){var n=t.listener,r=t.Ua||t.src;return t.Oa&&ln(t),n.call(r,e)}function vn(t,e){if(t.va)return!0;if(!Ke){if(!e)t:{e=["window","event"];for(var n=s,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Ye(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=pn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=pn(r[i],t,!1,e),n=n&&o}return n}return dn(t,new Ye(e,this))}function gn(t){return(t=t[on])instanceof en?t:null}var yn="__closure_events_fn_"+(1e9*Math.random()>>>0);function mn(t){return p(t)?t:(t[yn]||(t[yn]=function(e){return t.handleEvent(e)}),t[yn])}function _n(){Be.call(this),this.v=new en(this),this.$b=this,this.fb=null}function bn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function wn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function En(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.va&&s.capture==n){var a=s.listener,u=s.Ua||s.src;s.Oa&&nn(t.v,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}function In(t,e,n){if(p(t))n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function Tn(t){var e=null;return new be((function(n,r){-1==(e=In((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw s.clearTimeout(e),t}))}function Cn(t){if(t.V&&"function"==typeof t.V)return t.V();if("string"==typeof t)return t.split("");if(f(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Sn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.V||"function"!=typeof t.V){if(f(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function xn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof xn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function On(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Pn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Pn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}E(_n,Be),_n.prototype[Je]=!0,_n.prototype.addEventListener=function(t,e,n,r){an(this,t,e,n,r)},_n.prototype.removeEventListener=function(t,e,n,r){hn(this,t,e,n,r)},_n.prototype.dispatchEvent=function(t){var e,n=this.fb;if(n)for(e=[];n;n=n.fb)e.push(n);n=this.$b;var r=t.type||t;if("string"==typeof t)t=new Xe(t,n);else if(t instanceof Xe)t.target=t.target||n;else{var i=t;vt(t=new Xe(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=En(s,r,!0,t)&&i}if(i=En(s=t.b=n,r,!0,t)&&i,i=En(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=En(s=t.b=e[o],r,!1,t)&&i;return i},_n.prototype.Da=function(){if(_n.$a.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)tn(n[r]);delete e.a[t],e.b--}}this.fb=null},(t=xn.prototype).V=function(){On(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return On(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Pn(this.b,t)?this.b[t]:e},t.set=function(t,e){Pn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var An=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rn(t,e){var n;this.a=this.l=this.f="",this.g=null,this.i=this.c="",this.h=!1,t instanceof Rn?(this.h=void 0!==e?e:t.h,kn(this,t.f),this.l=t.l,this.a=t.a,Nn(this,t.g),this.c=t.c,Dn(this,$n(t.b)),this.i=t.i):t&&(n=String(t).match(An))?(this.h=!!e,kn(this,n[1]||"",!0),this.l=Un(n[2]||""),this.a=Un(n[3]||"",!0),Nn(this,n[4]),this.c=Un(n[5]||"",!0),Dn(this,n[6]||"",!0),this.i=Un(n[7]||"")):(this.h=!!e,this.b=new Hn(null,this.h))}function kn(t,e,n){t.f=n?Un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Nn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Dn(t,e,n){e instanceof Hn?(t.b=e,function(t,e){e&&!t.f&&(Xn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Qn(this,e),Zn(this,n,t))}),t)),t.f=e}(t.b,t.h)):(n||(e=Vn(e,Kn)),t.b=new Hn(e,t.h))}function Ln(t,e,n){t.b.set(e,n)}function Mn(t,e){return t.b.get(e)}function Fn(t){return t instanceof Rn?new Rn(t):new Rn(t,void 0)}function jn(t,e,n,r){var i=new Rn(null,void 0);return t&&kn(i,t),e&&(i.a=e),n&&Nn(i,n),r&&(i.c=r),i}function Un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Vn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,qn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function qn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Rn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Vn(e,Bn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Vn(e,Bn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.c)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Vn(n,"/"==n.charAt(0)?Wn:zn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Vn(n,Gn)),t.join("")},Rn.prototype.resolve=function(t){var e=new Rn(this),n=!!t.f;n?kn(e,t.f):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.c;if(n)Nn(e,t.g);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.a&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(st(i,"./")||st(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.b.toString(),n?Dn(e,$n(t.b)):n=!!t.i,n&&(e.i=t.i),e};var Bn=/[#\/\?@]/g,zn=/[#\?:]/g,Wn=/[#\?]/g,Kn=/[#\?@]/g,Gn=/#/g;function Hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Xn(t){t.a||(t.a=new xn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Yn(t){var e=Sn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Hn(null,void 0);t=Cn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?Zn(n,i,o):n.add(i,o)}return n}function Qn(t,e){Xn(t),e=tr(t,e),Pn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Pn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&On(t)))}function Jn(t,e){return Xn(t),e=tr(t,e),Pn(t.a.b,e)}function Zn(t,e,n){Qn(t,e),0<n.length&&(t.c=null,t.a.set(tr(t,e),Q(n)),t.b+=n.length)}function $n(t){var e=new Hn;return e.c=t.c,t.a&&(e.a=new xn(t.a),e.b=t.b),e}function tr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function er(t){var e=[];return rr(new nr,t,e),e.join("")}function nr(){}function rr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),rr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&("function"!=typeof(o=e[r])&&(n.push(i),sr(r,n),n.push(":"),rr(t,o,n),i=","));return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":sr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(t=Hn.prototype).add=function(t,e){Xn(this),this.c=null,t=tr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Xn(this),this.a.forEach((function(n,r){B(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){Xn(this);for(var t=this.a.V(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.V=function(t){Xn(this);var e=[];if("string"==typeof t)Jn(this,t)&&(e=Y(e,this.a.get(tr(this,t))));else{t=this.a.V();for(var n=0;n<t.length;n++)e=Y(e,t[n])}return e},t.set=function(t,e){return Xn(this),this.c=null,Jn(this,t=tr(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.V(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var ir={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},or=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function sr(t,e){e.push('"',t.replace(or,(function(t){var e=ir[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ir[t]=e),e})),'"')}function ar(){var t=xr();return Ht&&!!se&&11==se||/Edge\/\d+/.test(t)}function ur(){return s.window&&s.window.location.href||self&&self.location&&self.location.href||""}function cr(t,e){e=e||s.window;var n="about:blank";t&&(n=At(Dt(t)||Ft)),e.location.href=n}function hr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<hr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function lr(t){return!!((t=(t||xr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function fr(t){t=t||s.window;try{t.close()}catch(t){}}function pr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=xr().toLowerCase(),r&&(e.target=r,st(n,"crios/")&&(e.target="_blank")),Tr(xr())==Er&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Pt?n:Dt(void 0!==n.href?n.href:String(n))||Ft,n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var s=i.join(",");if((ht("iPhone")&&!ht("iPod")&&!ht("iPad")||ht("iPad")||ht("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(gt(s=de(document,"A"),"HTMLAnchorElement"),e=e instanceof Pt?e:Lt(e),s.href=At(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=Vt("",r,n,s),t=At(e),s&&(Yt&&st(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Bt(t)+'">',t=new jt(t=(r=Et())?r.createHTML(t):t,null,Ut),r=s.document)&&(r.write(function(t){return t instanceof jt&&t.constructor===jt?t.a:(D("expected object of type SafeHtml, got '"+t+"' of type "+l(t)),"type_error:SafeHtml")}(t)),r.close())):(s=Vt(e,r,n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(t){}return s}var dr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vr=/^[^@]+@[^@]+$/;function gr(){var t=null;return new be((function(e){"complete"==s.document.readyState?e():(t=function(){e()},cn(window,"load",t))})).o((function(e){throw hn(window,"load",t),e}))}function yr(t){return t=t||xr(),!("file:"!==kr()&&"ionic:"!==kr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function mr(){var t=s.window;try{return!(!t||t==t.top)}catch(t){return!1}}function _r(){return void 0!==s.WorkerGlobalScope&&"function"==typeof s.importScripts}function br(){return sf.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":sf.INTERNAL.hasOwnProperty("node")?"Node":_r()?"Worker":"Browser"}function wr(){var t=br();return"ReactNative"===t||"Node"===t}var Er="Firefox",Ir="Chrome";function Tr(t){var e=t.toLowerCase();return st(e,"opera/")||st(e,"opr/")||st(e,"opios/")?"Opera":st(e,"iemobile")?"IEMobile":st(e,"msie")||st(e,"trident/")?"IE":st(e,"edge/")?"Edge":st(e,"firefox/")?Er:st(e,"silk/")?"Silk":st(e,"blackberry")?"Blackberry":st(e,"webos")?"Webos":!st(e,"safari/")||st(e,"chrome/")||st(e,"crios/")||st(e,"android")?!st(e,"chrome/")&&!st(e,"crios/")||st(e,"edge/")?st(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Ir:"Safari"}var Cr={ld:"FirebaseCore-web",nd:"FirebaseUI-web"};function Sr(t,e){e=e||[];var n,r=[],i={};for(n in Cr)i[Cr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=br())?r=Tr(i=xr()):"Worker"===r&&(r=Tr(i=xr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function xr(){return s.navigator&&s.navigator.userAgent||""}function Or(t,e){t=t.split("."),e=e||s;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Pr(){try{var t=s.localStorage,e=Fr();if(t)return t.setItem(e,"1"),t.removeItem(e),!ar()||!!s.indexedDB}catch(t){return _r()&&!!s.indexedDB}return!1}function Ar(){return(Rr()||"chrome-extension:"===kr()||yr())&&!wr()&&Pr()&&!_r()}function Rr(){return"http:"===kr()||"https:"===kr()}function kr(){return s.location&&s.location.protocol||null}function Nr(t){return!lr(t=t||xr())&&Tr(t)!=Er}function Dr(t){return void 0===t?null:er(t)}function Lr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Mr(t){if(null!==t)return JSON.parse(t)}function Fr(t){return t||Math.floor(1e9*Math.random()).toString()}function jr(t){return"Safari"!=Tr(t=t||xr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Ur(){var t=s.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Vr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=xr(),e=br(),this.b=lr(t)||"ReactNative"===e}function qr(){var t=s.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Br(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function zr(){return!(!Or("fireauth.oauthhelper",s)&&!Or("fireauth.iframe",s))}Vr.prototype.get=function(){var t=s.navigator;return!t||"boolean"!=typeof t.onLine||!Rr()&&"chrome-extension:"!==kr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Wr,Kr={};function Gr(t){Kr[t]||(Kr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Hr={};Object.defineProperty(Hr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Hr,"abcd",{configurable:!0,enumerable:!0,value:2}),Wr=2==Hr.abcd}catch(Kt){Wr=!1}function Xr(t,e,n){Wr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Yr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Xr(t,n,e[n])}function Qr(t){var e={};return Yr(e,t),e}function Jr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Xr(e,n,Jr(t[n]));return e}function Zr(t){var e=t&&(t[ri]?"phone":null);if(!(e&&t&&t[ni]))throw new T("internal-error","Internal assert: invalid MultiFactorInfo object");Xr(this,"uid",t[ni]),Xr(this,"displayName",t[ti]||null);var n=null;t[ei]&&(n=new Date(t[ei]).toUTCString()),Xr(this,"enrollmentTime",n),Xr(this,"factorId",e)}function $r(t){try{var e=new ii(t)}catch(t){e=null}return e}Zr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ti="displayName",ei="enrolledAt",ni="mfaEnrollmentId",ri="phoneInfo";function ii(t){Zr.call(this,t),Xr(this,"phoneNumber",t[ri])}function oi(t){var e={},n=t[ci],r=t[li],i=t[fi];if(t=$r(t[hi]),!i||i!=ai&&i!=ui&&!n||i==ui&&!r||i==si&&!t)throw Error("Invalid checkActionCode response!");i==ui?(e[di]=n||null,e[gi]=n||null,e[pi]=r):(e[di]=r||null,e[gi]=r||null,e[pi]=n||null),e[vi]=t||null,Xr(this,mi,i),Xr(this,yi,Jr(e))}E(ii,Zr),ii.prototype.w=function(){var t=ii.$a.w.call(this);return t.phoneNumber=this.phoneNumber,t};var si="REVERT_SECOND_FACTOR_ADDITION",ai="EMAIL_SIGNIN",ui="VERIFY_AND_CHANGE_EMAIL",ci="email",hi="mfaInfo",li="newEmail",fi="requestType",pi="email",di="fromEmail",vi="multiFactorInfo",gi="previousEmail",yi="data",mi="operation";function _i(t){var e=Mn(t=Fn(t),bi)||null,n=Mn(t,wi)||null,r=Mn(t,Ti)||null;if(r=r&&Si[r]||null,!e||!n||!r)throw new T("argument-error",bi+", "+wi+"and "+Ti+" are required in a valid action code URL.");Yr(this,{apiKey:e,operation:r,code:n,continueUrl:Mn(t,Ei)||null,languageCode:Mn(t,Ii)||null,tenantId:Mn(t,Ci)||null})}var bi="apiKey",wi="oobCode",Ei="continueUrl",Ii="languageCode",Ti="mode",Ci="tenantId",Si={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:si,signIn:ai,verifyAndChangeEmail:ui,verifyEmail:"VERIFY_EMAIL"};function xi(t){try{return new _i(t)}catch(t){return null}}function Oi(t){var e=t[Ni];if(void 0===e)throw new T("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new T("invalid-continue-uri");this.i=e,this.b=this.a=null,this.g=!1;var n=t[Pi];if(n&&"object"==typeof n){e=n[Mi];var r=n[Di];if(n=n[Li],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new T("argument-error",Di+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new T("argument-error",Li+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new T("argument-error",Mi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new T("missing-android-pkg-name")}}else if(void 0!==n)throw new T("argument-error",Pi+" property must be a non null object when specified.");if(this.f=null,(e=t[ki])&&"object"==typeof e){if("string"==typeof(e=e[Fi])&&e.length)this.f=e;else if(void 0!==e)throw new T("argument-error",Fi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new T("argument-error",ki+" property must be a non null object when specified.");if(void 0!==(e=t[Ri])&&"boolean"!=typeof e)throw new T("argument-error",Ri+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Ai])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new T("argument-error",Ai+" property must be a non empty string when specified.");this.h=t||null}var Pi="android",Ai="dynamicLinkDomain",Ri="handleCodeInApp",ki="iOS",Ni="url",Di="installApp",Li="minimumVersion",Mi="packageName",Fi="bundleId";function ji(t){var e={};for(var n in e.continueUrl=t.i,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.h,e)null===e[n]&&delete e[n];return e}var Ui=null;function Vi(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Ui[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ui){Ui={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Ui[o]&&(Ui[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;e(i<<2|o>>4),64!=s&&(e(o<<4&240|s>>2),64!=a&&e(s<<6&192|a))}}(t,(function(t){e+=String.fromCharCode(t)})),e}function qi(t){var e=zi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.i=t,this.a=e.exp,this.h=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Bi(t){try{return new qi(t)}catch(t){return null}}function zi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Vi(t))}catch(t){}return null}qi.prototype.S=function(){return this.f},qi.prototype.l=function(){return this.c},qi.prototype.toString=function(){return this.i};var Wi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Ki=["client_id","response_type","scope","redirect_uri","state"],Gi={md:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Wa:Ki},od:{Ja:null,ua:500,ta:750,fa:"github.com",Wa:Ki},pd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Wa:Ki},vd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Wa:Wi},jd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Wa:[]}};function Hi(t){for(var e in Gi)if(Gi[e].fa==t)return Gi[e];return null}function Xi(t){var e={};e["facebook.com"]=$i,e["google.com"]=eo,e["github.com"]=to,e["twitter.com"]=no;var n=t&&t[Qi];try{if(n)return e[n]?new e[n](t):new Zi(t);if(void 0!==t[Yi])return new Ji(t)}catch(t){}return null}var Yi="idToken",Qi="providerId";function Ji(t){var e=t[Qi];if(!e&&t[Yi]){var n=Bi(t[Yi]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Xr(this,"providerId",e),Xr(this,"isNewUser",n)}function Zi(t){Ji.call(this,t),Xr(this,"profile",Jr((t=Mr(t.rawUserInfo||"{}"))||{}))}function $i(t){if(Zi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function to(t){if(Zi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Xr(this,"username",this.profile&&this.profile.login||null)}function eo(t){if(Zi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function no(t){if(Zi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Xr(this,"username",t.screenName||null)}function ro(t){var e=Fn(t),n=Mn(e,"link"),r=Mn(Fn(n),"link");return e=Mn(e,"deep_link_id"),Mn(Fn(e),"link")||e||r||n||t}function io(t,e){if(!t&&!e)throw new T("internal-error","Internal assert: no raw session string available");if(t&&e)throw new T("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?oo:so}E(Zi,Ji),E($i,Zi),E(to,Zi),E(eo,Zi),E(no,Zi);var oo="enroll",so="signin";function ao(){}function uo(t,e){return t.then((function(t){if(t[Js]){var n=Bi(t[Js]);if(!n||e!=n.h)throw new T("user-mismatch");return t}throw new T("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==x+"user-not-found"?new T("user-mismatch"):t}))}function co(t,e){if(!e)throw new T("internal-error","failed to construct a credential");this.a=e,Xr(this,"providerId",t),Xr(this,"signInMethod",t)}function ho(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function lo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new co(t.providerId,t.pendingToken)}catch(t){}return null}function fo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Xr(this,"idToken",e.idToken),e.accessToken&&Xr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Xr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new T("internal-error","failed to construct a credential");Xr(this,"accessToken",e.oauthToken),Xr(this,"secret",e.oauthTokenSecret)}Xr(this,"providerId",t),Xr(this,"signInMethod",n)}function po(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Yn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function vo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new fo(t.providerId,e,t.signInMethod)}catch(t){}}return null}function go(t,e){this.Pc=e||[],Yr(this,{providerId:t,isOAuthProvider:!0}),this.Hb={},this.ob=(Hi(t)||{}).Ja||null,this.nb=null}function yo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new T("argument-error",'SAML provider IDs must be prefixed with "saml."');go.call(this,t,[])}function mo(t){go.call(this,t,Ki),this.a=[]}function _o(){mo.call(this,"facebook.com")}function bo(t){if(!t)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new _o).credential({accessToken:e})}function wo(){mo.call(this,"github.com")}function Eo(t){if(!t)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new wo).credential({accessToken:e})}function Io(){mo.call(this,"google.com"),this.Ca("profile")}function To(t,e){var n=t;return d(t)&&(n=t.idToken,e=t.accessToken),(new Io).credential({idToken:n,accessToken:e})}function Co(){go.call(this,"twitter.com",Wi)}function So(t,e){var n=t;if(d(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new T("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new fo("twitter.com",n,"twitter.com")}function xo(t,e,n){this.a=t,this.f=e,Xr(this,"providerId","password"),Xr(this,"signInMethod",n===Po.EMAIL_LINK_SIGN_IN_METHOD?Po.EMAIL_LINK_SIGN_IN_METHOD:Po.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Oo(t){return t&&t.email&&t.password?new xo(t.email,t.password,t.signInMethod):null}function Po(){Yr(this,{providerId:"password",isOAuthProvider:!1})}function Ao(t,e){if(!(e=Ro(e)))throw new T("argument-error","Invalid email link!");return new xo(t,e.code,Po.EMAIL_LINK_SIGN_IN_METHOD)}function Ro(t){return(t=xi(t=ro(t)))&&t.operation===ai?t:null}function ko(t){if(!(t.cb&&t.bb||t.La&&t.ea))throw new T("internal-error");this.a=t,Xr(this,"providerId","phone"),this.fa="phone",Xr(this,"signInMethod","phone")}function No(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return B(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new ko(e)}return null}function Do(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.cb,code:t.a.bb}}function Lo(t){try{this.a=t||sf.auth()}catch(t){throw new T("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Yr(this,{providerId:"phone",isOAuthProvider:!1})}function Mo(t,e){if(!t)throw new T("missing-verification-id");if(!e)throw new T("missing-verification-code");return new ko({cb:t,bb:e})}function Fo(t){if(t.temporaryProof&&t.phoneNumber)return new ko({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,s=t&&t.pendingToken;try{switch(e){case"google.com":return To(o,n);case"facebook.com":return bo(n);case"github.com":return Eo(n);case"twitter.com":return So(n,r);default:return n||r||o||s?s?0==e.indexOf("saml.")?new co(e,s):new fo(e,{pendingToken:s,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new mo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function jo(t){if(!t.isOAuthProvider)throw new T("invalid-oauth-provider")}function Uo(t,e,n,r,i,o,s){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.h=o||null,this.i=s||null,this.a=i||null,!this.g&&!this.a)throw new T("invalid-auth-event");if(this.g&&this.a)throw new T("invalid-auth-event");if(this.g&&!this.f)throw new T("invalid-auth-event")}function Vo(t){return(t=t||{}).type?new Uo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&C(t.error),t.postBody,t.tenantId):null}function qo(){this.b=null,this.a=[]}io.prototype.Ha=function(){return this.a?xe(this.a):xe(this.b)},io.prototype.w=function(){return this.type==oo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},ao.prototype.ja=function(){},ao.prototype.b=function(){},ao.prototype.c=function(){},ao.prototype.w=function(){},co.prototype.ja=function(t){return _a(t,ho(this))},co.prototype.b=function(t,e){var n=ho(this);return n.idToken=e,ba(t,n)},co.prototype.c=function(t,e){return uo(wa(t,ho(this)),e)},co.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},fo.prototype.ja=function(t){return _a(t,po(this))},fo.prototype.b=function(t,e){var n=po(this);return n.idToken=e,ba(t,n)},fo.prototype.c=function(t,e){return uo(wa(t,po(this)),e)},fo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},go.prototype.Ka=function(t){return this.Hb=pt(t),this},E(yo,go),E(mo,go),mo.prototype.Ca=function(t){return G(this.a,t)||this.a.push(t),this},mo.prototype.Pb=function(){return Q(this.a)},mo.prototype.credential=function(t,e){var n;if(!(n=d(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new T("argument-error","credential failed: must provide the ID token and/or the access token.");return new fo(this.providerId,n,this.providerId)},E(_o,mo),Xr(_o,"PROVIDER_ID","facebook.com"),Xr(_o,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),E(wo,mo),Xr(wo,"PROVIDER_ID","github.com"),Xr(wo,"GITHUB_SIGN_IN_METHOD","github.com"),E(Io,mo),Xr(Io,"PROVIDER_ID","google.com"),Xr(Io,"GOOGLE_SIGN_IN_METHOD","google.com"),E(Co,go),Xr(Co,"PROVIDER_ID","twitter.com"),Xr(Co,"TWITTER_SIGN_IN_METHOD","twitter.com"),xo.prototype.ja=function(t){return this.signInMethod==Po.EMAIL_LINK_SIGN_IN_METHOD?nu(t,Pa,{email:this.a,oobCode:this.f}):nu(t,Ja,{email:this.a,password:this.f})},xo.prototype.b=function(t,e){return this.signInMethod==Po.EMAIL_LINK_SIGN_IN_METHOD?nu(t,Aa,{idToken:e,email:this.a,oobCode:this.f}):nu(t,za,{idToken:e,email:this.a,password:this.f})},xo.prototype.c=function(t,e){return uo(this.ja(t),e)},xo.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Yr(Po,{PROVIDER_ID:"password"}),Yr(Po,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Yr(Po,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),ko.prototype.ja=function(t){return t.eb(Do(this))},ko.prototype.b=function(t,e){var n=Do(this);return n.idToken=e,nu(t,$a,n)},ko.prototype.c=function(t,e){var n=Do(this);return n.operation="REAUTH",uo(t=nu(t,tu,n),e)},ko.prototype.w=function(){var t={providerId:"phone"};return this.a.cb&&(t.verificationId=this.a.cb),this.a.bb&&(t.verificationCode=this.a.bb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Lo.prototype.eb=function(t,e){var n=this.a.a;return xe(e.verify()).then((function(r){if("string"!=typeof r)throw new T("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=d(t)?t.session:null,o=d(t)?t.phoneNumber:t;return(i&&i.type==oo?i.Ha().then((function(t){return function(t,e){return nu(t,Ka,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==so?i.Ha().then((function(e){return function(t,e){return nu(t,Ga,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return nu(t,qa,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new T("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Yr(Lo,{PROVIDER_ID:"phone"}),Yr(Lo,{PHONE_SIGN_IN_METHOD:"phone"}),Uo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.i&&t.push(this.i),t.join("-")},Uo.prototype.S=function(){return this.i},Uo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.h,tenantId:this.i,error:this.a&&this.a.w()}};var Bo,zo=null;function Wo(t){var e="unauthorized-domain",n=void 0,r=Fn(t);t=r.a,"chrome-extension"==(r=r.f)?n=qt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=qt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",T.call(this,e,n)}function Ko(t,e,n){T.call(this,t,n),(t=e||{}).Ib&&Xr(this,"email",t.Ib),t.ea&&Xr(this,"phoneNumber",t.ea),t.credential&&Xr(this,"credential",t.credential),t.Yb&&Xr(this,"tenantId",t.Yb)}function Go(t){if(t.code){var e=t.code||"";0==e.indexOf(x)&&(e=e.substring(x.length));var n={credential:Fo(t),Yb:t.tenantId};if(t.email)n.Ib=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new T(e,t.message||void 0);return new Ko(e,n,t.message)}return null}function Ho(){}function Xo(t){return t.c||(t.c=t.b())}function Yo(){}function Qo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Jo(){}function Zo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=_(this.pc,this),this.a.onerror=_(this.Rb,this),this.a.onprogress=_(this.qc,this),this.a.ontimeout=_(this.uc,this)}function $o(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function ts(t,e,n){this.reset(t,e,n,void 0,void 0)}function es(t){this.f=t,this.b=this.c=this.a=null}function ns(t,e){this.name=t,this.value=e}E(Wo,T),E(Ko,T),Ko.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&vt(t,e),t},Ko.prototype.toJSON=function(){return this.w()},Ho.prototype.c=null,E(Yo,Ho),Yo.prototype.a=function(){var t=Qo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Yo.prototype.b=function(){var t={};return Qo(this)&&(t[0]=!0,t[1]=!0),t},Bo=new Yo,E(Jo,Ho),Jo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Zo;throw Error("Unsupported browser")},Jo.prototype.b=function(){return{}},(t=Zo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.pc=function(){this.status=200,this.response=this.responseText=this.a.responseText,$o(this,4)},t.Rb=function(){this.status=500,this.response=this.responseText="",$o(this,4)},t.uc=function(){this.Rb()},t.qc=function(){this.status=200,$o(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},ts.prototype.a=null,ts.prototype.reset=function(t,e,n,r,i){delete this.a},ns.prototype.toString=function(){return this.name};var rs=new ns("SEVERE",1e3),is=new ns("WARNING",900),os=new ns("CONFIG",700),ss=new ns("FINE",500);function as(t){return t.c?t.c:t.a?as(t.a):(D("Root logger has no level set."),null)}es.prototype.log=function(t,e,n){if(t.value>=as(this).value)for(p(e)&&(e=e()),t=new ts(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var us={},cs=null;function hs(t){var e;if(cs||(cs=new es(""),us[""]=cs,cs.c=os),!(e=us[t])){e=new es(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=hs(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,us[t]=e}return e}function ls(t,e){t&&t.log(ss,e,void 0)}function fs(t){this.f=t}function ps(t){_n.call(this),this.u=t,this.i=void 0,this.readyState=ds,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.h=hs("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}E(fs,Ho),fs.prototype.a=function(){return new ps(this.f)},fs.prototype.b=function(t){return function(){return t}}({}),E(ps,_n);var ds=0;function vs(t){t.c.read().then(t.oc.bind(t)).catch(t.Ta.bind(t))}function gs(t){t.readyState=4,t.g=null,t.c=null,t.m=null,ys(t)}function ys(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ms(t){_n.call(this),this.headers=new xn,this.O=t||null,this.c=!1,this.A=this.a=null,this.i=this.P=this.l="",this.f=this.N=this.h=this.G=!1,this.g=0,this.s=null,this.m=_s,this.u=this.R=!1}(t=ps.prototype).open=function(t,e){if(this.readyState!=ds)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,ys(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.i,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.tc.bind(this),this.Ta.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,gs(this)),this.readyState=ds},t.tc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,ys(this)),this.a&&(this.readyState=3,ys(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.rc.bind(this),this.Ta.bind(this)):void 0!==s.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,vs(this)):t.text().then(this.sc.bind(this),this.Ta.bind(this)))))},t.oc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?gs(this):ys(this),3==this.readyState&&vs(this)}},t.sc=function(t){this.a&&(this.response=this.responseText=t,gs(this))},t.rc=function(t){this.a&&(this.response=t,gs(this))},t.Ta=function(t){var e=this.h;e&&e.log(is,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&gs(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(is,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(is,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ps.prototype,"withCredentials",{get:function(){return"include"===this.i},set:function(t){this.i=t?"include":"same-origin"}}),E(ms,_n);var _s="";ms.prototype.b=hs("goog.net.XhrIo");var bs=/^https?$/i,ws=["POST","PUT"];function Es(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.i="",t.P=n,t.G=!1,t.c=!0,t.a=t.O?t.O.a():Bo.a(),t.A=t.O?Xo(t.O):Xo(Bo),t.a.onreadystatechange=_(t.Ub,t);try{ls(t.b,Rs(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(e){return ls(t.b,Rs(t,"Error opening Xhr: "+e.message)),void Ts(t,e)}e=r||"";var o=new xn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(f(t)||"string"==typeof t)B(t,e,void 0);else for(var n=Sn(t),r=Cn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=Is,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=s.FormData&&e instanceof s.FormData,!G(ws,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{Os(t),0<t.g&&(t.u=function(t){return Ht&&ie(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),ls(t.b,Rs(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=_(t.Ma,t)):t.s=In(t.Ma,t.g,t)),ls(t.b,Rs(t,"Sending request")),t.h=!0,t.a.send(e),t.h=!1}catch(e){ls(t.b,Rs(t,"Send error: "+e.message)),Ts(t,e)}}function Is(t){return"content-type"==t.toLowerCase()}function Ts(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.i=e,Cs(t),xs(t)}function Cs(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ss(t){if(t.c&&void 0!==o)if(t.A[1]&&4==Ps(t)&&2==As(t))ls(t.b,Rs(t,"Local request error detected and ignored"));else if(t.h&&4==Ps(t))In(t.Ub,0,t);else if(t.dispatchEvent("readystatechange"),4==Ps(t)){ls(t.b,Rs(t,"Request complete")),t.c=!1;try{var e,n=As(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var a=String(t.l).match(An)[1]||null;if(!a&&s.self&&s.self.location){var u=s.self.location.protocol;a=u.substr(0,u.length-1)}i=!bs.test(a?a.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Ps(t)?t.a.statusText:""}catch(e){ls(t.b,"Can not get status: "+e.message),c=""}t.i=c+" ["+As(t)+"]",Cs(t)}}finally{xs(t)}}}function xs(t,e){if(t.a){Os(t);var n=t.a,r=t.A[0]?h:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(rs,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Os(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(s.clearTimeout(t.s),t.s=null)}function Ps(t){return t.a?t.a.readyState:0}function As(t){try{return 2<Ps(t)?t.a.status:-1}catch(t){return-1}}function Rs(t,e){return e+" ["+t.P+" "+t.l+" "+As(t)+"]"}function ks(t){var e=zs;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.m=this.A=this.h=!1,this.i=0,this.b=null,this.l=0}function Ns(t,e,n){t.a=!0,t.c=n,t.f=!e,Fs(t)}function Ds(t){if(t.a){if(!t.m)throw new js(t);t.m=!1}}function Ls(t,e,n,r){t.g.push([e,n,r]),t.a&&Fs(t)}function Ms(t){return K(t.g,(function(t){return p(t[1])}))}function Fs(t){if(t.i&&t.a&&Ms(t)){var e=t.i,n=qs[e];n&&(s.clearTimeout(n.a),delete qs[e]),t.i=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.h;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var u=o.call(i||t.s,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(R(e)||"function"==typeof s.Promise&&e instanceof s.Promise)&&(r=!0,t.h=!0)}catch(r){e=r,t.f=!0,Ms(t)||(n=!0)}}t.c=e,r&&(u=_(t.v,t,!0),r=_(t.v,t,!1),e instanceof ks?(Ls(e,u,r),e.A=!0):e.then(u,r)),n&&(e=new Vs(e),qs[e.a]=e,t.i=e.a)}function js(){k.call(this)}function Us(){k.call(this)}function Vs(t){this.a=s.setTimeout(_(this.c,this),0),this.b=t}(t=ms.prototype).Ma=function(){void 0!==o&&this.a&&(this.i="Timed out after "+this.g+"ms, aborting",ls(this.b,Rs(this,this.i)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ls(this.b,Rs(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),xs(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),xs(this,!0)),ms.$a.Da.call(this)},t.Ub=function(){this.xa||(this.N||this.h||this.f?Ss(this):this.Ic())},t.Ic=function(){Ss(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case _s:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(rs,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return ls(this.b,"Can not get response: "+t.message),null}},ks.prototype.cancel=function(t){if(this.a)this.c instanceof ks&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.m=!0,this.a||(t=new Us(this),Ds(this),Ns(this,!1,t))}},ks.prototype.v=function(t,e){this.h=!1,Ns(this,t,e)},ks.prototype.then=function(t,e,n){var r,i,o=new be((function(t,e){r=t,i=e}));return Ls(this,r,(function(t){t instanceof Us?o.cancel():i(t)})),o.then(t,e,n)},ks.prototype.$goog_Thenable=!0,E(js,k),js.prototype.message="Deferred has already fired",js.prototype.name="AlreadyCalledError",E(Us,k),Us.prototype.message="Deferred was canceled",Us.prototype.name="CanceledError",Vs.prototype.c=function(){throw delete qs[this.a],this.b};var qs={};function Bs(t){var e,n=document,r=Tt(t).toString(),i=de(document,"SCRIPT"),o={Vb:i,Ma:void 0},a=new ks(o);return e=window.setTimeout((function(){Ws(i,!0);var t=new Hs(Gs,"Timeout reached for loading script "+r);Ds(a),Ns(a,!1,t)}),5e3),o.Ma=e,i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ws(i,!1,e),Ds(a),Ns(a,!0,null))},i.onerror=function(){Ws(i,!0,e);var t=new Hs(Ks,"Error while loading script "+r);Ds(a),Ns(a,!1,t)},vt(o={},{type:"text/javascript",charset:"UTF-8"}),ce(i,o),function(t,e){gt(t,"HTMLScriptElement"),t.src=Tt(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=s?e=c(e.document):(null===u&&(u=c(s.document)),e=u),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function zs(){if(this&&this.Vb){var t=this.Vb;t&&"SCRIPT"==t.tagName&&Ws(t,!0,this.Ma)}}function Ws(t,e,n){null!=n&&s.clearTimeout(n),t.onload=h,t.onerror=h,t.onreadystatechange=h,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Ks=0,Gs=1;function Hs(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),k.call(this,n),this.code=t}function Xs(t){this.f=t}function Ys(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.v=t.secureTokenTimeout||Zs,this.g=pt(t.secureTokenHeaders||$s),this.i=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.m=t.firebaseTimeout||ta,this.a=pt(t.firebaseHeaders||ea),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==br(),!(n=s.XMLHttpRequest||n&&sf.INTERNAL.node&&sf.INTERNAL.node.XMLHttpRequest)&&!_r())throw new T("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,_r()?this.f=new fs(self):wr()?this.f=new Xs(n):this.f=new Jo,this.b=null}E(Hs,k),E(Xs,Ho),Xs.prototype.a=function(){return new this.f},Xs.prototype.b=function(){return{}};var Qs,Js="idToken",Zs=new Vr(3e4,6e4),$s={"Content-Type":"application/x-www-form-urlencoded"},ta=new Vr(3e4,6e4),ea={"Content-Type":"application/json"};function na(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function ra(t,e){e&&(t.l=ia("https://securetoken.googleapis.com/v1/token",e),t.i=ia("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.h=ia("https://identitytoolkit.googleapis.com/v2/",e))}function ia(t,e){return t=Fn(t),e=Fn(e.url),t.c=t.a+t.c,kn(t,e.f),t.a=e.a,Nn(t,e.g),t.toString()}function oa(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function sa(t,e,n,r,i,o,a){(function(){var t=xr();return!((t=Tr(t)!=Ir?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Ht&&se&&!(9<se))})()||_r()?t=_(t.u,t):(Qs||(Qs=new be((function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{s[ua]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Ls(t,null,e,void 0)}(Bs(Ct(aa,{onload:ua})),(function(){e(Error("CORS_UNSUPPORTED"))}))}}(t,e)}))),t=_(t.s,t)),t(e,n,r,i,o,a)}Ys.prototype.S=function(){return this.b},Ys.prototype.u=function(t,e,n,r,i,o){if(_r()&&(void 0===s.fetch||void 0===s.Headers||void 0===s.Request))throw new T("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new ms(this.f);if(o){a.g=Math.max(0,o);var u=setTimeout((function(){a.dispatchEvent("timeout")}),o)}bn(a,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ls(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),wn(a,"ready",(function(){u&&clearTimeout(u),ze(this)})),wn(a,"timeout",(function(){u&&clearTimeout(u),ze(this),e&&e(null)})),Es(a,t,n,r,i)};var aa=new yt(wt,"https://apis.google.com/js/client.js?onload=%{onload}"),ua="__fcb"+Math.floor(1e6*Math.random()).toString();function ca(t,e,n,r,i,o,s){var a=Fn(e+n);Ln(a,"key",t.c),s&&Ln(a,"cb",w().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Ln(a,c,i[c]);return new be((function(e,n){sa(t,a.toString(),(function(t){t?t.error?n(iu(t,o||{})):e(t):n(new T("network-request-failed"))}),r,u?void 0:er(Lr(i)),t.a,t.m.get())}))}function ha(t){if("string"!=typeof(t=t.email)||!vr.test(t))throw new T("invalid-email")}function la(t){"email"in t&&ha(t)}function fa(t){if(!t[Js]){if(t.mfaPendingCredential)throw new T("multi-factor-auth-required",null,pt(t));throw new T("internal-error")}}function pa(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new T("internal-error")}else{if(!t.sessionInfo)throw new T("missing-verification-id");if(!t.code)throw new T("missing-verification-code")}}Ys.prototype.s=function(t,e,n,r,i){var o=this;Qs.then((function(){window.gapi.client.setApiKey(o.c);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(s),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Ys.prototype.yb=function(){return nu(this,Wa,{})},Ys.prototype.Ab=function(t,e){return nu(this,Ba,{idToken:t,email:e})},Ys.prototype.Bb=function(t,e){return nu(this,za,{idToken:t,password:e})};var da={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function va(t){if(!t.phoneVerificationInfo)throw new T("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new T("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new T("missing-verification-code")}function ga(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new T("internal-error")}function ya(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(Jn(t=new Hn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function ma(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Go(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Go(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Go(t)):t.errorMessage&&(e=ru(t.errorMessage)),e)throw e;fa(t)}function _a(t,e){return e.returnIdpCredential=!0,nu(t,Ha,e)}function ba(t,e){return e.returnIdpCredential=!0,nu(t,Ya,e)}function wa(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,nu(t,Xa,e)}function Ea(t){if(!t.oobCode)throw new T("invalid-action-code")}(t=Ys.prototype).Cb=function(t,e){var n={idToken:t},r=[];return lt(da,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),nu(this,Ba,n)},t.ub=function(t,e){return vt(t={requestType:"PASSWORD_RESET",email:t},e),nu(this,Fa,t)},t.vb=function(t,e){return vt(t={requestType:"EMAIL_SIGNIN",email:t},e),nu(this,Da,t)},t.tb=function(t,e){return vt(t={requestType:"VERIFY_EMAIL",idToken:t},e),nu(this,La,t)},t.Db=function(t,e,n){return vt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),nu(this,Ma,t)},t.eb=function(t){return nu(this,Za,t)},t.mb=function(t,e){return nu(this,Va,{oobCode:t,newPassword:e})},t.Qa=function(t){return nu(this,Ta,{oobCode:t})},t.ib=function(t){return nu(this,Ia,{oobCode:t})};var Ia={endpoint:"setAccountInfo",B:Ea,Z:"email",C:!0},Ta={endpoint:"resetPassword",B:Ea,F:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new T("internal-error")},C:!0},Ca={endpoint:"signupNewUser",B:function(t){if(ha(t),!t.password)throw new T("weak-password")},F:fa,U:!0,C:!0},Sa={endpoint:"createAuthUri",C:!0},xa={endpoint:"deleteAccount",M:["idToken"]},Oa={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],B:function(t){if(!Array.isArray(t.deleteProvider))throw new T("internal-error")}},Pa={endpoint:"emailLinkSignin",M:["email","oobCode"],B:ha,F:fa,U:!0,C:!0},Aa={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],B:ha,F:fa,U:!0},Ra={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],B:va,F:fa,C:!0,Na:!0},ka={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],B:va,F:fa,C:!0,Na:!0},Na={endpoint:"getAccountInfo"},Da={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new T("internal-error");ha(t)},Z:"email",C:!0},La={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new T("internal-error")},Z:"email",C:!0},Ma={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],B:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new T("internal-error")},Z:"email",C:!0},Fa={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new T("internal-error");ha(t)},Z:"email",C:!0},ja={kb:!0,endpoint:"getProjectConfig",Tb:"GET"},Ua={kb:!0,endpoint:"getRecaptchaParam",Tb:"GET",F:function(t){if(!t.recaptchaSiteKey)throw new T("internal-error")}},Va={endpoint:"resetPassword",B:Ea,Z:"email",C:!0},qa={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Z:"sessionInfo",C:!0},Ba={endpoint:"setAccountInfo",M:["idToken"],B:la,U:!0},za={endpoint:"setAccountInfo",M:["idToken"],B:function(t){if(la(t),!t.password)throw new T("weak-password")},F:fa,U:!0},Wa={endpoint:"signupNewUser",F:fa,U:!0,C:!0},Ka={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],B:function(t){if(!t.phoneEnrollmentInfo)throw new T("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new T("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new T("missing-app-credential")},F:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new T("internal-error")},C:!0,Na:!0},Ga={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],B:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new T("missing-app-credential")},F:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new T("internal-error")},C:!0,Na:!0},Ha={endpoint:"verifyAssertion",B:ga,Xa:ya,F:ma,U:!0,C:!0},Xa={endpoint:"verifyAssertion",B:ga,Xa:ya,F:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new T("user-not-found");if(t.errorMessage)throw ru(t.errorMessage);fa(t)},U:!0,C:!0},Ya={endpoint:"verifyAssertion",B:function(t){if(ga(t),!t.idToken)throw new T("internal-error")},Xa:ya,F:ma,U:!0},Qa={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new T("invalid-custom-token")},F:fa,U:!0,C:!0},Ja={endpoint:"verifyPassword",B:function(t){if(ha(t),!t.password)throw new T("wrong-password")},F:fa,U:!0,C:!0},Za={endpoint:"verifyPhoneNumber",B:pa,F:fa,C:!0},$a={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new T("internal-error");pa(t)},F:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Go(t);fa(t)}},tu={Gb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:pa,F:fa,C:!0},eu={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],F:function(t){if(!!t[Js]^!!t.refreshToken)throw new T("internal-error")},C:!0,Na:!0};function nu(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.M))return Oe(new T("internal-error"));var r,i=!!e.Na,o=e.Tb||"POST";return xe(n).then(e.B).then((function(){return e.U&&(n.returnSecureToken=!0),e.C&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),ca(t,i?t.h:t.i,e.endpoint,o,n,e.Gb,e.kb||!1)})).then((function(t){return r=t,e.Xa?e.Xa(n,r):r})).then(e.F).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new T("internal-error");return r[e.Z]}))}function ru(t){return iu({error:{errors:[{message:t}],code:400,message:t}})}function iu(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new T(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",vt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new T(r[i],e);return!e&&t&&(e=Dr(t)),new T("internal-error",e)}function ou(t){this.b=t,this.a=null,this.qb=function(t){return(cu||(cu=new be((function(t,e){function n(){Ur(),Or("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Ur(),e(Error("Network Error"))},timeout:au.get()})}if(Or("gapi.iframes.Iframe"))t();else if(Or("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();s[r]=function(){Or("gapi.load")?n():e(Error("Network Error"))},xe(Bs(r=Ct(su,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw cu=null,t})))).then((function(){return new be((function(e,n){Or("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),uu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var su=new yt(wt,"https://apis.google.com/js/api.js?onload=%{onload}"),au=new Vr(3e4,6e4),uu=new Vr(5e3,15e3),cu=null;function hu(t,e,n,r){this.l=t,this.i=e,this.h=n,this.g=r,this.f=null,this.g?t=jn((t=Fn(this.g.url)).f,t.a,t.g,"/emulator/auth/iframe"):t=jn("https",this.l,null,"/__/auth/iframe"),this.a=t,Ln(this.a,"apiKey",this.i),Ln(this.a,"appName",this.h),this.b=null,this.c=[]}function lu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.v=r,this.m=o,this.h=this.g=this.l=null,this.a=i,this.i=this.f=null}function fu(t){try{return sf.app(t).auth().Ga()}catch(t){return[]}}function pu(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.h=i||null,this.l=this.u=this.A=null,this.i=[],this.v=this.a=null}function du(t){var e=ur();return function(t){return nu(t,ja,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Fn(e),r=n.f;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],s=n,a=r;if(0==o.indexOf("chrome-extension://")?s=Fn(o).a==s&&"chrome-extension"==a:"http"!=a&&"https"!=a?s=!1:dr.test(o)?s=s==o:(o=o.split(".").join("\\."),s=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)),s){t=!0;break t}}t=!1}if(!t)throw new Wo(ur())}))}function vu(t){return t.v||(t.v=gr().then((function(){if(!t.u){var e=t.c,n=t.h,r=fu(t.b),i=new hu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=Q(r||[]),t.u=i.toString()}t.m=new ou(t.u),function(t){if(!t.m)throw Error("IfcHandler must be initialized!");!function(t,e){t.qb.then((function(){t.a.register("authEvent",e,Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.m,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Vo(e.authEvent),n=0;n<t.i.length;n++)r=t.i[n](e)||r;return(n={}).status=r?"ACK":"ERROR",xe(n)}return n.status="ERROR",xe(n)}))}(t)}))),t.v}function gu(t){return t.l||(t.A=t.c?Sr(t.c,fu(t.b)):null,t.l=new Ys(t.g,A(t.h),t.A),t.f&&ra(t.l,t.f)),t.l}function yu(t,e,n,r,i,o,s,a,u,c,h,l){return(t=new lu(t,e,n,r,i,l)).l=o,t.g=s,t.h=a,t.b=pt(u||null),t.f=c,t.xb(h).toString()}function mu(t){if(this.a=t||sf.INTERNAL.reactNative&&sf.INTERNAL.reactNative.AsyncStorage,!this.a)throw new T("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function _u(t){this.b=t,this.a={},this.f=_(this.c,this)}hu.prototype.toString=function(){return this.f?Ln(this.a,"v",this.f):Qn(this.a.b,"v"),this.b?Ln(this.a,"eid",this.b):Qn(this.a.b,"eid"),this.c.length?Ln(this.a,"fw",this.c.join(",")):Qn(this.a.b,"fw"),this.a.toString()},lu.prototype.xb=function(t){return this.i=t,this},lu.prototype.toString=function(){if(this.m){var t=Fn(this.m.url);t=jn(t.f,t.a,t.g,"/emulator/auth/handler")}else t=jn("https",this.u,null,"/__/auth/handler");if(Ln(t,"apiKey",this.s),Ln(t,"appName",this.c),Ln(t,"authType",this.v),this.a.isOAuthProvider){var e=this.a;try{var n=sf.app(this.c).auth().ka()}catch(t){n=null}for(var r in e.nb=n,Ln(t,"providerId",this.a.providerId),e=Lr((n=this.a).Hb))e[r]=e[r].toString();r=n.Pc,e=pt(e);for(var i=0;i<r.length;i++){var o=r[i];o in e&&delete e[o]}n.ob&&n.nb&&!e[n.ob]&&(e[n.ob]=n.nb),ft(e)||Ln(t,"customParameters",Dr(e))}if("function"==typeof this.a.Pb&&((n=this.a.Pb()).length&&Ln(t,"scopes",n.join(","))),this.l?Ln(t,"redirectUrl",this.l):Qn(t.b,"redirectUrl"),this.g?Ln(t,"eventId",this.g):Qn(t.b,"eventId"),this.h?Ln(t,"v",this.h):Qn(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Mn(t,s)&&Ln(t,s,this.b[s]);return this.i?Ln(t,"tid",this.i):Qn(t.b,"tid"),this.f?Ln(t,"eid",this.f):Qn(t.b,"eid"),(s=fu(this.c)).length&&Ln(t,"fw",s.join(",")),t.toString()},(t=pu.prototype).Nb=function(t,e,n){var r=new T("popup-closed-by-user"),i=new T("web-storage-unsupported"),o=this,s=!1;return this.la().then((function(){(function(t){var e={type:"webStorageSupport"};return vu(t).then((function(){return function(t,e){return t.qb.then((function(){return new be((function(n){t.a.send(e.type,e,n,Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.m,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&fr(t),e(i),s=!0)}))})).o((function(){})).then((function(){if(!s)return function(t){return new be((function(e){return function n(){Tn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!s)return Tn(n).then((function(){e(r)}))}))},t.Wb=function(){var t=xr();return!Nr(t)&&!jr(t)},t.Sb=function(){return!1},t.Lb=function(t,e,n,r,i,o,s,a){if(!t)return Oe(new T("popup-blocked"));if(s&&!Nr())return this.la().o((function(e){fr(t),i(e)})),r(),xe();this.a||(this.a=du(gu(this)));var u=this;return this.a.then((function(){var e=u.la().o((function(e){throw fr(t),i(e),e}));return r(),e})).then((function(){(jo(n),s)||cr(yu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.h,a,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Mb=function(t,e,n,r){this.a||(this.a=du(gu(this)));var i=this;return this.a.then((function(){jo(e),cr(yu(i.s,i.g,i.b,t,e,ur(),n,i.c,void 0,i.h,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.la=function(){var t=this;return vu(this).then((function(){return t.m.qb})).o((function(){throw t.a=null,new T("network-request-failed")}))},t.Zb=function(){return!0},t.Ea=function(t){this.i.push(t)},t.Ra=function(t){X(this.i,(function(e){return e==t}))},(t=mu.prototype).get=function(t){return xe(this.a.getItem(t)).then((function(t){return t&&Mr(t)}))},t.set=function(t,e){return xe(this.a.setItem(t,Dr(e)))},t.T=function(t){return xe(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var bu,wu=[];function Eu(t,e,n){ft(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Iu(t){this.a=t}function Tu(t){this.c=t,this.b=!1,this.a=[]}function Cu(t,e,n,r){var i,o,s,a,u=n||{},c=null;if(t.b)return Oe(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new be((function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),s=setTimeout((function(){r(Error("unsupported_event"))}),h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(s),a=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(a),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))})).then((function(e){return Su(t,c),e})).o((function(e){throw Su(t,c),e}))}function Su(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),X(t.a,(function(t){return t==e}))}}function xu(){if(!Ru())throw new T("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.v=s.indexedDB,this.type="indexedDB",this.g=this.m=this.f=this.l=null,this.s=!1,this.i=null;var t=this;_r()&&self?(this.m=function(){var t=_r()?self:null;if(B(wu,(function(n){n.b==t&&(e=n)})),!e){var e=new _u(t);wu.push(e)}return e}(),Eu(this.m,"keyChanged",(function(e,n){return Mu(t).then((function(e){return 0<e.length&&B(t.a,(function(t){t(e)})),{keyProcessed:G(e,n.key)}}))})),Eu(this.m,"ping",(function(){return xe(["keyChanged"])}))):function(){var t=s.navigator;return t&&t.serviceWorker?xe().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):xe(null)}().then((function(e){(t.i=e)&&(t.g=new Tu(new Iu(e)),Cu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&G(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Ou(t){return new be((function(e,n){var r=t.v.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new be((function(e,n){var r=t.v.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Ou(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Pu(t){return t.h||(t.h=Ou(t)),t.h}function Au(t,e){var n=0;return new be((function r(i,o){Pu(t).then(e).then(i).o((function(e){if(!(3<++n))return Pu(t).then((function(e){return e.close(),t.h=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function Ru(){try{return!!s.indexedDB}catch(t){return!1}}function ku(t){return t.objectStore("firebaseLocalStorage")}function Nu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Du(t){return new be((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Lu(t,e){return t.g&&t.i&&function(){var t=s.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.i?Cu(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):xe()}function Mu(t){return Pu(t).then((function(t){var e=ku(Nu(t,!1));return e.getAll?Du(e.getAll()):new be((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=hr(t.c,n),t.c=n}return r}))}function Fu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function ju(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=xe().then((function(){if(Ru()){var t=Fr(),r="__sak"+t;return bu||(bu=new xu),(n=bu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.T(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){B(e.a,(function(e){e(t)}))})),t}))}function Uu(){this.a={},this.type="inMemory"}function Vu(){if(!function(){var t="Node"==br();if(!(t=qu()||t&&sf.INTERNAL.node&&sf.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==br())throw new T("internal-error","The LocalStorage compatibility library was not found.");throw new T("web-storage-unsupported")}this.a=qu()||sf.INTERNAL.node.localStorage,this.type="localStorage"}function qu(){try{var t=s.localStorage,e=Fr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Bu(){this.type="nullStorage"}function zu(){if(!function(){var t="Node"==br();if(!(t=Wu()||t&&sf.INTERNAL.node&&sf.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==br())throw new T("internal-error","The SessionStorage compatibility library was not found.");throw new T("web-storage-unsupported")}this.a=Wu()||sf.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Wu(){try{var t=s.sessionStorage,e=Fr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Ku(){var t={};t.Browser=Xu,t.Node=Yu,t.ReactNative=Qu,t.Worker=Ju,this.a=t[br()]}_u.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];B(r,(function(e){i.push(xe().then((function(){return e(t.origin,t.data.data)})))})),Ae(i).then((function(r){var i=[];B(r,(function(t){i.push({fulfilled:t.Ob,value:t.value,reason:t.reason?t.reason.message:void 0})})),B(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Iu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Tu.prototype.close=function(){for(;0<this.a.length;)Su(this,this.a[0]);this.b=!0},(t=xu.prototype).set=function(t,e){var n=this,r=!1;return Au(this,(function(e){return Du((e=ku(Nu(e,!0))).get(t))})).then((function(i){return Au(n,(function(o){if(o=ku(Nu(o,!0)),i)return i.value=e,Du(o.put(i));n.b++,r=!0;var s={};return s.fbase_key=t,s.value=e,Du(o.add(s))}))})).then((function(){return n.c[t]=e,Lu(n,t)})).na((function(){r&&n.b--}))},t.get=function(t){return Au(this,(function(e){return Du(ku(Nu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.T=function(t){var e=this,n=!1;return Au(this,(function(r){return n=!0,e.b++,Du(ku(Nu(r,!0)).delete(t))})).then((function(){return delete e.c[t],Lu(e,t)})).na((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){function e(){t.f=setTimeout((function(){t.l=Mu(t).then((function(e){0<e.length&&B(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}Fu(t),e()}(this),this.a.push(t)},t.ia=function(t){X(this.a,(function(e){return e==t})),0==this.a.length&&Fu(this)},(t=ju.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.T=function(t){return this.b.then((function(e){return e.T(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){X(this.a,(function(e){return e==t}))},(t=Uu.prototype).get=function(t){return xe(this.a[t])},t.set=function(t,e){return this.a[t]=e,xe()},t.T=function(t){return delete this.a[t],xe()},t.ca=function(){},t.ia=function(){},(t=Vu.prototype).get=function(t){var e=this;return xe().then((function(){return Mr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return xe().then((function(){var r=Dr(e);null===r?n.T(t):n.a.setItem(t,r)}))},t.T=function(t){var e=this;return xe().then((function(){e.a.removeItem(t)}))},t.ca=function(t){s.window&&an(s.window,"storage",t)},t.ia=function(t){s.window&&hn(s.window,"storage",t)},(t=Bu.prototype).get=function(){return xe(null)},t.set=function(){return xe()},t.T=function(){return xe()},t.ca=function(){},t.ia=function(){},(t=zu.prototype).get=function(t){var e=this;return xe().then((function(){return Mr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return xe().then((function(){var r=Dr(e);null===r?n.T(t):n.a.setItem(t,r)}))},t.T=function(t){var e=this;return xe().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Gu,Hu,Xu={D:Vu,ab:zu},Yu={D:Vu,ab:zu},Qu={D:mu,ab:Bu},Ju={D:Vu,ab:Bu},Zu={qd:"local",NONE:"none",sd:"session"};function $u(){var t=!(jr(xr())||!mr()),e=Nr(),n=Pr();this.v=t,this.i=e,this.l=n,this.a={},Gu||(Gu=new Ku),t=Gu;try{this.g=!ar()&&zr()||!s.indexedDB?new t.a.D:new ju(_r()?new Uu:new t.a.D)}catch(t){this.g=new Uu,this.i=!0}try{this.h=new t.a.ab}catch(t){this.h=new Uu}this.m=new Uu,this.f=_(this.Xb,this),this.b={}}function tc(){return Hu||(Hu=new $u),Hu}function ec(t,e){switch(e){case"session":return t.h;case"none":return t.m;default:return t.g}}function nc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function rc(t,e,n){return n=nc(e,n),"local"==e.D&&(t.b[n]=null),ec(t,e.D).T(n)}function ic(t){t.c&&(clearInterval(t.c),t.c=null)}function oc(t){this.a=t,this.b=tc()}(t=$u.prototype).get=function(t,e){return ec(this,t.D).get(nc(t,e))},t.set=function(t,e,n){var r=nc(t,n),i=this,o=ec(this,t.D);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.D&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=nc(t,e),this.l&&(this.b[t]=s.localStorage.getItem(t)),ft(this.a)&&(ec(this,"local").ca(this.f),this.i||(ar()||!zr())&&s.indexedDB||!this.l||function(t){ic(t),t.c=setInterval((function(){for(var e in t.a){var n=s.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Ye({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Xb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=nc(t,e),this.a[t]&&(X(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),ft(this.a)&&(ec(this,"local").ia(this.f),ic(this))},t.Xb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=s.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.lb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?ec(this,"local").ia(this.f):ic(this),this.v)if(n=s.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?s.localStorage.setItem(e,r):s.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===s.localStorage.getItem(e)||(o.b[e]=s.localStorage.getItem(e),o.lb(e))},Ht&&se&&10==se&&s.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else B(t,_(this.lb,this))},t.lb=function(t){this.a[t]&&B(this.a[t],(function(t){t()}))};var sc,ac={name:"authEvent",D:"local"};function uc(){this.a=tc()}function cc(t,e){this.b=hc,this.f=s.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.h=t,this.i=e,this.l=s.Int32Array?new Int32Array(64):Array(64),void 0===sc&&(sc=s.Int32Array?new Int32Array(yc):yc),this.reset()}E(cc,(function(){this.b=-1}));for(var hc=64,lc=hc-1,fc=[],pc=0;pc<lc;pc++)fc[pc]=0;var dc=Y(128,fc);function vc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+s|0}r=0|t.a[0],i=0|t.a[1];var a=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((s=(s=c&h^~c&l)+(0|sc[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+s|0,u=a,a=i,i=r,r=s+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+a|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function gc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(vc(t),i=0);else{if(!f(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(vc(t),i=0)}}t.c=i,t.g+=n}cc.prototype.reset=function(){this.g=this.c=0,this.a=s.Int32Array?new Int32Array(this.i):Q(this.i)};var yc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function mc(){cc.call(this,8,_c)}E(mc,cc);var _c=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function bc(t,e,n,r,i,o){this.m=t,this.h=e,this.l=n,this.v=r||null,this.u=i||null,this.s=o,this.i=e+":"+n,this.A=new uc,this.g=new oc(this.i),this.f=null,this.b=[],this.a=this.c=null}function wc(t){return new T("invalid-cordova-configuration",t)}function Ec(t){var e=new mc;gc(e,t),t=[];var n=8*e.g;56>e.c?gc(e,dc,56-e.c):gc(e,dc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(vc(e),r=n=0;r<e.h;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return W(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}function Ic(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Tc(t){return t.f||(t.f=t.la().then((function(){return new be((function(e){t.Ea((function n(r){return e(r),t.Ra(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Cc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=ro(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Mr(Mn(o=Fn(i),"firebaseError")||null))?C(o):null)?new Uo(r.c,r.b,null,null,o,null,r.S()):new Uo(r.c,r.b,i,r.f,null,null,r.S())),i=o||n}Ic(t,i)}))}var n=new Uo("unknown",null,null,null,new T("no-auth-event")),r=!1,i=Tn(500).then((function(){return Cc(t).then((function(){r||Ic(t,n)}))})),o=s.handleOpenURL;s.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Or("BuildInfo.packageName",s).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},zo||(zo=new qo),function(t){var e=zo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Or("universalLinks.subscribe",s))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Cc(t){var e=null;return function(t){return t.b.get(ac,t.a).then((function(t){return Vo(t)}))}(t.g).then((function(n){return e=n,rc((n=t.g).b,ac,n.a)})).then((function(){return e}))}function Sc(t){this.a=t,this.b=tc()}(t=bc.prototype).la=function(){return this.Ia?this.Ia:this.Ia=(yr(void 0)?gr().then((function(){return new be((function(t,e){var n=s.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Oe(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Or("universalLinks.subscribe",s))throw wc("cordova-universal-links-plugin-fix is not installed");if(void 0===Or("BuildInfo.packageName",s))throw wc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Or("cordova.plugins.browsertab.openUrl",s))throw wc("cordova-plugin-browsertab is not installed");if("function"!=typeof Or("cordova.InAppBrowser.open",s))throw wc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new T("cordova-not-ready")}))},t.Nb=function(t,e){return e(new T("operation-not-supported-in-this-environment")),xe()},t.Lb=function(){return Oe(new T("operation-not-supported-in-this-environment"))},t.Zb=function(){return!1},t.Wb=function(){return!0},t.Sb=function(){return!0},t.Mb=function(t,e,n,r){if(this.c)return Oe(new T("redirect-operation-pending"));var i=this,o=s.document,a=null,u=null,c=null,h=null;return this.c=xe().then((function(){return jo(e),Tc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Uo(e,r,null,o,new T("no-auth-event"),null,i),u=Or("BuildInfo.packageName",s);if("string"!=typeof u)throw new T("invalid-cordova-configuration");var c=Or("BuildInfo.displayName",s),h={};if(xr().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=u;else{if(!xr().toLowerCase().match(/android/))return Oe(new T("operation-not-supported-in-this-environment"));h.apn=u}c&&(h.appDisplayName=c),o=Ec(o),h.sessionId=o;var l=yu(t.m,t.h,t.l,e,n,null,r,t.v,h,t.u,i,t.s);return t.la().then((function(){var e=t.i;return t.A.a.set(ac,a.w(),e)})).then((function(){var e=Or("cordova.plugins.browsertab.isAvailable",s);if("function"!=typeof e)throw new T("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Or("cordova.plugins.browsertab.openUrl",s)))throw new T("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=Or("cordova.InAppBrowser.open",s)))throw new T("invalid-cordova-configuration");e=xr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new be((function(t,e){u=function(){var e=Or("cordova.plugins.browsertab.close",s);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),c=function(){a||(a=Tn(2e3).then((function(){e(new T("redirect-cancelled-by-user"))})))},h=function(){qr()&&c()},o.addEventListener("resume",c,!1),xr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)})).o((function(t){return Cc(i).then((function(){throw t}))}))})).na((function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),a&&a.cancel(),u&&i.Ra(u),i.c=null}))},t.Ea=function(t){this.b.push(t),Tc(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Uo("unknown",null,null,null,new T("no-auth-event")),t(e))}))},t.Ra=function(t){X(this.b,(function(e){return e==t}))};var xc={name:"pendingRedirect",D:"session"};function Oc(t){return rc(t.b,xc,t.a)}function Pc(t,e,n,r){this.h={},this.u=0,this.O=t,this.m=e,this.v=n,this.G=r,this.i=[],this.f=!1,this.l=_(this.s,this),this.b=new Wc,this.A=new Yc,this.g=new Sc(Bc(this.m,this.v)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.A,this.c.linkViaPopup=this.A,this.c.reauthViaPopup=this.A,this.a=Ac(this.O,this.m,this.v,S,this.G)}function Ac(t,e,n,r,i){var o=sf.SDK_VERSION||null;return yr()?new bc(t,e,n,o,r,i):new pu(t,e,n,o,r,i)}function Rc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.la().o((function(n){throw t.a==e&&t.reset(),n}))}function kc(t){t.a.Wb()&&Rc(t).o((function(e){var n=new Uo("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));jc(e)&&t.s(n)})),t.a.Sb()||Kc(t.b)}function Nc(t,e){G(t.i,e)||t.i.push(e),t.f||function(t){return t.b.get(xc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Oc(t.g).then((function(){Rc(t).o((function(e){var n=new Uo("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));jc(e)&&t.s(n)}))})):kc(t)})).o((function(){kc(t)}))}function Dc(t,e){X(t.i,(function(t){return t==e}))}Pc.prototype.reset=function(){this.f=!1,this.a.Ra(this.l),this.a=Ac(this.O,this.m,this.v,null,this.G),this.h={}},Pc.prototype.s=function(t){if(!t)throw new T("invalid-auth-event");if(6e5<=w()-this.u&&(this.h={},this.u=0),t&&t.getUid()&&this.h.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.i.length;n++){var r=this.i[n];if(r.Eb(t.c,t.b)){(e=this.c[t.c])&&(e.i(t,r),t&&(t.f||t.b)&&(this.h[t.getUid()]=!0,this.u=w())),e=!0;break}}return Kc(this.b),e};var Lc=new Vr(2e3,1e4),Mc=new Vr(3e4,6e4);function Fc(t,e,n,r,i,o,s){return t.a.Lb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,s)}function jc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Uc(t,e,n,r,i){var o;return function(t){return t.b.set(xc,"pending",t.a)}(t.g).then((function(){return t.a.Mb(e,n,r,i).o((function(e){if(jc(e))throw new T("operation-not-supported-in-this-environment");return o=e,Oc(t.g).then((function(){throw o}))})).then((function(){return t.a.Zb()?new be((function(){})):Oc(t.g).then((function(){return t.qa()})).then((function(){})).o((function(){}))}))}))}function Vc(t,e,n,r,i){return t.a.Nb(r,(function(t){e.ma(n,null,t,i)}),Lc.get())}Pc.prototype.qa=function(){return this.b.qa()};var qc={};function Bc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function zc(t,e,n,r){var i=Bc(e,n,r);return qc[i]||(qc[i]=new Pc(t,e,n,r)),qc[i]}function Wc(){this.b=null,this.f=[],this.c=[],this.a=null,this.h=this.g=!1}function Kc(t){t.g||(t.g=!0,Xc(t,!1,null,null))}function Gc(t){t.g&&!t.h&&Xc(t,!1,null,null)}function Hc(t,e){if(t.b=function(){return xe(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Xc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Oe(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Hc(t,n):Hc(t,{user:null}),t.f=[],t.c=[]}function Yc(){}function Qc(){this.hb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.hb},set:function(t){this.hb=t},enumerable:!1})}function Jc(t,e){this.a=e,Xr(this,"verificationId",t)}function Zc(t,e,n,r){return new Lo(t).eb(e,n).then((function(t){return new Jc(t,r)}))}function $c(t){var e=zi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new T("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Yr(this,{token:t,expirationTime:Br(1e3*e.exp),authTime:Br(1e3*e.auth_time),issuedAtTime:Br(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function th(t,e,n){var r=e&&e[nh];if(!r)throw new T("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=pt(e),this.g=n,this.c=new io(null,r),this.b=[];var i=this;B(e[eh]||[],(function(t){(t=$r(t))&&i.b.push(t)})),Xr(this,"auth",this.a),Xr(this,"session",this.c),Xr(this,"hints",this.b)}Wc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Wc.prototype.i=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.h=!(!i&&!o),"unknown"!=n||i||o?t.a?(Xc(this,!0,null,t.a),xe()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.h,s=e.S(),a=!!e.c.match(/Redirect$/);n(r,i,s,o).then((function(e){Xc(t,a,e,null)})).o((function(e){Xc(t,a,null,e)}))}(this,t,e):Oe(new T("invalid-auth-event")):(Xc(this,!1,null,null),xe())}else Oe(new T("invalid-auth-event"))},Wc.prototype.qa=function(){var t=this;return new be((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new T("timeout");t.a&&t.a.cancel(),t.a=Tn(Mc.get()).then((function(){t.b||(t.g=!0,Xc(t,!0,null,e))}))}(t))}))},Yc.prototype.i=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ma(t.c,null,t.a,t.b),xe()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.S(),t.h).then((function(t){e.ma(r,t,null,n)})).o((function(t){e.ma(r,null,t,n)}))}(t,e):Oe(new T("invalid-auth-event"))}else Oe(new T("invalid-auth-event"))},Jc.prototype.confirm=function(t){return t=Mo(this.verificationId,t),this.a(t)};var eh="mfaInfo",nh="mfaPendingCredential";function rh(t,e,n,r){T.call(this,"multi-factor-auth-required",r,e),this.b=new th(t,e,n),Xr(this,"resolver",this.b)}function ih(t,e,n){if(t&&d(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new rh(e,t.serverResponse,n,t.message)}catch(t){}return null}function oh(){}function sh(t){Xr(this,"factorId",t.fa),this.a=t}function ah(t){if(sh.call(this,t),this.a.fa!=Lo.PROVIDER_ID)throw new T("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function uh(t,e){for(var n in Xe.call(this,t),e)this[n]=e[n]}function ch(t,e){this.a=t,this.b=[],this.c=_(this.xc,this),an(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&B(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ni]=t.uid),t.displayName&&(r[ti]=t.displayName),t.enrollmentTime&&(r[ei]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[ri]=t.phoneNumber);try{e=new ii(r)}catch(t){}t=e}else t=null;t&&n.push(t)})),hh(this,n)}function hh(t,e){t.b=e,Xr(t,"enrolledFactors",e)}function lh(t,e,n){if(this.i=t,this.h=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function fh(t,e){t.stop(),t.b=Tn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=s.document,e=null;return qr()||!t?xe():new be((function(n){e=function(){qr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.i()})).then((function(){fh(t,!0)})).o((function(e){t.h(e)&&fh(t,!1)}))}function ph(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function dh(t,e){void 0===e&&(t.b?e=(e=t.b).a-e.g:e=0),t.c=Date.now()+1e3*e}function vh(t,e){t.b=Bi(e[Js]||""),t.a=e.refreshToken,dh(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function gh(t,e){return function(t,e){return new be((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?sa(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(iu(t)):t.access_token&&t.refresh_token?n(t):r(new T("internal-error")):r(new T("network-request-failed"))}),"POST",Yn(e).toString(),t.g,t.v.get()):r(new T("internal-error"))}))}(t.f,e).then((function(e){return t.b=Bi(e.access_token),t.a=e.refresh_token,dh(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function yh(t,e){this.a=t||null,this.b=e||null,Yr(this,{lastSignInTime:Br(e||null),creationTime:Br(t||null)})}function mh(t,e,n,r,i,o){Yr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function _h(t,e,n){this.G=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var r=sf.SDK_VERSION?Sr(sf.SDK_VERSION):null;this.a=new Ys(this.l,A(S),r),t.emulatorConfig&&ra(this.a,t.emulatorConfig),this.b=new ph(this.a),xh(this,e[Js]),vh(this.b,e),Xr(this,"refreshToken",this.b.a),Ah(this,n||{}),_n.call(this),this.P=!1,this.s&&Ar()&&(this.h=zc(this.s,this.l,this.m)),this.R=[],this.f=null,this.u=function(t){return new lh((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.$=_(this.gb,this);var i=this;this.pa=null,this.Ba=function(t){i.wa(t.i)},this.ba=null,this.za=function(t){ra(i.a,t.c)},this.W=null,this.X=[],this.Aa=function(t){Eh(i,t.f)},this.aa=null,this.N=new ch(this,n),Xr(this,"multiFactor",this.N)}function bh(t,e){t.ba&&hn(t.ba,"languageCodeChanged",t.Ba),(t.ba=e)&&an(e,"languageCodeChanged",t.Ba)}function wh(t,e){t.W&&hn(t.W,"emulatorConfigChanged",t.za),(t.W=e)&&an(e,"emulatorConfigChanged",t.za)}function Eh(t,e){t.X=e,oa(t.a,sf.SDK_VERSION?Sr(sf.SDK_VERSION,t.X):null)}function Ih(t,e){t.aa&&hn(t.aa,"frameworkChanged",t.Aa),(t.aa=e)&&an(e,"frameworkChanged",t.Aa)}function Th(t){try{return sf.app(t.m).auth()}catch(e){throw new T("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Ch(t){t.A||t.u.b||(t.u.start(),hn(t,"tokenChanged",t.$),an(t,"tokenChanged",t.$))}function Sh(t){hn(t,"tokenChanged",t.$),t.u.stop()}function xh(t,e){t.ya=e,Xr(t,"_lat",e)}function Oh(t){for(var e=[],n=0;n<t.R.length;n++)e.push(t.R[n](t));return Ae(e).then((function(){return t}))}function Ph(t){t.h&&!t.P&&(t.P=!0,Nc(t.h,t))}function Ah(t,e){Yr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new yh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Rh(){}function kh(t){return xe().then((function(){if(t.A)throw new T("app-deleted")}))}function Nh(t){return W(t.providerData,(function(t){return t.providerId}))}function Dh(t,e){e&&(Lh(t,e.providerId),t.providerData.push(e))}function Lh(t,e){X(t.providerData,(function(t){return t.providerId==e}))}function Mh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Xr(t,e,n)}function Fh(t,e){t!=e&&(Yr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Xr(t,"metadata",function(t){return new yh(t.a,t.b)}(e.metadata)):Xr(t,"metadata",new yh),B(e.providerData,(function(e){Dh(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),Xr(t,"refreshToken",t.b.a),hh(t.N,e.N.b))}function jh(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return nu(t.a,Na,{idToken:e}).then(_(t.Jc,t))}(t,e).then((function(){return n||Mh(t,"isAnonymous",!1),e}))}))}function Uh(t,e){e[Js]&&t.ya!=e[Js]&&(vh(t.b,e),t.dispatchEvent(new uh("tokenChanged")),xh(t,e[Js]),Mh(t,"refreshToken",t.b.a))}function Vh(t,e){return jh(t).then((function(){if(G(Nh(t),e))return Oh(t).then((function(){throw new T("provider-already-linked")}))}))}function qh(t,e,n){return Qr({user:t,credential:Fo(e),additionalUserInfo:e=Xi(e),operationType:n})}function Bh(t,e){return Uh(t,e),t.reload().then((function(){return t}))}function zh(t,e,n,r,i){if(!Ar())return Oe(new T("operation-not-supported-in-this-environment"));if(t.f&&!i)return Oe(t.f);var o=Hi(n.providerId),s=Fr(t.uid+":::"),a=null;(!Nr()||mr())&&t.s&&n.isOAuthProvider&&(a=yu(t.s,t.l,t.m,e,n,null,s,sf.SDK_VERSION||null,null,null,t.tenantId));var u=pr(a,o&&o.ua,o&&o.ta);return r=r().then((function(){if(Kh(t),!i)return t.I().then((function(){}))})).then((function(){return Fc(t.h,u,e,n,s,!!a,t.tenantId)})).then((function(){return new be((function(n,r){t.ma(e,null,new T("cancelled-popup-request"),t.i||null),t.g=n,t.O=r,t.i=s,t.c=Vc(t.h,t,e,u,s)}))})).then((function(t){return u&&fr(u),t?Qr(t):null})).o((function(t){throw u&&fr(u),t})),Gh(t,r,i)}function Wh(t,e,n,r,i){if(!Ar())return Oe(new T("operation-not-supported-in-this-environment"));if(t.f&&!i)return Oe(t.f);var o=null,s=Fr(t.uid+":::");return r=r().then((function(){if(Kh(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=s,Oh(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Yh,t.w(),e.a)),e})).then((function(){return Uc(t.h,e,n,s,t.tenantId)})).o((function(e){if(o=e,t.ha)return Qh(t.ha);throw o})).then((function(){if(o)throw o})),Gh(t,r,i)}function Kh(t){if(!t.h||!t.P){if(t.h&&!t.P)throw new T("internal-error");throw new T("auth-domain-config-required")}}function Gh(t,e,n){var r=function(t,e,n){return t.f&&!n?(e.cancel(),Oe(t.f)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.f||t.dispatchEvent(new uh("userInvalidated")),t.f=e),e}))}(t,e,n);return t.G.push(r),r.na((function(){H(t.G,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=ih(e.w(),Th(t),_(t.ic,t))),n||e}))}function Hh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Js]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new _h(e,n,t);return t.providerData&&B(t.providerData,(function(t){t&&Dh(i,Qr(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function Xh(t){this.a=t,this.b=tc()}th.prototype.Qc=function(t){var e=this;return t.rb(this.a.a,this.c).then((function(t){var n=pt(e.f);return delete n[eh],delete n[nh],vt(n,t),e.g(n)}))},E(rh,T),oh.prototype.rb=function(t,e,n){return e.type==oo?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),vt(n,{phoneVerificationInfo:Do(t.a)}),nu(e,Ra,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return vt(n={mfaPendingCredential:n},{phoneVerificationInfo:Do(t.a)}),nu(e,ka,n)}))}(this,t,e)},E(sh,oh),E(ah,sh),E(uh,Xe),(t=ch.prototype).xc=function(t){hh(this,function(t){var e=[];return B(t.mfaInfo||[],(function(t){(t=$r(t))&&e.push(t)})),e}(t.gd))},t.Qb=function(){return this.a.I().then((function(t){return new io(t,null)}))},t.ec=function(t,e){var n=this,r=this.a.a;return this.Qb().then((function(n){return t.rb(r,n,e)})).then((function(t){return Uh(n.a,t),n.a.reload()}))},t.ad=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return nu(r,eu,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=z(e.b,(function(t){return t.uid!=n}));return hh(e,r),Uh(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:W(this.b,(function(t){return t.w()}))}}},lh.prototype.start=function(){this.a=this.c,fh(this,!0)},lh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ph.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},ph.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Oe(new T("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?gh(this,{grant_type:"refresh_token",refresh_token:this.a}):xe(null):xe({accessToken:this.b.toString(),refreshToken:this.a})},yh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},E(_h,_n),_h.prototype.wa=function(t){this.pa=t,na(this.a,t)},_h.prototype.ka=function(){return this.pa},_h.prototype.Ga=function(){return Q(this.X)},_h.prototype.gb=function(){this.u.b&&(this.u.stop(),this.u.start())},Xr(_h.prototype,"providerId","firebase"),(t=_h.prototype).reload=function(){var t=this;return Gh(this,kh(this).then((function(){return jh(t).then((function(){return Oh(t)})).then(Rh)})))},t.nc=function(t){return this.I(t).then((function(t){return new $c(t)}))},t.I=function(t){var e=this;return Gh(this,kh(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new T("internal-error");return t.accessToken!=e.ya&&(xh(e,t.accessToken),e.dispatchEvent(new uh("tokenChanged"))),Mh(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Jc=function(t){if(!(t=t.users)||!t.length)throw new T("internal-error");Ah(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?W(t,(function(t){return new mh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Dh(this,e[n]);Mh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new uh("userReloaded",{gd:t}))},t.Kc=function(t){return Gr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.sb(t)},t.sb=function(t){var e=this,n=null;return Gh(this,t.c(this.a,this.uid).then((function(t){return Uh(e,t),n=qh(e,t,"reauthenticate"),e.f=null,e.reload()})).then((function(){return n})),!0)},t.Bc=function(t){return Gr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.pb(t)},t.pb=function(t){var e=this,n=null;return Gh(this,Vh(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=qh(e,t,"link"),Bh(e,t)})).then((function(){return n})))},t.Cc=function(t,e){var n=this;return Gh(this,Vh(this,"phone").then((function(){return Zc(Th(n),t,e,_(n.pb,n))})))},t.Lc=function(t,e){var n=this;return Gh(this,xe().then((function(){return Zc(Th(n),t,e,_(n.sb,n))})),!0)},t.Ab=function(t){var e=this;return Gh(this,this.I().then((function(n){return e.a.Ab(n,t)})).then((function(t){return Uh(e,t),e.reload()})))},t.dd=function(t){var e=this;return Gh(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Uh(e,t),e.reload()})))},t.Bb=function(t){var e=this;return Gh(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return Uh(e,t),e.reload()})))},t.Cb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return kh(this);var e=this;return Gh(this,this.I().then((function(n){return e.a.Cb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Uh(e,t),Mh(e,"displayName",t.displayName||null),Mh(e,"photoURL",t.photoUrl||null),B(e.providerData,(function(t){"password"===t.providerId&&(Xr(t,"displayName",e.displayName),Xr(t,"photoURL",e.photoURL))})),Oh(e)})).then(Rh))},t.bd=function(t){var e=this;return Gh(this,jh(this).then((function(n){return G(Nh(e),t)?function(t,e,n){return nu(t,Oa,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return B(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),B(Nh(e),(function(t){n[t]||Lh(e,t)})),n[Lo.PROVIDER_ID]||Xr(e,"phoneNumber",null),Oh(e)})):Oh(e).then((function(){throw new T("no-such-provider")}))})))},t.delete=function(){var t=this;return Gh(this,this.I().then((function(e){return nu(t.a,xa,{idToken:e})})).then((function(){t.dispatchEvent(new uh("userDeleted"))}))).then((function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");bh(t,null),wh(t,null),Ih(t,null),t.G=[],t.A=!0,Sh(t),Xr(t,"refreshToken",null),t.h&&Dc(t.h,t)}))},t.Eb=function(t,e){return!!("linkViaPopup"==t&&(this.i||null)==e&&this.g||"reauthViaPopup"==t&&(this.i||null)==e&&this.g||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.ma=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.i||null)||(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.i||null)?_(this.Jb,this):"reauthViaPopup"==t&&e==(this.i||null)?_(this.Kb,this):"linkViaRedirect"==t&&(this.ga||null)==e?_(this.Jb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?_(this.Kb,this):null},t.Dc=function(t){var e=this;return zh(this,"linkViaPopup",t,(function(){return Vh(e,t.providerId).then((function(){return Oh(e)}))}),!1)},t.Mc=function(t){return zh(this,"reauthViaPopup",t,(function(){return xe()}),!0)},t.Ec=function(t){var e=this;return Wh(this,"linkViaRedirect",t,(function(){return Vh(e,t.providerId)}),!1)},t.Nc=function(t){return Wh(this,"reauthViaRedirect",t,(function(){return xe()}),!0)},t.Jb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Gh(this,this.I().then((function(n){return ba(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=qh(i,t,"link"),Bh(i,t)})).then((function(){return o})))},t.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Gh(this,xe().then((function(){return uo(wa(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=qh(i,t,"reauthenticate"),Uh(i,t),i.f=null,i.reload()})).then((function(){return o})),!0)},t.tb=function(t){var e=this,n=null;return Gh(this,this.I().then((function(e){return n=e,void 0===t||ft(t)?{}:ji(new Oi(t))})).then((function(t){return e.a.tb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Db=function(t,e){var n=this,r=null;return Gh(this,this.I().then((function(t){return r=t,void 0===e||ft(e)?{}:ji(new Oi(e))})).then((function(e){return n.a.Db(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.ic=function(t){var e=null,n=this;return Gh(this,t=uo(xe(t),n.uid).then((function(t){return e=qh(n,t,"reauthenticate"),Uh(n,t),n.f=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&vt(t,this.metadata.w()),B(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),vt(t,this.N.w()),t};var Yh={name:"redirectUser",D:"session"};function Qh(t){return rc(t.b,Yh,t.a)}function Jh(t){this.a=t,this.b=tc(),this.c=null,this.f=function(t){var e=tl("local"),n=tl("session"),r=tl("none");return function(t,e,n){var r=nc(e,n),i=ec(t,e.D);return t.get(e,n).then((function(o){var a=null;try{a=Mr(s.localStorage.getItem(r))}catch(t){}if(a&&!o)return s.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&s.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get($h,t.a).then((function(t){return t?tl(t):e}))}))}))})).then((function(e){return t.c=e,Zh(t,e.D)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(tl("local"),this.a,_(this.g,this))}function Zh(t,e){var n,r=[];for(n in Zu)Zu[n]!==e&&r.push(rc(t.b,tl(Zu[n]),t.a));return r.push(rc(t.b,$h,t.a)),function(t){return new be((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},a=0;a<t.length;a++)Pe(t[a],b(o,a),s);else e(i)}))}(r)}Jh.prototype.g=function(){var t=this,e=tl("local");il(this,(function(){return xe().then((function(){return t.c&&"local"!=t.c.D?t.b.get(e,t.a):null})).then((function(n){if(n)return Zh(t,"local").then((function(){t.c=e}))}))}))};var $h={name:"persistence",D:"session"};function tl(t){return{name:"authUser",D:t}}function el(t,e){return il(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function nl(t){return il(t,(function(){return rc(t.b,t.c,t.a)}))}function rl(t,e,n){return il(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Hh(t||{})}))}))}function il(t,e){return t.f=t.f.then(e,e),t.f}function ol(t){if(this.m=!1,Xr(this,"settings",new Qc),Xr(this,"app",t),!dl(this).options||!dl(this).options.apiKey)throw new T("invalid-api-key");t=sf.SDK_VERSION?Sr(sf.SDK_VERSION):null,this.a=new Ys(dl(this).options&&dl(this).options.apiKey,A(S),t),this.R=[],this.u=[],this.P=[],this.ac=sf.INTERNAL.createSubscribe(_(this.yc,this)),this.X=void 0,this.bc=sf.INTERNAL.createSubscribe(_(this.zc,this)),fl(this,null),this.l=new Jh(dl(this).options.apiKey+":"+dl(this).name),this.G=new Xh(dl(this).options.apiKey+":"+dl(this).name),this.$=ml(this,function(t){var e=dl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Yh,t.a).then((function(t){return t&&e&&(t.authDomain=e),Hh(t||{})}))}(t.G,dl(t).options.authDomain).then((function(e){return(t.s=e)&&(e.ha=t.G),Qh(t.G)}));return ml(t,e)}(t).then((function(){return rl(t.l,e,t.f)})).then((function(e){return e?(e.ha=t.G,t.s&&(t.s.ga||null)==(e.ga||null)?e:e.reload().then((function(){return el(t.l,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:nl(t.l)}))):null})).then((function(e){fl(t,e||null)}));return ml(t,n)}(this)),this.h=ml(this,function(t){return t.$.then((function(){return hl(t)})).o((function(){})).then((function(){if(!t.m)return t.pa()})).o((function(){})).then((function(){if(!t.m){t.ba=!0;var e=t.l;e.b.addListener(tl("local"),e.a,t.pa)}}))}(this)),this.ba=!1,this.pa=_(this.Yc,this),this.Ba=_(this.da,this),this.ya=_(this.kc,this),this.za=_(this.vc,this),this.Aa=_(this.wc,this),this.b=null,function(t){var e=dl(t).options.authDomain,n=dl(t).options.apiKey;e&&Ar()&&(t.gb=t.$.then((function(){if(!t.m){if(t.b=zc(e,n,dl(t).name,t.f),Nc(t.b,t),vl(t)&&Ph(vl(t)),t.s){Ph(t.s);var r=t.s;r.wa(t.ka()),bh(r,t),Eh(r=t.s,t.N),Ih(r,t),ra((r=t.s).a,t.f),wh(r,t),t.s=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=_(this.delete,this),this.INTERNAL.logFramework=_(this.Fc,this),this.A=0,_n.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ka()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.S()},set:function(t){this.xb(t)},enumerable:!1}),t.W=null}(this),this.N=[],this.f=null}function sl(t){Xe.call(this,"languageCodeChanged"),this.i=t}function al(t){Xe.call(this,"emulatorConfigChanged"),this.c=t}function ul(t){Xe.call(this,"frameworkChanged"),this.f=t}function cl(t){return t.gb||Oe(new T("auth-domain-config-required"))}function hl(t){if(!Ar())return Oe(new T("operation-not-supported-in-this-environment"));var e=cl(t).then((function(){return t.b.qa()})).then((function(t){return t?Qr(t):null}));return ml(t,e)}function ll(t,e){var n={};return n.apiKey=dl(t).options.apiKey,n.authDomain=dl(t).options.authDomain,n.appName=dl(t).name,t.f&&(n.emulatorConfig=t.f),t.$.then((function(){return function(t,e,n,r){var i=new _h(t,e);return n&&(i.ha=n),r&&Eh(i,r),i.reload().then((function(){return i}))}(n,e,t.G,t.Ga())})).then((function(e){return vl(t)&&e.uid==vl(t).uid?(Fh(vl(t),e),t.da(e)):(fl(t,e),Ph(e),t.da(e))})).then((function(){yl(t)}))}function fl(t,e){vl(t)&&(function(t,e){X(t.R,(function(t){return t==e}))}(vl(t),t.Ba),hn(vl(t),"tokenChanged",t.ya),hn(vl(t),"userDeleted",t.za),hn(vl(t),"userInvalidated",t.Aa),Sh(vl(t))),e&&(e.R.push(t.Ba),an(e,"tokenChanged",t.ya),an(e,"userDeleted",t.za),an(e,"userInvalidated",t.Aa),0<t.A&&Ch(e)),Xr(t,"currentUser",e),e&&(e.wa(t.ka()),bh(e,t),Eh(e,t.N),Ih(e,t),ra(e.a,t.f),wh(e,t))}function pl(t,e){var n=null,r=null;return ml(t,e.then((function(e){return n=Fo(e),r=Xi(e),ll(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=ih(e.w(),t,_(t.jc,t))),n||e})).then((function(){return Qr({user:vl(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function dl(t){return t.app}function vl(t){return t.currentUser}function gl(t){return vl(t)&&vl(t)._lat||null}function yl(t){if(t.ba){for(var e=0;e<t.u.length;e++)t.u[e]&&t.u[e](gl(t));if(t.X!==t.getUid()&&t.P.length)for(t.X=t.getUid(),e=0;e<t.P.length;e++)t.P[e]&&t.P[e](gl(t))}}function ml(t,e){return t.R.push(e),e.na((function(){H(t.R,e)})),e}function _l(){}function bl(){this.a={},this.b=1e12}Jh.prototype.wb=function(t){var e=null,n=this;return function(t){var e=new T("invalid-persistence-type"),n=new T("unsupported-persistence-type");t:{for(r in Zu)if(Zu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(br()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Ru()&&"none"!==t)throw n;break;default:if(!Pr()&&"none"!==t)throw n}}(t),il(this,(function(){return t!=n.c.D?n.b.get(n.c,n.a).then((function(r){return e=r,Zh(n,t)})).then((function(){if(n.c=tl(t),e)return n.b.set(n.c,e,n.a)})):xe()}))},E(ol,_n),E(sl,Xe),E(al,Xe),E(ul,Xe),(t=ol.prototype).wb=function(t){return ml(this,t=this.l.wb(t))},t.wa=function(t){this.aa===t||this.m||(this.aa=t,na(this.a,this.aa),this.dispatchEvent(new sl(this.ka())))},t.ka=function(){return this.aa},t.ed=function(){var t=s.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.fd=function(t,e){if(!this.f){if(!/^https?:\/\//.test(t))throw new T("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");!function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),s.document&&!t&&gr().then((function(){var t=s.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),s.document.body.appendChild(t)}))}(!!e&&!!e.disableWarnings),this.f={url:t},this.settings.hb=!0,ra(this.a,this.f),this.dispatchEvent(new al(this.f))}},t.Fc=function(t){this.N.push(t),oa(this.a,sf.SDK_VERSION?Sr(sf.SDK_VERSION,this.N):null),this.dispatchEvent(new ul(this.N))},t.Ga=function(){return Q(this.N)},t.xb=function(t){this.W===t||this.m||(this.W=t,this.a.b=this.W)},t.S=function(){return this.W},t.toJSON=function(){return{apiKey:dl(this).options.apiKey,authDomain:dl(this).options.authDomain,appName:dl(this).name,currentUser:vl(this)&&vl(this).w()}},t.Eb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.i==e&&!!this.g;default:return!1}},t.ma=function(t,e,n,r){"signInViaPopup"==t&&this.i==r&&(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.i==e&&this.g?_(this.hc,this):null},t.hc=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return pl(i,_a(i.a,o))}))},t.Wc=function(t){if(!Ar())return Oe(new T("operation-not-supported-in-this-environment"));var e=this,n=Hi(t.providerId),r=Fr(),i=null;(!Nr()||mr())&&dl(this).options.authDomain&&t.isOAuthProvider&&(i=yu(dl(this).options.authDomain,dl(this).options.apiKey,dl(this).name,"signInViaPopup",t,null,r,sf.SDK_VERSION||null,null,null,this.S(),this.f));var o=pr(i,n&&n.ua,n&&n.ta);return ml(this,n=cl(this).then((function(n){return Fc(n,o,"signInViaPopup",t,r,!!i,e.S())})).then((function(){return new be((function(t,n){e.ma("signInViaPopup",null,new T("cancelled-popup-request"),e.i),e.g=t,e.O=n,e.i=r,e.c=Vc(e.b,e,"signInViaPopup",o,r)}))})).then((function(t){return o&&fr(o),t?Qr(t):null})).o((function(t){throw o&&fr(o),t})))},t.Xc=function(t){if(!Ar())return Oe(new T("operation-not-supported-in-this-environment"));var e=this;return ml(this,cl(this).then((function(){return function(t){return il(t,(function(){return t.b.set($h,t.c.D,t.a)}))}(e.l)})).then((function(){return Uc(e.b,"signInViaRedirect",t,void 0,e.S())})))},t.qa=function(){var t=this;return hl(this).then((function(e){return t.b&&Gc(t.b.b),e})).o((function(e){throw t.b&&Gc(t.b.b),e}))},t.cd=function(t){if(!t)return Oe(new T("null-user"));if(this.W!=t.tenantId)return Oe(new T("tenant-id-mismatch"));var e=this,n={};n.apiKey=dl(this).options.apiKey,n.authDomain=dl(this).options.authDomain,n.appName=dl(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[Js]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new _h(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&Eh(e,r),Fh(e,t),e}(t,n,e.G,e.Ga());return ml(this,this.h.then((function(){if(dl(e).options.apiKey!=t.l)return r.reload()})).then((function(){return vl(e)&&t.uid==vl(e).uid?(Fh(vl(e),t),e.da(t)):(fl(e,r),Ph(r),e.da(r))})).then((function(){yl(e)})))},t.zb=function(){var t=this;return ml(this,this.h.then((function(){return t.b&&Gc(t.b.b),vl(t)?(fl(t,null),nl(t.l).then((function(){yl(t)}))):xe()})))},t.Yc=function(){var t=this;return rl(this.l,dl(this).options.authDomain).then((function(e){if(!t.m){var n;if(n=vl(t)&&e){n=vl(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Fh(vl(t),e),vl(t).I();(vl(t)||e)&&(fl(t,e),e&&(Ph(e),e.ha=t.G),t.b&&Nc(t.b,t),yl(t))}}))},t.da=function(t){return el(this.l,t)},t.kc=function(){yl(this),this.da(vl(this))},t.vc=function(){this.zb()},t.wc=function(){this.zb()},t.jc=function(t){var e=this;return this.h.then((function(){return pl(e,xe(t))}))},t.yc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(vl(e))}))},t.zc=function(t){var e=this;!function(t,e){t.P.push(e),ml(t,t.h.then((function(){!t.m&&G(t.P,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(gl(t)))})))}(this,(function(){t.next(vl(e))}))},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(vl(r)):"function"==typeof t.next&&t.next(vl(r))})),this.ac(t,e,n)},t.Gc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(vl(r)):"function"==typeof t.next&&t.next(vl(r))})),this.bc(t,e,n)},t.mc=function(t){var e=this;return ml(this,this.h.then((function(){return vl(e)?vl(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Sc=function(t){var e=this;return this.h.then((function(){return pl(e,nu(e.a,Qa,{token:t}))})).then((function(t){var n=t.user;return Mh(n,"isAnonymous",!1),e.da(n),t}))},t.Tc=function(t,e){var n=this;return this.h.then((function(){return pl(n,nu(n.a,Ja,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return pl(n,nu(n.a,Ca,{email:t,password:e}))}))},t.Za=function(t){var e=this;return this.h.then((function(){return pl(e,t.ja(e.a))}))},t.Rc=function(t){return Gr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Za(t)},t.yb=function(){var t=this;return this.h.then((function(){var e=vl(t);if(e&&e.isAnonymous){var n=Qr({providerId:null,isNewUser:!1});return Qr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return pl(t,t.a.yb()).then((function(e){var n=e.user;return Mh(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return vl(this)&&vl(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.A++,0<this.A&&vl(this)&&Ch(vl(this))},t.Oc=function(t){var e=this;B(this.u,(function(n){n==t&&e.A--})),0>this.A&&(this.A=0),0==this.A&&vl(this)&&Sh(vl(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.u.push(t),ml(this,this.h.then((function(){e.m||G(e.u,t)&&t(gl(e))})))},t.removeAuthTokenListener=function(t){X(this.u,(function(e){return e==t}))},t.delete=function(){this.m=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.l&&(t=this.l).b.removeListener(tl("local"),t.a,this.pa),this.b&&(Dc(this.b,this),Gc(this.b.b)),Promise.resolve()},t.gc=function(t){return ml(this,function(t,e){return nu(t,Sa,{identifier:e,continueUri:Rr()?ur():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Ac=function(t){return!!Ro(t)},t.vb=function(t,e){var n=this;return ml(this,xe().then((function(){var t=new Oi(e);if(!t.c)throw new T("argument-error",Ri+" must be true when sending sign in link to email");return ji(t)})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},t.hd=function(t){return this.Qa(t).then((function(t){return t.data.email}))},t.mb=function(t,e){return ml(this,this.a.mb(t,e).then((function(){})))},t.Qa=function(t){return ml(this,this.a.Qa(t).then((function(t){return new oi(t)})))},t.ib=function(t){return ml(this,this.a.ib(t).then((function(){})))},t.ub=function(t,e){var n=this;return ml(this,xe().then((function(){return void 0===e||ft(e)?{}:ji(new Oi(e))})).then((function(e){return n.a.ub(t,e)})).then((function(){})))},t.Vc=function(t,e){return ml(this,Zc(this,t,e,_(this.Za,this)))},t.Uc=function(t,e){var n=this;return ml(this,xe().then((function(){var r=e||ur(),i=Ao(t,r);if(!(r=Ro(r)))throw new T("argument-error","Invalid email link!");if(r.tenantId!==n.S())throw new T("tenant-id-mismatch");return n.Za(i)})))},_l.prototype.render=function(){},_l.prototype.reset=function(){},_l.prototype.getResponse=function(){},_l.prototype.execute=function(){};var wl=null;function El(t,e){return(e=Il(e))&&t.a[e]||null}function Il(t){return(t=void 0===t?1e12:t)?t.toString():null}function Tl(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.i="invisible"!==this.c.size,this.f=ue(t);var n=this;this.h=function(){n.execute()},this.i?this.execute():an(this.f,"click",this.h)}function Cl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Sl(){}function xl(){}bl.prototype.render=function(t,e){return this.a[this.b.toString()]=new Tl(t,e),this.b++},bl.prototype.reset=function(t){var e=El(this,t);t=Il(t),e&&t&&(e.delete(),delete this.a[t])},bl.prototype.getResponse=function(t){return(t=El(this,t))?t.getResponse():null},bl.prototype.execute=function(t){(t=El(this,t))&&t.execute()},Tl.prototype.getResponse=function(){return Cl(this),this.b},Tl.prototype.execute=function(){Cl(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.i&&t.execute()}),6e4)}),500))},Tl.prototype.delete=function(){Cl(this),this.g=!0,clearTimeout(this.a),this.a=null,hn(this.f,"click",this.h)},Xr(Sl,"FACTOR_ID","phone"),xl.prototype.g=function(){return wl||(wl=new bl),xe(wl)},xl.prototype.c=function(){};var Ol=null;function Pl(){this.b=s.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Al=new yt(wt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Rl=new Vr(3e4,6e4);Pl.prototype.g=function(t){var e=this;return new be((function(n,r){var i=setTimeout((function(){r(new T("network-request-failed"))}),Rl.get());!s.grecaptcha||t!==e.f&&!e.b?(s[e.a]=function(){if(s.grecaptcha){e.f=t;var o=s.grecaptcha.render;s.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(s.grecaptcha)}else clearTimeout(i),r(new T("internal-error"));delete s[e.a]},xe(Bs(Ct(Al,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new T("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(s.grecaptcha))}))},Pl.prototype.c=function(){this.b--};var kl=null;function Nl(t,e,n,r,i,o,a){if(Xr(this,"type","recaptcha"),this.c=this.f=null,this.A=!1,this.m=e,this.g=null,a?(Ol||(Ol=new xl),a=Ol):(kl||(kl=new Pl),a=kl),this.v=a,this.a=n||{theme:"light",type:"image"},this.i=[],this.a[Ml])throw new T("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.h="invisible"===this.a[Fl],!s.document)throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ue(e)||!this.h&&ue(e).hasChildNodes())throw new T("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Ys(t,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[Dl];this.a[Dl]=function(t){if(jl(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Or(c,s);"function"==typeof e&&e(t)}};var h=this.a[Ll];this.a[Ll]=function(){if(jl(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=Or(h,s);"function"==typeof t&&t()}}}var Dl="callback",Ll="expired-callback",Ml="sitekey",Fl="size";function jl(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Ul(t,e){return t.i.push(e),e.na((function(){H(t.i,e)})),e}function Vl(t){if(t.A)throw new T("internal-error","RecaptchaVerifier instance has been destroyed.")}function ql(t,e,n){var r=!1;try{this.b=n||sf.app()}catch(t){throw new T("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new T("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ga()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=sf.SDK_VERSION?Sr(sf.SDK_VERSION,o):null,Nl.call(this,n,t,e,(function(){try{var t=i.b.auth().ka()}catch(e){t=null}return t}),o,A(S),r)}function Bl(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<e.length;s++)if(e[s].optional)o=!0;else{if(o)throw new T("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].K(n[i])&&!o){if(e=e[i],0>i||i>=zl.length)throw new T("internal-error","Argument validator received an unsupported number of arguments.");n=zl[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.J+".";break t}r=null}}if(r)throw new T("argument-error",t+" failed: "+r)}(t=Nl.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Ul(this,xe().then((function(){if(Rr()&&!_r())return gr();throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.v.g(t.u())})).then((function(e){return t.g=e,nu(t.s,Ua,{})})).then((function(e){t.a[Ml]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){Vl(this);var t=this;return Ul(this,this.Ia().then((function(){if(null===t.c){var e=t.m;if(!t.h){var n=ue(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!ae&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',Bt(s.name),'"'),s.type){o.push(' type="',Bt(s.type),'"');var a={};vt(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=de(i,o),s&&("string"==typeof s?o.className=s:Array.isArray(s)?o.className=s.join(" "):ce(o,s)),2<r.length&&pe(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Vl(this);var t=this;return Ul(this,this.render().then((function(e){return new be((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){X(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.h&&t.g.execute(t.c)}}))})))},t.reset=function(){Vl(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Vl(this),this.A=!0,this.v.c();for(var t=0;t<this.i.length;t++)this.i[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.h){t=ue(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},E(ql,Nl);var zl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Wl(t,e){return{name:t||"",J:"a valid string",optional:!!e,K:function(t){return"string"==typeof t}}}function Kl(t,e){return{name:t||"",J:"a boolean",optional:!!e,K:function(t){return"boolean"==typeof t}}}function Gl(t,e){return{name:t||"",J:"a valid object",optional:!!e,K:d}}function Hl(t,e){return{name:t||"",J:"a function",optional:!!e,K:function(t){return"function"==typeof t}}}function Xl(t,e){return{name:t||"",J:"null",optional:!!e,K:function(t){return null===t}}}function Yl(t){return{name:t?t+"Credential":"credential",J:t?"a valid "+t+" credential":"a valid credential",optional:!1,K:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ja||!n)}}}function Ql(t,e){return d(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Jl(t){return d(t)&&"string"==typeof t.uid}function Zl(t,e,n,r){return{name:n||"",J:t.J+" or "+e.J,optional:!!r,K:function(n){return t.K(n)||e.K(n)}}}function $l(t,e){for(var n in e){var r=e[n].name;t[r]=nf(r,t[n],e[n].j)}}function tf(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:b((function(t){return this[t]}),n),set:b((function(t,e,n,r){Bl(t,[n],[r],!0),this[e]=r}),r,n,e[n].jb),enumerable:!0})}}function ef(t,e,n,r){t[e]=nf(e,n,r)}function nf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Bl(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}$l(ol.prototype,{ib:{name:"applyActionCode",j:[Wl("code")]},Qa:{name:"checkActionCode",j:[Wl("code")]},mb:{name:"confirmPasswordReset",j:[Wl("code"),Wl("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Wl("email"),Wl("password")]},gc:{name:"fetchSignInMethodsForEmail",j:[Wl("email")]},qa:{name:"getRedirectResult",j:[]},Ac:{name:"isSignInWithEmailLink",j:[Wl("emailLink")]},Gc:{name:"onAuthStateChanged",j:[Zl(Gl(),Hl(),"nextOrObserver"),Hl("opt_error",!0),Hl("opt_completed",!0)]},Hc:{name:"onIdTokenChanged",j:[Zl(Gl(),Hl(),"nextOrObserver"),Hl("opt_error",!0),Hl("opt_completed",!0)]},ub:{name:"sendPasswordResetEmail",j:[Wl("email"),Zl(Gl("opt_actionCodeSettings",!0),Xl(null,!0),"opt_actionCodeSettings",!0)]},vb:{name:"sendSignInLinkToEmail",j:[Wl("email"),Gl("actionCodeSettings")]},wb:{name:"setPersistence",j:[Wl("persistence")]},Rc:{name:"signInAndRetrieveDataWithCredential",j:[Yl()]},yb:{name:"signInAnonymously",j:[]},Za:{name:"signInWithCredential",j:[Yl()]},Sc:{name:"signInWithCustomToken",j:[Wl("token")]},Tc:{name:"signInWithEmailAndPassword",j:[Wl("email"),Wl("password")]},Uc:{name:"signInWithEmailLink",j:[Wl("email"),Wl("emailLink",!0)]},Vc:{name:"signInWithPhoneNumber",j:[Wl("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Wc:{name:"signInWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Xc:{name:"signInWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},cd:{name:"updateCurrentUser",j:[Zl({name:"user",J:"an instance of Firebase User",optional:!1,K:function(t){return!!(t&&t instanceof _h)}},Xl(),"user")]},zb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Wl(null,!0)]},ed:{name:"useDeviceLanguage",j:[]},fd:{name:"useEmulator",j:[Wl("url"),Gl("options",!0)]},hd:{name:"verifyPasswordResetCode",j:[Wl("code")]}}),tf(ol.prototype,{lc:{name:"languageCode",jb:Zl(Wl(),Xl(),"languageCode")},ti:{name:"tenantId",jb:Zl(Wl(),Xl(),"tenantId")}}),ol.Persistence=Zu,ol.Persistence.LOCAL="local",ol.Persistence.SESSION="session",ol.Persistence.NONE="none",$l(_h.prototype,{delete:{name:"delete",j:[]},nc:{name:"getIdTokenResult",j:[Kl("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Kl("opt_forceRefresh",!0)]},Bc:{name:"linkAndRetrieveDataWithCredential",j:[Yl()]},pb:{name:"linkWithCredential",j:[Yl()]},Cc:{name:"linkWithPhoneNumber",j:[Wl("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Dc:{name:"linkWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ec:{name:"linkWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Kc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Yl()]},sb:{name:"reauthenticateWithCredential",j:[Yl()]},Lc:{name:"reauthenticateWithPhoneNumber",j:[Wl("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Mc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Nc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},tb:{name:"sendEmailVerification",j:[Zl(Gl("opt_actionCodeSettings",!0),Xl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Wl(null,!0)]},bd:{name:"unlink",j:[Wl("provider")]},Ab:{name:"updateEmail",j:[Wl("email")]},Bb:{name:"updatePassword",j:[Wl("password")]},dd:{name:"updatePhoneNumber",j:[Yl("phone")]},Cb:{name:"updateProfile",j:[Gl("profile")]},Db:{name:"verifyBeforeUpdateEmail",j:[Wl("email"),Zl(Gl("opt_actionCodeSettings",!0),Xl(null,!0),"opt_actionCodeSettings",!0)]}}),$l(bl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),$l(_l.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),$l(be.prototype,{na:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),tf(Qc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",jb:Kl("appVerificationDisabledForTesting")}}),$l(Jc.prototype,{confirm:{name:"confirm",j:[Wl("verificationCode")]}}),ef(ao,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[vo,Oo,No,lo],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Zl(Wl(),Gl(),"json")]),ef(Po,"credential",(function(t,e){return new xo(t,e)}),[Wl("email"),Wl("password")]),$l(xo.prototype,{w:{name:"toJSON",j:[Wl(null,!0)]}}),$l(_o.prototype,{Ca:{name:"addScope",j:[Wl("scope")]},Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),ef(_o,"credential",bo,[Zl(Wl(),Gl(),"token")]),ef(Po,"credentialWithLink",Ao,[Wl("email"),Wl("emailLink")]),$l(wo.prototype,{Ca:{name:"addScope",j:[Wl("scope")]},Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),ef(wo,"credential",Eo,[Zl(Wl(),Gl(),"token")]),$l(Io.prototype,{Ca:{name:"addScope",j:[Wl("scope")]},Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),ef(Io,"credential",To,[Zl(Wl(),Zl(Gl(),Xl()),"idToken"),Zl(Wl(),Xl(),"accessToken",!0)]),$l(Co.prototype,{Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),ef(Co,"credential",So,[Zl(Wl(),Gl(),"token"),Wl("secret",!0)]),$l(mo.prototype,{Ca:{name:"addScope",j:[Wl("scope")]},credential:{name:"credential",j:[Zl(Wl(),Zl(Gl(),Xl()),"optionsOrIdToken"),Zl(Wl(),Xl(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Gl("customOAuthParameters")]}}),$l(fo.prototype,{w:{name:"toJSON",j:[Wl(null,!0)]}}),$l(co.prototype,{w:{name:"toJSON",j:[Wl(null,!0)]}}),ef(Lo,"credential",Mo,[Wl("verificationId"),Wl("verificationCode")]),$l(Lo.prototype,{eb:{name:"verifyPhoneNumber",j:[Zl(Wl(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(t){return!!t&&(t.session&&t.phoneNumber?Ql(t.session,oo)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Ql(t.session,so)&&Jl(t.multiFactorHint):t.session&&t.multiFactorUid?Ql(t.session,so)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),$l(ko.prototype,{w:{name:"toJSON",j:[Wl(null,!0)]}}),$l(T.prototype,{toJSON:{name:"toJSON",j:[Wl(null,!0)]}}),$l(Ko.prototype,{toJSON:{name:"toJSON",j:[Wl(null,!0)]}}),$l(Wo.prototype,{toJSON:{name:"toJSON",j:[Wl(null,!0)]}}),$l(rh.prototype,{toJSON:{name:"toJSON",j:[Wl(null,!0)]}}),$l(th.prototype,{Qc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}}]}}),$l(ch.prototype,{Qb:{name:"getSession",j:[]},ec:{name:"enroll",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}},Wl("displayName",!0)]},ad:{name:"unenroll",j:[Zl({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Jl},Wl(),"multiFactorInfoIdentifier")]}}),$l(ql.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),ef(_i,"parseLink",xi,[Wl("link")]),ef(Sl,"assertion",(function(t){return new ah(t)}),[Yl("phone")]),function(){if(void 0===sf||!sf.INTERNAL||!sf.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ai,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:si,VERIFY_AND_CHANGE_EMAIL:ui,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:ol,AuthCredential:ao,Error:T};ef(t,"EmailAuthProvider",Po,[]),ef(t,"FacebookAuthProvider",_o,[]),ef(t,"GithubAuthProvider",wo,[]),ef(t,"GoogleAuthProvider",Io,[]),ef(t,"TwitterAuthProvider",Co,[]),ef(t,"OAuthProvider",mo,[Wl("providerId")]),ef(t,"SAMLAuthProvider",yo,[Wl("providerId")]),ef(t,"PhoneAuthProvider",Lo,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(t){return!!(t&&t instanceof ol)}}]),ef(t,"RecaptchaVerifier",ql,[Zl(Wl(),{name:"",J:"an HTML element",optional:!1,K:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Gl("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(t){return!!(t&&t instanceof sf.app.App)}}]),ef(t,"ActionCodeURL",_i,[]),ef(t,"PhoneMultiFactorGenerator",Sl,[]),sf.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new ol(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),sf.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:_((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:_(t.mc,t),addAuthTokenListener:_(t.cc,t),removeAuthTokenListener:_(t.Oc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),sf.registerVersion("@firebase/auth","0.16.1"),sf.INTERNAL.extendNamespace({User:_h})}()}.apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var af=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),vl(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:dl(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),uf=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return yl(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),cf=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new af(e)}}catch(t){}return new uf},hf=cf("localStorage"),lf=cf("sessionStorage"),ff=new Wl("@firebase/database"),pf=function(){var t=1;return function(){return t++}}(),df=function(t){var e=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,Hh(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),n=new wl;n.update(e);var r=n.digest();return Qh.encodeByteArray(r)},vf=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=vf.apply(null,i):n+="object"==typeof i?vl(i):i,n+=" "}return n},gf=null,yf=!0,mf=function(t,e){Hh(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(ff.logLevel=Fl.VERBOSE,gf=ff.log.bind(ff),e&&lf.set("logging_enabled",!0)):"function"==typeof t?gf=t:(gf=null,lf.remove("logging_enabled"))},_f=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===yf&&(yf=!1,null===gf&&!0===lf.get("logging_enabled")&&mf(!0)),gf){var n=vf.apply(null,t);gf(n)}},bf=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];_f.apply(void 0,zh([t],e))}},wf=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+vf.apply(void 0,zh(t));ff.error(n)},Ef=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+vf.apply(void 0,zh(t));throw ff.error(n),new Error(n)},If=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+vf.apply(void 0,zh(t));ff.warn(n)},Tf=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Cf="[MIN_NAME]",Sf="[MAX_NAME]",xf=function(t,e){if(t===e)return 0;if(t===Cf||e===Sf)return-1;if(e===Cf||t===Sf)return 1;var n=Lf(t),r=Lf(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},Of=function(t,e){return t===e?0:t<e?-1:1},Pf=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+vl(e))},Af=function(t){if("object"!=typeof t||null===t)return vl(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=vl(e[i]),r+=":",r+=Af(t[e[i]]);return r+="}"},Rf=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kf(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var Nf=function(t){Hh(!Tf(t),"Invalid JSON number");var e,n,r,i,o,s=1023;0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),s))+s,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var a=[];for(o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse();var u=a.join(""),c="";for(o=0;o<64;o+=8){var h=parseInt(u.substr(o,8),2).toString(16);1===h.length&&(h="0"+h),c+=h}return c.toLowerCase()},Df=new RegExp("^-?(0*)\\d{1,10}$"),Lf=function(t){if(Df.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},Mf=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw If("Exception was thrown by user callback.",e),t}),Math.floor(0))}},Ff=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},jf=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!1,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=xf(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),Uf=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Pl(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=Pl(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=Pl(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),Vf=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,qf="websocket",Bf="long_polling",zf=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=hf.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&hf.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(Hh("string"==typeof t,"typeof type must == string"),Hh("object"==typeof e,"typeof params must == object"),t===qf)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==Bf)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return kf(e,(function(t,e){r.push(t+"="+e)})),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();var Wf,Kf,Gf,Hf,Xf,Yf=function(t,e){var n=Qf(t),r=n.namespace;"firebase.com"===n.domain&&Ef(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Ef("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&If("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new zf(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new jf(n.pathString)}},Qf=function(t){var e="",n="",r="",i="",o="",s=!0,a="https",u=443;if("string"==typeof t){var c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));var h=t.indexOf("/");-1===h&&(h=t.length);var l=t.indexOf("?");-1===l&&(l=t.length),e=t.substring(0,Math.min(h,l)),h<l&&(i=
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(h,l)));var f=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=qh(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var a=s.split("=");2===a.length?r[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):If("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,l)));(c=e.indexOf(":"))>=0?(s="https"===a||"wss"===a,u=parseInt(e.substring(c+1),10)):c=e.length;var p=e.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var d=e.indexOf(".");r=e.substring(0,d).toLowerCase(),n=e.substring(d+1),o=r}"ns"in f&&(o=f.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}},Jf=/[\[\].#$\/\u0000-\u001F\u007F]/,Zf=/[\[\].#$\u0000-\u001F\u007F]/,$f=10485760,tp=function(t){return"string"==typeof t&&0!==t.length&&!Jf.test(t)},ep=function(t){return"string"==typeof t&&0!==t.length&&!Zf.test(t)},np=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!Tf(t)||t&&"object"==typeof t&&yl(t,".sv")},rp=function(t,e,n,r,i){i&&void 0===n||ip(Sl(t,e,i),n,r)},ip=function(t,e,n){var r=n instanceof jf?new Uf(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(Tf(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>$f/3&&Pl(e)>$f)throw new Error(t+"contains a string greater than "+"10485760 utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(kf(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!tp(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),ip(t,n,r),r.pop()})),i&&o)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},op=function(t,e,n,r,i){if(!i||void 0!==n){var o=Sl(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var s=[];kf(n,(function(t,e){var n=new jf(t);if(ip(o,e,r.child(n)),".priority"===n.getBack()&&!np(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(n)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!tp(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(jf.comparePaths);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&s.contains(r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(o,s)}},sp=function(t,e,n,r){if(!r||void 0!==n){if(Tf(n))throw new Error(Sl(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!np(n))throw new Error(Sl(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ap=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Sl(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},up=function(t,e,n,r){if(!(r&&void 0===n||tp(n)))throw new Error(Sl(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},cp=function(t,e,n,r){if(!(r&&void 0===n||ep(n)))throw new Error(Sl(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},hp=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),cp(t,e,n,r)},lp=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},fp=function(t,e,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!tp(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ep(t)}(r))throw new Error(Sl(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},pp=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Sl(t,e,r)+"must be a boolean.")},dp=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){Cl("OnDisconnect.cancel",0,1,arguments.length),xl("OnDisconnect.cancel",1,t,!0);var e=new tl;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){Cl("OnDisconnect.remove",0,1,arguments.length),lp("OnDisconnect.remove",this.path_),xl("OnDisconnect.remove",1,t,!0);var e=new tl;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){Cl("OnDisconnect.set",1,2,arguments.length),lp("OnDisconnect.set",this.path_),rp("OnDisconnect.set",1,t,this.path_,!1),xl("OnDisconnect.set",2,e,!0);var n=new tl;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){Cl("OnDisconnect.setWithPriority",2,3,arguments.length),lp("OnDisconnect.setWithPriority",this.path_),rp("OnDisconnect.setWithPriority",1,t,this.path_,!1),sp("OnDisconnect.setWithPriority",2,e,!1),xl("OnDisconnect.setWithPriority",3,n,!0);var r=new tl;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(Cl("OnDisconnect.update",1,2,arguments.length),lp("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,If("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}op("OnDisconnect.update",1,t,this.path_,!1),xl("OnDisconnect.update",2,e,!0);var i=new tl;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),vp=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return Cl("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),gp=(Wf="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Kf=0,Gf=[],function(t){var e,n=t===Kf;Kf=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=Wf.charAt(t%64),t=Math.floor(t/64);Hh(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===Gf[e];e--)Gf[e]=0;Gf[e]++}else for(e=0;e<12;e++)Gf[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=Wf.charAt(Gf[e]);return Hh(20===i.length,"nextPushId: Length should be 20."),i}),yp=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),mp=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new yp(Cf,t),r=new yp(Cf,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return yp.MIN},t}(),_p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Hf},set:function(t){Hf=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return xf(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw Xh("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return yp.MIN},e.prototype.maxPost=function(){return new yp(Sf,Hf)},e.prototype.makePost=function(t,e){return Hh("string"==typeof t,"KeyIndex indexValue must always be a string."),new yp(t,Hf)},e.prototype.toString=function(){return".key"},e}(mp),bp=new _p;var wp,Ep,Ip,Tp=function(t){return"number"==typeof t?"number:"+Nf(t):"string:"+t},Cp=function(t){if(t.isLeafNode()){var e=t.val();Hh("string"==typeof e||"number"==typeof e||"object"==typeof e&&yl(e,".sv"),"Priority must be a string or number.")}else Hh(t===Xf||t.isEmpty(),"priority of unexpected type.");Hh(t===Xf||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Sp=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Hh(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Cp(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return wp},set:function(t){wp=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(Hh(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Tp(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?Nf(this.value_):this.value_,this.lazyHash_=df(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(Hh(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return Hh(i>=0,"Unknown leaf type: "+n),Hh(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();var xp,Op,Pp=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?xf(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return yp.MIN},e.prototype.maxPost=function(){return new yp(Sf,new Sp("[PRIORITY-POST]",Ip))},e.prototype.makePost=function(t,e){var n=Ep(t);return new yp(e,new Sp("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(mp)),Ap=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Rp=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Np.EMPTY_NODE,this.right=null!=o?o:Np.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Np.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Np.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),kp=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Rp(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Np=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Rp.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Rp.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Ap(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Ap(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Ap(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Ap(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new kp,t}(),Dp=Math.log(2),Lp=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Dp,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Mp=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,s,a=r-e;if(0===a)return null;if(1===a)return o=t[e],s=n?n(o):o,new Rp(s,o.node,Rp.BLACK,null,null);var u=parseInt(a/2,10)+e,c=i(e,u),h=i(u+1,r);return o=t[u],s=n?n(o):o,new Rp(s,o.node,Rp.BLACK,c,h)},o=function(e){for(var r=null,o=null,s=t.length,a=function(e,r){var o=s-e,a=s;s-=e;var c=i(o+1,a),h=t[o],l=n?n(h):h;u(new Rp(l,h.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var h=e.nextBitIsOne(),l=Math.pow(2,e.count-(c+1));h?a(l,Rp.BLACK):(a(l,Rp.BLACK),a(l,Rp.RED))}return o}(new Lp(t.length));return new Np(r||e,o)},Fp={},jp=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return Hh(Fp&&Pp,"ChildrenNode.ts has not been loaded"),xp=xp||new t({".priority":Fp},{".priority":Pp})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=ml(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Np?e:null},t.prototype.hasIndex=function(t){return yl(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){Hh(e!==bp,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,s=n.getIterator(yp.Wrap),a=s.getNext();a;)o=o||e.isDefinedOn(a.node),i.push(a),a=s.getNext();r=o?Mp(i,e.getCompare()):Fp;var u=e.toString(),c=jh({},this.indexSet_);c[u]=e;var h=jh({},this.indexes_);return h[u]=r,new t(h,c)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(bl(this.indexes_,(function(t,i){var o=ml(r.indexSet_,i);if(Hh(o,"Missing index implementation for "+i),t===Fp){if(o.isDefinedOn(e.node)){for(var s=[],a=n.getIterator(yp.Wrap),u=a.getNext();u;)u.name!==e.name&&s.push(u),u=a.getNext();return s.push(e),Mp(s,o.getCompare())}return Fp}var c=n.get(e.name),h=t;return c&&(h=h.remove(new yp(e.name,c))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(bl(this.indexes_,(function(t){if(t===Fp)return t;var r=n.get(e.name);return r?t.remove(new yp(e.name,r)):t})),this.indexSet_)},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Up(t,e){return xf(t.name,e.name)}function Vp(t,e){return xf(t,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var qp=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Cp(this.priorityNode_),this.children_.isEmpty()&&Hh(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Op||(Op=new t(new Np(Vp),null,jp.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Op},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Op:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(Hh(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new yp(e,n),i=void 0,o=void 0;n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?Op:this.priorityNode_;return new t(i,s,o)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;Hh(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Pp,(function(s,a){n[s]=a.val(e),r++,o&&t.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1})),!e&&o&&i<2*r){var s=[];for(var a in n)s[a]=n[a];return s}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Tp(this.getPriority().val())+":"),this.forEachChild(Pp,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":df(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new yp(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new yp(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new yp(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,yp.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,yp.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Bp?-1:0},t.prototype.withIndex=function(e){if(e===bp||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===bp||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Pp),r=e.getIterator(Pp),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===bp?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Bp=new(function(t){function e(){return t.call(this,new Np(Vp),qp.EMPTY_NODE,jp.Default)||this}return Fh(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return qp.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(qp));Object.defineProperties(yp,{MIN:{value:new yp(Cf,qp.EMPTY_NODE)},MAX:{value:new yp(Sf,Bp)}}),_p.__EMPTY_NODE=qp.EMPTY_NODE,Sp.__childrenNodeConstructor=qp,Xf=Bp,function(t){Ip=t}(Bp);function zp(t,e){if(void 0===e&&(e=null),null===t)return qp.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),Hh(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Sp(t,zp(e));if(t instanceof Array){var n=qp.EMPTY_NODE;return kf(t,(function(e,r){if(yl(t,e)&&"."!==e.substring(0,1)){var i=zp(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(zp(e))}var r=[],i=!1;if(kf(t,(function(t,e){if("."!==t.substring(0,1)){var n=zp(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new yp(t,n)))}})),0===r.length)return qp.EMPTY_NODE;var o=Mp(r,Up,(function(t){return t.name}),Vp);if(i){var s=Mp(r,Pp.getCompare());return new qp(o,zp(e),new jp({".priority":s},{".priority":Pp}))}return new qp(o,zp(e),jp.Default)}!function(t){Ep=t}(zp);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Wp,Kp=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?xf(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return yp.MIN},e.prototype.maxPost=function(){return yp.MAX},e.prototype.makePost=function(t,e){var n=zp(t);return new yp(e,n)},e.prototype.toString=function(){return".value"},e}(mp)),Gp=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,Hh(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return Fh(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?xf(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=zp(t),r=qp.EMPTY_NODE.updateChild(this.indexPath_,n);return new yp(e,r)},e.prototype.maxPost=function(){var t=qp.EMPTY_NODE.updateChild(this.indexPath_,Bp);return new yp(Sf,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(mp),Hp=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return Cl("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return Cl("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return Cl("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return Cl("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){Cl("DataSnapshot.child",0,1,arguments.length),e=String(e),cp("DataSnapshot.child",1,e,!1);var n=new jf(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,Pp)},t.prototype.hasChild=function(t){Cl("DataSnapshot.hasChild",1,1,arguments.length),cp("DataSnapshot.hasChild",1,t,!1);var e=new jf(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return Cl("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(Cl("DataSnapshot.forEach",1,1,arguments.length),xl("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,(function(r,i){return e(new t(i,n.ref_.child(r),Pp))}))},t.prototype.hasChildren=function(){return Cl("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return Cl("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return Cl("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Xp=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+vl(this.snapshot.exportVal())},t}(),Yp=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Qp=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Xp("value",this,new Hp(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Hh(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Yp(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Jp=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,yl(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new Yp(this,t,e):null},t.prototype.createEvent=function(t,e){Hh(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Xp(t.type,this,new Hp(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Hh(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var s=r[0],a=i[0];return!(a!==s||e.callbacks_[s]&&this.callbacks_[a]&&e.callbacks_[s]!==this.callbacks_[a])}return i.every((function(t){return e.callbacks_[t]===n.callbacks_[t]}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),Zp=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Hh(Wp,"Reference.ts has not been loaded"),Wp},set:function(t){Wp=t},enumerable:!1,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===bp){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Cf)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Sf)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===Pp){if(null!=e&&!np(e)||null!=n&&!np(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Hh(t.getIndex()instanceof Gp||t.getIndex()===Kp,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return Cl("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){Cl("Query.on",2,4,arguments.length),ap("Query.on",1,e,!1),xl("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var s={};s[e]=n,this.onChildEvent(s,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new Qp(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new Jp(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){Cl("Query.off",0,3,arguments.length),ap("Query.off",1,t,!0),xl("Query.off",2,e,!0),Ol("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var o=e||null;r=new Qp(o,null,n||null)}else t&&(e&&((i={})[t]=e),r=new Jp(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.get=function(){return this.repo.getValue(this)},t.prototype.once=function(e,n,r,i){var o=this;Cl("Query.once",1,4,arguments.length),ap("Query.once",1,e,!1),xl("Query.once",2,n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),a=!0,u=new tl;u.promise.catch((function(){}));var c=function(t){a&&(a=!1,o.off(e,c),n&&n.bind(s.context)(t),u.resolve(t))};return this.on(e,c,(function(t){o.off(e,c),s.cancel&&s.cancel.bind(s.context)(t),u.reject(t)})),u.promise},t.prototype.limitToFirst=function(e){if(Cl("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(Cl("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(Cl("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');cp("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new jf(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Gp(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){Cl("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(bp);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){Cl("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(Pp);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){Cl("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Kp);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),Cl("Query.startAt",0,2,arguments.length),rp("Query.startAt",1,e,this.path,!0),up("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),Cl("Query.endAt",0,2,arguments.length),rp("Query.endAt",1,e,this.path,!0),up("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(Cl("Query.equalTo",1,2,arguments.length),rp("Query.equalTo",1,t,this.path,!1),up("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return Cl("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return Cl("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=Af(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(Cl("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===e.repo,i=this.path.equals(e.path),o=this.queryIdentifier()===e.queryIdentifier();return r&&i&&o},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,xl(t,3,r.cancel,!0),r.context=n,Ol(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(Sl(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),$p=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),td=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=this.path_.child(e);return new t(this.syncTree_,n)},t.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},t}(),ed=function(t,e,n){return t&&"object"==typeof t?(Hh(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?nd(t[".sv"],e,n):"object"==typeof t[".sv"]?rd(t[".sv"],e):void Hh(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},nd=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Hh(!1,"Unexpected server value: "+t)}},rd=function(t,e,n){t.hasOwnProperty("increment")||Hh(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&Hh(!1,"Unexpected increment value: "+r);var i=e.node();if(Hh(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var o=i.getValue();return"number"!=typeof o?r:o+r},id=function(t,e,n,r){return sd(e,new td(n,t),r)},od=function(t,e,n){return sd(t,new $p(e),n)};function sd(t,e,n){var r,i=t.getPriority().val(),o=ed(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var s=t,a=ed(s.getValue(),e,n);return a!==s.getValue()||o!==s.getPriority().val()?new Sp(a,zp(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Sp(o))),u.forEachChild(Pp,(function(t,i){var o=sd(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ad,ud=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&this.children.size>0){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(Pp,(function(t,e){n.remember(new jf(t),e)})),this.forget(t)}if(this.children.size>0){var r=t.getFront();if(t=t.popFront(),this.children.has(r))this.children.get(r).forget(t)&&this.children.delete(r);return 0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild((function(n,r){var i=new jf(t.toString()+"/"+n);r.forEachTree(i,e)}))},t.prototype.forEachChild=function(t){this.children.forEach((function(e,n){t(n,e)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(ad||(ad={}));var cd,hd,ld=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,Hh(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),fd=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=ad.ACK_USER_WRITE,this.source=ld.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return Hh(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new jf(e));return new t(jf.Empty,n,this.revert)}return Hh(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),pd=function(){function t(t,e){void 0===e&&(cd||(cd=new Np(Of)),e=cd),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return kf(e,(function(t,e){n=n.set(new jf(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:jf.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new jf(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r=e.getFront(),i=(this.children.get(r)||t.Empty).setTree(e.popFront(),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(jf.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(t.child(r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,jf.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,jf.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(jf.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(t.child(n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t.Empty=new t(null),t}(),dd=function(){function t(t,e){this.source=t,this.path=e,this.type=ad.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,jf.Empty):new t(this.source,this.path.popFront())},t}(),vd=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=ad.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,jf.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),gd=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=ad.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new jf(e));return n.isEmpty()?null:n.value?new vd(this.source,jf.Empty,n.value):new t(this.source,jf.Empty,n)}return Hh(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),yd=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),md=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new yd(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new yd(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new yd(qp.EMPTY_NODE,!1,!1),new yd(qp.EMPTY_NODE,!1,!1)),t}(),_d=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),bd=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){Hh(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(_d.childRemovedChange(e,s)):Hh(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(_d.childAddedChange(e,n)):o.trackChildChange(_d.childChangedChange(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Pp,(function(t,r){e.hasChild(t)||n.trackChildChange(_d.childRemovedChange(t,r))})),e.isLeafNode()||e.forEachChild(Pp,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(_d.childChangedChange(e,r,i))}else n.trackChildChange(_d.childAddedChange(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?qp.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),wd=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;Hh(e===_d.CHILD_ADDED||e===_d.CHILD_CHANGED||e===_d.CHILD_REMOVED,"Only child changes supported for tracking"),Hh(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e===_d.CHILD_ADDED&&i===_d.CHILD_REMOVED)this.changeMap.set(n,_d.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e===_d.CHILD_REMOVED&&i===_d.CHILD_ADDED)this.changeMap.delete(n);else if(e===_d.CHILD_REMOVED&&i===_d.CHILD_CHANGED)this.changeMap.set(n,_d.childRemovedChange(n,r.oldSnap));else if(e===_d.CHILD_CHANGED&&i===_d.CHILD_ADDED)this.changeMap.set(n,_d.childAddedChange(n,t.snapshotNode));else{if(e!==_d.CHILD_CHANGED||i!==_d.CHILD_CHANGED)throw Xh("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,_d.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),Ed=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Id=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new yd(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),Td=function(t,e){this.viewCache=t,this.changes=e},Cd=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){Hh(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),Hh(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var o,s,a=new wd;if(n.type===ad.OVERWRITE){var u=n;u.source.fromUser?o=this.applyUserOverwrite_(e,u.path,u.snap,r,i,a):(Hh(u.source.fromServer,"Unknown source."),s=u.source.tagged||e.getServerCache().isFiltered()&&!u.path.isEmpty(),o=this.applyServerOverwrite_(e,u.path,u.snap,r,i,s,a))}else if(n.type===ad.MERGE){var c=n;c.source.fromUser?o=this.applyUserMerge_(e,c.path,c.children,r,i,a):(Hh(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.getServerCache().isFiltered(),o=this.applyServerMerge_(e,c.path,c.children,r,i,s,a))}else if(n.type===ad.ACK_USER_WRITE){var h=n;o=h.revert?this.revertUserWrite_(e,h.path,r,i,a):this.ackUserWrite_(e,h.path,h.affectedTree,r,i,a)}else{if(n.type!==ad.LISTEN_COMPLETE)throw Xh("Unknown operation type: "+n.type);o=this.listenComplete_(e,n.path,r,a)}var l=a.getChanges();return t.maybeAddValueEvent_(e,o,l),new Td(o,l)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(_d.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var s=void 0,a=void 0;if(e.isEmpty())if(Hh(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var u=t.getCompleteServerSnap(),c=u instanceof qp?u:qp.EMPTY_NODE,h=n.calcCompleteEventChildren(c);s=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var l=n.calcCompleteEventCache(t.getCompleteServerSnap());s=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var f=e.getFront();if(".priority"===f){Hh(1===e.getLength(),"Can't have a priority with additional path components");var p=o.getNode();a=t.getServerCache().getNode();var d=n.calcEventCacheAfterServerOverwrite(e,p,a);s=null!=d?this.filter_.updatePriority(p,d):o.getNode()}else{var v=e.popFront(),g=void 0;if(o.isCompleteForChild(f)){a=t.getServerCache().getNode();var y=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),a);g=null!=y?o.getNode().getImmediateChild(f).updateChild(v,y):o.getNode().getImmediateChild(f)}else g=n.calcCompleteChild(f,t.getServerCache());s=null!=g?this.filter_.updateChild(o.getNode(),f,g,v,r,i):o.getNode()}}return t.updateEventSnap(s,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,s){var a,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())a=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(e,n);a=c.updateFullNode(u.getNode(),h,null)}else{var l=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),p=u.getNode().getImmediateChild(l).updateChild(f,n);a=".priority"===l?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),l,p,f,Ed,null)}var d=t.updateServerSnap(a,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),v=new Id(r,d,i);return this.generateEventCacheAfterServerEvent_(d,e,r,v,s)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var s,a,u=t.getEventCache(),c=new Id(r,t,i);if(e.isEmpty())a=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),s=t.updateEventSnap(a,!0,this.filter_.filtersNodes());else{var h=e.getFront();if(".priority"===h)a=this.filter_.updatePriority(t.getEventCache().getNode(),n),s=t.updateEventSnap(a,u.isFullyInitialized(),u.isFiltered());else{var l=e.popFront(),f=u.getNode().getImmediateChild(h),p=void 0;if(l.isEmpty())p=n;else{var d=c.getCompleteChild(h);p=null!=d?".priority"===l.getBack()&&d.getChild(l.parent()).isEmpty()?d:d.updateChild(l,n):qp.EMPTY_NODE}if(f.equals(p))s=t;else{var v=this.filter_.updateChild(u.getNode(),h,p,l,c,o);s=t.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return s},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,s){var a=this,u=e;return r.foreach((function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())&&(u=a.applyUserOverwrite_(u,h,c,i,o,s))})),r.foreach((function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())||(u=a.applyUserOverwrite_(u,h,c,i,o,s))})),u},t.prototype.applyMerge_=function(t,e){return e.foreach((function(e,n){t=t.updateChild(e,n)})),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,s){var a=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:pd.Empty.setTree(e,n);var h=t.getServerCache().getNode();return u.children.inorderTraversal((function(e,n){if(h.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),l=a.applyMerge_(u,n);c=a.applyServerOverwrite_(c,new jf(e),l,r,i,o,s)}})),u.children.inorderTraversal((function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!h.hasChild(e)&&!u){var l=t.getServerCache().getNode().getImmediateChild(e),f=a.applyMerge_(l,n);c=a.applyServerOverwrite_(c,new jf(e),f,r,i,o,s)}})),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var s=t.getServerCache().isFiltered(),a=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,a.getNode().getChild(e),r,i,s,o);if(e.isEmpty()){var u=pd.Empty;return a.getNode().forEachChild(bp,(function(t,e){u=u.set(new jf(t),e)})),this.applyServerMerge_(t,e,u,r,i,s,o)}return t}var c=pd.Empty;return n.foreach((function(t,n){var r=e.child(t);a.isCompleteForPath(r)&&(c=c.set(t,a.getNode().getChild(r)))})),this.applyServerMerge_(t,e,c,r,i,s,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,Ed,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var s=new Id(n,t,r),a=t.getEventCache().getNode(),u=void 0;if(e.isEmpty()||".priority"===e.getFront()){var c=void 0;if(t.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();Hh(h instanceof qp,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(h)}c=c,u=this.filter_.updateFullNode(a,c,i)}else{var l=e.getFront(),f=n.calcCompleteChild(l,t.getServerCache());null==f&&t.getServerCache().isCompleteForChild(l)&&(f=a.getImmediateChild(l)),(u=null!=f?this.filter_.updateChild(a,l,f,e.popFront(),s,i):t.getEventCache().getNode().hasChild(l)?this.filter_.updateChild(a,l,qp.EMPTY_NODE,e.popFront(),s,i):a).isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(u=this.filter_.updateFullNode(u,o,i))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(jf.Empty),t.updateEventSnap(u,o,this.filter_.filtersNodes())},t}(),Sd=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach((function(t){t.type===_d.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(_d.childMovedChange(t.childName,t.snapshotNode))})),this.generateEventsForType_(i,_d.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,_d.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,_d.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,_d.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,_d.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,s=n.filter((function(t){return t.type===e}));s.sort(this.compareChanges_.bind(this)),s.forEach((function(e){var n=o.materializeSingleChange_(e,i);r.forEach((function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))}))}))},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_)),t},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw Xh("Should only compare child_ events.");var n=new yp(t.childName,t.snapshotNode),r=new yp(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),xd=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new bd(n.getIndex()),i=n.getNodeFilter();this.processor_=new Cd(i);var o=e.getServerCache(),s=e.getEventCache(),a=r.updateFullNode(qp.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(qp.EMPTY_NODE,s.getNode(),null),c=new yd(a,o.isFullyInitialized(),r.filtersNodes()),h=new yd(u,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=new md(h,c),this.eventGenerator_=new Sd(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){Hh(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach((function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)}))}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var s=this.eventRegistrations_[o];if(s.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(s)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===ad.MERGE&&null!==t.source.queryId&&(Hh(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),Hh(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),Hh(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];e.getNode().isLeafNode()||e.getNode().forEachChild(Pp,(function(t,e){n.push(_d.childAddedChange(t,e))}));return e.isFullyInitialized()&&n.push(_d.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),Od=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Hh(hd,"Reference.ts has not been loaded"),hd},set:function(t){Hh(!hd,"__referenceConstructor has already been defined"),hd=t},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,i,o=t.source.queryId;if(null!==o){var s=this.views.get(o);return Hh(null!=s,"SyncTree gave us an op for an invalid query."),s.applyOperation(t,e,n)}var a=[];try{for(var u=qh(this.views.values()),c=u.next();!c.done;c=u.next()){s=c.value;a=a.concat(s.applyOperation(t,e,n))}}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return a},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),s=this.views.get(o);if(!s){var a=n.calcCompleteEventCache(i?r:null),u=!1;a?u=!0:r instanceof qp?(a=n.calcCompleteEventChildren(r),u=!1):(a=qp.EMPTY_NODE,u=!1);var c=new md(new yd(a,u,!1),new yd(r,i,!1));s=new xd(t,c),this.views.set(o,s)}return s.addEventRegistration(e),s.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i,o,s=e.queryIdentifier(),a=[],u=[],c=this.hasCompleteView();if("default"===s)try{for(var h=qh(this.views.entries()),l=h.next();!l.done;l=h.next()){var f=Bh(l.value,2),p=f[0],d=f[1];u=u.concat(d.removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(p),d.getQuery().getQueryParams().loadsAllData()||a.push(d.getQuery()))}}catch(t){i={error:t}}finally{try{l&&!l.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else(d=this.views.get(s))&&(u=u.concat(d.removeEventRegistration(n,r)),d.isEmpty()&&(this.views.delete(s),d.getQuery().getQueryParams().loadsAllData()||a.push(d.getQuery())));return c&&!this.hasCompleteView()&&a.push(new t.__referenceConstructor(e.repo,e.path)),{removed:a,events:u}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=qh(this.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var i=qh(this.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r||s.getCompleteServerCache(t)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=qh(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),Pd=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new pd(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,s=jf.relativePath(i,e);return o=o.updateChild(s,n),new t(this.writeTree_.set(i,o))}var a=new pd(n);return new t(this.writeTree_.setTree(e,a))},t.prototype.addWrites=function(t,e){var n=this;return kf(e,(function(e,r){n=n.addWrite(t.child(e),r)})),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,pd.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(jf.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(Pp,(function(e,n){t.push(new yp(e,n))})):this.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new yp(e,n.value))})),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new pd(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(t){return Ad(jf.Empty,this.writeTree_,t)},t.Empty=new t(new pd(null)),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ad(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?(Hh(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ad(t.child(e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(t.child(".priority"),r)),n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Rd=function(){function t(){this.visibleWrites_=Pd.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new kd(t,this)},t.prototype.addOverwrite=function(t,e,n,r){Hh(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){Hh(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex((function(e){return e.writeId===t}));Hh(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,s=this.allWrites_.length-1;i&&s>=0;){var a=this.allWrites_[s];a.visible&&(s>=n&&this.recordContainsPath_(a,r.path)?i=!1:r.path.contains(a.path)&&(o=!0)),s--}if(i){if(o)return this.resetTree_(),!0;r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):kf(r.children,(function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))}));return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(jf.Empty)){var s=t.layerTree_(this.allWrites_,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))}),e);c=n||qp.EMPTY_NODE;return s.apply(c)}return null}var a=this.visibleWrites_.getCompleteNode(e);if(null!=a)return a;var u=this.visibleWrites_.childCompoundWrite(e);if(u.isEmpty())return n;if(null!=n||u.hasCompleteWrite(jf.Empty)){var c=n||qp.EMPTY_NODE;return u.apply(c)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=qp.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(Pp,(function(t,e){n=n.updateImmediateChild(t,e)})),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(Pp,(function(t,e){var r=i.childCompoundWrite(new jf(t)).apply(e);n=n.updateImmediateChild(t,r)})),i.getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){Hh(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var s,a=this.visibleWrites_.childCompoundWrite(t),u=a.getCompleteNode(jf.Empty);if(null!=u)s=u;else{if(null==e)return[];s=a.apply(e)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var c=[],h=o.getCompare(),l=i?s.getReverseIteratorFrom(n,o):s.getIteratorFrom(n,o),f=l.getNext();f&&c.length<r;)0!==h(f,n)&&c.push(f),f=l.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,jf.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Pd.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var s=o.path,a=void 0;if(o.snap)n.contains(s)?(a=jf.relativePath(n,s),r=r.addWrite(a,o.snap)):s.contains(n)&&(a=jf.relativePath(s,n),r=r.addWrite(jf.Empty,o.snap.getChild(a)));else{if(!o.children)throw Xh("WriteRecord should have .snap or .children");if(n.contains(s))a=jf.relativePath(n,s),r=r.addWrites(a,o.children);else if(s.contains(n))if((a=jf.relativePath(s,n)).isEmpty())r=r.addWrites(jf.Empty,o.children);else{var u=ml(o.children,a.getFront());if(u){var c=u.getChild(a.popFront());r=r.addWrite(jf.Empty,c)}}}}}return r},t}(),kd=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Nd=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=pd.Empty,this.pendingWriteTree_=new Rd,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new vd(ld.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=pd.fromObject(e);return this.applyOperationToSyncPoints_(new gd(ld.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=pd.Empty;return null!=n.snap?r=r.set(jf.Empty,!0):kf(n.children,(function(t,e){r=r.set(new jf(t),e)})),this.applyOperationToSyncPoints_(new fd(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new vd(ld.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=pd.fromObject(e);return this.applyOperationToSyncPoints_(new gd(ld.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new dd(ld.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=jf.relativePath(s,e),c=new vd(ld.forServerTaggedQuery(a),u,n);return this.applyTaggedOperation_(s,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=jf.relativePath(s,e),c=pd.fromObject(n),h=new gd(ld.forServerTaggedQuery(a),u,c);return this.applyTaggedOperation_(s,h)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,s=i.queryId,a=jf.relativePath(o,e),u=new dd(ld.forServerTaggedQuery(s),a);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,(function(t,e){var n=jf.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()}));var s,a=this.syncPointTree_.get(r);(a?(o=o||a.hasCompleteView(),i=i||a.getCompleteServerCache(jf.Empty)):(a=new Od,this.syncPointTree_=this.syncPointTree_.set(r,a)),null!=i)?s=!0:(s=!1,i=qp.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=e.getCompleteServerCache(jf.Empty);n&&(i=i.updateImmediateChild(t,n))})));var u=a.viewExistsForQuery(e);if(!u&&!e.getQueryParams().loadsAllData()){var c=t.makeQueryKey_(e);Hh(!this.queryToTagMap.has(c),"View does not exist, but we have a tag");var h=t.getNextQueryTag_();this.queryToTagMap.set(c,h),this.tagToQueryMap.set(h,c)}var l=this.pendingWriteTree_.childWrites(r),f=a.addEventRegistration(e,n,l,i,s);if(!u&&!o){var p=a.viewForQuery(e);f=f.concat(this.setupListener_(e,p))}return f},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,s=this.syncPointTree_.get(o),a=[];if(s&&("default"===e.queryIdentifier()||s.viewExistsForQuery(e))){var u=s.removeEventRegistration(e,n,r);s.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;a=u.events;var h=-1!==c.findIndex((function(t){return t.getQueryParams().loadsAllData()})),l=this.syncPointTree_.findOnPath(o,(function(t,e){return e.hasCompleteView()}));if(h&&!l){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(f),d=0;d<p.length;++d){var v=p[d],g=v.getQuery(),y=this.createListenerForView_(v);this.listenProvider_.startListening(t.queryForListening_(g),this.tagForQuery_(g),y.hashFn,y.onComplete)}}if(!l&&c.length>0&&!r)if(h){this.listenProvider_.stopListening(t.queryForListening_(e),null)}else c.forEach((function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)}));this.removeTags_(c)}return a},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,(function(e,n){var r=jf.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i}));return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold((function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),kf(n,(function(t,e){r=r.concat(e)})),r}))},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),o=this.createListenerForView_(n),s=this.listenProvider_.startListening(t.queryForListening_(e),i,o.hashFn,o.onComplete),a=this.syncPointTree_.subtree(r);if(i)Hh(!a.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var u=a.fold((function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map((function(t){return t.getQuery()})))),kf(n,(function(t,e){r=r.concat(e)})),r})),c=0;c<u.length;++c){var h=u[c];this.listenProvider_.stopListening(t.queryForListening_(h),this.tagForQuery_(h))}return s},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||qp.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return Hh(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new jf(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);Hh(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(jf.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(jf.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(jf.Empty));var o=[],s=t.path.getFront(),a=t.operationForChild(s),u=e.children.get(s);if(u&&a){var c=n?n.getImmediateChild(s):null,h=r.child(s);o=o.concat(this.applyOperationHelper_(a,u,c,h))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(jf.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(jf.Empty));var s=[];return e.children.inorderTraversal((function(e,o){var a=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(s=s.concat(i.applyOperationDescendantsHelper_(c,o,a,u)))})),o&&(s=s.concat(o.applyOperation(t,r,n))),s},t.nextQueryTag_=1,t}(),Dd=function(){function t(){this.rootNode_=qp.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Ld=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),yl(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return Zh(this.counters_)},t}(),Md=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new Ld),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),Fd=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=jh({},t);return this.last_&&kf(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),jd=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Fd(t);var n=1e4+2e4*Math.random();Ff(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;kf(e,(function(e,i){i>0&&yl(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),Ff(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Ud=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new Vd(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.equals(t)}))},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.contains(t)||t.contains(e)}))},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r)t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),Vd=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();gf&&_f("event: "+e.toString()),Mf(n)}}},t.prototype.getPath=function(){return this.path_},t}(),qd=function(){function t(t){this.allowedEvents_=t,this.listeners_={},Hh(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=zh(this.listeners_[t]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){Hh(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),Bd=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return Fh(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Hh("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(qd),zd=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||nl()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return Fh(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Hh("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(qd),Wd=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&Mf((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},t}(),Kd="start",Gd="close",Hd=function(){function t(t,e,n,r,i){this.connId=t,this.repoInfo=e,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bf(t),this.stats_=Md.getCollection(e),this.urlFn=function(t){return e.connectionURL(Bf,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Wd(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new Xd((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Bh(t,5),i=r[0],o=r[1],s=r[2];r[3],r[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===Kd)n.id=o,n.password=s;else{if(i!==Gd)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Bh(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),"undefined"!=typeof location&&location.hostname&&Vf.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!!t.forceAllow_||!(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=vl(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n,r=(n=Yh(e),Qh.encodeByteArray(n,!0)),i=Rf(r,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},t.prototype.incrementIncomingBytes_=function(t){var e=vl(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Xd=function(){function t(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=pf(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(t){_f("frame writing exception"),t.stack&&_f(t.stack),_f(t)}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||_f("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){_f("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}}),Math.floor(1))},t}(),Yd="";function Qd(t){Yd=t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jd=null;"undefined"!=typeof MozWebSocket?Jd=MozWebSocket:"undefined"!=typeof WebSocket&&(Jd=WebSocket);var Zd=function(){function t(e,n,r,i,o){this.connId=e,this.applicationId=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bf(this.connId),this.stats_=Md.getCollection(n),this.connURL=t.connectionURL_(n,i,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n){var r={v:"5"};return"undefined"!=typeof location&&location.hostname&&Vf.test(location.hostname)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL(qf,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,hf.set("previous_websocket_failure",!0);try{if(sl());else{var r={headers:{"X-Firebase-GMPID":this.applicationId||""}};this.mySock=new Jd(this.connURL,[],r)}}catch(t){this.log_("Error instantiating WebSocket.");var i=t.message||t.data;return i&&this.log_(i),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Jd&&!t.forceDisallow_},t.previouslyFailed=function(){return hf.isInMemoryStorage||!0===hf.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){hf.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=dl(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(Hh(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=vl(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=Rf(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),$d=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Hd,Zd]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=Zd&&Zd.isAvailable(),o=i&&!Zd.previouslyFailed();if(e.webSocketOnly&&(i||If("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Zd];else{var s=this.transports_=[];try{for(var a=qh(t.ALL_TRANSPORTS),u=a.next();!u.done;u=a.next()){var c=u.value;c&&c.isAvailable()&&s.push(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),tv=function(){function t(t,e,n,r,i,o,s,a){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bf("c:"+this.id+":"),this.transportManager_=new $d(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ff((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=Pf("t",t),n=Pf("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=Pf("t",t),n=Pf("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=Pf("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?wf("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):wf("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&If("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Ff((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ff((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(hf.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),ev=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),nv=1e3,rv=function(t){function e(n,r,i,o,s,a,u){var c=t.call(this)||this;if(c.repoInfo_=n,c.applicationId_=r,c.onDataUpdate_=i,c.onConnectStatus_=o,c.onServerInfoUpdate_=s,c.authTokenProvider_=a,c.authOverride_=u,c.id=e.nextPersistentConnectionId_++,c.log_=bf("p:"+c.id+":"),c.interruptReasons_={},c.listens=new Map,c.outstandingPuts_=[],c.outstandingGets_=[],c.outstandingPutCount_=0,c.outstandingGetCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=nv,c.maxReconnectDelay_=3e5,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,u&&!sl())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return c.scheduleConnect_(0),Bd.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&zd.getInstance().on("online",c.onOnline_,c),c}return Fh(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(vl(i)),Hh(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this,n=new tl,r={p:t.path.toString(),q:t.queryObject()},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[o];void 0!==t&&i===t&&(delete e.outstandingGets_[o],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+o+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(o),n.promise},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),Hh(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),Hh(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var s={p:i};t.tag&&(s.q=r.queryObject(),s.t=t.tag),s.h=t.hashFn(),this.sendRequest("q",s,(function(s){var a=s.d,u=s.s;e.warnOnListenWarnings_(a,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",s),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,a))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&yl(t,"w")){var n=ml(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();If("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){var e;(t&&40===t.length||"object"==typeof(e=gl(t).claims)&&!0===e.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t,e=this;if(this.connected_&&this.authToken_){var n=this.authToken_,r=(t=gl(n).claims)&&"object"==typeof t&&t.hasOwnProperty("iat")?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,(function(t){var r=t.s,i=t.d||"error";e.authToken_===n&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),Hh(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+vl(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):wf("Unrecognized action received from server: "+vl(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;Hh(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=nv,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=nv,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=nv),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){var t=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+e.nextConnectionId_++,s=this,a=this.lastSessionId,u=!1,c=null,h=function(){c?c.close():(u=!0,i())};this.realtime_={close:h,sendRequest:function(t){Hh(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)}};var l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(l).then((function(t){u?_f("getToken() completed but was canceled"):(_f("getToken() completed. Creating connection."),s.authToken_=t&&t.accessToken,c=new tv(o,s.repoInfo_,s.applicationId_,n,r,i,(function(t){If(t+" ("+s.repoInfo_.toString()+")"),s.interrupt("server_kill")}),a))})).then(null,(function(e){s.log_("Failed to get token: "+e),u||(t.repoInfo_.nodeAdmin&&If(e),h())}))}},e.prototype.interrupt=function(t){_f("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){_f("Resuming connection for reason: "+t),delete this.interruptReasons_[t],_l(this.interruptReasons_)&&(this.reconnectDelay_=nv,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return Af(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new jf(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){_f("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var i=qh(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,qh(s.values())),u=a.next();!u.done;u=a.next()){var c=u.value;this.sendListen_(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var l=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(l.action,l.pathString,l.data,l.onComplete)}for(h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},e.prototype.sendConnectStats_=function(){var t={};t["sdk.js."+Yd.replace(/\./g,"-")]=1,nl()?t["framework.cordova"]=1:ol()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=zd.getInstance().currentlyOnline();return _l(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(ev),iv=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=bf("p:rest:"),i.listens_={},i}return Fh(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(Hh(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,s=t.path.toString();this.log_("Listen called for "+s+" "+t.queryIdentifier());var a=e.getListenId_(t,r),u={};this.listens_[a]=u;var c=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(s+".json",c,(function(t,e){var n=e;(404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(s,n,!1,r),ml(o.listens_,a)===u)&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=t.getQueryParams().toRestQueryStringParameters(),r=t.path.toString(),i=new tl;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var o=i&&i.accessToken;o&&(e.auth=o);var s=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}(e);r.log_("Sending REST request for "+s);var a=new XMLHttpRequest;a.onreadystatechange=function(){if(n&&4===a.readyState){r.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);var t=null;if(a.status>=200&&a.status<300){try{t=dl(a.responseText)}catch(t){If("Failed to parse JSON response for "+s+": "+a.responseText)}n(null,t)}else 401!==a.status&&404!==a.status&&If("Got unsuccessful REST response for "+s+" Status: "+a.status),n(a.status);n=null}},a.open("GET",s,!0),a.send()}))},e}(ev),ov="repo_interrupt",sv=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.app=n,this.authTokenProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ud,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new ud,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.start=function(){var t=this;if(this.stats_=Md.getCollection(this.repoInfo_),this.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)this.server_=new iv(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var e=this.app.options.databaseAuthVariableOverride;if(null!=e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{vl(e)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new rv(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,e),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),this.statsReporter_=Md.getOrCreateReporter(this.repoInfo_,(function(){return new jd(t.stats_,t.server_)})),this.transactionsInit_(),this.infoData_=new Dd,this.infoSyncTree_=new Nd({startListening:function(e,n,r,i){var o=[],s=t.infoData_.getNode(e.path);return s.isEmpty()||(o=t.infoSyncTree_.applyServerOverwrite(e.path,s),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Nd({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);t.eventQueue_.raiseEventsForChangedPath(e.path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})},t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new jf(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new jf(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var s=bl(e,(function(t){return zp(t)}));o=this.serverSyncTree_.applyTaggedQueryMerge(i,s,r)}else{var a=zp(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,a,r)}else if(n){var u=bl(e,(function(t){return zp(t)}));o=this.serverSyncTree_.applyServerMerge(i,u)}else{var c=zp(e);o=this.serverSyncTree_.applyServerOverwrite(i,c)}var h=i;o.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;kf(t,(function(t,n){e.updateInfo_(t,n)}))},t.prototype.updateInfo_=function(t,e){var n=new jf("/.info/"+t),r=zp(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.getValue=function(t){var e=this;return this.server_.get(t).then((function(n){var r=zp(n),i=e.serverSyncTree_.applyServerOverwrite(t.path,r);return e.eventQueue_.raiseEventsAtPath(t.path,i),Promise.resolve(new Hp(r,t.getRef(),t.getQueryParams().getIndex()))}),(function(n){e.log_("get for query "+vl(t)+" falling back to cache after error: "+n);var r=e.serverSyncTree_.calcCompleteEventCache(t.path);return r.isEmpty()?Promise.reject(new Error(n)):Promise.resolve(new Hp(r,t.getRef(),t.getQueryParams().getIndex()))}))},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),s=zp(e,n),a=this.serverSyncTree_.calcCompleteEventCache(t),u=od(s,a,o),c=this.getNextWriteId_(),h=this.serverSyncTree_.applyUserOverwrite(t,u,c,!0);this.eventQueue_.queueEvents(h),this.server_.put(t.toString(),s.val(!0),(function(e,n){var o="ok"===e;o||If("set at "+t+" failed: "+e);var s=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(t,s),i.callOnCompleteCallback(r,e,n)}));var l=this.abortTransactions_(t);this.rerunTransactions_(l),this.eventQueue_.raiseEventsForChangedPath(l,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),s={};if(kf(e,(function(e,n){i=!1,s[e]=id(t.child(e),zp(n),r.serverSyncTree_,o)})),i)_f("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var a=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,s,a);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,(function(e,i){var o="ok"===e;o||If("update at "+t+" failed: "+e);var s=r.serverSyncTree_.ackUserWrite(a,!o),u=s.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,s),r.callOnCompleteCallback(n,e,i)})),kf(e,(function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=new ud;this.onDisconnect_.forEachTree(jf.Empty,(function(r,i){var o=id(r,i,t.serverSyncTree_,e);n.remember(r,o)}));var r=[];n.forEachTree(jf.Empty,(function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)})),this.onDisconnect_=new ud,this.eventQueue_.raiseEventsForChangedPath(jf.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)}))},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=zp(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),(function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)}))},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=zp(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),(function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)}))},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(_l(e))return _f("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,(function(i,o){"ok"===i&&kf(e,(function(e,n){var i=zp(n);r.onDisconnect_.remember(t.child(e),i)})),r.callOnCompleteCallback(n,i,o)}))},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(ov)},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(ov)},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new Fd(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce((function(t,e){return Math.max(e.length,t)}),0);kf(e,(function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)}))}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),_f.apply(void 0,zh([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&Mf((function(){if("ok"===e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}}))},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new mv(this))},enumerable:!1,configurable:!0}),t}(),av=function(){function t(e){this.indexedFilter_=new bd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new yp(e,n))||(n=qp.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=qp.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(qp.EMPTY_NODE);var i=this;return e.forEachChild(Pp,(function(t,e){i.matches(new yp(t,e))||(r=r.updateImmediateChild(t,qp.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),uv=function(){function t(t){this.rangedFilter_=new av(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new yp(e,n))||(n=qp.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=qp.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=qp.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(qp.EMPTY_NODE);var a=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var l=!1;i.hasNext();){s=i.getNext();!l&&c(a,s)<=0&&(l=!0),l&&o<this.limit_&&c(s,u)<=0?o++:r=r.updateImmediateChild(s.name,qp.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var s=this.index_.getCompare();o=function(t,e){return s(e,t)}}else o=this.index_.getCompare();var a=t;Hh(a.numChildren()===this.limit_,"");var u=new yp(e,n),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(a.hasChild(e)){for(var l=a.getImmediateChild(e),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===e||a.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:o(f,u);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(_d.childChangedChange(e,n,l)),a.updateImmediateChild(e,n);null!=i&&i.trackChildChange(_d.childRemovedChange(e,l));var d=a.updateImmediateChild(e,qp.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(_d.childAddedChange(f.name,f.node)),d.updateImmediateChild(f.name,f.node)):d}return n.isEmpty()?t:h&&o(c,u)>=0?(null!=i&&(i.trackChildChange(_d.childRemovedChange(c.name,c.node)),i.trackChildChange(_d.childAddedChange(e,n))),a.updateImmediateChild(e,n).updateImmediateChild(c.name,qp.EMPTY_NODE)):t},t}(),cv=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Pp}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return Hh(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return Hh(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Cf},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return Hh(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return Hh(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Sf},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return Hh(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==Pp&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Pp},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new bd(this.getIndex()):this.hasLimit()?new uv(this):new av(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()||(this.index_===Pp?e=n.PRIORITY_INDEX:this.index_===Kp?e=n.VALUE_INDEX:this.index_===bp?e=n.KEY_INDEX:(Hh(this.index_ instanceof Gp,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=vl(e),this.startSet_&&(r[n.START_AT]=vl(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+vl(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=vl(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+vl(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_)),r},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),hv=function(t){function e(e,n){if(!(e instanceof sv))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,cv.DEFAULT,!1)||this}return Fh(e,t),e.prototype.getKey=function(){return Cl("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return Cl("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof jf||(null===this.path.getFront()?hp("Reference.child",1,t,!1):cp("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){Cl("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){Cl("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){Cl("Reference.set",1,2,arguments.length),lp("Reference.set",this.path),rp("Reference.set",1,t,this.path,!1),xl("Reference.set",2,e,!0);var n=new tl;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(Cl("Reference.update",1,2,arguments.length),lp("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,If("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}op("Reference.update",1,t,this.path,!1),xl("Reference.update",2,e,!0);var i=new tl;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(Cl("Reference.setWithPriority",2,3,arguments.length),lp("Reference.setWithPriority",this.path),rp("Reference.setWithPriority",1,t,this.path,!1),sp("Reference.setWithPriority",2,e,!1),xl("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new tl;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return Cl("Reference.remove",0,1,arguments.length),lp("Reference.remove",this.path),xl("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(Cl("Reference.transaction",1,3,arguments.length),lp("Reference.transaction",this.path),xl("Reference.transaction",1,t,!1),xl("Reference.transaction",2,e,!0),pp("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new tl;"function"==typeof e&&r.promise.catch((function(){}));var i=function(t,n,i){t?r.reject(t):r.resolve(new vp(n,i)),"function"==typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){Cl("Reference.setPriority",1,2,arguments.length),lp("Reference.setPriority",this.path),sp("Reference.setPriority",1,t,!1),xl("Reference.setPriority",2,e,!0);var n=new tl;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){Cl("Reference.push",0,2,arguments.length),lp("Reference.push",this.path),rp("Reference.push",1,t,this.path,!0),xl("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=gp(r),o=this.child(i),s=this.child(i);return n=null!=t?o.set(t,e).then((function(){return s})):Promise.resolve(s),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch((function(){})),o},e.prototype.onDisconnect=function(){return lp("Reference.onDisconnect",this.path),new dp(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Zp);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Zp.__referenceConstructor=hv,Od.__referenceConstructor=hv;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var lv,fv=function(){this.children={},this.childCount=0,this.value=null},pv=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new fv),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n=e instanceof jf?e:new jf(e),r=this,i=n.getFront();null!==i;){r=new t(i,r,ml(r.node_.children,i)||new fv),i=(n=n.popFront()).getFront()}return r},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){Hh(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;kf(this.node_.children,(function(r,i){e(new t(r,n,i))}))},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild((function(e){e.forEachDescendant(t,!0,n)})),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild((function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)}))},t.prototype.path=function(){return new jf(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=yl(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(lv||(lv={})),sv.MAX_TRANSACTION_RETRIES_=25,sv.prototype.transactionsInit_=function(){this.transactionQueueTree_=new pv},sv.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},o=new hv(this,t);o.on("value",i);var s={path:t,update:e,onComplete:n,status:null,order:pf(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=this.getLatestState_(t);s.currentInputSnapshot=a;var u=s.update(a.val());if(void 0===u){if(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete){var c=new Hp(s.currentInputSnapshot,new hv(this,s.path),Pp);s.onComplete(null,!1,c)}}else{ip("transaction failed: Data returned ",u,s.path),s.status=lv.RUN;var h=this.transactionQueueTree_.subTree(t),l=h.getValue()||[];l.push(s),h.setValue(l);var f=void 0;if("object"==typeof u&&null!==u&&yl(u,".priority"))f=ml(u,".priority"),Hh(np(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else f=(this.serverSyncTree_.calcCompleteEventCache(t)||qp.EMPTY_NODE).getPriority().val();f=f;var p=this.generateServerValues(),d=zp(u,f),v=od(d,a,p);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=v,s.currentWriteId=this.getNextWriteId_();var g=this.serverSyncTree_.applyUserOverwrite(t,v,s.currentWriteId,s.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,g),this.sendReadyTransactions_()}},sv.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||qp.EMPTY_NODE},sv.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);Hh(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return t.status===lv.RUN}))&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild((function(t){e.sendReadyTransactions_(t)}))},sv.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map((function(t){return t.currentWriteId})),i=this.getLatestState_(t,r),o=i,s=i.hash(),a=0;a<e.length;a++){var u=e[a];Hh(u.status===lv.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=lv.SENT,u.retryCount++;var c=jf.relativePath(t,u.path);o=o.updateChild(c,u.currentOutputSnapshotRaw)}var h=o.val(!0),l=t;this.server_.put(l.toString(),h,(function(r){n.log_("transaction put response",{path:l.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=0;s<e.length;s++){if(e[s].status=lv.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[s].currentWriteId)),e[s].onComplete){var a=e[s].currentOutputSnapshotResolved,u=new hv(n,e[s].path),c=new Hp(a,u,Pp);o.push(e[s].onComplete.bind(null,null,!0,c))}e[s].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i);for(s=0;s<o.length;s++)Mf(o[s])}else{if("datastale"===r)for(s=0;s<e.length;s++)e[s].status===lv.SENT_NEEDS_ABORT?e[s].status=lv.NEEDS_ABORT:e[s].status=lv.RUN;else{If("transaction at "+l.toString()+" failed: "+r);for(s=0;s<e.length;s++)e[s].status=lv.NEEDS_ABORT,e[s].abortReason=r}n.rerunTransactions_(t)}}),s)},sv.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},sv.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,r=[],i=[],o=t.filter((function(t){return t.status===lv.RUN})).map((function(t){return t.currentWriteId})),s=0;s<t.length;s++){var a=t[s],u=jf.relativePath(e,a.path),c=!1,h=void 0;if(Hh(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===lv.NEEDS_ABORT)c=!0,h=a.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else if(a.status===lv.RUN)if(a.retryCount>=sv.MAX_TRANSACTION_RETRIES_)c=!0,h="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else{var l=this.getLatestState_(a.path,o);a.currentInputSnapshot=l;var f=t[s].update(l.val());if(void 0!==f){ip("transaction failed: Data returned ",f,a.path);var p=zp(f);"object"==typeof f&&null!=f&&yl(f,".priority")||(p=p.updatePriority(l.getPriority()));var d=a.currentWriteId,v=this.generateServerValues(),g=od(p,l,v);a.currentOutputSnapshotRaw=p,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(d),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(a.path,g,a.currentWriteId,a.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(d,!0))}else c=!0,h="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,i),i=[],c&&(t[s].status=lv.COMPLETED,n=t[s].unwatcher,setTimeout(n,Math.floor(0)),t[s].onComplete))if("nodata"===h){var y=new hv(this,t[s].path),m=t[s].currentInputSnapshot,_=new Hp(m,y,Pp);r.push(t[s].onComplete.bind(null,null,!1,_))}else r.push(t[s].onComplete.bind(null,new Error(h),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(s=0;s<r.length;s++)Mf(r[s]);this.sendReadyTransactions_()}},sv.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;for(e=t.getFront();null!==e&&null===n.getValue();)n=n.subTree(e),e=(t=t.popFront()).getFront();return n},sv.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort((function(t,e){return t.order-e.order})),e},sv.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild((function(t){n.aggregateTransactionQueuesForNode_(t,e)}))},sv.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==lv.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild((function(t){e.pruneCompletedTransactionsBelowNode_(t)}))},sv.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor((function(t){e.abortTransactionsOnNode_(t)})),this.abortTransactionsOnNode_(r),r.forEachDescendant((function(t){e.abortTransactionsOnNode_(t)})),n},sv.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)if(e[o].status===lv.SENT_NEEDS_ABORT);else if(e[o].status===lv.SENT)Hh(i===o-1,"All SENT items should be at beginning of queue."),i=o,e[o].status=lv.SENT_NEEDS_ABORT,e[o].abortReason="set";else if(Hh(e[o].status===lv.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete){n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))}-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r);for(o=0;o<n.length;o++)Mf(n[o])}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var dv,vv=function(){function t(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then((function(t){return n.auth_=t}))}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(_f("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout((function(){return t(null)}),0),this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)})))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',If(t)},t}(),gv=function(){function t(){}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:t.EMULATOR_AUTH_TOKEN})},t.prototype.addTokenChangeListener=function(e){e(t.EMULATOR_AUTH_TOKEN)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.EMULATOR_AUTH_TOKEN="owner",t}(),yv=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return dv||(dv=new t),dv},t.prototype.interrupt=function(){var t,e,n,r;try{for(var i=qh(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,qh(Object.keys(this.repos_[s]))),u=a.next();!u.done;u=a.next()){var c=u.value;this.repos_[s][c].interrupt()}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.resume=function(){var t,e,n,r;try{for(var i=qh(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,qh(Object.keys(this.repos_[s]))),u=a.next();!u.done;u=a.next()){var c=u.value;this.repos_[s][c].resume()}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.applyEmulatorSettings=function(t,e,n){t.repoInfo_=new zf(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),t.repoInfo_.nodeAdmin&&(t.authTokenProvider_=new gv)},t.prototype.databaseFromApp=function(t,e,n,r){var i=n||t.options.databaseURL;void 0===i&&(t.options.projectId||Ef("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_f("Using default host for project ",t.options.projectId),i=t.options.projectId+"-default-rtdb.firebaseio.com");var o,s=Yf(i,r),a=s.repoInfo,u=void 0;"undefined"!=typeof process&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(o=!0,i="http://"+u+"?ns="+a.namespace,a=(s=Yf(i,r)).repoInfo):o=!s.repoInfo.secure;var c=r&&o?new gv:new vv(t,e);return fp("Invalid Firebase Database URL",1,s),s.path.isEmpty()||Ef("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(a,t,c).database},t.prototype.deleteRepo=function(t){var e=ml(this.repos_,t.app.name);e&&ml(e,t.key)===t||Ef("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.key]},t.prototype.createRepo=function(t,e,n){var r=ml(this.repos_,e.name);r||(r={},this.repos_[e.name]=r);var i=ml(r,t.toURLString());return i&&Ef("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new sv(t,this.useRestClient_,e,n),r[t.toURLString()]=i,i},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),mv=function(){function t(t){var e=this;this.repoInternal_=t,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return Uh(e,void 0,void 0,(function(){return Vh(this,(function(t){return this.checkDeleted_("delete"),yv.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]}))}))}},t instanceof sv||Ef("Don't call new Database() directly - please use firebase.database().")}return Object.defineProperty(t.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new hv(this.repo_,jf.Empty)),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),t.prototype.useEmulator=function(t,e){this.checkDeleted_("useEmulator"),this.instanceStarted_?Ef("Cannot call useEmulator() after instance has already been initialized."):yv.getInstance().applyEmulatorSettings(this.repoInternal_,t,e)},t.prototype.ref=function(t){return this.checkDeleted_("ref"),Cl("database.ref",0,1,arguments.length),t instanceof hv?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),Cl(e,1,1,arguments.length);var n=Yf(t,this.repo_.repoInfo_.nodeAdmin);fp(e,1,n);var r=n.repoInfo;return this.repo_.repoInfo_.isCustomHost()||r.host===this.repo_.repoInfo_.host||Ef(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repoInternal_&&Ef("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){Cl("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){Cl("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(t){return{".sv":{increment:t}}}},t}();var _v=Object.freeze({__proto__:null,forceLongPolling:function(){Zd.forceDisallow(),Hd.forceAllow()},forceWebSockets:function(){Hd.forceDisallow()},isWebSocketsAvailable:function(){return Zd.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,i=t.customAuthImpl,o=t.namespace,s=t.nodeAdmin,a=void 0!==s&&s;Qd(r);var u=new Nl("auth-internal",new Ll("database-standalone"));return u.setComponent(new Rl("auth-internal",(function(){return i}),"PRIVATE")),{instance:yv.getInstance().databaseFromApp(e,u,n,a),namespace:o}}}),bv=rv;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */rv.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},rv.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var wv=tv,Ev=zf,Iv=Object.freeze({__proto__:null,DataConnection:bv,RealTimeConnection:wv,hijackHash:function(t){var e=rv.prototype.put;return rv.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){rv.prototype.put=e}},ConnectionTarget:Ev,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){yv.getInstance().forceRestClient(t)}}),Tv=mv.ServerValue;!function(t){Qd(t.SDK_VERSION),t.INTERNAL.registerComponent(new Rl("database",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return yv.getInstance().databaseFromApp(n,r,e)}),"PUBLIC").setServiceProps({Reference:hv,Query:Zp,Database:mv,DataSnapshot:Hp,enableLogging:mf,INTERNAL:_v,ServerValue:Tv,TEST_ACCESS:Iv}).setMultipleInstances(!0)),t.registerVersion("@firebase/database","0.8.3")}(sf);
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var Cv=function(t,e){return(Cv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Sv(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var xv,Ov="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Pv=Pv||{},Av=Ov||self;function Rv(){}function kv(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Nv(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Dv="closure_uid_"+(1e9*Math.random()>>>0),Lv=0;function Mv(t,e,n){return t.call.apply(t.bind,arguments)}function Fv(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function jv(t,e,n){return(jv=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Mv:Fv).apply(null,arguments)}function Uv(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Vv(){return Date.now()}function qv(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Bv(){this.j=this.j,this.i=this.i}Bv.prototype.j=!1,Bv.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(t){Object.prototype.hasOwnProperty.call(t,Dv)&&t[Dv]||(t[Dv]=++Lv)})(this)},Bv.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var zv=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Wv=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Kv(t){return Array.prototype.concat.apply([],arguments)}function Gv(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Hv(t){return/^[\s\xa0]*$/.test(t)}var Xv,Yv=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Qv(t,e){return-1!=t.indexOf(e)}function Jv(t,e){return t<e?-1:t>e?1:0}t:{var Zv=Av.navigator;if(Zv){var $v=Zv.userAgent;if($v){Xv=$v;break t}}Xv=""}function tg(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function eg(t){var e={};for(var n in t)e[n]=t[n];return e}var ng="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rg(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ng.length;o++)n=ng[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ig(t){return ig[" "](t),t}ig[" "]=Rv;var og,sg,ag=Qv(Xv,"Opera"),ug=Qv(Xv,"Trident")||Qv(Xv,"MSIE"),cg=Qv(Xv,"Edge"),hg=cg||ug,lg=Qv(Xv,"Gecko")&&!(Qv(Xv.toLowerCase(),"webkit")&&!Qv(Xv,"Edge"))&&!(Qv(Xv,"Trident")||Qv(Xv,"MSIE"))&&!Qv(Xv,"Edge"),fg=Qv(Xv.toLowerCase(),"webkit")&&!Qv(Xv,"Edge");function pg(){var t=Av.document;return t?t.documentMode:void 0}t:{var dg="",vg=(sg=Xv,lg?/rv:([^\);]+)(\)|;)/.exec(sg):cg?/Edge\/([\d\.]+)/.exec(sg):ug?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(sg):fg?/WebKit\/(\S+)/.exec(sg):ag?/(?:Version)[ \/]?(\S+)/.exec(sg):void 0);if(vg&&(dg=vg?vg[1]:""),ug){var gg=pg();if(null!=gg&&gg>parseFloat(dg)){og=String(gg);break t}}og=dg}var yg,mg={};function _g(t){return function(t,e){var n=mg;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=Yv(String(og)).split("."),r=Yv(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=Jv(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||Jv(0==s[2].length,0==a[2].length)||Jv(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}if(Av.document&&ug){var bg=pg();yg=bg||(parseInt(og,10)||void 0)}else yg=void 0;var wg=yg,Eg=!ug||9<=Number(wg),Ig=ug&&!_g("9"),Tg=function(){if(!Av.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Av.addEventListener("test",Rv,e),Av.removeEventListener("test",Rv,e)}catch(t){}return t}();function Cg(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Sg(t,e){if(Cg.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lg){t:{try{ig(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:xg[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Cg.prototype.b=function(){this.defaultPrevented=!0},qv(Sg,Cg);var xg={2:"touch",3:"pen",4:"mouse"};Sg.prototype.b=function(){Sg.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ig)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var Og="closure_listenable_"+(1e6*Math.random()|0),Pg=0;function Ag(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Pg,this.Y=this.Z=!1}function Rg(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function kg(t){this.src=t,this.a={},this.b=0}function Ng(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=zv(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Rg(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Dg(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}kg.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dg(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ag(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lg="closure_lm_"+(1e6*Math.random()|0),Mg={};function Fg(t,e,n,r,i){if(r&&r.once)return Ug(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Fg(t,e[o],n,r,i);return null}return n=Hg(n),t&&t[Og]?t.va(e,n,Nv(r)?!!r.capture:!!r,i):jg(t,e,n,!1,r,i)}function jg(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Nv(i)?!!i.capture:!!i;if(s&&!Eg)return null;var a=Kg(t);if(a||(t[Lg]=a=new kg(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Wg,e=Eg?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Tg||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Bg(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ug(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ug(t,e[o],n,r,i);return null}return n=Hg(n),t&&t[Og]?t.wa(e,n,Nv(r)?!!r.capture:!!r,i):jg(t,e,n,!0,r,i)}function Vg(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Vg(t,e[o],n,r,i);else r=Nv(r)?!!r.capture:!!r,n=Hg(n),t&&t[Og]?(t=t.c,(e=String(e).toString())in t.a&&(-1<(n=Dg(o=t.a[e],n,r,i))&&(Rg(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Kg(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Dg(e,n,r,i)),(n=-1<t?e[t]:null)&&qg(n))}function qg(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Og])Ng(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Bg(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Kg(e))?(Ng(n,t),0==n.b&&(n.src=null,e[Lg]=null)):Rg(t)}}}function Bg(t){return t in Mg?Mg[t]:Mg[t]="on"+t}function zg(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&qg(t),n.call(r,e)}function Wg(t,e){if(t.Y)return!0;if(!Eg){if(!e)t:{e=["window","event"];for(var n=Av,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return zg(t,e=new Sg(e,this))}return zg(t,new Sg(e,this))}function Kg(t){return(t=t[Lg])instanceof kg?t:null}var Gg="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hg(t){return"function"==typeof t?t:(t[Gg]||(t[Gg]=function(e){return t.handleEvent(e)}),t[Gg])}function Xg(){Bv.call(this),this.c=new kg(this),this.J=this,this.C=null}function Yg(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Cg(e,t);else if(e instanceof Cg)e.target=e.target||t;else{var i=e;rg(e=new Cg(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=Qg(s,r,!0,e)&&i}if(i=Qg(s=e.a=t,r,!0,e)&&i,i=Qg(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Qg(s=e.a=n[o],r,!1,e)&&i}function Qg(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&Ng(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}qv(Xg,Bv),Xg.prototype[Og]=!0,(xv=Xg.prototype).addEventListener=function(t,e,n,r){Fg(this,t,e,n,r)},xv.removeEventListener=function(t,e,n,r){Vg(this,t,e,n,r)},xv.G=function(){if(Xg.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rg(n[r]);delete e.a[t],e.b--}}this.C=null},xv.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},xv.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Jg=Av.JSON.stringify;function Zg(){this.b=this.a=null}var $g,ty=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new ny}),(function(t){t.reset()}));function ey(){var t=sy,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function ny(){this.next=this.b=this.a=null}function ry(t){Av.setTimeout((function(){throw t}),0)}function iy(t,e){$g||function(){var t=Av.Promise.resolve(void 0);$g=function(){t.then(ay)}}(),oy||($g(),oy=!0),sy.add(t,e)}Zg.prototype.add=function(t,e){var n=ty.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},ny.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},ny.prototype.reset=function(){this.next=this.b=this.a=null};var oy=!1,sy=new Zg;function ay(){for(var t;t=ey();){try{t.a.call(t.b)}catch(t){ry(t)}var e=ty;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}oy=!1}function uy(t,e){Xg.call(this),this.b=t||1,this.a=e||Av,this.f=jv(this.Za,this),this.g=Vv()}function cy(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function hy(t,e,n){if("function"==typeof t)n&&(t=jv(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=jv(t.handleEvent,t)}return 2147483647<Number(e)?-1:Av.setTimeout(t,e||0)}function ly(t){t.a=hy((function(){t.a=null,t.c&&(t.c=!1,ly(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}qv(uy,Xg),(xv=uy.prototype).aa=!1,xv.M=null,xv.Za=function(){if(this.aa){var t=Vv()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Yg(this,"tick"),this.aa&&(cy(this),this.start()))}},xv.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Vv())},xv.G=function(){uy.X.G.call(this),cy(this),delete this.a};var fy=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}Cv(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:ly(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(Av.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(Bv);function py(t){Bv.call(this),this.b=t,this.a={}}qv(py,Bv);var dy=[];function vy(t,e,n,r){Array.isArray(n)||(n&&(dy[0]=n.toString()),n=dy);for(var i=0;i<n.length;i++){var o=Fg(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function gy(t){tg(t.a,(function(t,e){this.a.hasOwnProperty(e)&&qg(t)}),t),t.a={}}function yy(){this.a=!0}function my(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Jg(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}py.prototype.G=function(){py.X.G.call(this),gy(this)},py.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},yy.prototype.info=function(){};var _y={},by=null;function wy(){return by=by||new Xg}function Ey(t){Cg.call(this,_y.Fa,t)}function Iy(t){var e=wy();Yg(e,new Ey(e,t))}function Ty(t,e){Cg.call(this,_y.STAT_EVENT,t),this.stat=e}function Cy(t){var e=wy();Yg(e,new Ty(e,t))}function Sy(t){Cg.call(this,_y.Ga,t)}function xy(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Av.setTimeout((function(){t()}),e)}_y.Fa="serverreachability",qv(Ey,Cg),_y.STAT_EVENT="statevent",qv(Ty,Cg),_y.Ga="timingevent",qv(Sy,Cg);var Oy={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Py={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ay(){}function Ry(t){var e;return(e=t.a)||(e=t.a={}),e}function ky(){}Ay.prototype.a=null;var Ny,Dy={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ly(){Cg.call(this,"d")}function My(){Cg.call(this,"c")}function Fy(){}function jy(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new py(this),this.P=Uy,t=hg?125:void 0,this.R=new uy(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}qv(Ly,Cg),qv(My,Cg),qv(Fy,Ay),Ny=new Fy;var Uy=45e3,Vy={},qy={};function By(t,e,n){t.H=1,t.i=hm(im(e)),t.j=n,t.I=!0,zy(t,null)}function zy(t,e){t.u=Vv(),Gy(t),t.l=im(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Im(n.b,"t",r),t.D=0,t.a=y_(t.g,t.g.C?e:null),0<t.O&&(t.F=new fy(jv(t.Ca,t,t.a),t.O)),vy(t.J,t.a,"readystatechange",t.Xa),e=t.B?eg(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Iy(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function Wy(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ky(t,n);if(i==qy){4==e&&(t.h=4,Cy(14),r=!1),my(t.c,t.f,null,"[Incomplete Response]");break}if(i==Vy){t.h=4,Cy(15),my(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}my(t.c,t.f,i,null),Jy(t,i)}4==e&&0==n.length&&(t.h=1,Cy(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),c_(e),e.F=!0,Cy(11))):(my(t.c,t.f,n,"[Invalid Chunked Response]"),Qy(t),Yy(t))}function Ky(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?qy:(n=Number(e.substring(n,r)),isNaN(n)?Vy:(r+=1)+n>e.length?qy:(e=e.substr(r,n),t.D=r+n,e))}function Gy(t){t.T=Vv()+t.P,Hy(t,t.P)}function Hy(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=xy(jv(t.Va,t),e)}function Xy(t){t.o&&(Av.clearTimeout(t.o),t.o=null)}function Yy(t){0==t.g.v||t.A||f_(t.g,t)}function Qy(t){Xy(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,cy(t.R),gy(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Jy(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||Am(n.b,t)))if(n.I=t.N,!t.C&&Am(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;l_(n),t_(n)}u_(n),Cy(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=xy(jv(n.Sa,n),6e3));if(1>=Pm(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else d_(n,11)}else if((t.C||n.a==t)&&l_(n),!Hv(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(Qv(h,"spdy")||Qv(h,"quic")||Qv(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(Rm(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,cm(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=Vv()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).la=g_(u,u.C?u.ga:null,u.fa),p.C){km(u.b,p);var d=p,v=u.D;v&&d.setTimeout(v),d.o&&(Xy(d),Gy(d)),u.a=p}else a_(u);0<n.g.length&&r_(n)}else"stop"!=i[0]&&"close"!=i[0]||d_(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?d_(n,7):$m(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Iy(4)}catch(t){}}function Zy(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(kv(t)||"string"==typeof t)Wv(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(kv(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(kv(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function $y(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof $y)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function tm(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];em(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)em(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function em(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(xv=jy.prototype).setTimeout=function(t){this.P=t},xv.Xa=function(t){t=t.target;var e=this.F;e&&3==Ym(t)?e.f():this.Ca(t)},xv.Ca=function(t){try{if(t==this.a)t:{var e=Ym(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!hg&&!this.a.$())){this.A||4!=e||7==n||Iy(8==n||0>=r?3:2),Xy(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Hv(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Cy(12),Qy(this),Yy(this);break t}my(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Jy(this,u)}this.I?(Wy(this,e,o),hg&&this.b&&3==e&&(vy(this.J,this.R,"tick",this.Wa),this.R.start())):(my(this.c,this.f,o,null),Jy(this,o)),4==e&&Qy(this),this.b&&!this.A&&(4==e?f_(this.g,this):(this.b=!1,Gy(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Cy(12)):(this.h=0,Cy(13)),Qy(this),Yy(this)}}}catch(t){}},xv.Wa=function(){if(this.a){var t=Ym(this.a),e=this.a.$();this.D<e.length&&(Xy(this),Wy(this,t,e),this.b&&4!=t&&Gy(this))}},xv.cancel=function(){this.A=!0,Qy(this)},xv.Va=function(){this.o=null;var t=Vv();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(Iy(3),Cy(17)),Qy(this),this.h=2,Yy(this)):Hy(this,this.T-t)},(xv=$y.prototype).K=function(){tm(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},xv.L=function(){return tm(this),this.a.concat()},xv.get=function(t,e){return em(this.b,t)?this.b[t]:e},xv.set=function(t,e){em(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},xv.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var nm=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function rm(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof rm){this.a=void 0!==e?e:t.a,om(this,t.f),this.j=t.j,sm(this,t.c),am(this,t.h),this.g=t.g,e=t.b;var n=new _m;n.c=e.c,e.a&&(n.a=new $y(e.a),n.b=e.b),um(this,n),this.i=t.i}else t&&(n=String(t).match(nm))?(this.a=!!e,om(this,n[1]||"",!0),this.j=lm(n[2]||""),sm(this,n[3]||"",!0),am(this,n[4]),this.g=lm(n[5]||"",!0),um(this,n[6]||"",!0),this.i=lm(n[7]||"")):(this.a=!!e,this.b=new _m(null,this.a))}function im(t){return new rm(t)}function om(t,e,n){t.f=n?lm(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function sm(t,e,n){t.c=n?lm(e,!0):e}function am(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function um(t,e,n){e instanceof _m?(t.b=e,function(t,e){e&&!t.f&&(bm(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(wm(this,e),Im(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=fm(e,ym)),t.b=new _m(e,t.a))}function cm(t,e,n){t.b.set(e,n)}function hm(t){return cm(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Vv()).toString(36)),t}function lm(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function fm(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,pm),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pm(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}rm.prototype.toString=function(){var t=[],e=this.f;e&&t.push(fm(e,dm,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(fm(e,dm,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(fm(n,"/"==n.charAt(0)?gm:vm,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",fm(n,mm)),t.join("")};var dm=/[#\/\?@]/g,vm=/[#\?:]/g,gm=/[#\?]/g,ym=/[#\?@]/g,mm=/#/g;function _m(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function bm(t){t.a||(t.a=new $y,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function wm(t,e){bm(t),e=Tm(t,e),em(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,em((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&tm(t)))}function Em(t,e){return bm(t),e=Tm(t,e),em(t.a.b,e)}function Im(t,e,n){wm(t,e),0<n.length&&(t.c=null,t.a.set(Tm(t,e),Gv(n)),t.b+=n.length)}function Tm(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(xv=_m.prototype).add=function(t,e){bm(this),this.c=null,t=Tm(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},xv.forEach=function(t,e){bm(this),this.a.forEach((function(n,r){Wv(n,(function(n){t.call(e,n,r,this)}),this)}),this)},xv.L=function(){bm(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},xv.K=function(t){bm(this);var e=[];if("string"==typeof t)Em(this,t)&&(e=Kv(e,this.a.get(Tm(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Kv(e,t[n])}return e},xv.set=function(t,e){return bm(this),this.c=null,Em(this,t=Tm(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},xv.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},xv.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Cm=function(t,e){this.b=t,this.a=e};function Sm(t){this.g=t||xm,Av.PerformanceNavigationTiming?t=0<(t=Av.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Av.ia&&Av.ia.ya&&Av.ia.ya()&&Av.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var xm=10;function Om(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Pm(t){return t.b?1:t.a?t.a.size:0}function Am(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Rm(t,e){t.a?t.a.add(e):t.b=e}function km(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nm(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=Sv(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Gv(t.c)}function Dm(){}function Lm(){this.a=new Dm}function Mm(t,e,n){var r=n||"";try{Zy(t,(function(t,n){var i=t;Nv(t)&&(i=Jg(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Fm(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Sm.prototype.cancel=function(){var t,e;if(this.c=Nm(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=Sv(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Dm.prototype.stringify=function(t){return Av.JSON.stringify(t,void 0)},Dm.prototype.parse=function(t){return Av.JSON.parse(t,void 0)};var jm=Av.JSON.parse;function Um(t){Xg.call(this),this.headers=new $y,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vm,this.D=this.F=!1}qv(Um,Xg);var Vm="",qm=/^https?$/i,Bm=["POST","PUT"];function zm(t){return"content-type"==t.toLowerCase()}function Wm(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Km(t),Hm(t)}function Km(t){t.u||(t.u=!0,Yg(t,"complete"),Yg(t,"error"))}function Gm(t){if(t.b&&void 0!==Pv&&(!t.s[1]||4!=Ym(t)||2!=t.W()))if(t.l&&4==Ym(t))hy(t.za,0,t);else if(Yg(t,"readystatechange"),4==Ym(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(nm)[1]||null;if(!o&&Av.self&&Av.self.location){var s=Av.self.location.protocol;o=s.substr(0,s.length-1)}i=!qm.test(o?o.toLowerCase():"")}e=i}if(e)Yg(t,"complete"),Yg(t,"success");else{t.h=6;try{var a=2<Ym(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",Km(t)}}finally{Hm(t)}}}function Hm(t,e){if(t.a){Xm(t);var n=t.a,r=t.s[0]?Rv:null;t.a=null,t.s=null,e||Yg(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Xm(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(Av.clearTimeout(t.m),t.m=null)}function Ym(t){return t.a?t.a.readyState:0}function Qm(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return tg(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):cm(t,e,n))}function Jm(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Zm(t){this.pa=0,this.g=[],this.c=new yy,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Jm("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Jm("baseRetryDelayMs",5e3,t),this.Ra=Jm("retryDelaySeedMs",1e4,t),this.Ma=Jm("forwardChannelMaxRetries",2,t),this.ma=Jm("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Sm(t&&t.concurrentRequestLimit),this.ka=new Lm,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function $m(t){if(e_(t),3==t.v){var e=t.R++,n=im(t.B);cm(n,"SID",t.J),cm(n,"RID",e),cm(n,"TYPE","terminate"),o_(t,n),(e=new jy(t,t.c,e,void 0)).H=2,e.i=hm(im(n)),n=!1,Av.navigator&&Av.navigator.sendBeacon&&(n=Av.navigator.sendBeacon(e.i.toString(),"")),!n&&Av.Image&&((new Image).src=e.i,n=!0),n||(e.a=y_(e.g,null),e.a.ba(e.i)),e.u=Vv(),Gy(e)}v_(t)}function t_(t){t.a&&(c_(t),t.a.cancel(),t.a=null)}function e_(t){t_(t),t.j&&(Av.clearTimeout(t.j),t.j=null),l_(t),t.b.cancel(),t.h&&("number"==typeof t.h&&Av.clearTimeout(t.h),t.h=null)}function n_(t,e){t.g.push(new Cm(t.Oa++,e)),3==t.v&&r_(t)}function r_(t){Om(t.b)||t.h||(t.h=!0,iy(t.Ba,t),t.u=0)}function i_(t,e){var n;n=e?e.f:t.R++;var r=im(t.B);cm(r,"SID",t.J),cm(r,"RID",n),cm(r,"AID",t.P),o_(t,r),t.i&&t.l&&Qm(r,t.i,t.l),n=new jy(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=s_(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Rm(t.b,n),By(n,r,e)}function o_(t,e){t.f&&Zy({},(function(t,n){cm(e,n,t)}))}function s_(t,e,n){n=Math.min(t.g.length,n);var r=t.f?jv(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Mm(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function a_(t){t.a||t.j||(t.T=1,iy(t.Aa,t),t.o=0)}function u_(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=xy(jv(t.Aa,t),p_(t,t.o)),t.o++,!0)}function c_(t){null!=t.s&&(Av.clearTimeout(t.s),t.s=null)}function h_(t){t.a=new jy(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=im(t.la);cm(e,"RID","rpc"),cm(e,"SID",t.J),cm(e,"CI",t.H?"0":"1"),cm(e,"AID",t.P),o_(t,e),cm(e,"TYPE","xmlhttp"),t.i&&t.l&&Qm(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=hm(im(e)),n.j=null,n.I=!0,zy(n,t)}function l_(t){null!=t.m&&(Av.clearTimeout(t.m),t.m=null)}function f_(t,e){var n=null;if(t.a==e){l_(t),c_(t),t.a=null;var r=2}else{if(!Am(t.b,e))return;n=e.s,km(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=Vv()-e.u;var i=t.u;Yg(r=wy(),new Sy(r,n,e,i)),r_(t)}else a_(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Pm(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=xy(jv(t.Ba,t,e),p_(t,t.u)),t.u++,0)))}(t,e)||2==r&&u_(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:d_(t,5);break;case 4:d_(t,10);break;case 3:d_(t,6);break;default:d_(t,2)}}function p_(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function d_(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=jv(t.Ya,t);n||(n=new rm("//www.google.com/images/cleardot.gif"),Av.location&&"http"==Av.location.protocol||om(n,"https"),hm(n)),function(t,e){var n=new yy;if(Av.Image){var r=new Image;r.onload=Uv(Fm,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Uv(Fm,n,r,"TestLoadImage: error",!1,e),r.onabort=Uv(Fm,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Uv(Fm,n,r,"TestLoadImage: timeout",!1,e),Av.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Cy(2);t.v=0,t.f&&t.f.ra(e),v_(t),e_(t)}function v_(t){t.v=0,t.I=-1,t.f&&(0==Nm(t.b).length&&0==t.g.length||(t.b.c.length=0,Gv(t.g),t.g.length=0),t.f.qa())}function g_(t,e,n){var r=function(t){return t instanceof rm?im(t):new rm(t,void 0)}(n);if(""!=r.c)e&&sm(r,e+"."+r.c),am(r,r.h);else{var i=Av.location;r=function(t,e,n,r){var i=new rm(null,void 0);return t&&om(i,t),e&&sm(i,e),n&&am(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&tg(t.V,(function(t,e){cm(r,e,t)})),e=t.A,n=t.na,e&&n&&cm(r,e,n),cm(r,"VER",t.ha),o_(t,r),r}function y_(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Um(t.Na)).F=t.C,e}function m_(){}function __(){if(ug&&!(10<=Number(wg)))throw Error("Environmental error: no available transport.")}function b_(t,e){Xg.call(this),this.a=new Zm(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Hv(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Hv(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new I_(this)}function w_(t){Ly.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function E_(){My.call(this),this.status=1}function I_(t){this.a=t}(xv=Um.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ry(this.H):Ry(Ny),this.a.onreadystatechange=jv(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Wm(this,t)}t=n||"";var i=new $y(this.headers);r&&Zy(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=zm,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=Av.FormData&&t instanceof Av.FormData,!(0<=zv(Bm,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Xm(this),0<this.o&&((this.D=function(t){return ug&&_g(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=jv(this.xa,this)):this.m=hy(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Wm(this,t)}},xv.xa=function(){void 0!==Pv&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Yg(this,"timeout"),this.abort(8))},xv.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Yg(this,"complete"),Yg(this,"abort"),Hm(this))},xv.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Hm(this,!0)),Um.X.G.call(this)},xv.za=function(){this.j||(this.A||this.l||this.g?Gm(this):this.Ua())},xv.Ua=function(){Gm(this)},xv.W=function(){try{return 2<Ym(this)?this.a.status:-1}catch(t){return-1}},xv.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},xv.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),jm(e)}},xv.ua=function(){return this.h},xv.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(xv=Zm.prototype).ha=8,xv.v=1,xv.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new jy(this,this.c,t,void 0),r=this.l;if(this.O&&(r?rg(r=eg(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=s_(this,n,e),cm(i=im(this.B),"RID",t),cm(i,"CVER",22),this.A&&cm(i,"X-HTTP-Session-Id",this.A),o_(this,i),this.i&&r&&Qm(i,this.i,r),Rm(this.b,n),this.Ia&&cm(i,"TYPE","init"),this.da?(cm(i,"$req",e),cm(i,"SID","null"),n.U=!0,By(n,i,null)):By(n,i,e),this.v=2}}else 3==this.v&&(t?i_(this,t):0==this.g.length||Om(this.b)||i_(this))},xv.Aa=function(){if(this.j=null,h_(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=xy(jv(this.Ta,this),t)}},xv.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Cy(10),t_(this),h_(this))},xv.Sa=function(){null!=this.m&&(this.m=null,t_(this),u_(this),Cy(19))},xv.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Cy(2)):(this.c.info("Failed to ping google.com"),Cy(1))},(xv=m_.prototype).ta=function(){},xv.sa=function(){},xv.ra=function(){},xv.qa=function(){},xv.Ja=function(){},__.prototype.a=function(t,e){return new b_(t,e)},qv(b_,Xg),b_.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Cy(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=g_(t,null,t.fa),r_(t)},b_.prototype.close=function(){$m(this.a)},b_.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,n_(this.a,e)}else this.l?((e={}).__data__=Jg(t),n_(this.a,e)):n_(this.a,t)},b_.prototype.G=function(){this.a.f=null,delete this.f,$m(this.a),delete this.a,b_.X.G.call(this)},qv(w_,Ly),qv(E_,My),qv(I_,m_),I_.prototype.ta=function(){Yg(this.a,"a")},I_.prototype.sa=function(t){Yg(this.a,new w_(t))},I_.prototype.ra=function(t){Yg(this.a,new E_(t))},I_.prototype.qa=function(){Yg(this.a,"b")},__.prototype.createWebChannel=__.prototype.a,b_.prototype.send=b_.prototype.h,b_.prototype.open=b_.prototype.g,b_.prototype.close=b_.prototype.close,Oy.NO_ERROR=0,Oy.TIMEOUT=8,Oy.HTTP_ERROR=6,Py.COMPLETE="complete",ky.EventType=Dy,Dy.OPEN="a",Dy.CLOSE="b",Dy.ERROR="c",Dy.MESSAGE="d",Xg.prototype.listen=Xg.prototype.va,Um.prototype.listenOnce=Um.prototype.wa,Um.prototype.getLastError=Um.prototype.Qa,Um.prototype.getLastErrorCode=Um.prototype.ua,Um.prototype.getStatus=Um.prototype.W,Um.prototype.getResponseJson=Um.prototype.Pa,Um.prototype.getResponseText=Um.prototype.$,Um.prototype.send=Um.prototype.ba;var T_=Oy,C_=Py,S_=_y,x_=10,O_=11,P_=ky,A_=Um,R_=new Wl("@firebase/firestore");function k_(){return R_.logLevel}function N_(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(R_.logLevel<=Fl.DEBUG){var r=e.map(M_);R_.debug.apply(R_,Wh(["Firestore (8.2.2): "+t],r))}}function D_(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(R_.logLevel<=Fl.ERROR){var r=e.map(M_);R_.error.apply(R_,Wh(["Firestore (8.2.2): "+t],r))}}function L_(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(R_.logLevel<=Fl.WARN){var r=e.map(M_);R_.warn.apply(R_,Wh(["Firestore (8.2.2): "+t],r))}}function M_(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function F_(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.2) INTERNAL ASSERTION FAILED: "+t;throw D_(e),new Error(e)}function j_(t,e){t||F_()}function U_(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function V_(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var q_=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=V_(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function B_(t,e){return t<e?-1:t>e?1:0}function z_(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function W_(t){return t+"\0"}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var K_=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.i,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return B_(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();K_.h=new K_("");var G_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},H_=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Fh(e,t),e}(Error),X_=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(K_.fromBase64String(e))}catch(e){throw new H_(G_.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(K_.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),Y_=function(t){this._=t};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Q_(){if("undefined"==typeof Uint8Array)throw new H_(G_.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function J_(){if("undefined"==typeof atob)throw new H_(G_.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Z_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.fromBase64String=function(t){return J_(),new e(X_.fromBase64String(t))},e.fromUint8Array=function(t){return Q_(),new e(X_.fromUint8Array(t))},e.prototype.toBase64=function(){return J_(),this._.toBase64()},e.prototype.toUint8Array=function(){return Q_(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Y_),$_=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},tb=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),eb=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */eb.UNAUTHENTICATED=new eb(null),eb.P=new eb("google-credentials-uid"),eb.g=new eb("first-party-uid");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var nb=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},rb=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(eb.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),ib=function(){function t(t){var e=this;this.C=null,this.currentUser=eb.UNAUTHENTICATED,this.N=!1,this.O=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.O++,e.currentUser=e.F(),e.N=!0,e.p&&e.p(e.currentUser)},this.O=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then((function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.O,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.O!==e?(N_("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(j_("string"==typeof n.accessToken),new nb(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.F=function(){var t=this.auth&&this.auth.getUid();return j_(null===t||"string"==typeof t),new eb(t)},t}(),ob=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=eb.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),sb=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new ob(this.k,this.M))},t.prototype.S=function(t){t(eb.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),ab=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();ab.U=-1;var ub=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new H_(G_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new H_(G_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new H_(G_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new H_(G_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?B_(this.nanoseconds,t.nanoseconds):B_(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),cb=function(){function t(t){this.timestamp=t}return t.j=function(e){return new t(e)},t.min=function(){return new t(new ub(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),hb=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&F_(),void 0===n?n=t.length-e:n>t.length-e&&F_(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),lb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new H_(G_.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.at=function(){return new e([])},e}(hb),fb=/^[_a-zA-Z][_a-zA-Z0-9]*$/,pb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return fb.test(t)},e.prototype.ot=function(){return this.rt().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new H_(G_.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new H_(G_.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new H_(G_.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new H_(G_.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(hb),db=function(){function t(t){this.path=t}return t.ft=function(e){return new t(lb.ct(e))},t.dt=function(e){return new t(lb.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===lb.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return lb.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new lb(e.slice()))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vb(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gb(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function yb(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var mb=function(){function t(t){this.fields=t,t.sort(pb.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return z_(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),_b=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bb(t){if(j_(!!t),"string"==typeof t){var e=0,n=_b.exec(t);if(j_(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:wb(t.seconds),nanos:wb(t.nanos)}}function wb(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Eb(t){return"string"==typeof t?K_.fromBase64String(t):K_.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ib(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Tb(t){var e=t.mapValue.fields.__previous_value__;return Ib(e)?Tb(e):e}function Cb(t){var e=bb(t.mapValue.fields.__local_write_time__.timestampValue);return new ub(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sb(t){return null==t}function xb(t){return 0===t&&1/t==-1/0}function Ob(t){return"number"==typeof t&&Number.isInteger(t)&&!xb(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pb(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ib(t)?4:10:F_()}function Ab(t,e){var n=Pb(t);if(n!==Pb(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Cb(t).isEqual(Cb(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=bb(t.timestampValue),r=bb(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Eb(t.bytesValue).isEqual(Eb(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return wb(t.geoPointValue.latitude)===wb(e.geoPointValue.latitude)&&wb(t.geoPointValue.longitude)===wb(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return wb(t.integerValue)===wb(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=wb(t.doubleValue),r=wb(e.doubleValue);return n===r?xb(n)===xb(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return z_(t.arrayValue.values||[],e.arrayValue.values||[],Ab);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(vb(n)!==vb(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ab(n[i],r[i])))return!1;return!0}(t,e);default:return F_()}}function Rb(t,e){return void 0!==(t.values||[]).find((function(t){return Ab(t,e)}))}function kb(t,e){var n=Pb(t),r=Pb(e);if(n!==r)return B_(n,r);switch(n){case 0:return 0;case 1:return B_(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=wb(t.integerValue||t.doubleValue),r=wb(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Nb(t.timestampValue,e.timestampValue);case 4:return Nb(Cb(t),Cb(e));case 5:return B_(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Eb(t),r=Eb(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=B_(n[i],r[i]);if(0!==o)return o}return B_(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=B_(wb(t.latitude),wb(e.latitude));return 0!==n?n:B_(wb(t.longitude),wb(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=kb(n[i],r[i]);if(o)return o}return B_(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=B_(r[s],o[s]);if(0!==a)return a;var u=kb(n[r[s]],i[o[s]]);if(0!==u)return u}return B_(r.length,o.length)}(t.mapValue,e.mapValue);default:throw F_()}}function Nb(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return B_(t,e);var n=bb(t),r=bb(e),i=B_(n.seconds,r.seconds);return 0!==i?i:B_(n.nanos,r.nanos)}function Db(t){return Lb(t)}function Lb(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=bb(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Eb(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,db.dt(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Lb(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Lb(t.fields[o])}return e+"}"}(t.mapValue):F_();var e,n}function Mb(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function Fb(t){return!!t&&"integerValue"in t}function jb(t){return!!t&&"arrayValue"in t}function Ub(t){return!!t&&"nullValue"in t}function Vb(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qb(t){return!!t&&"mapValue"in t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bb=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!qb(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return Ab(this.proto,t.proto)},t}(),zb=function(){function t(t){void 0===t&&(t=Bb.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Pb(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(pb.at(),this.Rt);return null!=t?new Bb(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=qb(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.gt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Wb(t){var e=[];return gb(t.fields||{},(function(t,n){var r=new pb([t]);if(qb(n)){var i=Wb(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new mb(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Kb=function(t,e){this.key=t,this.version=e},Gb=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Fh(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Kb),Hb=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Fh(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Kb),Xb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Kb),Yb=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.St=null};function Qb(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Yb(t,e,n,r,i,o,s)}function Jb(t){var e=U_(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.ot()+t.op.toString()+Db(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.ot()+t.dir}(t)})).join(","),Sb(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=hw(e.startAt)),e.endAt&&(n+="|ub:",n+=hw(e.endAt)),e.St=n}return e.St}function Zb(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!fw(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Ab(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dw(t.startAt,e.startAt)&&dw(t.endAt,e.endAt)}function $b(t){return db.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var tw=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Fh(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new ew(t,n,r):"array-contains"===n?new ow(t,r):"in"===n?new sw(t,r):"not-in"===n?new aw(t,r):"array-contains-any"===n?new uw(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new nw(t,n):new rw(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(kb(e,this.value)):null!==e&&Pb(this.value)===Pb(e)&&this.Ct(kb(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return F_()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),ew=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=db.dt(r.referenceValue),i}return Fh(e,t),e.prototype.matches=function(t){var e=db.J(t.key,this.key);return this.Ct(e)},e}(tw),nw=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=iw("in",n),r}return Fh(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(tw),rw=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=iw("not-in",n),r}return Fh(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(tw);function iw(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return db.dt(t.referenceValue)}))}var ow=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Fh(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return jb(e)&&Rb(e.arrayValue,this.value)},e}(tw),sw=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Fh(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Rb(this.value.arrayValue,e)},e}(tw),aw=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Fh(e,t),e.prototype.matches=function(t){if(Rb(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Rb(this.value.arrayValue,e)},e}(tw),uw=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Fh(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!jb(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Rb(e.value.arrayValue,t)}))},e}(tw),cw=function(t,e){this.position=t,this.before=e};function hw(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Db(t)})).join(",")}var lw=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function fw(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function pw(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ht()?db.J(db.dt(s.referenceValue),n.key):kb(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function dw(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ab(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var vw=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.Ot=null,this.Ft=null,this.startAt,this.endAt};function gw(t,e,n,r,i,o,s,a){return new vw(t,e,n,r,i,o,s,a)}function yw(t){return new vw(t)}function mw(t){return!Sb(t.limit)&&"F"===t.limitType}function _w(t){return!Sb(t.limit)&&"L"===t.limitType}function bw(t){return t.Nt.length>0?t.Nt[0].field:null}function ww(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function Ew(t){return null!==t.collectionGroup}function Iw(t){var e=U_(t);if(null===e.Ot){e.Ot=[];var n=ww(e),r=bw(e);if(null!==n&&null===r)n.ht()||e.Ot.push(new lw(n)),e.Ot.push(new lw(pb.lt(),"asc"));else{for(var i=!1,o=0,s=e.Nt;o<s.length;o++){var a=s[o];e.Ot.push(a),a.field.ht()&&(i=!0)}if(!i){var u=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ot.push(new lw(pb.lt(),u))}}}return e.Ot}function Tw(t){var e=U_(t);if(!e.Ft)if("F"===e.limitType)e.Ft=Qb(e.path,e.collectionGroup,Iw(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Iw(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new lw(o.field,s))}var a=e.endAt?new cw(e.endAt.position,!e.endAt.before):null,u=e.startAt?new cw(e.startAt.position,!e.startAt.before):null;e.Ft=Qb(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.Ft}function Cw(t,e,n){return new vw(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Sw(t,e){return Zb(Tw(t),Tw(e))&&t.limitType===e.limitType}function xw(t){return Jb(Tw(t))+"|lt:"+t.limitType}function Ow(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.ot()+" "+e.op+" "+Db(e.value);var e})).join(", ")+"]"),Sb(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+hw(t.startAt)),t.endAt&&(e+=", endAt: "+hw(t.endAt)),"Target("+e+")"}(Tw(t))+"; limitType="+t.limitType+")"}function Pw(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):db.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!pw(t.startAt,Iw(t),e)||t.endAt&&pw(t.endAt,Iw(t),e))}(t,e)}function Aw(t){return function(e,n){for(var r=!1,i=0,o=Iw(t);i<o.length;i++){var s=o[i],a=Rw(s,e,n);if(0!==a)return a;r=r||s.field.ht()}return 0}}function Rw(t,e,n){var r=t.field.ht()?db.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?kb(r,i):F_()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return F_()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var kw=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=cb.min()),void 0===o&&(o=cb.min()),void 0===s&&(s=K_.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Nw(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xb(e)?"-0":e}}function Dw(t){return{integerValue:""+t}}function Lw(t,e){return Ob(e)?Dw(e):Nw(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Mw=function(){this.Ut=void 0};function Fw(t,e,n){return t instanceof Vw?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof qw?Bw(t,e):t instanceof zw?Ww(t,e):function(t,e){var n=Uw(t,e),r=Gw(n)+Gw(t.Qt);return Fb(n)&&Fb(t.Qt)?Dw(r):Nw(t.Kt,r)}(t,e)}function jw(t,e,n){return t instanceof qw?Bw(t,e):t instanceof zw?Ww(t,e):n}function Uw(t,e){return t instanceof Kw?Fb(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Vw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e}(Mw),qw=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Fh(e,t),e}(Mw);function Bw(t,e){for(var n=Hw(e),r=function(t){n.some((function(e){return Ab(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var zw=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Fh(e,t),e}(Mw);function Ww(t,e){for(var n=Hw(e),r=function(t){n=n.filter((function(e){return!Ab(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Kw=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return Fh(e,t),e}(Mw);function Gw(t){return wb(t.integerValue||t.doubleValue)}function Hw(t){return jb(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xw=function(t,e){this.field=t,this.transform=e},Yw=function(t,e){this.version=t,this.transformResults=e},Qw=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.jt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Jw(t,e){return void 0!==t.updateTime?e instanceof Gb&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Gb}var Zw=function(){};function $w(t,e,n){return t instanceof iE?function(t,e,n){var r=t.value;if(n.transformResults){var i=aE(t.fieldTransforms,e,n.transformResults);r=cE(t.fieldTransforms,r,i)}return new Gb(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof oE?function(t,e,n){if(!Jw(t.Gt,e))return new Xb(t.key,n.version);var r=sE(t,e,n.transformResults?aE(t.fieldTransforms,e,n.transformResults):[]);return new Gb(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Hb(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function tE(t,e,n,r){return t instanceof iE?function(t,e,n,r){if(!Jw(t.Gt,e))return e;var i=t.value,o=uE(t.fieldTransforms,n,e);i=cE(t.fieldTransforms,i,o);var s=rE(e);return new Gb(t.key,s,i,{bt:!0})}(t,e,r):t instanceof oE?function(t,e,n,r){if(!Jw(t.Gt,e))return e;var i=rE(e),o=sE(t,e,uE(t.fieldTransforms,n,e));return new Gb(t.key,i,o,{bt:!0})}(t,e,r):function(t,e){return Jw(t.Gt,e)?new Hb(t.key,cb.min()):e}(t,e)}function eE(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Gb?e.field(o.field):void 0,a=Uw(o.transform,s||null);null!=a&&(n=null==n?(new zb).set(o.field,a):n.set(o.field,a))}return n?n.yt():null}(t.fieldTransforms,e)}function nE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&z_(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof qw&&e instanceof qw||t instanceof zw&&e instanceof zw?z_(t.elements,e.elements,Ab):t instanceof Kw&&e instanceof Kw?Ab(t.Qt,e.Qt):t instanceof Vw&&e instanceof Vw}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function rE(t){return t instanceof Gb?t.version:cb.min()}var iE=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return Fh(e,t),e}(Zw),oE=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.zt=r,s.Gt=i,s.fieldTransforms=o,s.type=1,s}return Fh(e,t),e}(Zw);function sE(t,e,n){var r;return r=function(t,e){var n=new zb(e);return t.zt.fields.forEach((function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.yt()}(t,r=e instanceof Gb?e.data():Bb.empty()),cE(t.fieldTransforms,r,n)}function aE(t,e,n){var r=[];j_(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof Gb&&(a=e.field(o.field)),r.push(jw(s,a,n[i]))}return r}function uE(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=null;n instanceof Gb&&(c=n.field(a.field)),i.push(Fw(u,c,e))}return i}function cE(t,e,n){for(var r=new zb(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}var hE,lE,fE=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return Fh(e,t),e}(Zw),pE=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return Fh(e,t),e}(Zw),dE=function(t){this.count=t};function vE(t){switch(t){case G_.OK:return F_();case G_.CANCELLED:case G_.UNKNOWN:case G_.DEADLINE_EXCEEDED:case G_.RESOURCE_EXHAUSTED:case G_.INTERNAL:case G_.UNAVAILABLE:case G_.UNAUTHENTICATED:return!1;case G_.INVALID_ARGUMENT:case G_.NOT_FOUND:case G_.ALREADY_EXISTS:case G_.PERMISSION_DENIED:case G_.FAILED_PRECONDITION:case G_.ABORTED:case G_.OUT_OF_RANGE:case G_.UNIMPLEMENTED:case G_.DATA_LOSS:return!0;default:return F_()}}function gE(t){if(void 0===t)return D_("GRPC error has no .code"),G_.UNKNOWN;switch(t){case hE.OK:return G_.OK;case hE.CANCELLED:return G_.CANCELLED;case hE.UNKNOWN:return G_.UNKNOWN;case hE.DEADLINE_EXCEEDED:return G_.DEADLINE_EXCEEDED;case hE.RESOURCE_EXHAUSTED:return G_.RESOURCE_EXHAUSTED;case hE.INTERNAL:return G_.INTERNAL;case hE.UNAVAILABLE:return G_.UNAVAILABLE;case hE.UNAUTHENTICATED:return G_.UNAUTHENTICATED;case hE.INVALID_ARGUMENT:return G_.INVALID_ARGUMENT;case hE.NOT_FOUND:return G_.NOT_FOUND;case hE.ALREADY_EXISTS:return G_.ALREADY_EXISTS;case hE.PERMISSION_DENIED:return G_.PERMISSION_DENIED;case hE.FAILED_PRECONDITION:return G_.FAILED_PRECONDITION;case hE.ABORTED:return G_.ABORTED;case hE.OUT_OF_RANGE:return G_.OUT_OF_RANGE;case hE.UNIMPLEMENTED:return G_.UNIMPLEMENTED;case hE.DATA_LOSS:return G_.DATA_LOSS;default:return F_()}}(lE=hE||(hE={}))[lE.OK=0]="OK",lE[lE.CANCELLED=1]="CANCELLED",lE[lE.UNKNOWN=2]="UNKNOWN",lE[lE.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lE[lE.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lE[lE.NOT_FOUND=5]="NOT_FOUND",lE[lE.ALREADY_EXISTS=6]="ALREADY_EXISTS",lE[lE.PERMISSION_DENIED=7]="PERMISSION_DENIED",lE[lE.UNAUTHENTICATED=16]="UNAUTHENTICATED",lE[lE.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lE[lE.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lE[lE.ABORTED=10]="ABORTED",lE[lE.OUT_OF_RANGE=11]="OUT_OF_RANGE",lE[lE.UNIMPLEMENTED=12]="UNIMPLEMENTED",lE[lE.INTERNAL=13]="INTERNAL",lE[lE.UNAVAILABLE=14]="UNAVAILABLE",lE[lE.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var yE=function(){function t(t,e){this.J=t,this.root=e||_E.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,_E.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,_E.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Zt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new mE(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new mE(this.root,t,this.J,!1)},t.prototype.se=function(){return new mE(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new mE(this.root,t,this.J,!0)},t}(),mE=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),_E=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw F_();if(this.right._e())throw F_();var t=this.left.me();if(t!==this.right.me())throw F_();return t+(this._e()?0:1)},t}();_E.EMPTY=null,_E.RED=!0,_E.Jt=!1,_E.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw F_()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw F_()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw F_()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw F_()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw F_()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new _E(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var bE=function(){function t(t){this.J=t,this.data=new yE(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt((function(e,n){return t(e),!1}))},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new wE(this.data.ee())},t.prototype.ne=function(t){return new wE(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),wE=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),EE=new yE(db.J);function IE(){return EE}function TE(){return IE()}var CE=new yE(db.J);function SE(){return CE}var xE=new yE(db.J);function OE(){return xE}var PE=new bE(db.J);function AE(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=PE,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var RE=new bE(B_);function kE(){return RE}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var NE=function(){function t(t){this.J=t?function(e,n){return t(e,n)||db.J(e.key,n.key)}:function(t,e){return db.J(t.key,e.key)},this.Ve=SE(),this.pe=new yE(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),DE=function(){function t(){this.ve=new yE(db.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):F_():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt((function(e,n){t.push(n)})),t},t}(),LE=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=s,this.Ne=a}return t.Oe=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,NE.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&Sw(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),ME=function(){function t(t,e,n,r,i){this.Mt=t,this.Fe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,FE.Be(e,n)),new t(cb.min(),r,kE(),IE(),AE())},t}(),FE=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(K_.h,n,AE(),AE(),AE())},t}(),jE=function(t,e,n,r){this.je=t,this.removedTargetIds=e,this.key=n,this.We=r},UE=function(t,e){this.targetId=t,this.Ge=e},VE=function(t,e,n,r){void 0===n&&(n=K_.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},qE=function(){function t(){this.ze=0,this.He=WE(),this.Je=K_.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=AE(),e=AE(),n=AE();return this.He.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:F_()}})),new FE(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=WE()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),BE=function(){function t(t){this.hn=t,this.ln=new Map,this._n=IE(),this.fn=zE(),this.dn=new bE(B_)}return t.prototype.wn=function(t){for(var e=0,n=t.je;e<n.length;e++){var r=n[e];t.We instanceof Gb?this.En(r,t.We):t.We instanceof Hb&&this.Tn(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.We)},t.prototype.In=function(t){var e=this;this.mn(t,(function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:F_()}}))},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach((function(t,r){n.Rn(r)&&e(r)}))},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if($b(i))if(0===n){var o=new db(i.path);this.Tn(e,o,new Hb(o,cb.min()))}else j_(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach((function(r,i){var o=e.gn(i);if(o){if(r.qe&&$b(o.target)){var s=new db(o.target.path);null!==e._n.get(s)||e.bn(i,s)||e.Tn(i,s,new Hb(s,t))}r.tn&&(n.set(i,r.nn()),r.sn())}}));var r=AE();this.fn.forEach((function(t,n){var i=!0;n.Re((function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new ME(t,n,this.dn,this._n,r);return this._n=IE(),this.fn=zE(),this.dn=new bE(B_),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new qE,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new bE(B_),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||N_("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new qE),this.hn.Sn(t).forEach((function(n){e.Tn(t,n,null)}))},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function zE(){return new yE(db.J)}function WE(){return new yE(db.J)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var KE={asc:"ASCENDING",desc:"DESCENDING"},GE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HE=function(t,e){this.T=t,this.qt=e};function XE(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function YE(t,e){return t.qt?e.toBase64():e.toUint8Array()}function QE(t,e){return XE(t,e.G())}function JE(t){return j_(!!t),cb.j(function(t){var e=bb(t);return new ub(e.seconds,e.nanos)}(t))}function ZE(t,e){return function(t){return new lb(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function $E(t){var e=lb.ct(t);return j_(II(e)),e}function tI(t,e){return ZE(t.T,e.path)}function eI(t,e){var n=$E(e);if(n.get(1)!==t.T.projectId)throw new H_(G_.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new H_(G_.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new db(oI(n))}function nI(t,e){return ZE(t.T,e)}function rI(t){var e=$E(t);return 4===e.length?lb.at():oI(e)}function iI(t){return new lb(["projects",t.T.projectId,"databases",t.T.database]).ot()}function oI(t){return j_(t.length>4&&"documents"===t.get(4)),t.X(5)}function sI(t,e,n){return{name:tI(t,e),fields:n.proto.mapValue.fields}}function aI(t,e,n){var r=eI(t,e.name),i=JE(e.updateTime),o=new Bb({mapValue:{fields:e.fields}});return new Gb(r,i,o,{hasCommittedMutations:!!n})}function uI(t,e){var n;if(e instanceof iE)n={update:sI(t,e.key,e.value)};else if(e instanceof fE)n={delete:tI(t,e.key)};else if(e instanceof oE)n={update:sI(t,e.key,e.data),updateMask:EI(e.zt)};else{if(!(e instanceof pE))return F_();n={verify:tI(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Vw)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof qw)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof zw)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof Kw)return{fieldPath:e.field.ot(),increment:n.Qt};throw F_()}(0,t)}))),e.Gt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:QE(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:F_()}(t,e.Gt)),n}function cI(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Qw.updateTime(JE(t.updateTime)):void 0!==t.exists?Qw.exists(t.exists):Qw.jt()}(e.currentDocument):Qw.jt(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)j_("REQUEST_TIME"===e.setToServerValue),n=new Vw;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new qw(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new zw(i)}else"increment"in e?n=new Kw(t,e.increment):F_();var o=pb._t(e.fieldPath);return new Xw(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=eI(t,e.update.name),o=new Bb({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new mb(e.map((function(t){return pb._t(t)})))}(e.updateMask);return new oE(i,o,s,n,r)}return new iE(i,o,n,r)}if(e.delete){var a=eI(t,e.delete);return new fE(a,n)}if(e.verify){var u=eI(t,e.verify);return new pE(u,n)}return F_()}function hI(t,e){return{documents:[nI(t,e.path)]}}function lI(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=nI(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=nI(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Vb(t.value))return{unaryFilter:{field:mI(t.field),op:"IS_NAN"}};if(Ub(t.value))return{unaryFilter:{field:mI(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Vb(t.value))return{unaryFilter:{field:mI(t.field),op:"IS_NOT_NAN"}};if(Ub(t.value))return{unaryFilter:{field:mI(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mI(t.field),op:yI(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:mI(t.field),direction:gI(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.qt||Sb(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=dI(e.startAt)),e.endAt&&(n.structuredQuery.endAt=dI(e.endAt)),n}function fI(t){var e=rI(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){j_(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=pI(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new lw(_I(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Sb(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=vI(n.startAt));var h=null;return n.endAt&&(h=vI(n.endAt)),gw(e,i,a,s,u,"F",c,h)}function pI(t){return t?void 0!==t.unaryFilter?[wI(t)]:void 0!==t.fieldFilter?[bI(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return pI(t)})).reduce((function(t,e){return t.concat(e)})):F_():[]}function dI(t){return{before:t.before,values:t.position}}function vI(t){var e=!!t.before,n=t.values||[];return new cw(n,e)}function gI(t){return KE[t]}function yI(t){return GE[t]}function mI(t){return{fieldPath:t.ot()}}function _I(t){return pb._t(t.fieldPath)}function bI(t){return tw.create(_I(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return F_()}}(t.fieldFilter.op),t.fieldFilter.value)}function wI(t){switch(t.unaryFilter.op){case"IS_NAN":var e=_I(t.unaryFilter.field);return tw.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=_I(t.unaryFilter.field);return tw.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=_I(t.unaryFilter.field);return tw.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=_I(t.unaryFilter.field);return tw.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return F_()}}function EI(t){var e=[];return t.fields.forEach((function(t){return e.push(t.ot())})),{fieldPaths:e}}function II(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var TI=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},CI=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.On=!1,t((function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)}),(function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.On&&F_(),this.On=!0,this.Nn?this.error?this.Fn(n,this.error):this.kn(e,this.result):new t((function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.Fn(n,e).next(t,i)}}))},t.prototype.Mn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln((function(){return e(n)})):t.resolve(n)},t.prototype.Fn=function(e,n){return e?this.Ln((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.$n=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.$n(r)},t}(),SI=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new TI,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new PI(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=DI(e.target.error);n.qn.reject(new PI(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new PI(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(N_("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new RI(e)},t}(),xI=function(){function t(e,n,r){this.name=e,this.version=n,this.Qn=r,12.2===t.Kn(el())&&D_("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return N_("SimpleDb","Removing database:",t),kI(window.indexedDB.deleteDatabase(t)).Mn()},t.jn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=el(),n=t.Kn(e),r=0<n&&n<10,i=t.Gn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.zn)},t.Hn=function(t,e){return t.store(e)},t.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Jn=function(t){return Uh(this,void 0,void 0,(function(){var e,n=this;return Vh(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(N_("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new PI(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new H_(G_.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new PI(t,n))},i.onupgradeneeded=function(t){N_("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Qn.Yn(e,i.transaction,t.oldVersion,n.version).next((function(){N_("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}}))}))},t.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i,o,s,a,u;return Vh(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Vh(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.Jn(t)];case 2:return a.db=l.sent(),e=SI.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),CI.reject(t)})).Mn(),u={},s.catch((function(){})),[4,e.Un];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,N_("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),OI=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return kI(this.ts.delete())},t}(),PI=function(t){function e(e,n){var r=this;return(r=t.call(this,G_.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Fh(e,t),e}(H_);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function AI(t){return"IndexedDbTransactionError"===t.name}var RI=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(N_("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(N_("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),kI(n)},t.prototype.add=function(t){return N_("SimpleDb","ADD",this.store.name,t,t),kI(this.store.add(t))},t.prototype.get=function(t){var e=this;return kI(this.store.get(t)).next((function(n){return void 0===n&&(n=null),N_("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return N_("SimpleDb","DELETE",this.store.name,t),kI(this.store.delete(t))},t.prototype.count=function(){return N_("SimpleDb","COUNT",this.store.name),kI(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.us=function(t,e){N_("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,(function(t,e,n){return n.delete()}))},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new CI((function(n,r){e.onerror=function(t){var e=DI(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.cs=function(t,e){var n=[];return new CI((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new OI(i),s=e(i.primaryKey,i.value,o);if(s instanceof CI){var a=s.catch((function(t){return o.done(),CI.reject(t)}));n.push(a)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}})).next((function(){return CI.$n(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function kI(t){return new CI((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=DI(t.target.error);n(e)}}))}var NI=!1;function DI(t){var e=xI.Kn(el());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new H_("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return NI||(NI=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var LI=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new TI,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch((function(t){}))}return t.Is=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.As=setTimeout((function(){return e.Rs()}),t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new H_(G_.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys((function(){return null!==t.As?(t.clearTimeout(),t.op().then((function(e){return t.Ts.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function MI(t,e){if(D_("AsyncQueue",e+": "+t),AI(t))return new H_(G_.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var FI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",jI=function(){function t(){this.gs=[]}return t.prototype.Vs=function(t){this.gs.push(t)},t.prototype.ps=function(){this.gs.forEach((function(t){return t()}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function UI(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=qI(e)),e=VI(t.get(n),e);return qI(e)}function VI(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function qI(t){return t+""}function BI(t){var e=t.length;if(j_(e>=2),2===e)return j_(""===t.charAt(0)&&""===t.charAt(1)),lb.at();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&F_(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:F_()}o=s+2}return new lb(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var zI=function(t,e){this.seconds=t,this.nanoseconds=e},WI=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};WI.store="owner",WI.key="owner";var KI=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};KI.store="mutationQueues",KI.keyPath="userId";var GI=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};GI.store="mutations",GI.keyPath="batchId",GI.userMutationsIndex="userMutationsIndex",GI.userMutationsKeyPath=["userId","batchId"];var HI=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,UI(e)]},t.key=function(t,e,n){return[t,UI(e),n]},t}();HI.store="documentMutations",HI.PLACEHOLDER=new HI;var XI=function(t,e){this.path=t,this.readTime=e},YI=function(t,e){this.path=t,this.version=e},QI=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};QI.store="remoteDocuments",QI.readTimeIndex="readTimeIndex",QI.readTimeIndexPath="readTime",QI.collectionReadTimeIndex="collectionReadTimeIndex",QI.collectionReadTimeIndexPath=["parentPath","readTime"];var JI=function(t){this.byteSize=t};JI.store="remoteDocumentGlobal",JI.key="remoteDocumentGlobalKey";var ZI=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};ZI.store="targets",ZI.keyPath="targetId",ZI.queryTargetsIndexName="queryTargetsIndex",ZI.queryTargetsKeyPath=["canonicalId","targetId"];var $I=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};$I.store="targetDocuments",$I.keyPath=["targetId","path"],$I.documentTargetsIndex="documentTargetsIndex",$I.documentTargetsKeyPath=["path","targetId"];var tT=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};tT.key="targetGlobalKey",tT.store="targetGlobal";var eT=function(t,e){this.collectionId=t,this.parent=e};eT.store="collectionParents",eT.keyPath=["collectionId","parent"];var nT=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};nT.store="clientMetadata",nT.keyPath="clientId";var rT=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};rT.store="bundles",rT.keyPath="bundleId";var iT=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};iT.store="namedQueries",iT.keyPath="name";var oT=Wh(Wh(Wh(Wh([KI.store,GI.store,HI.store,QI.store,ZI.store,WI.store,tT.store,$I.store],[nT.store]),[JI.store]),[eT.store]),[rT.store,iT.store]),sT=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bs=e,r.vs=n,r}return Fh(e,t),e}(jI);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function aT(t,e){var n=U_(t);return xI.Hn(n.bs,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var uT=function(){function t(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ds=function(t,e,n){for(var r=n.Cs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=$w(o,e,r[i]))}return e},t.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=tE(s,e,0,this.Ss));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=tE(s,e,0,this.Ss))}return e},t.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),AE())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&z_(this.mutations,t.mutations,(function(t,e){return nE(t,e)}))&&z_(this.baseMutations,t.baseMutations,(function(t,e){return nE(t,e)}))},t}(),cT=function(){function t(t,e,n,r){this.batch=t,this.Os=e,this.Cs=n,this.Fs=r}return t.from=function(e,n,r){j_(e.mutations.length===r.length);for(var i=OE(),o=e.mutations,s=0;s<o.length;s++)i=i.Ht(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),hT=function(t){this.ks=t};function lT(t,e){if(e.document)return aI(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=db.Tt(e.noDocument.path),r=gT(e.noDocument.readTime);return new Hb(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=db.Tt(e.unknownDocument.path);return r=gT(e.unknownDocument.version),new Xb(i,r)}return F_()}function fT(t,e,n){var r=pT(n),i=e.key.path.Z().rt();if(e instanceof Gb){var o=function(t,e){return{name:tI(t,e.key),fields:e.vt().mapValue.fields,updateTime:XE(t,e.version.G())}}(t.ks,e),s=e.hasCommittedMutations;return new QI(null,null,o,s,r,i)}if(e instanceof Hb){var a=e.key.path.rt(),u=vT(e.version);return s=e.hasCommittedMutations,new QI(null,new XI(a,u),null,s,r,i)}if(e instanceof Xb){var c=e.key.path.rt(),h=vT(e.version);return new QI(new YI(c,h),null,null,!0,r,i)}return F_()}function pT(t){var e=t.G();return[e.seconds,e.nanoseconds]}function dT(t){var e=new ub(t[0],t[1]);return cb.j(e)}function vT(t){var e=t.G();return new zI(e.seconds,e.nanoseconds)}function gT(t){var e=new ub(t.seconds,t.nanoseconds);return cb.j(e)}function yT(t,e){for(var n=(e.baseMutations||[]).map((function(e){return cI(t.ks,e)})),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map((function(e){return cI(t.ks,e)})),s=ub.fromMillis(e.localWriteTimeMs);return new uT(e.batchId,s,n,o)}function mT(t){var e,n,r=gT(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?gT(t.lastLimboFreeSnapshotVersion):cb.min();return void 0!==t.query.documents?(j_(1===(n=t.query).documents.length),e=Tw(yw(rI(n.documents[0])))):e=function(t){return Tw(fI(t))}(t.query),new kw(e,t.targetId,0,t.lastListenSequenceNumber,r,i,K_.fromBase64String(t.resumeToken))}function _T(t,e){var n,r=vT(e.Mt),i=vT(e.lastLimboFreeSnapshotVersion);n=$b(e.target)?hI(t.ks,e.target):lI(t.ks,e.target);var o=e.resumeToken.toBase64();return new ZI(e.targetId,Jb(e.target),r,o,e.sequenceNumber,i,n)}function bT(t){var e=fI({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Cw(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wT=function(){function t(){}return t.prototype.Ms=function(t,e){return ET(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:gT(e.createTime),version:e.version};var e}))},t.prototype.Ls=function(t,e){return ET(t).put({bundleId:(n=e).id,createTime:vT(JE(n.createTime)),version:n.version});var n},t.prototype.$s=function(t,e){return IT(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:bT(e.bundledQuery),readTime:gT(e.readTime)};var e}))},t.prototype.Bs=function(t,e){return IT(t).put(function(t){return{name:t.name,readTime:vT(JE(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function ET(t){return aT(t,rT.store)}function IT(t){return aT(t,iT.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var TT=function(){function t(){this.qs=new CT}return t.prototype.Us=function(t,e){return this.qs.add(e),CI.resolve()},t.prototype.Qs=function(t,e){return CI.resolve(this.qs.getEntries(e))},t}(),CT=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new bE(lb.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new bE(lb.J)).rt()},t}(),ST=function(){function t(){this.Ks=new CT}return t.prototype.Us=function(t,e){var n=this;if(!this.Ks.has(e)){var r=e.et(),i=e.Z();t.Vs((function(){n.Ks.add(e)}));var o={collectionId:r,parent:UI(i)};return xT(t).put(o)}return CI.resolve()},t.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[W_(e),""],!1,!0);return xT(t).os(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(BI(o.parent))}return n}))},t}();function xT(t){return aT(t,eT.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var OT={js:!1,Ws:0,Gs:0,zs:0},PT=function(){function t(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}return t.Xs=function(e){return new t(e,t.Zs,t.ti)},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function AT(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){if(t.code!==G_.FAILED_PRECONDITION||t.message!==FI)throw t;return N_("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */PT.Zs=10,PT.ti=1e3,PT.ei=new PT(41943040,PT.Zs,PT.ti),PT.ni=new PT(-1,0,0);var RT=function(){function t(t,e){this.si=t,this.ii=e,this.ri={}}return t.prototype.get=function(t){var e=this.si(t),n=this.ri[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.ii(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){gb(this.ri,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.nt=function(){return yb(this.ri)},t}(),kT=function(){function t(){this.oi=new RT((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.ci=!1}return t.prototype.ai=function(t){var e=this.oi.get(t);return e?e.readTime:cb.min()},t.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},t.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},t.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?CI.resolve(n.li):this.di(t,e)},t.prototype.getEntries=function(t,e){return this.wi(t,e)},t.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},t.prototype.hi=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function NT(t,e,n){var r=t.store(GI.store),i=t.store(HI.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.ls({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){j_(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=HI.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return CI.$n(o).next((function(){return c}))}function DT(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw F_();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var LT=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}return t.Ai=function(e,n,r,i){return j_(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return FT(t).ls({index:GI.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Pi=function(t,e,n,r){var i=this,o=jT(t),s=FT(t);return s.add({}).next((function(a){j_("number"==typeof a);for(var u=new uT(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return uI(t.ks,e)})),i=n.mutations.map((function(e){return uI(t.ks,e)}));return new GI(e,n.batchId,n.Ss.toMillis(),r,i)}(i.Kt,i.userId,u),h=[],l=new bE((function(t,e){return B_(t.ot(),e.ot())})),f=0,p=r;f<p.length;f++){var d=p[f],v=HI.key(i.userId,d.key.path,a);l=l.add(d.key.path.Z()),h.push(s.put(c)),h.push(o.put(v,HI.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ti.Us(t,e))})),t.Vs((function(){i.mi[a]=u.keys()})),CI.$n(h).next((function(){return u}))}))},t.prototype.yi=function(t,e){var n=this;return FT(t).get(e).next((function(t){return t?(j_(t.userId===n.userId),yT(n.Kt,t)):null}))},t.prototype.gi=function(t,e){var n=this;return this.mi[e]?CI.resolve(this.mi[e]):this.yi(t,e).next((function(t){if(t){var r=t.keys();return n.mi[e]=r,r}return null}))},t.prototype.Vi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return FT(t).ls({index:GI.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(j_(e.batchId>=r),o=yT(n.Kt,e)),i.done()})).next((function(){return o}))},t.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return FT(t).ls({index:GI.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return FT(t).os(GI.userMutationsIndex,n).next((function(t){return t.map((function(t){return yT(e.Kt,t)}))}))},t.prototype.vi=function(t,e){var n=this,r=HI.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return jT(t).ls({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=BI(u);if(a===n.userId&&e.path.isEqual(h))return FT(t).get(c).next((function(t){if(!t)throw F_();j_(t.userId===n.userId),o.push(yT(n.Kt,t))}));s.done()})).next((function(){return o}))},t.prototype.Si=function(t,e){var n=this,r=new bE(B_),i=[];return e.forEach((function(e){var o=HI.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=jT(t).ls({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=BI(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),CI.$n(i).next((function(){return n.Di(t,r)}))},t.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=HI.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new bE(B_);return jT(t).ls({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=BI(u);s===n.userId&&r.st(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Di(t,a)}))},t.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(FT(t).get(e).next((function(t){if(null===t)throw F_();j_(t.userId===n.userId),r.push(yT(n.Kt,t))})))})),CI.$n(i).next((function(){return r}))},t.prototype.xi=function(t,e){var n=this;return NT(t.bs,this.userId,e).next((function(r){return t.Vs((function(){n.Ni(e.batchId)})),CI.forEach(r,(function(e){return n.Ii.Oi(t,e)}))}))},t.prototype.Ni=function(t){delete this.mi[t]},t.prototype.Fi=function(t){var e=this;return this.Ri(t).next((function(n){if(!n)return CI.resolve();var r=IDBKeyRange.lowerBound(HI.prefixForUser(e.userId)),i=[];return jT(t).ls({range:r},(function(t,n,r){if(t[0]===e.userId){var o=BI(t[1]);i.push(o)}else r.done()})).next((function(){j_(0===i.length)}))}))},t.prototype.ki=function(t,e){return MT(t,this.userId,e)},t.prototype.Mi=function(t){var e=this;return UT(t).get(this.userId).next((function(t){return t||new KI(e.userId,-1,"")}))},t}();function MT(t,e,n){var r=HI.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return jT(t).ls({range:o,hs:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function FT(t){return aT(t,GI.store)}function jT(t){return aT(t,HI.store)}function UT(t){return aT(t,KI.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var VT=function(){function t(t){this.Li=t}return t.prototype.next=function(){return this.Li+=2,this.Li},t.$i=function(){return new t(0)},t.Bi=function(){return new t(-1)},t}(),qT=function(){function t(t,e){this.Ii=t,this.Kt=e}return t.prototype.qi=function(t){var e=this;return this.Ui(t).next((function(n){var r=new VT(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Ki=function(t){return this.Ui(t).next((function(t){return cb.j(new ub(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.ji=function(t){return this.Ui(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Wi=function(t,e,n){var r=this;return this.Ui(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)}))},t.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next((function(){return n.Ui(t).next((function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)}))}))},t.prototype.Ji=function(t,e){return this.zi(t,e)},t.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next((function(){return BT(t).delete(e.targetId)})).next((function(){return n.Ui(t)})).next((function(e){return j_(e.targetCount>0),e.targetCount-=1,n.Qi(t,e)}))},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return BT(t).ls((function(s,a){var u=mT(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.Yi(t,u)))})).next((function(){return CI.$n(o)})).next((function(){return i}))},t.prototype.mn=function(t,e){return BT(t).ls((function(t,n){var r=mT(n);e(r)}))},t.prototype.Ui=function(t){return zT(t).get(tT.key).next((function(t){return j_(null!==t),t}))},t.prototype.Qi=function(t,e){return zT(t).put(tT.key,e)},t.prototype.zi=function(t,e){return BT(t).put(_T(this.Kt,e))},t.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tr=function(t){return this.Ui(t).next((function(t){return t.targetCount}))},t.prototype.er=function(t,e){var n=Jb(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return BT(t).ls({range:r,index:ZI.queryTargetsIndexName},(function(t,n,r){var o=mT(n);Zb(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.nr=function(t,e,n){var r=this,i=[],o=WT(t);return e.forEach((function(e){var s=UI(e.path);i.push(o.put(new $I(n,s))),i.push(r.Ii.sr(t,n,e))})),CI.$n(i)},t.prototype.ir=function(t,e,n){var r=this,i=WT(t);return CI.forEach(e,(function(e){var o=UI(e.path);return CI.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])}))},t.prototype.Xi=function(t,e){var n=WT(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.cr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=WT(t),i=AE();return r.ls({range:n,hs:!0},(function(t,e,n){var r=BI(t[1]),o=new db(r);i=i.add(o)})).next((function(){return i}))},t.prototype.ki=function(t,e){var n=UI(e.path),r=IDBKeyRange.bound([n],[W_(n)],!1,!0),i=0;return WT(t).ls({index:$I.documentTargetsIndex,hs:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Dn=function(t,e){return BT(t).get(e).next((function(t){return t?mT(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function BT(t){return aT(t,ZI.store)}function zT(t){return aT(t,tT.store)}function WT(t){return aT(t,$I.store)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function KT(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=B_(n,i);return 0===s?B_(r,o):s}var GT=function(){function t(t){this.ar=t,this.buffer=new bE(KT),this.ur=0}return t.prototype.hr=function(){return++this.ur},t.prototype.lr=function(t){var e=[t,this.hr()];if(this.buffer.size<this.ar)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();KT(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),HT=function(){function t(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}return t.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},t.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(t.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),t.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;N_("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,(function(){return Uh(e,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return AI(e=n.sent())?(N_("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,AT(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),XT=function(){function t(t,e){this.Ar=t,this.params=e}return t.prototype.Rr=function(t,e){return this.Ar.Pr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.yr=function(t,e){var n=this;if(0===e)return CI.resolve(ab.U);var r=new GT(e);return this.Ar.mn(t,(function(t){return r.lr(t.sequenceNumber)})).next((function(){return n.Ar.gr(t,(function(t){return r.lr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},t.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},t.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(N_("LruGarbageCollector","Garbage collection skipped; disabled"),CI.resolve(OT)):this.br(t).next((function(r){return r<n.params.Hs?(N_("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),OT):n.vr(t,e)}))},t.prototype.br=function(t){return this.Ar.br(t)},t.prototype.vr=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.Rr(t,this.params.Js).next((function(e){return e>c.params.Ys?(N_("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Ys+" from "+e),r=c.params.Ys):r=e,o=Date.now(),c.yr(t,r)})).next((function(r){return n=r,s=Date.now(),c.Zi(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.Vr(t,n)})).next((function(t){return u=Date.now(),k_()<=Fl.DEBUG&&N_("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),CI.resolve({js:!0,Ws:r,Gs:i,zs:t})}))},t}(),YT=function(){function t(t,e){this.db=t,this._r=function(t,e){return new XT(t,e)}(this,e)}return t.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Sr=function(t){var e=0;return this.gr(t,(function(t){e++})).next((function(){return e}))},t.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},t.prototype.gr=function(t,e){return this.Cr(t,(function(t,n){return e(n)}))},t.prototype.sr=function(t,e,n){return QT(t,n)},t.prototype.rr=function(t,e,n){return QT(t,n)},t.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},t.prototype.Oi=function(t,e){return QT(t,e)},t.prototype.Nr=function(t,e){return function(t,e){var n=!1;return UT(t)._s((function(r){return MT(t,r,e).next((function(t){return t&&(n=!0),CI.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.Vr=function(t,e){var n=this,r=this.db.Fr().Or(),i=[],o=0;return this.Cr(t,(function(s,a){if(a<=e){var u=n.Nr(t,s).next((function(e){if(!e)return o++,r.fi(t,s).next((function(){return r._i(s),WT(t).delete([0,UI(s.path)])}))}));i.push(u)}})).next((function(){return CI.$n(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.vs);return this.db.Dr().Ji(t,n)},t.prototype.kr=function(t,e){return QT(t,e)},t.prototype.Cr=function(t,e){var n,r=WT(t),i=ab.U;return r.ls({index:$I.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==ab.U&&e(new db(BI(n)),i),i=a,n=s):i=ab.U})).next((function(){i!==ab.U&&e(new db(BI(n)),i)}))},t.prototype.br=function(t){return this.db.Fr().Mr(t)},t}();function QT(t,e){return WT(t).put(function(t,e){return new $I(0,UI(t.path),e)}(e,t.vs))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var JT=function(){function t(t,e){this.Kt=t,this.Ti=e}return t.prototype.ui=function(t,e,n){return tC(t).put(eC(e),n)},t.prototype._i=function(t,e){var n=tC(t),r=eC(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Lr(t,r)}))},t.prototype.fi=function(t,e){var n=this;return tC(t).get(eC(e)).next((function(t){return n.$r(t)}))},t.prototype.Br=function(t,e){var n=this;return tC(t).get(eC(e)).next((function(t){var e=n.$r(t);return e?{li:e,size:DT(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=TE();return this.qr(t,e,(function(t,e){var i=n.$r(e);r=r.Ht(t,i)})).next((function(){return r}))},t.prototype.Ur=function(t,e){var n=this,r=TE(),i=new yE(db.J);return this.qr(t,e,(function(t,e){var o=n.$r(e);o?(r=r.Ht(t,o),i=i.Ht(t,DT(e))):(r=r.Ht(t,null),i=i.Ht(t,0))})).next((function(){return{Qr:r,Kr:i}}))},t.prototype.qr=function(t,e,n){if(e.nt())return CI.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return tC(t).ls({range:r},(function(t,e,r){for(var s=db.Tt(t);o&&db.J(o,s)<0;)n(o,null),o=i.ce();o&&o.isEqual(s)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ae()?i.ce():null}))},t.prototype.jr=function(t,e,n){var r=this,i=SE(),o=e.path.length+1,s={};if(n.isEqual(cb.min())){var a=e.path.rt();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.rt(),c=pT(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=QI.collectionReadTimeIndex}return tC(t).ls(s,(function(t,n,s){if(t.length===o){var a=lT(r.Kt,n);e.path.st(a.key.path)?a instanceof Gb&&Pw(e,a)&&(i=i.Ht(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.Or=function(t){return new ZT(this,!!t&&t.Wr)},t.prototype.Mr=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return $T(t).get(JI.key).next((function(t){return j_(!!t),t}))},t.prototype.Lr=function(t,e){return $T(t).put(JI.key,e)},t.prototype.$r=function(t){if(t){var e=lT(this.Kt,t);return e instanceof Hb&&e.version.isEqual(cb.min())?null:e}return null},t}(),ZT=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Gr=e,r.Wr=n,r.zr=new RT((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Fh(e,t),e.prototype.Ei=function(t){var e=this,n=[],r=0,i=new bE((function(t,e){return B_(t.ot(),e.ot())}));return this.oi.forEach((function(o,s){var a=e.zr.get(o);if(s.li){var u=fT(e.Gr.Kt,s.li,e.ai(o));i=i.add(o.path.Z());var c=DT(u);r+=c-a,n.push(e.Gr.ui(t,o,u))}else if(r-=a,e.Wr){var h=fT(e.Gr.Kt,new Hb(o,cb.min()),e.ai(o));n.push(e.Gr.ui(t,o,h))}else n.push(e.Gr._i(t,o))})),i.forEach((function(r){n.push(e.Gr.Ti.Us(t,r))})),n.push(this.Gr.updateMetadata(t,r)),CI.$n(n)},e.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next((function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)}))},e.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next((function(t){var e=t.Qr;return t.Kr.forEach((function(t,e){n.zr.set(t,e)})),e}))},e}(kT);function $T(t){return aT(t,JI.store)}function tC(t){return aT(t,QI.store)}function eC(t){return t.path.rt()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var nC=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;j_(n<r&&n>=0&&r<=11);var o=new SI("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(WI.store)}(t),function(t){t.createObjectStore(KI.store,{keyPath:KI.keyPath}),t.createObjectStore(GI.store,{keyPath:GI.keyPath,autoIncrement:!0}).createIndex(GI.userMutationsIndex,GI.userMutationsKeyPath,{unique:!0}),t.createObjectStore(HI.store)}(t),rC(t),function(t){t.createObjectStore(QI.store)}(t));var s=CI.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore($I.store),t.deleteObjectStore(ZI.store),t.deleteObjectStore(tT.store)}(t),rC(t)),s=s.next((function(){return function(t){var e=t.store(tT.store),n=new tT(0,0,cb.min().G(),0);return e.put(tT.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(GI.store).os().next((function(n){t.deleteObjectStore(GI.store),t.createObjectStore(GI.store,{keyPath:GI.keyPath,autoIncrement:!0}).createIndex(GI.userMutationsIndex,GI.userMutationsKeyPath,{unique:!0});var r=e.store(GI.store),i=n.map((function(t){return r.put(t)}));return CI.$n(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(nT.store,{keyPath:nT.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Hr(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(JI.store)}(t),i.Jr(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.Yr(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Xr(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(QI.store);e.createIndex(QI.readTimeIndex,QI.readTimeIndexPath,{unique:!1}),e.createIndex(QI.collectionReadTimeIndex,QI.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Zr(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(rT.store,{keyPath:rT.keyPath})}(t),function(t){t.createObjectStore(iT.store,{keyPath:iT.keyPath})}(t)}))),s},t.prototype.Jr=function(t){var e=0;return t.store(QI.store).ls((function(t,n){e+=DT(n)})).next((function(){var n=new JI(e);return t.store(JI.store).put(JI.key,n)}))},t.prototype.Hr=function(t){var e=this,n=t.store(KI.store),r=t.store(GI.store);return n.os().next((function(n){return CI.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(GI.userMutationsIndex,i).next((function(r){return CI.forEach(r,(function(r){j_(r.userId===n.userId);var i=yT(e.Kt,r);return NT(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.Yr=function(t){var e=t.store($I.store),n=t.store(QI.store);return t.store(tT.store).get(tT.key).next((function(t){var r=[];return n.ls((function(n,i){var o=new lb(n),s=function(t){return[0,UI(t)]}(o);r.push(e.get(s).next((function(n){return n?CI.resolve():function(n){return e.put(new $I(0,UI(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return CI.$n(r)}))}))},t.prototype.Xr=function(t,e){t.createObjectStore(eT.store,{keyPath:eT.keyPath});var n=e.store(eT.store),r=new CT,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:UI(i)})}};return e.store(QI.store).ls({hs:!0},(function(t,e){var n=new lb(t);return i(n.Z())})).next((function(){return e.store(HI.store).ls({hs:!0},(function(t,e){t[0];var n=t[1],r=(t[2],BI(n));return i(r.Z())}))}))},t.prototype.Zr=function(t){var e=this,n=t.store(ZI.store);return n.ls((function(t,r){var i=mT(r),o=_T(e.Kt,i);return n.put(o)}))},t}();function rC(t){t.createObjectStore($I.store,{keyPath:$I.keyPath}).createIndex($I.documentTargetsIndex,$I.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(ZI.store,{keyPath:ZI.keyPath}).createIndex(ZI.queryTargetsIndexName,ZI.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(tT.store)}var iC="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",oC=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.eo=o,this.window=s,this.document=a,this.no=c,this.so=h,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!t.jn())throw new H_(G_.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new YT(this,i),this.lo=n+"main",this.Kt=new hT(u),this._o=new xI(this.lo,11,new nC(this.Kt)),this.fo=new qT(this.Ii,this.Kt),this.Ti=new ST,this.wo=function(t,e){return new JT(t,e)}(this.Kt,this.Ti),this.Eo=new wT,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===h&&D_("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Io().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new H_(G_.FAILED_PRECONDITION,iC);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.fo.ji(e)}))})).then((function(e){t.io=new ab(e,t.no)})).then((function(){t.ro=!0})).catch((function(e){return t._o&&t._o.close(),Promise.reject(e)}))},t.prototype.Po=function(t){var e=this;return this.ho=function(n){return Uh(e,void 0,void 0,(function(){return Vh(this,(function(e){return this.Tr?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.yo=function(t){var e=this;this._o.Zn((function(n){return Uh(e,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys((function(){return Uh(e,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return aC(e).put(new nT(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.po(e).next((function(e){e||(t.isPrimary=!1,t.eo.bo((function(){return t.ho(!1)})))}))})).next((function(){return t.vo(e)})).next((function(n){return t.isPrimary&&!n?t.So(e).next((function(){return!1})):!!n&&t.Do(e).next((function(){return!0}))}))})).catch((function(e){if(AI(e))return N_("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return N_("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.eo.bo((function(){return t.ho(e)})),t.isPrimary=e}))},t.prototype.po=function(t){var e=this;return sC(t).get(WI.key).next((function(t){return CI.resolve(e.Co(t))}))},t.prototype.xo=function(t){return aC(t).delete(this.clientId)},t.prototype.No=function(){return Uh(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Vh(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.Oo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=aT(t,nT.store);return e.os().next((function(t){var n=i.Fo(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return CI.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.To)for(e=0,n=t;e<n.length;e++)r=n[e],this.To.removeItem(this.ko(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,(function(){return t.Io().then((function(){return t.No()})).then((function(){return t.Ro()}))}))},t.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.vo=function(t){var e=this;return this.so?CI.resolve(!0):sC(t).get(WI.key).next((function(n){if(null!==n&&e.Oo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new H_(G_.FAILED_PRECONDITION,iC);return!1}}return!(!e.networkEnabled||!e.inForeground)||aC(t).os().next((function(t){return void 0===e.Fo(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&N_("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.Lo=function(){return Uh(this,void 0,void 0,(function(){var t=this;return Vh(this,(function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[WI.store,nT.store],(function(e){var n=new sT(e,ab.U);return t.So(n).next((function(){return t.xo(n)}))}))];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}}))}))},t.prototype.Fo=function(t,e){var n=this;return t.filter((function(t){return n.Oo(t.updateTimeMs,e)&&!n.Mo(t.clientId)}))},t.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return aC(e).os().next((function(e){return t.Fo(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.Ko=function(t){return LT.Ai(t,this.Kt,this.Ti,this.Ii)},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.jo=function(){return this.Ti},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;N_("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this._o.runTransaction(t,o,oT,(function(o){return i=new sT(o,r.io?r.io.next():ab.U),"readwrite-primary"===e?r.po(i).next((function(t){return!!t||r.vo(i)})).next((function(e){if(!e)throw D_("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.eo.bo((function(){return r.ho(!1)})),new H_(G_.FAILED_PRECONDITION,FI);return n(i)})).next((function(t){return r.Do(i).next((function(){return t}))})):r.Go(i).next((function(){return n(i)}))})).then((function(t){return i.ps(),t}))},t.prototype.Go=function(t){var e=this;return sC(t).get(WI.key).next((function(t){if(null!==t&&e.Oo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new H_(G_.FAILED_PRECONDITION,iC)}))},t.prototype.Do=function(t){var e=new WI(this.clientId,this.allowTabSynchronization,Date.now());return sC(t).put(WI.key,e)},t.jn=function(){return xI.jn()},t.prototype.So=function(t){var e=this,n=sC(t);return n.get(WI.key).next((function(t){return e.Co(t)?(N_("IndexedDbPersistence","Releasing primary lease."),n.delete(WI.key)):CI.resolve()}))},t.prototype.Oo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(D_("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys((function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()}))},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},t.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys((function(){return e.Lo()}))},this.window.addEventListener("unload",this.oo))},t.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},t.prototype.Mo=function(t){var e;try{var n=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return N_("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return D_("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){D_("Failed to set zombie client id.",t)}},t.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},t.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function sC(t){return aT(t,WI.store)}function aC(t){return aT(t,nT.store)}function uC(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var cC=function(t,e){this.progress=t,this.zo=e},hC=function(){function t(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next((function(r){return n.Yo(t,e,r)}))},t.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t}))},t.prototype.Xo=function(t,e,n){var r=TE();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)})),r},t.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next((function(e){return n.tc(t,e)}))},t.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next((function(r){var i=n.Xo(t,e,r),o=IE();return i.forEach((function(t,e){e||(e=new Hb(t,cb.min())),o=o.Ht(t,e)})),o}))},t.prototype.jr=function(t,e,n){return function(t){return db.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):Ew(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new db(e)).next((function(t){var e=SE();return t instanceof Gb&&(e=e.Ht(t.key,t)),e}))},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=SE();return this.Ti.Qs(t,i).next((function(s){return CI.forEach(s,(function(s){var a=function(t,e){return new vw(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.sc(t,a,n).next((function(t){t.forEach((function(t,e){o=o.Ht(t,e)}))}))})).next((function(){return o}))}))},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.jr(t,e,n).next((function(n){return r=n,o.Ho.Ci(t,e)})).next((function(e){return i=e,o.ic(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=tE(u,r.get(c),0,o.Ss);r=h instanceof Gb?r.Ht(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){Pw(e,n)||(r=r.remove(t))})),r}))},t.prototype.ic=function(t,e,n){for(var r=AE(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof oE&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.wo.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Gb&&(c=c.Ht(t,e))})),c}))},t}(),lC=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=AE(),i=AE(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),fC=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.jr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(e)||n.isEqual(cb.min())?this.hc(t,e):this.uc.Zo(t,r).next((function(o){var s=i.lc(e,o);return(mw(e)||_w(e))&&i._c(e.limitType,s,r,n)?i.hc(t,e):(k_()<=Fl.DEBUG&&N_("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ow(e)),i.uc.jr(t,e,n).next((function(t){return s.forEach((function(e){t=t.Ht(e.key,e)})),t})))}))},t.prototype.lc=function(t,e){var n=new bE(Aw(t));return e.forEach((function(e,r){r instanceof Gb&&Pw(t,r)&&(n=n.add(r))})),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,e){return k_()<=Fl.DEBUG&&N_("QueryEngine","Using full collection scan to execute query:",Ow(e)),this.uc.jr(t,e,cb.min())},t}(),pC=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new yE(B_),this.wc=new RT((function(t){return Jb(t)}),Zb),this.Ec=cb.min(),this.Ho=t.Ko(n),this.Tc=t.Fr(),this.fo=t.Dr(),this.Ic=new hC(this.Tc,this.Ho,this.persistence.jo()),this.Eo=t.Wo(),this.fc.ac(this.Ic)}return t.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.pr(n,e.dc)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function dC(t,e,n,r){return new pC(t,e,n,r)}function vC(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o;return Vh(this,(function(s){switch(s.label){case 0:return n=U_(t),r=n.Ho,i=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Ho.bi(t).next((function(s){return o=s,r=n.persistence.Ko(e),i=new hC(n.Tc,r,n.persistence.jo()),r.bi(t)})).next((function(e){for(var n=[],r=[],s=AE(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];s=s.add(m.key)}}return i.Zo(t,s).next((function(t){return{mc:t,Ac:n,Rc:r}}))}))}))];case 1:return o=s.sent(),[2,(n.Ho=r,n.Ic=i,n.fc.ac(n.Ic),o)]}}))}))}function gC(t,e){var n=U_(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Tc.Or({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=CI.resolve();return o.forEach((function(t){s=s.next((function(){return r.fi(e,t)})).next((function(e){var o=e,s=n.Fs.get(t);j_(null!==s),(!o||o.version.u(s)<0)&&(o=i.Ds(t,o,n))&&r.ui(o,n.Os)}))})),s.next((function(){return t.Ho.xi(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Ho.Fi(t)})).next((function(){return n.Ic.Zo(t,r)}))}))}function yC(t){var e=U_(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.fo.Ki(t)}))}function mC(t,e){var n=U_(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Tc.Or({Wr:!0});i=n.dc;var s=[];e.Fe.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.fo.ir(t,e.Ke,o).next((function(){return n.fo.nr(t,e.Ue,o)})));var u=e.resumeToken;if(u.o()>0){var c=a.$t(u,r).Lt(t.vs);i=i.Ht(o,c),function(t,e,n){return j_(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.W()-t.Mt.W()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(a,c,e)&&s.push(n.fo.Ji(t,c))}}}));var a=IE();if(e.Me.forEach((function(r,i){e.Le.has(r)&&s.push(n.persistence.Ii.kr(t,r))})),s.push(_C(t,o,e.Me,r,void 0).next((function(t){a=t}))),!r.isEqual(cb.min())){var u=n.fo.Ki(t).next((function(e){return n.fo.Wi(t,t.vs,r)}));s.push(u)}return CI.$n(s).next((function(){return o.apply(t)})).next((function(){return n.Ic.tc(t,a)}))})).then((function(t){return n.dc=i,t}))}function _C(t,e,n,r,i){var o=AE();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=IE();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s instanceof Hb&&s.version.isEqual(cb.min())?(e._i(n,u),o=o.Ht(n,s)):null==a||s.version.u(a.version)>0||0===s.version.u(a.version)&&a.hasPendingWrites?(e.ui(s,u),o=o.Ht(n,s)):N_("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}function bC(t,e){var n=U_(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Ho.Vi(t,e)}))}function wC(t,e){var n=U_(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.fo.er(t,e).next((function(i){return i?(r=i,CI.resolve(r)):n.fo.qi(t).next((function(i){return r=new kw(e,i,0,t.vs),n.fo.Gi(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t}))}function EC(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s;return Vh(this,(function(a){switch(a.label){case 0:r=U_(t),i=r.dc.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.Ii.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!AI(s=a.sent()))throw s;return N_("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(i.target),[2]}}))}))}function IC(t,e,n){var r=U_(t),i=cb.min(),o=AE();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=U_(t),i=r.wc.get(n);return void 0!==i?CI.resolve(r.dc.get(i)):r.fo.er(e,n)}(r,t,Tw(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.fc.jr(t,e,n?i:cb.min(),n?o:AE())})).next((function(t){return{documents:t,Pc:o}}))}))}function TC(t,e){var n=U_(t),r=U_(n.fo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Dn(t,e).next((function(t){return t?t.target:null}))}))}function CC(t){var e=U_(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=U_(t),i=IE(),o=pT(n),s=tC(e),a=IDBKeyRange.lowerBound(o,!0);return s.ls({index:QI.readTimeIndex,range:a},(function(t,e){var n=lT(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime})).next((function(){return{zo:i,readTime:dT(o)}}))}(e.Tc,t,e.Ec)})).then((function(t){var n=t.zo,r=t.readTime;return e.Ec=r,n}))}function SC(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){return[2,(e=U_(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=tC(t),n=cb.min();return e.ls({index:QI.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=dT(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Ec=t}))]}))}))}function xC(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i,o,s,a,u,c,h,l,f,p;return Vh(this,(function(d){switch(d.label){case 0:for(i=U_(t),o=AE(),s=IE(),a=OE(),u=0,c=n;u<c.length;u++)h=c[u],l=e.yc(h.metadata.name),h.document&&(o=o.add(l)),s=s.Ht(l,e.gc(h)),a=a.Ht(l,e.Vc(h.metadata.readTime));return f=i.Tc.Or({Wr:!0}),[4,wC(i,function(t){return Tw(yw(lb.ct("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return _C(t,f,s,cb.min(),a).next((function(e){return f.apply(t),e})).next((function(e){return i.fo.Xi(t,p.targetId).next((function(){return i.fo.nr(t,o,p.targetId)})).next((function(){return i.Ic.tc(t,e)}))}))}))]}}))}))}function OC(t,e,n){return void 0===n&&(n=AE()),Uh(this,void 0,void 0,(function(){var r,i;return Vh(this,(function(o){switch(o.label){case 0:return[4,wC(t,Tw(bT(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=U_(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=JE(e.readTime);if(r.Mt.u(o)>=0)return i.Eo.Bs(t,e);var s=r.$t(K_.h,o);return i.dc=i.dc.Ht(s.targetId,s),i.fo.Ji(t,s).next((function(){return i.fo.Xi(t,r.targetId)})).next((function(){return i.fo.nr(t,n,r.targetId)})).next((function(){return i.Eo.Bs(t,e)}))}))]}}))}))
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var PC=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ms=function(t,e){return CI.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:JE(n.createTime)}),CI.resolve()},t.prototype.$s=function(t,e){return CI.resolve(this.vc.get(e))},t.prototype.Bs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:bT(t.bundledQuery),readTime:JE(t.readTime)}}(e)),CI.resolve()},t}(),AC=function(){function t(){this.Sc=new bE(RC.Dc),this.Cc=new bE(RC.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.sr=function(t,e){var n=new RC(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach((function(t){return n.sr(t,e)}))},t.prototype.rr=function(t,e){this.Oc(new RC(t,e))},t.prototype.Fc=function(t,e){var n=this;t.forEach((function(t){return n.rr(t,e)}))},t.prototype.kc=function(t){var e=this,n=new db(new lb([])),r=new RC(n,t),i=new RC(n,t+1),o=[];return this.Cc.Ae([r,i],(function(t){e.Oc(t),o.push(t.key)})),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach((function(e){return t.Oc(e)}))},t.prototype.Oc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new db(new lb([])),n=new RC(e,t),r=new RC(e,t+1),i=AE();return this.Cc.Ae([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.ki=function(t){var e=new RC(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),RC=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return db.J(t.key,e.key)||B_(t.$c,e.$c)},t.xc=function(t,e){return B_(t.$c,e.$c)||db.J(t.key,e.key)},t}(),kC=function(){function t(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new bE(RC.Dc)}return t.prototype.Ri=function(t){return CI.resolve(0===this.Ho.length)},t.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,this.Ho.length>0&&this.Ho[this.Ho.length-1];var o=new uT(i,e,n,r);this.Ho.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.qc=this.qc.add(new RC(u.key,i)),this.Ti.Us(t,u.key.path.Z())}return CI.resolve(o)},t.prototype.yi=function(t,e){return CI.resolve(this.Uc(e))},t.prototype.Vi=function(t,e){var n=e+1,r=this.Qc(n),i=r<0?0:r;return CI.resolve(this.Ho.length>i?this.Ho[i]:null)},t.prototype.pi=function(){return CI.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.bi=function(t){return CI.resolve(this.Ho.slice())},t.prototype.vi=function(t,e){var n=this,r=new RC(e,0),i=new RC(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],(function(t){var e=n.Uc(t.$c);o.push(e)})),CI.resolve(o)},t.prototype.Si=function(t,e){var n=this,r=new bE(B_);return e.forEach((function(t){var e=new RC(t,0),i=new RC(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],(function(t){r=r.add(t.$c)}))})),CI.resolve(this.Kc(r))},t.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,i=n;db.Et(i)||(i=i.child(""));var o=new RC(new db(i),0),s=new bE(B_);return this.qc.Re((function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(s=s.add(t.$c)),!0)}),o),CI.resolve(this.Kc(s))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Uc(t);null!==r&&n.push(r)})),n},t.prototype.xi=function(t,e){var n=this;j_(0===this.jc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return CI.forEach(e.mutations,(function(i){var o=new RC(i.key,e.batchId);return r=r.delete(o),n.Ii.Oi(t,i.key)})).next((function(){n.qc=r}))},t.prototype.Ni=function(t){},t.prototype.ki=function(t,e){var n=new RC(e,0),r=this.qc.Pe(n);return CI.resolve(e.isEqual(r&&r.key))},t.prototype.Fi=function(t){return this.Ho.length,CI.resolve()},t.prototype.jc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),NC=function(){function t(t,e){this.Ti=t,this.Wc=e,this.docs=new yE(db.J),this.size=0}return t.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.Ht(r,{li:e,size:s,readTime:n}),this.size+=s-o,this.Ti.Us(t,r.path.Z())},t.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.fi=function(t,e){var n=this.docs.get(e);return CI.resolve(n?n.li:null)},t.prototype.getEntries=function(t,e){var n=this,r=TE();return e.forEach((function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)})),CI.resolve(r)},t.prototype.jr=function(t,e,n){for(var r=SE(),i=new db(e.path.child("")),o=this.docs.ne(i);o.ae();){var s=o.ce(),a=s.key,u=s.value,c=u.li,h=u.readTime;if(!e.path.st(a.path))break;h.u(n)<=0||c instanceof Gb&&Pw(e,c)&&(r=r.Ht(c.key,c))}return CI.resolve(r)},t.prototype.Gc=function(t,e){return CI.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Or=function(t){return new DC(this)},t.prototype.Mr=function(t){return CI.resolve(this.size)},t}(),DC=function(t){function e(e){var n=this;return(n=t.call(this)||this).Gr=e,n}return Fh(e,t),e.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach((function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)})),CI.$n(n)},e.prototype.di=function(t,e){return this.Gr.fi(t,e)},e.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},e}(kT),LC=function(){function t(t){this.persistence=t,this.zc=new RT((function(t){return Jb(t)}),Zb),this.lastRemoteSnapshotVersion=cb.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new AC,this.targetCount=0,this.Yc=VT.$i()}return t.prototype.mn=function(t,e){return this.zc.forEach((function(t,n){return e(n)})),CI.resolve()},t.prototype.Ki=function(t){return CI.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ji=function(t){return CI.resolve(this.Hc)},t.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),CI.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),CI.resolve()},t.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new VT(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,CI.resolve()},t.prototype.Ji=function(t,e){return this.zi(e),CI.resolve()},t.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,CI.resolve()},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.zc.delete(s),o.push(r.Xi(t,a.targetId)),i++)})),CI.$n(o).next((function(){return i}))},t.prototype.tr=function(t){return CI.resolve(this.targetCount)},t.prototype.er=function(t,e){var n=this.zc.get(e)||null;return CI.resolve(n)},t.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),CI.resolve()},t.prototype.ir=function(t,e,n){this.Jc.Fc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach((function(e){i.push(r.Oi(t,e))})),CI.$n(i)},t.prototype.Xi=function(t,e){return this.Jc.kc(e),CI.resolve()},t.prototype.cr=function(t,e){var n=this.Jc.Lc(e);return CI.resolve(n)},t.prototype.ki=function(t,e){return CI.resolve(this.Jc.ki(e))},t}(),MC=function(){function t(t,e){var n=this;this.Xc={},this.io=new ab(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new LC(this),this.Ti=new TT,this.wo=function(t,e){return new NC(t,(function(t){return n.Ii.Zc(t)}))}(this.Ti),this.Kt=new hT(e),this.Eo=new PC(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.yo=function(){},t.prototype.Vo=function(){},t.prototype.jo=function(){return this.Ti},t.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new kC(this.Ti,this.Ii),this.Xc[t.R()]=e),e},t.prototype.Dr=function(){return this.fo},t.prototype.Fr=function(){return this.wo},t.prototype.Wo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;N_("MemoryPersistence","Starting transaction:",t);var i=new FC(this.io.next());return this.Ii.ta(),n(i).next((function(t){return r.Ii.ea(i).next((function(){return t}))})).Mn().then((function(t){return i.ps(),t}))},t.prototype.na=function(t,e){return CI.Bn(Object.values(this.Xc).map((function(n){return function(){return n.ki(t,e)}})))},t}(),FC=function(t){function e(e){var n=this;return(n=t.call(this)||this).vs=e,n}return Fh(e,t),e}(jI),jC=function(){function t(t){this.persistence=t,this.sa=new AC,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw F_()},enumerable:!1,configurable:!0}),t.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),CI.resolve()},t.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),CI.resolve()},t.prototype.Oi=function(t,e){return this.oa.add(e.toString()),CI.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach((function(t){return n.oa.add(t.toString())}));var r=this.persistence.Dr();return r.cr(t,e.targetId).next((function(t){t.forEach((function(t){return n.oa.add(t.toString())}))})).next((function(){return r.Yi(t,e)}))},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.Fr().Or();return CI.forEach(this.oa,(function(r){var i=db.ft(r);return e.ca(t,i).next((function(t){t||n._i(i)}))})).next((function(){return e.ia=null,n.apply(t)}))},t.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next((function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())}))},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return CI.Bn([function(){return CI.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function UC(t,e){return"firestore_clients_"+t+"_"+e}function VC(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function qC(t,e){return"firestore_targets_"+t+"_"+e}var BC=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new H_(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(D_("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),zC=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new H_(r.error.code,r.error.message)),i?new t(e,r.state,o):(D_("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),WC=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=kE(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ob(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(D_("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),KC=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(D_("SharedClientState","Failed to parse online state: "+e),null)},t}(),GC=function(){function t(){this.activeTargetIds=kE()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),HC=function(){function t(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new yE(B_),this.Tr=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=UC(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new GC),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.jn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Uh(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return Vh(this,(function(f){switch(f.label){case 0:return[4,this.fa.Qo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(i=this.getItem(UC(this.persistenceKey,r)))&&(o=WC.aa(r,i))&&(this.Ta=this.Ta.Ht(o.clientId,o));for(this.pa(),(s=this.storage.getItem(this.ga))&&(a=this.ba(s))&&this.va(a),u=0,c=this.Ia;u<c.length;u++)h=c[u],this.Ea(h);return this.Ia=[],this.window.addEventListener("unload",(function(){return l.Lo()})),this.Tr=!0,[2]}}))}))},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Oa=function(t,e,n){this.Na(t,e,n),this.Fa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(qC(this.persistenceKey,t));if(n){var r=zC.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(qC(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach((function(t){r.Fa(t)})),this.currentUser=t,n.forEach((function(t){r.xa(t)}))},t.prototype.Ka=function(t){this.ja(t)},t.prototype.Wa=function(){this.Ga()},t.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return N_("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){N_("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){N_("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(N_("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void D_("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo((function(){return Uh(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Vh(this,(function(a){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(i=this.Za(n.key,n.newValue)))return[2,this.tu(i)]}else if(n.key===this.ga){if(null!==n.newValue&&(o=this.ba(n.newValue)))return[2,this.va(o)]}else if(n.key===this.Aa)(s=function(t){var e=ab.U;if(null!=t)try{var n=JSON.parse(t);j_("number"==typeof n),e=n}catch(t){D_("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==ab.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new BC(this.currentUser,t,e,n),i=VC(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Fa=function(t){var e=VC(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ja=function(t){var e={clientId:this._a,onlineState:t};this.storage.setItem(this.ga,JSON.stringify(e))},t.prototype.Ua=function(t,e,n){var r=qC(this.persistenceKey,t),i=new zC(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return WC.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return BC.aa(new eb(i),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return zC.aa(r,e)},t.prototype.ba=function(t){return KC.aa(t)},t.prototype.Xa=function(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(N_("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.fa.iu(s,a).then((function(){n.Ta=r}))},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=kE();return t.forEach((function(t,n){e=e.ye(n.activeTargetIds)})),e},t}(),XC=function(){function t(){this.ru=new GC,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Oa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new GC,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.Lo=function(){},t.prototype.q=function(t){},t.prototype.Wa=function(){},t}(),YC=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.Lo=function(){},t}(),QC=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){N_("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){N_("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.jn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),JC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ZC=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),$C=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return Fh(e,t),e.prototype.Du=function(t,e,n,r){return new Promise((function(i,o){var s=new A_;s.listenOnce(C_.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case T_.NO_ERROR:var e=s.getResponseJson();N_("Connection","XHR received:",JSON.stringify(e)),i(e);break;case T_.TIMEOUT:N_("Connection",'RPC "'+t+'" timed out'),o(new H_(G_.DEADLINE_EXCEEDED,"Request time out"));break;case T_.HTTP_ERROR:var n=s.getStatus();if(N_("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(G_).indexOf(e)>=0?e:G_.UNKNOWN}(r.status);o(new H_(a,r.message))}else o(new H_(G_.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new H_(G_.UNAVAILABLE,"Connection failed."));break;default:F_()}}finally{N_("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.xu=function(t,e){var n=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new __,i=wy(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(o.initMessageHeaders,e),nl()||ol()||el().indexOf("Electron/")>=0||function(){var t=el();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||el().indexOf("MSAppHost/")>=0||il()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");N_("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new ZC({du:function(t){c?N_("Connection","Not sending because WebChannel is closed:",t):(u||(N_("Connection","Opening WebChannel transport."),a.open(),u=!0),N_("Connection","WebChannel sending:",t),a.send(t))},wu:function(){return a.close()}}),l=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(a,P_.EventType.OPEN,(function(){c||N_("Connection","WebChannel transport opened.")})),l(a,P_.EventType.CLOSE,(function(){c||(c=!0,N_("Connection","WebChannel transport closed"),h.Pu())})),l(a,P_.EventType.ERROR,(function(t){c||(c=!0,L_("Connection","WebChannel transport errored:",t),h.Pu(new H_(G_.UNAVAILABLE,"The operation could not be completed")))})),l(a,P_.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];j_(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){N_("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=hE[t];if(void 0!==e)return gE(e)}(o),u=i.message;void 0===s&&(s=G_.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),c=!0,h.Pu(new H_(s,u)),a.close()}else N_("Connection","WebChannel received:",n),h.yu(n)}})),l(i,S_.STAT_EVENT,(function(t){t.stat===x_?N_("Connection","Detected buffering proxy"):t.stat===O_&&N_("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Ru()}),0),h},e}(function(){function t(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);N_("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then((function(t){return N_("RestConnection","Received: ",t),t}),(function(e){throw L_("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.2",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){var n=JC[t];return this.Vu+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function tS(){return"undefined"!=typeof window?window:null}function eS(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function nS(t){return new HE(t,!0)}var rS=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Ou=r,this.Fu=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Fu},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&N_("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,(function(){return e.Lu=Date.now(),t()})),this.ku*=this.Ou,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Fu&&(this.ku=this.Fu)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),iS=function(){function t(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.ju=i,this.listener=o,this.state=0,this.Wu=0,this.Gu=null,this.stream=null,this.zu=new rS(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,(function(){return t.th()})))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){return this.Ju()?[2,this.close(0)]:[2]}))}))},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.Wu++,3!==t?this.zu.reset():e&&e.code===G_.RESOURCE_EXHAUSTED?(D_(e.toString()),D_("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===G_.UNAUTHENTICATED&&this.ju.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.Wu),n=this.Wu;this.ju.getToken().then((function(e){t.Wu===n&&t.rh(e)}),(function(n){e((function(){var e=new H_(G_.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)}))}))},t.prototype.rh=function(t){var e=this,n=this.ih(this.Wu);this.stream=this.ah(t),this.stream.Eu((function(){n((function(){return e.state=2,e.listener.Eu()}))})),this.stream.Iu((function(t){n((function(){return e.oh(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu((function(){return Uh(t,void 0,void 0,(function(){return Vh(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.oh=function(t){return N_("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.eo.ys((function(){return e.Wu===t?n():(N_("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),oS=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,s}return Fh(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:F_()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(j_(void 0===e||"string"==typeof e),K_.fromBase64String(e||"")):(j_(void 0===e||e instanceof Uint8Array),K_.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?G_.UNKNOWN:gE(t.code);return new H_(e,t.message||"")}(a);n=new VE(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=eI(t,r.document.name),o=JE(r.document.updateTime);var a=new Bb({mapValue:{fields:r.document.fields}}),u=(s=new Gb(i,o,a,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new jE(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=eI(t,r.document),o=r.readTime?JE(r.readTime):cb.min(),a=new Hb(i,o),s=r.removedTargetIds||[],n=new jE([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=eI(t,r.document),o=r.removedTargetIds||[],n=new jE([],o,i,null);else{if(!("filter"in e))return F_();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new dE(r),o=h.targetId,n=new UE(o,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return cb.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?cb.min():e.readTime?JE(e.readTime):cb.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=iI(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=$b(r)?{documents:hI(t,r)}:{query:lI(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=YE(t,e.resumeToken):e.Mt.u(cb.min())>0&&(n.readTime=XE(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return F_()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(this.Kt,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=iI(this.Kt),e.removeTarget=t,this.eh(e)},e}(iS),sS=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,s._h=!1,s}return Fh(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(j_(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(j_(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?JE(t.updateTime):JE(e);n.isEqual(cb.min())&&(n=JE(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Yw(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=JE(t.commitTime);return this.listener.wh(n,e)}return j_(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=iI(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return uI(e.Kt,t)}))};this.eh(n)},e}(iS),aS=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return Fh(e,t),e.prototype.mh=function(){if(this.Ih)throw new H_(G_.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then((function(i){return r.Ku.bu(t,e,n,i)})).catch((function(t){throw t.code===G_.UNAUTHENTICATED&&r.credentials.v(),t}))},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then((function(i){return r.Ku.Cu(t,e,n,i)})).catch((function(t){throw t.code===G_.UNAUTHENTICATED&&r.credentials.v(),t}))},e.prototype.terminate=function(){this.Ih=!1},e}((function(){})),uS=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,(function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()})))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(D_(e),this.Ph=!1):N_("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),cS=function(t,e,n,r,i){var o=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Oh=new Set,this.Fh=[],this.kh=i,this.kh.cu((function(t){n.ys((function(){return Uh(o,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return mS(this)?(N_("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return(e=U_(t)).Oh.add(4),[4,lS(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Oh.delete(4),[4,hS(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Mh=new uS(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function hS(t){return Uh(this,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:if(!mS(t))return[3,4];e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function lS(t){return Uh(this,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:e=0,n=t.Fh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function fS(t,e){var n=U_(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),yS(n)?gS(n):NS(n).Ju()&&dS(n,e))}function pS(t,e){var n=U_(t),r=NS(n);n.Nh.delete(e),r.Ju()&&vS(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():mS(n)&&n.Mh.set("Unknown"))}function dS(t,e){t.Lh.cn(e.targetId),NS(t).hh(e)}function vS(t,e){t.Lh.cn(e),NS(t).lh(e)}function gS(t){t.Lh=new BE({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),NS(t).start(),t.Mh.yh()}function yS(t){return mS(t)&&!NS(t).Hu()&&t.Nh.size>0}function mS(t){return 0===U_(t).Oh.size}function _S(t){t.Lh=void 0}function bS(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){return t.Nh.forEach((function(e,n){dS(t,e)})),[2]}))}))}function wS(t,e){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(n){return _S(t),yS(t)?(t.Mh.ph(e),gS(t)):t.Mh.set("Unknown"),[2]}))}))}function ES(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o;return Vh(this,(function(s){switch(s.label){case 0:if(t.Mh.set("Online"),!(e instanceof VE&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o;return Vh(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.Nh.has(o)?[4,t.Ch.$h(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.Nh.delete(o),t.Lh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),N_("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,IS(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof jE?t.Lh.wn(e):e instanceof UE?t.Lh.yn(e):t.Lh.In(e),n.isEqual(cb.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,yC(t.Sh)];case 8:return i=s.sent(),n.u(i)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Fe.forEach((function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}})),n.ke.forEach((function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(K_.h,n.Mt)),vS(t,e);var r=new kw(n.target,e,1,n.sequenceNumber);dS(t,r)}})),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return N_("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,IS(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function IS(t,e,n){return Uh(this,void 0,void 0,(function(){var r=this;return Vh(this,(function(i){switch(i.label){case 0:if(!AI(e))throw e;return t.Oh.add(1),[4,lS(t)];case 1:return i.sent(),t.Mh.set("Offline"),n||(n=function(){return yC(t.Sh)}),t.fs.bo((function(){return Uh(r,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return N_("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Oh.delete(1),[4,hS(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function TS(t,e){return e().catch((function(n){return IS(t,n,e)}))}function CS(t){return Uh(this,void 0,void 0,(function(){var e,n,r,i,o;return Vh(this,(function(s){switch(s.label){case 0:e=U_(t),n=DS(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return mS(t)&&t.xh.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,bC(e.Sh,r)];case 3:return null===(i=s.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=i.batchId,function(t,e){t.xh.push(e);var n=DS(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,IS(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return SS(e)&&xS(e),[2]}}))}))}function SS(t){return mS(t)&&!DS(t).Hu()&&t.xh.length>0}function xS(t){DS(t).start()}function OS(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){return DS(t).Th(),[2]}))}))}function PS(t){return Uh(this,void 0,void 0,(function(){var e,n,r,i;return Vh(this,(function(o){for(e=DS(t),n=0,r=t.xh;n<r.length;n++)i=r[n],e.dh(i.mutations);return[2]}))}))}function AS(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i;return Vh(this,(function(o){switch(o.label){case 0:return r=t.xh.shift(),i=cT.from(r,e,n),[4,TS(t,(function(){return t.Ch.qh(i)}))];case 1:return o.sent(),[4,CS(t)];case 2:return o.sent(),[2]}}))}))}function RS(t,e){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(n){switch(n.label){case 0:return e&&DS(t).fh?[4,function(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return vE(r=e.code)&&r!==G_.ABORTED?(n=t.xh.shift(),DS(t).Xu(),[4,TS(t,(function(){return t.Ch.Uh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,CS(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return SS(t)&&xS(t),[2]}}))}))}function kS(t,e){return Uh(this,void 0,void 0,(function(){var n;return Vh(this,(function(r){switch(r.label){case 0:return n=U_(t),e?(n.Oh.delete(2),[4,hS(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Oh.add(2),[4,lS(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function NS(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=U_(t);return r.mh(),new oS(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:bS.bind(null,t),Iu:wS.bind(null,t),uh:ES.bind(null,t)}),t.Fh.push((function(n){return Uh(e,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),yS(t)?gS(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),_S(t),e.label=3;case 3:return[2]}}))}))}))),t.Qh}function DS(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=U_(t);return r.mh(),new sS(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:OS.bind(null,t),Iu:RS.bind(null,t),Eh:PS.bind(null,t),wh:AS.bind(null,t)}),t.Fh.push((function(n){return Uh(e,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,CS(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(N_("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kh
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var LS=function(){this.jh=void 0,this.listeners=[]},MS=function(){this.queries=new RT((function(t){return xw(t)}),Sw),this.onlineState="Unknown",this.Wh=new Set};function FS(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Vh(this,(function(c){switch(c.label){case 0:if(n=U_(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new LS),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.Gh(r)];case 2:return s.jh=c.sent(),[3,4];case 3:return a=c.sent(),u=MI(a,"Initialization of query '"+Ow(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zh(n.onlineState),o.jh&&e.Hh(o.jh)&&qS(n),[2]}}))}))}function jS(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s;return Vh(this,(function(a){return n=U_(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Jh(r))]:[2]}))}))}function US(t,e){for(var n=U_(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hh(s)&&(r=!0);u.jh=s}}r&&qS(n)}function VS(t,e,n){var r=U_(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function qS(t){t.Wh.forEach((function(t){t.next()}))}var BS=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new LE(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){if(t.docChanges.length>0)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=LE.Oe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),zS=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),WS=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return eI(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?aI(this.Kt,t.document,!1):new Hb(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return JE(t)},t}(),KS=function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=GS(t)}return t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new WS(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.yc(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||AE()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Uh(this,void 0,void 0,(function(){var t,e,n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return[4,xC(this.Sh,new WS(this.Kt),this.documents,this.rl.id)];case 1:t=o.sent(),e=this.cl(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,OC(this.Sh,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new cC(Object.assign({},this.progress),t))]}}))}))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function GS(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var HS=function(t){this.key=t},XS=function(t){this.key=t},YS=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=AE(),this.Ce=AE(),this.ll=Aw(t),this._l=new NE(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new DE,i=e?e._l:this._l,o=e?e.Ce:this.Ce,s=i,a=!1,u=mw(this.query)&&i.size===this.query.limit?i.last():null,c=_w(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt((function(t,e){var h=i.get(t),l=e instanceof Gb?e:null;l&&(l=Pw(n.query,l)?l:null);var f=!!h&&n.Ce.has(h.key),p=!!l&&(l.bt||n.Ce.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:3,doc:l}),d=!0):n.El(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.ll(l,u)>0||c&&n.ll(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),mw(this.query)||_w(this.query))for(;s.size>this.query.limit;){var h=mw(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{_l:s,wl:r,_c:a,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F_()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)})),this.Tl(n);var s=e?this.Il():[],a=0===this.hl.size&&this.qe?1:0,u=a!==this.ul;return this.ul=a,0!==o.length||u?{snapshot:new LE(this.query,t._l,i,o,t.Ce,0===a,u,!1),ml:s}:{ml:s}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new DE,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach((function(t){return e.al=e.al.add(t)})),t.Qe.forEach((function(t){})),t.Ke.forEach((function(t){return e.al=e.al.delete(t)})),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=AE(),this._l.forEach((function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))}));var n=[];return e.forEach((function(e){t.hl.has(e)||n.push(new XS(e))})),this.hl.forEach((function(t){e.has(t)||n.push(new HS(t))})),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=AE();var e=this.dl(t.documents);return this.Ei(e,!0)},t.prototype.Pl=function(){return LE.Oe(this.query,this._l,this.Ce,0===this.ul)},t}(),QS=function(t,e,n){this.query=t,this.targetId=e,this.view=n},JS=function(t){this.key=t,this.yl=!1},ZS=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new RT((function(t){return xw(t)}),Sw),this.Dl=new Map,this.Cl=[],this.xl=new yE(db.J),this.Nl=new Map,this.Ol=new AC,this.Fl={},this.kl=new Map,this.Ml=VT.Bi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function $S(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return n=Ox(t),(o=n.Sl.get(e))?(r=o.targetId,n.pl.ka(r),i=o.view.Pl(),[3,4]):[3,1];case 1:return[4,wC(n.Sh,Tw(e))];case 2:return s=u.sent(),a=n.pl.ka(s.targetId),r=s.targetId,[4,tx(n,e,r,"current"===a)];case 3:i=u.sent(),n.$l&&fS(n.gl,s),u.label=4;case 4:return[2,i]}}))}))}function tx(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Vh(this,(function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i,o,s;return Vh(this,(function(a){switch(a.label){case 0:return(i=e.view.dl(n))._c?[4,IC(t.Sh,e.query,!1).then((function(t){var n=t.documents;return e.view.dl(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.Fe.get(e.targetId),s=e.view.Ei(i,t.$l,o),[2,(px(t,e.targetId,s.ml),s.snapshot)]}}))}))}(t,e,n,r)},[4,IC(t.Sh,e,!0)];case 1:return i=h.sent(),o=new YS(e,i.Pc),s=o.dl(i.documents),a=FE.Be(n,r&&"Offline"!==t.onlineState),u=o.Ei(s,t.$l,a),px(t,n,u.ml),c=new QS(e,n,o),[2,(t.Sl.set(e,c),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),u.snapshot)]}}))}))}function ex(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return n=U_(t),r=n.Sl.get(e),(i=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,i.filter((function(t){return!Sw(t,e)}))),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,EC(n.Sh,r.targetId,!1).then((function(){n.pl.Ba(r.targetId),pS(n.gl,r.targetId),lx(n,r.targetId)})).catch(AT)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return lx(n,r.targetId),[4,EC(n.Sh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function nx(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s;return Vh(this,(function(a){switch(a.label){case 0:r=Px(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=U_(t),i=ub.now(),o=e.reduce((function(t,e){return t.add(e.key)}),AE());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Ic.Zo(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=eE(c,n.get(c.key));null!=h&&s.push(new oE(c.key,h,Wb(h.proto.mapValue),Qw.exists(!0)))}return r.Ho.Pi(t,i,s,e)}))})).then((function(t){var e=t.Ns(n);return{batchId:t.batchId,oi:e}}))}(r.Sh,e)];case 2:return i=a.sent(),r.pl.xa(i.batchId),function(t,e,n){var r=t.Fl[t.currentUser.R()];r||(r=new yE(B_)),r=r.Ht(e,n),t.Fl[t.currentUser.R()]=r}(r,i.batchId,n),[4,gx(r,i.oi)];case 3:return a.sent(),[4,CS(r.gl)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=MI(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function rx(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:n=U_(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,mC(n.Sh,e)];case 2:return r=i.sent(),e.Fe.forEach((function(t,e){var r=n.Nl.get(e);r&&(j_(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?j_(r.yl):t.Ke.size>0&&(j_(r.yl),r.yl=!1))})),[4,gx(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,AT(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function ix(t,e,n){var r=U_(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach((function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=U_(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)})),r&&qS(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function ox(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Vh(this,(function(c){switch(c.label){case 0:return(r=U_(t)).pl.qa(e,"rejected",n),i=r.Nl.get(e),(o=i&&i.key)?(s=(s=new yE(db.J)).Ht(o,new Hb(o,cb.min())),a=AE().add(o),u=new ME(cb.min(),new Map,new bE(B_),s,a),[4,rx(r,u)]):[3,2];case 1:return c.sent(),r.xl=r.xl.remove(o),r.Nl.delete(e),vx(r),[3,4];case 2:return[4,EC(r.Sh,e,!1).then((function(){return lx(r,e,n)})).catch(AT)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function sx(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i;return Vh(this,(function(o){switch(o.label){case 0:n=U_(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,gC(n.Sh,e)];case 2:return i=o.sent(),hx(n,r,null),cx(n,r),n.pl.Oa(r,"acknowledged"),[4,gx(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,AT(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ax(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i;return Vh(this,(function(o){switch(o.label){case 0:r=U_(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=U_(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Ho.yi(t,e).next((function(e){return j_(null!==e),r=e.keys(),n.Ho.xi(t,e)})).next((function(){return n.Ho.Fi(t)})).next((function(){return n.Ic.Zo(t,r)}))}))}(r.Sh,e)];case 2:return i=o.sent(),hx(r,e,n),cx(r,e),r.pl.Oa(e,"rejected",n),[4,gx(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,AT(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ux(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s;return Vh(this,(function(a){switch(a.label){case 0:mS((n=U_(t)).gl)||N_("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=U_(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Ho.pi(t)}))}(n.Sh)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.kl.get(r)||[]).push(e),n.kl.set(r,i),[3,4]);case 3:return o=a.sent(),s=MI(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function cx(t,e){(t.kl.get(e)||[]).forEach((function(t){t.resolve()})),t.kl.delete(e)}function hx(t,e,n){var r=U_(t),i=r.Fl[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Fl[r.currentUser.R()]=i}}function lx(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Ol.kc(e).forEach((function(e){t.Ol.ki(e)||fx(t,e)}))}function fx(t,e){var n=t.xl.get(e);null!==n&&(pS(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),vx(t))}function px(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof HS?(t.Ol.sr(o.key,e),dx(t,o)):o instanceof XS?(N_("SyncEngine","Document no longer in limbo: "+o.key),t.Ol.rr(o.key,e),t.Ol.ki(o.key)||fx(t,o.key)):F_()}}function dx(t,e){var n=e.key;t.xl.get(n)||(N_("SyncEngine","New document in limbo: "+n),t.Cl.push(n),vx(t))}function vx(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new JS(e)),t.xl=t.xl.Ht(e,n),fS(t.gl,new kw(Tw(yw(e.path)),n,2,ab.U))}}function gx(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s;return Vh(this,(function(a){switch(a.label){case 0:return r=U_(t),i=[],o=[],s=[],r.Sl.nt()?[3,3]:(r.Sl.forEach((function(t,a){s.push(r.Bl(a,e,n).then((function(t){if(t){r.$l&&r.pl.qa(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=lC.cc(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vl.uh(i),[4,function(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h;return Vh(this,(function(l){switch(l.label){case 0:n=U_(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return CI.forEach(e,(function(e){return CI.forEach(e.rc,(function(r){return n.persistence.Ii.sr(t,e.targetId,r)})).next((function(){return CI.forEach(e.oc,(function(r){return n.persistence.Ii.rr(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!AI(r=l.sent()))throw r;return N_("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.dc.get(a),c=u.Mt,h=u.Bt(c),n.dc=n.dc.Ht(a,h));return[2]}}))}))}(r.Sh,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function yx(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return(n=U_(t)).currentUser.isEqual(e)?[3,3]:(N_("SyncEngine","User change. New user:",e.R()),[4,vC(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach((function(t){t.forEach((function(t){t.reject(new H_(G_.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,gx(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function mx(t,e){var n=U_(t),r=n.Nl.get(e);if(r&&r.yl)return AE().add(r.key);var i=AE(),o=n.Dl.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Sl.get(u);i=i.ye(c.view.fl)}return i}function _x(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return[4,IC((n=U_(t)).Sh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Rl(r),[2,(n.$l&&px(n,e.targetId,i.ml),i)]}}))}))}function bx(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){return[2,CC((e=U_(t)).Sh).then((function(t){return gx(e,t)}))]}))}))}function wx(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i,o;return Vh(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=U_(t),r=U_(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.gi(t,e).next((function(e){return e?n.Ic.Zo(t,e):CI.resolve(null)}))}))}((i=U_(t)).Sh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,CS(i.gl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(hx(i,e,r||null),cx(i,e),function(t,e){U_(U_(t).Ho).Ni(e)}(i.Sh,e)):F_(),s.label=4;case 4:return[4,gx(i,o)];case 5:return s.sent(),[3,7];case 6:N_("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function Ex(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Vh(this,(function(h){switch(h.label){case 0:return Ox(n=U_(t)),Px(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,Ix(n,r.rt())]);case 1:return i=h.sent(),n.Ll=!0,[4,kS(n.gl,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],fS(n.gl,a);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(u=[],c=Promise.resolve(),n.Dl.forEach((function(t,e){n.pl.$a(e)?u.push(e):c=c.then((function(){return lx(n,e),EC(n.Sh,e,!0)})),pS(n.gl,e)})),[4,c]);case 4:return h.sent(),[4,Ix(n,u)];case 5:return h.sent(),function(t){var e=U_(t);e.Nl.forEach((function(t,n){pS(e.gl,n)})),e.Ol.Mc(),e.Nl=new Map,e.xl=new yE(db.J)}(n),n.Ll=!1,[4,kS(n.gl,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function Ix(t,e,n){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,l,f,p,d,v;return Vh(this,(function(g){switch(g.label){case 0:n=U_(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Dl.get(a))&&0!==c.length?[4,wC(n.Sh,Tw(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],p=n.Sl.get(f),[4,_x(n,p)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,TC(n.Sh,a)];case 8:return v=g.sent(),[4,wC(n.Sh,v)];case 9:return u=g.sent(),[4,tx(n,Tx(v),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vl.uh(i),r)]}}))}))}function Tx(t){return gw(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Cx(t){var e=U_(t);return U_(U_(e.Sh).persistence).Qo()}function Sx(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i,o,s;return Vh(this,(function(a){switch(a.label){case 0:return(i=U_(t)).Ll?(N_("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,CC(i.Sh)];case 3:return o=a.sent(),s=ME.$e(e,"current"===n),[4,gx(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,EC(i.Sh,e,!0)];case 6:return a.sent(),lx(i,e,r),[3,8];case 7:F_(),a.label=8;case 8:return[2]}}))}))}function xx(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f;return Vh(this,(function(p){switch(p.label){case 0:if(!(r=Ox(t)).Ll)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Dl.has(s)?(N_("SyncEngine","Adding an already active target "+s),[3,5]):[4,TC(r.Sh,s)]):[3,6];case 2:return a=p.sent(),[4,wC(r.Sh,a)];case 3:return u=p.sent(),[4,tx(r,Tx(a),u.targetId,!1)];case 4:p.sent(),fS(r.gl,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Vh(this,(function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,EC(r.Sh,t,!1).then((function(){pS(r.gl,t),lx(r,t)})).catch(AT)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function Ox(t){var e=U_(t);return e.gl.Ch.Bh=rx.bind(null,e),e.gl.Ch.Sn=mx.bind(null,e),e.gl.Ch.$h=ox.bind(null,e),e.vl.uh=US.bind(null,e.Vl),e.vl.ql=VS.bind(null,e.Vl),e}function Px(t){var e=U_(t);return e.gl.Ch.qh=sx.bind(null,e),e.gl.Ch.Uh=ax.bind(null,e),e}function Ax(t,e,n){var r=U_(t);(function(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Vh(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=U_(t),r=JE(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Eo.Ms(t,e.id)})).then((function(t){return!!t&&t.createTime.u(r)>=0}))}(t.Sh,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n.Ul(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n.Ql(GS(r)),i=new KS(r,t.Sh,e.Kt),[4,e.Kl()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.ol(o)]:[3,10];case 7:return(s=c.sent())&&n.Ql(s),[4,e.Kl()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return a=c.sent(),[4,gx(t,a.zo,void 0)];case 12:return c.sent(),[4,function(t,e){var n=U_(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Eo.Ls(t,e)}))}(t.Sh,r)];case 13:return c.sent(),n.Ul(a.progress),[3,15];case 14:return L_("SyncEngine","Loading bundle failed with "+(u=c.sent())),n.jl(u),[3,15];case 15:return[2]}}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)(r,e,n).then((function(){r.pl.Wa()}))}var Rx=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return this.Kt=nS(t.gu.T),this.pl=this.Wl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}}))}))},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return dC(this.persistence,new fC,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new MC(jC.ra,this.Kt)},t.prototype.Wl=function(t){return new XC},t.prototype.terminate=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}}))}))},t}(),kx=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Fh(e,t),e.prototype.initialize=function(e){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,SC(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,Px(this.Xl.fa)];case 4:return n.sent(),[4,CS(this.Xl.gl)];case 5:return n.sent(),[2]}}))}))},e.prototype.Jl=function(t){return dC(this.persistence,new fC,t.Yl,this.Kt)},e.prototype.Hl=function(t){var e=this.persistence.Ii._r;return new HT(e,t.fs)},e.prototype.Gl=function(t){var e=uC(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?PT.Xs(this.cacheSizeBytes):PT.ei;return new oC(this.synchronizeTabs,e,t.clientId,n,t.fs,tS(),eS(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new XC},e}(Rx),Nx=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Fh(e,t),e.prototype.initialize=function(e){return Uh(this,void 0,void 0,(function(){var n,r=this;return Vh(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.fa,this.pl instanceof HC?(this.pl.fa={nu:wx.bind(null,n),su:Sx.bind(null,n),iu:xx.bind(null,n),Qo:Cx.bind(null,n),eu:bx.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Po((function(t){return Uh(r,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return[4,Ex(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Wl=function(t){var e=tS();if(!HC.jn(e))throw new H_(G_.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=uC(t.gu.T,t.gu.persistenceKey);return new HC(e,t.fs,n,t.clientId,t.Yl)},e}(kx),Dx=function(){function t(){}return t.prototype.initialize=function(t,e){return Uh(this,void 0,void 0,(function(){var n=this;return Vh(this,(function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return ix(n.fa,t,1)},this.gl.Ch.s_=yx.bind(null,this.fa),[4,kS(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.e_=function(t){return new MS},t.prototype.Zl=function(t){var e,n=nS(t.gu.T),r=(e=t.gu,new $C(e));return function(t,e,n){return new aS(t,e,n)}(t.credentials,r,n)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return ix(s.fa,t,0)},o=QC.jn()?new QC:new YC,new cS(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var a=new ZS(t,e,n,r,i,o);return s&&(a.Ll=!0),a}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return e=U_(t),N_("RemoteStore","RemoteStore shutting down."),e.Oh.add(5),[4,lS(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}}))}))}(this.gl)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Lx(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return Uh(this,void 0,void 0,(function(){var r;return Vh(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){return[2]}))}))},releaseLock:function(){}}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Mx=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Fx=function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new TI,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then((function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Kl=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}}))}))},t.prototype.a_=function(){return Uh(this,void 0,void 0,(function(){var t,e,n,r;return Vh(this,(function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new zS(JSON.parse(r),t.length+n)]}}))}))},t.prototype.__=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.u_=function(){return Uh(this,void 0,void 0,(function(){var t,e;return Vh(this,(function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.l_=function(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return Uh(this,void 0,void 0,(function(){var t,e;return Vh(this,(function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),jx=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new H_(G_.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new pb(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}(),Ux=function(t){this._methodName=t};
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vx(t,e,n){if(!n)throw new H_(G_.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function qx(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new H_(G_.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Bx(t,e,n,r){if(!0===e&&!0===r)throw new H_(G_.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function zx(t){if(!db.Et(t))throw new H_(G_.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Wx(t){if(db.Et(t))throw new H_(G_.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Kx(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":F_()}function Gx(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new H_(G_.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Kx(t);throw new H_(G_.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Hx(t,e){if(e<=0)throw new H_(G_.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xx=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new H_(G_.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new H_(G_.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Bx("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Yx=new Map,Qx=function(){function t(t,e){this.w_="(lite)",this.E_=new Xx({}),this.T_=!1,t instanceof tb?(this.I_=t,this.m_=new rb):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new H_(G_.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tb(t.options.projectId)}(t),this.m_=new ib(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new H_(G_.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new H_(G_.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Xx(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new rb;switch(t.type){case"gapi":var e=t.client;return j_(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new sb(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new H_(G_.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.b_=function(){return this,(t=Yx.get(this))&&(N_("ComponentProvider","Removing Datastore"),Yx.delete(this),t.terminate()),Promise.resolve();var t},t}(),Jx=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new $x(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),Zx=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),$x=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,yw(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Fh(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new Jx(this.firestore,null,new db(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(Zx);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function tO(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Y_&&(t=t._),Vx("collection","path",e),t instanceof Qx)return Wx(n=lb.ct.apply(lb,Wh([e],r))),new $x(t,null,n);if(!(t instanceof Jx||t instanceof $x))throw new H_(G_.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Wx(n=lb.ct.apply(lb,Wh([t.path],r)).child(lb.ct(e))),new $x(t.firestore,null,n)}function eO(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Y_&&(t=t._),1===arguments.length&&(e=q_.t()),Vx("doc","path",e),t instanceof Qx)return zx(n=lb.ct.apply(lb,Wh([e],r))),new Jx(t,null,new db(n));if(!(t instanceof Jx||t instanceof $x))throw new H_(G_.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return zx(n=t.D_.child(lb.ct.apply(lb,Wh([e],r)))),new Jx(t.firestore,t instanceof $x?t.v_:null,new db(n))}function nO(t,e){return t instanceof Y_&&(t=t._),e instanceof Y_&&(e=e._),(t instanceof Jx||t instanceof $x)&&(e instanceof Jx||e instanceof $x)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function rO(t,e){return t instanceof Y_&&(t=t._),e instanceof Y_&&(e=e._),t instanceof Zx&&e instanceof Zx&&t.firestore===e.firestore&&Sw(t.C_,e.C_)&&t.v_===e.v_
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var iO=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new H_(G_.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new H_(G_.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return B_(this.x_,t.x_)||B_(this.N_,t.N_)},t}(),oO=/^__.*__$/,sO=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return null!==this.zt?new oE(t,this.data,this.zt,e,this.fieldTransforms):new iE(t,this.data,e,this.fieldTransforms)},t}(),aO=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.O_=function(t,e){return new oE(t,this.data,this.zt,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function uO(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F_()}}var cO=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.F_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.F_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return PO(t,this.settings.methodName,this.settings.j_||!1,this.path,this.settings.W_)},t.prototype.contains=function(t){return void 0!==this.zt.find((function(e){return t.st(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.st(e.field)}))},t.prototype.F_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(uO(this.k_)&&oO.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),hO=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||nS(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new cO({k_:t,methodName:e,W_:n,path:pb.at(),B_:!1,j_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function lO(t){var e=t.p_(),n=nS(t.I_);return new hO(t.I_,!!e.ignoreUndefinedProperties,n)}function fO(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);CO("Data must be an object, but it was:",s,r);var a,u,c=IO(r,s);if(o.merge)a=new mb(s.zt),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=SO(e,f[l],n);if(!s.contains(p))throw new H_(G_.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");AO(h,p)||h.push(p)}a=new mb(h),u=s.fieldTransforms.filter((function(t){return a.It(t.field)}))}else a=null,u=s.fieldTransforms;return new sO(new Bb(c),a,u)}var pO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Ux);function dO(t,e,n){return new cO({k_:3,W_:e.settings.W_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var vO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.z_=function(t){return new Xw(t.path,new Vw)},e.prototype.isEqual=function(t){return t instanceof e},e}(Ux),gO=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Fh(e,t),e.prototype.z_=function(t){var e=dO(this,t,!0),n=this.H_.map((function(t){return EO(t,e)})),r=new qw(n);return new Xw(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ux),yO=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Fh(e,t),e.prototype.z_=function(t){var e=dO(this,t,!0),n=this.H_.map((function(t){return EO(t,e)})),r=new zw(n);return new Xw(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ux),mO=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Fh(e,t),e.prototype.z_=function(t){var e=new Kw(t.Kt,Lw(t.Kt,this.J_));return new Xw(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Ux);function _O(t,e,n,r){var i=t.G_(1,e,n);CO("Data must be an object, but it was:",i,r);var o=[],s=new zb;gb(r,(function(t,r){var a=OO(e,t,n);r instanceof Y_&&(r=r._);var u=i.U_(a);if(r instanceof pO)o.push(a);else{var c=EO(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new mb(o);return new aO(s.yt(),a,i.fieldTransforms)}function bO(t,e,n,r,i,o){var s=t.G_(1,e,n),a=[SO(e,r,n)],u=[i];if(o.length%2!=0)throw new H_(G_.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(SO(e,o[c])),u.push(o[c+1]);for(var h=[],l=new zb,f=a.length-1;f>=0;--f)if(!AO(h,a[f])){var p=a[f],d=u[f];d instanceof Y_&&(d=d._);var v=s.U_(p);if(d instanceof pO)h.push(p);else{var g=EO(d,v);null!=g&&(h.push(p),l.set(p,g))}}var y=new mb(h);return new aO(l.yt(),y,s.fieldTransforms)}function wO(t,e,n,r){return void 0===r&&(r=!1),EO(n,t.G_(r?4:3,e))}function EO(t,e){if(t instanceof Y_&&(t=t._),TO(t))return CO("Unsupported field value:",e,t),IO(t,e);if(t instanceof Ux)return function(t,e){if(!uO(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=EO(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Y_&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Lw(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ub.fromDate(t);return{timestampValue:XE(e.Kt,n)}}if(t instanceof ub)return n=new ub(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:XE(e.Kt,n)};if(t instanceof iO)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof X_)return{bytesValue:YE(e.Kt,t.l)};if(t instanceof Jx){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ZE(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+Kx(t))}(t,e)}function IO(t,e){var n={};return yb(t)?e.path&&e.path.length>0&&e.zt.push(e.path):gb(t,(function(t,r){var i=EO(r,e.L_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function TO(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ub||t instanceof iO||t instanceof X_||t instanceof Jx||t instanceof Ux)}function CO(t,e,n){if(!TO(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Kx(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}}function SO(t,e,n){if(e instanceof Y_&&(e=e._),e instanceof jx)return e.d_;if("string"==typeof e)return OO(t,e);throw PO("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var xO=new RegExp("[~\\*/\\[\\]]");function OO(t,e,n){if(e.search(xO)>=0)throw PO("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(jx.bind.apply(jx,Wh([void 0],e.split("."))))).d_}catch(r){throw PO("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function PO(t,e,n,r,i){var o=r&&!r.nt(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new H_(G_.INVALID_ARGUMENT,(a+=". ")+t+u)}function AO(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var RO=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Uh(this,void 0,void 0,(function(){var e,n=this;return Vh(this,(function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new H_(G_.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return n=U_(t),r=iI(n.Kt)+"/documents",i={documents:e.map((function(t){return tI(n.Kt,t)}))},[4,n.Cu("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){j_(!!e.found),e.found.name,e.found.updateTime;var n=eI(t,e.found.name),r=JE(e.found.updateTime),i=new Bb({mapValue:{fields:e.found.fields}});return new Gb(n,r,i,{})}(t,e):"missing"in e?function(t,e){j_(!!e.missing),j_(!!e.readTime);var n=eI(t,e.missing),r=JE(e.readTime);return new Hb(n,r)}(t,e):F_()}(n.Kt,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());j_(!!e),a.push(e)})),a)]}}))}))}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Hb||t instanceof Gb?n.sf(t):F_()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.O_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.O_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new fE(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Uh(this,void 0,void 0,(function(){var t,e=this;return Vh(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=db.ft(n);e.mutations.push(new pE(r,e.Gt(r)))})),[4,function(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return n=U_(t),r=iI(n.Kt)+"/documents",i={writes:e.map((function(t){return uI(n.Kt,t)}))},[4,n.bu("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},t.prototype.sf=function(t){var e;if(t instanceof Gb)e=t.version;else{if(!(t instanceof Hb))throw F_();e=cb.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new H_(G_.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Qw.updateTime(e):Qw.jt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(cb.min()))throw new H_(G_.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qw.updateTime(e)}return Qw.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),kO=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new rS(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu((function(){return Uh(t,void 0,void 0,(function(){var t,e,n=this;return Vh(this,(function(r){return t=new RO(this.Dh),(e=this.uf(t))&&e.then((function(e){n.fs.ys((function(){return t.commit().then((function(){n.Ts.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Sb(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys((function(){return e.af(),Promise.resolve()}))):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!vE(e)}return!1},t}(),NO=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=eb.UNAUTHENTICATED,this.clientId=q_.t(),this._f=function(){},this.N=new TI,this.credentials.S((function(t){N_("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()}))}return t.prototype.getConfiguration=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}}))}))},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then((function(){return e._f(e.user)}))},t.prototype.df=function(){if(this.fs.wf)throw new H_(G_.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new TI;return this.fs.Tf((function(){return Uh(t,void 0,void 0,(function(){var t,n;return Vh(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=MI(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function DO(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i=this;return Vh(this,(function(o){switch(o.label){case 0:return t.fs.Af(),N_("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Yl,t.ff((function(n){r.isEqual(n)||(r=n,t.fs.bo((function(){return Uh(i,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return[4,vC(e.Sh,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.yo((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function LO(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return t.fs.Af(),[4,MO(t)];case 1:return n=i.sent(),N_("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff((function(n){return t.fs.bo((function(){return function(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return(n=U_(t)).fs.Af(),N_("RemoteStore","RemoteStore received new credentials"),r=mS(n),n.Oh.add(3),[4,lS(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Oh.delete(3),[4,hS(n)];case 3:return i.sent(),[2]}}))}))}(e.gl,n)}))})),t.If=e,[2]}}))}))}function MO(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(N_("FirestoreClient","Using default OfflineComponentProvider"),[4,DO(t,new Rx)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function FO(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(N_("FirestoreClient","Using default OnlineComponentProvider"),[4,LO(t,new Dx)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function jO(t){return MO(t).then((function(t){return t.persistence}))}function UO(t){return MO(t).then((function(t){return t.Sh}))}function VO(t){return FO(t).then((function(t){return t.gl}))}function qO(t){return FO(t).then((function(t){return t.fa}))}function BO(t){return Uh(this,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:return[4,FO(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=$S.bind(null,e.fa),n.Jh=ex.bind(null,e.fa),n)]}}))}))}function zO(t,e,n){var r=this;void 0===n&&(n={});var i=new TI;return t.fs.ys((function(){return Uh(r,void 0,void 0,(function(){var r;return Vh(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Mx({next:function(o){e.ys((function(){return jS(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new H_(G_.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new H_(G_.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new BS(yw(n.path),o,{includeMetadataChanges:!0,sl:!0});return FS(t,s)},[4,BO(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}}))}))})),i.promise}function WO(t,e,n){var r=this;void 0===n&&(n={});var i=new TI;return t.fs.ys((function(){return Uh(r,void 0,void 0,(function(){var r;return Vh(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Mx({next:function(n){e.ys((function(){return jS(t,s)})),n.fromCache&&"server"===r.source?i.reject(new H_(G_.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new BS(n,o,{includeMetadataChanges:!0,sl:!0});return FS(t,s)},[4,BO(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.fs,e,n,i])]}}))}))})),i.promise}var KO=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new rS(this,"async_queue_retry"),this.vf=function(){var e=eS();e&&N_("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=eS();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=eS();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},t.prototype.bo=function(t){var e=this;this.ys((function(){return e.Pf.push(t),e.Cf()}))},t.prototype.Cf=function(){return Uh(this,void 0,void 0,(function(){var t,e=this;return Vh(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!AI(t=n.sent()))throw t;return N_("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,D_("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n,n},t.prototype.Ir=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=LI.Is(this,t,e,n,(function(t){return r.xf(t)}));return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&F_()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Uh(this,void 0,void 0,(function(){var t;return Vh(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Of=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.ws-e.ws}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()}))},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),GO=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new KO,r.w_="name"in e?e.name:"[DEFAULT]",r}return Fh(e,t),e.prototype.b_=function(){return this.Lf||XO(this),this.Lf.terminate()},e}(Qx);function HO(t){return t.Lf||XO(t),t.Lf.df(),t.Lf}function XO(t){var e=t.p_(),n=function(t,e,n){return new $_(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new NO(t.m_,t.Mf,n)}function YO(t,e,n){var r=this,i=new TI;return t.fs.enqueue((function(){return Uh(r,void 0,void 0,(function(){var r;return Vh(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,DO(t,n)];case 1:return o.sent(),[4,LO(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===G_.FAILED_PRECONDITION||t.code===G_.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function QO(t){if(t.R_||t.P_)throw new H_(G_.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var JO=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),Pb(t)){case 0:return null;case 1:return t.booleanValue;case 2:return wb(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Eb(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.jf(t.arrayValue,e);case 10:return this.Wf(t.mapValue,e);default:throw F_()}},t.prototype.Wf=function(t,e){var n=this,r={};return gb(t.fields||{},(function(t,i){r[t]=n.$f(i,e)})),r},t.prototype.Kf=function(t){return new iO(wb(t.latitude),wb(t.longitude))},t.prototype.jf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.$f(t,e)}))},t.prototype.qf=function(t,e){switch(e){case"previous":var n=Tb(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Cb(t));default:return null}},t.prototype.Bf=function(t){var e=bb(t);return new ub(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=lb.ct(t);j_(II(n));var r=new tb(n.get(1),n.get(3)),i=new db(n.X(5));return r.isEqual(e)||D_("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),ZO=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Jx(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new $O(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(tP("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),$O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(ZO);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function tP(t,e){return"string"==typeof e?OO(t,e):e instanceof Y_?e._.d_:e.d_}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function eP(t){if(_w(t)&&0===t.Nt.length)throw new H_(G_.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var nP=function(){};function rP(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.Yf(t)}return t}var iP=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return Fh(e,t),e.prototype.Yf=function(t){var e=lO(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new H_(G_.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){lP(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(hP(r,t,l))}a={arrayValue:{values:u}}}else a=hP(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||lP(s,o),a=wO(n,"where",s,"in"===o||"not-in"===o);var f=tw.create(i,o,a);return function(t,e){if(e.xt()){var n=ww(t);if(null!==n&&!n.isEqual(e.field))throw new H_(G_.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=bw(t);null!==r&&fP(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new H_(G_.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new H_(G_.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Zx(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new vw(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(nP),oP=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return Fh(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new H_(G_.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new H_(G_.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new lw(e,n);return function(t,e){if(null===bw(t)){var n=ww(t);null!==n&&fP(t,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new Zx(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new vw(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(nP),sP=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return Fh(e,t),e.prototype.Yf=function(t){return new Zx(t.firestore,t.v_,Cw(t.C_,this.nd,this.sd))},e}(nP),aP=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Fh(e,t),e.prototype.Yf=function(t){var e=cP(t,this.type,this.rd,this.od);return new Zx(t.firestore,t.v_,function(t,e){return new vw(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(nP),uP=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return Fh(e,t),e.prototype.Yf=function(t){var e=cP(t,this.type,this.rd,this.od);return new Zx(t.firestore,t.v_,function(t,e){return new vw(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(nP);function cP(t,e,n,r){if(n[0]instanceof Y_&&(n[0]=n[0]._),n[0]instanceof ZO)return function(t,e,n,r,i){if(!r)throw new H_(G_.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Iw(t);s<a.length;s++){var u=a[s];if(u.field.ht())o.push(Mb(e,r.key));else{var c=r.field(u.field);if(Ib(c))throw new H_(G_.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.ot();throw new H_(G_.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new cw(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=lO(t.firestore);return function(t,e,n,r,i,o){var s=t.Nt;if(i.length>s.length)throw new H_(G_.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.ht()){if("string"!=typeof c)throw new H_(G_.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ew(t)&&-1!==c.indexOf("/"))throw new H_(G_.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(lb.ct(c));if(!db.Et(h))throw new H_(G_.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new db(h);a.push(Mb(e,l))}else{var f=wO(n,r,c);a.push(f)}}return new cw(a,o)}(t.C_,t.firestore.I_,i,e,n,r)}function hP(t,e,n){if(n instanceof Y_&&(n=n._),"string"==typeof n){if(""===n)throw new H_(G_.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ew(e)&&-1!==n.indexOf("/"))throw new H_(G_.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(lb.ct(n));if(!db.Et(r))throw new H_(G_.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Mb(t,new db(r))}if(n instanceof Jx)return Mb(t,n.S_);throw new H_(G_.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Kx(n)+".")}function lP(t,e){if(!Array.isArray(t)||0===t.length)throw new H_(G_.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new H_(G_.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function fP(t,e,n){if(!n.isEqual(e))throw new H_(G_.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function pP(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function dP(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var vP=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Fh(e,t),e.prototype.Uf=function(t){return new X_(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Jx(this.firestore,null,e)},e}(JO),gP=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),yP=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this).zf=e,a.ad=e,a.metadata=o,a}return Fh(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new mP(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(tP("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(ZO),mP=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(yP),_P=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new gP(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach((function(r){t.call(e,new mP(n.zf,n.Hf,r.key,r,new gP(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new H_(G_.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map((function(e){var r=new mP(t.zf,t.Hf,e.doc.key,e.doc,new gP(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t.ud.De;return t.ud.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new mP(t.zf,t.Hf,e.doc.key,e.doc,new gP(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:bP(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.ld=e),this.hd},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F_()}}function wP(t,e){return t instanceof yP&&e instanceof yP?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof _P&&e instanceof _P&&t.zf===e.zf&&rO(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var EP=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Fh(e,t),e.prototype.Uf=function(t){return new X_(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new Jx(this.firestore,null,e)},e}(JO);function IP(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Gx(t,Jx);var o=Gx(t.firestore,GO),s=lO(o);return e instanceof Y_&&(e=e._),CP(o,[("string"==typeof e||e instanceof jx?bO(s,"updateDoc",t.S_,e,n,r):_O(s,"updateDoc",t.S_,e)).O_(t.S_,Qw.exists(!0))])}function TP(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Y_&&(t=t._);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||pP(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(pP(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Jx)c=Gx(t.firestore,GO),h=yw(t.S_.path),u={next:function(e){i[a]&&i[a](SP(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=Gx(t,Zx);c=Gx(p.firestore,GO),h=p.C_;var d=new EP(c);u={next:function(t){i[a]&&i[a](new _P(c,d,p,t))},error:i[a+1],complete:i[a+2]},eP(t.C_)}return function(t,e,n,r){var i=this,o=new Mx(r),s=new BS(e,o,n);return t.fs.ys((function(){return Uh(i,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return e=FS,[4,BO(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.r_(),t.fs.ys((function(){return Uh(i,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return e=jS,[4,BO(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(HO(c),h,l,u)}function CP(t,e){return function(t,e){var n=this,r=new TI;return t.fs.ys((function(){return Uh(n,void 0,void 0,(function(){var n;return Vh(this,(function(i){switch(i.label){case 0:return n=nx,[4,qO(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(HO(t),e)}function SP(t,e,n){var r=n.docs.get(e.S_),i=new EP(t);return new yP(t,i,e.S_,r,new gP(n.hasPendingWrites,n.fromCache),e.v_)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xP=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=lO(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=OP(t,this.zf),i=dP(r.v_,e,n),o=fO(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.O_(r.S_,Qw.jt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,s=OP(t,this.zf);return e instanceof Y_&&(e=e._),o="string"==typeof e||e instanceof jx?bO(this.wd,"WriteBatch.update",s.S_,e,n,r):_O(this.wd,"WriteBatch.update",s.S_,e),this.fd.push(o.O_(s.S_,Qw.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=OP(t,this.zf);return this.fd=this.fd.concat(new fE(e.S_,Qw.jt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new H_(G_.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function OP(t,e){if(t instanceof Y_&&(t=t._),t.firestore!==e)throw new H_(G_.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var PP=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return Fh(e,t),e.prototype.get=function(e){var n=this,r=OP(e,this.zf),i=new EP(this.zf);return t.prototype.get.call(this,e).then((function(t){return new yP(n.zf,i,r.S_,t.Jf,new gP(!1,!1),r.v_)}))},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=lO(t)}return t.prototype.get=function(t){var e=this,n=OP(t,this.zf),r=new vP(this.zf);return this.Td.ef([n.S_]).then((function(t){if(!t||1!==t.length)return F_();var i=t[0];if(i instanceof Hb)return new ZO(e.zf,r,n.S_,null,n.v_);if(i instanceof Gb)return new ZO(e.zf,r,i.key,i,n.v_);throw F_()}))},t.prototype.set=function(t,e,n){var r=OP(t,this.zf),i=dP(r.v_,e,n),o=fO(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=OP(t,this.zf);return e instanceof Y_&&(e=e._),o="string"==typeof e||e instanceof jx?bO(this.wd,"Transaction.update",s.S_,e,n,r):_O(this.wd,"Transaction.update",s.S_,e),this.Td.update(s.S_,o),this},t.prototype.delete=function(t){var e=OP(t,this.zf);return this.Td.delete(e.S_),this},t}()),AP=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){QO(t=Gx(t,GO));var n=HO(t),r=t.p_(),i=new Dx;return YO(n,i,new kx(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){QO(t=Gx(t,GO));var e=HO(t),n=t.p_(),r=new Dx;return YO(e,r,new Nx(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new H_(G_.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new TI;return t.Mf.Tf((function(){return Uh(e,void 0,void 0,(function(){var e;return Vh(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return xI.jn()?(e=t+"main",[4,xI.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(uC(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._)},t}(),RP=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof tb||(i.md=e),i}return Fh(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Gx(t,Qx)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&L_("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue((function(){return Uh(e,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:return[4,jO(t)];case 1:return e=r.sent(),[4,VO(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),function(t){var e=U_(t);return e.Oh.delete(0),hS(e)}(n))]}}))}))}))}(HO(Gx(this._,GO)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue((function(){return Uh(e,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:return[4,jO(t)];case 1:return e=r.sent(),[4,VO(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return(e=U_(t)).Oh.add(0),[4,lS(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(HO(Gx(this._,GO)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Bx("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new TI;return t.fs.ys((function(){return Uh(e,void 0,void 0,(function(){var e;return Vh(this,(function(r){switch(r.label){case 0:return e=ux,[4,qO(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(HO(Gx(this._,GO)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Mx(e);return t.fs.ys((function(){return Uh(n,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return e=function(t,e){U_(t).Wh.add(e),e.next()},[4,BO(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.r_(),t.fs.ys((function(){return Uh(n,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return e=function(t,e){U_(t).Wh.delete(e)},[4,BO(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(HO(t=Gx(t,GO)),pP(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new H_(G_.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new WP(this,tO(this._,t))}catch(t){throw MP(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new LP(this,eO(this._,t))}catch(t){throw MP(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new qP(this,function(t,e){if(t=Gx(t,Qx),Vx("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new H_(G_.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Zx(t,null,function(t){return new vw(lb.at(),t)}(e))}(this._,t))}catch(t){throw MP(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new TI;return t.fs.ys((function(){return Uh(n,void 0,void 0,(function(){var n;return Vh(this,(function(i){switch(i.label){case 0:return[4,function(t){return FO(t).then((function(t){return t.Dh}))}(t)];case 1:return n=i.sent(),new kO(t.fs,n,e,r).run(),[2]}}))}))})),r.promise}(HO(t),(function(n){return e(new PP(t,n))}))}(this._,(function(n){return t(new NP(e,n))}))},e.prototype.batch=function(){var t=this;return HO(this._),new DP(new xP(this._,(function(e){return CP(t._,e)})))},e.prototype.loadBundle=function(t){throw new H_(G_.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new H_(G_.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Y_),kP=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Fh(e,t),e.prototype.Uf=function(t){return new Z_(new X_(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return LP.Ad(e,this.firestore,null)},e}(JO);var NP=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r.Hf=new kP(e),r}return Fh(e,t),e.prototype.get=function(t){var e=this,n=KP(t);return this._.get(n).then((function(t){return new UP(e.zf,new yP(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))}))},e.prototype.set=function(t,e,n){var r=KP(t);return n?(qx("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=KP(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Wh([s,e,n],i)),this},e.prototype.delete=function(t){var e=KP(t);return this._.delete(e),this},e}(Y_),DP=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.set=function(t,e,n){var r=KP(t);return n?(qx("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=KP(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,Wh([s,e,n],i)),this},e.prototype.delete=function(t){var e=KP(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(Y_),LP=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new kP(e),r}return Fh(e,t),e.Rd=function(t,n,r){if(t.length%2!=0)throw new H_(G_.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new Jx(n._,r,new db(t)))},e.Ad=function(t,n,r){return new e(n,new Jx(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new WP(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new WP(this.firestore,tO(this._,t))}catch(t){throw MP(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Y_&&(t=t._),t instanceof Jx&&nO(this._,t)},e.prototype.set=function(t,e){e=qx("DocumentReference.set",e);try{return function(t,e,n){t=Gx(t,Jx);var r=Gx(t.firestore,GO),i=dP(t.v_,e,n);return CP(r,[fO(lO(r),"setDoc",t.S_,i,null!==t.v_,n).O_(t.S_,Qw.jt())])}(this._,t,e)}catch(t){throw MP(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?IP(this._,t):IP.apply(void 0,Wh([this._,t,e],n))}catch(t){throw MP(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return CP(Gx((t=this._).firestore,GO),[new fE(t.S_,Qw.jt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=FP(e),i=jP(e,(function(e){return new UP(t.firestore,new yP(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))}));return TP(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Gx(t,Jx);var e=Gx(t.firestore,GO),n=HO(e),r=new EP(e);return function(t,e){var n=this,r=new TI;return t.fs.ys((function(){return Uh(n,void 0,void 0,(function(){var n;return Vh(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i;return Vh(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=U_(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Ic.Jo(t,e)}))}(t,e)];case 1:return(i=o.sent())instanceof Gb?n.resolve(i):i instanceof Hb?n.resolve(null):n.reject(new H_(G_.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=MI(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,UO(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.S_).then((function(n){return new yP(e,r,t.S_,n,new gP(n instanceof Gb&&n.bt,!0),t.v_)}))}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Gx(t,Jx);var e=Gx(t.firestore,GO);return zO(HO(e),t.S_,{source:"server"}).then((function(n){return SP(e,t,n)}))}(this._):function(t){t=Gx(t,Jx);var e=Gx(t.firestore,GO);return zO(HO(e),t.S_).then((function(n){return SP(e,t,n)}))}(this._)).then((function(t){return new UP(e.firestore,new yP(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Y_);function MP(t,e,n){return t.message=t.message.replace(e,n),t}function FP(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!pP(r))return r}return{}}function jP(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=pP(t[0])?t[0]:pP(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var UP=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Fh(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new LP(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return wP(this._,t._)},e}(Y_),VP=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.prototype.data=function(t){return this._.data(t)},e}(UP),qP=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new kP(e),r}return Fh(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,rP(this._,function(t,e,n){var r=e,i=tP("where",t);return new iP(i,r,n)}(t,n,r)))}catch(t){throw MP(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,rP(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=tP("orderBy",t);return new oP(r,n)}(t,n)))}catch(t){throw MP(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,rP(this._,function(t){return Hx("limit",t),new sP("limit",t,"F")}(t)))}catch(t){throw MP(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,rP(this._,function(t){return Hx("limitToLast",t),new sP("limitToLast",t,"L")}(t)))}catch(t){throw MP(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,rP(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new aP("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw MP(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,rP(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new aP("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw MP(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,rP(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new uP("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw MP(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,rP(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new uP("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw MP(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return rO(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Gx(t,Zx);var e=Gx(t.firestore,GO),n=HO(e),r=new EP(e);return function(t,e){var n=this,r=new TI;return t.fs.ys((function(){return Uh(n,void 0,void 0,(function(){var n;return Vh(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,IC(t,e,!0)];case 1:return a=u.sent(),r=new YS(e,a.Pc),i=r.dl(a.documents),o=r.Ei(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=MI(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,UO(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.C_).then((function(n){return new _P(e,r,t,n)}))}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Gx(t,Zx);var e=Gx(t.firestore,GO),n=HO(e),r=new EP(e);return WO(n,t.C_,{source:"server"}).then((function(n){return new _P(e,r,t,n)}))}(this._):function(t){t=Gx(t,Zx);var e=Gx(t.firestore,GO),n=HO(e),r=new EP(e);return eP(t.C_),WO(n,t.C_).then((function(n){return new _P(e,r,t,n)}))}(this._)).then((function(t){return new zP(e.firestore,new _P(e.firestore._,e.Hf,e._,t.ud))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=FP(e),i=jP(e,(function(e){return new zP(t.firestore,new _P(t.firestore._,t.Hf,t._,e.ud))}));return TP(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(Y_),BP=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Fh(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new VP(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(Y_),zP=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return Fh(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new qP(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map((function(e){return new VP(t.zf,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map((function(t){return new BP(e.zf,t)}))},e.prototype.forEach=function(t,e){var n=this;this._.forEach((function(r){t.call(e,new VP(n.zf,r))}))},e.prototype.isEqual=function(t){return wP(this._,t._)},e}(Y_),WP=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return Fh(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new LP(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new LP(this.firestore,void 0===t?eO(this._):eO(this._,t))}catch(t){throw MP(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Gx(t.firestore,GO),r=eO(t),i=dP(t.v_,e);return CP(n,[fO(lO(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).O_(r.S_,Qw.exists(!1))]).then((function(){return r}))}(this._,t).then((function(t){return new LP(e.firestore,t)}))},e.prototype.isEqual=function(t){return nO(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(t))},e}(qP);function KP(t){return t instanceof Y_&&(t=t._),Gx(t,Jx)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var GP=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(jx.bind.apply(jx,Wh([void 0],e))))||this}return Fh(e,t),e.documentId=function(){return new e(pb.lt().ot())},e.prototype.isEqual=function(t){return t instanceof Y_&&(t=t._),t instanceof jx&&this._.d_.isEqual(t.d_)},e}(Y_),HP=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fh(e,t),e.serverTimestamp=function(){var t=new vO("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new pO("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gO("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yO("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new mO("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(Y_),XP=function(){function t(){this.Pd={},this.yd=new TI,this.gd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this.Pd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.yd.promise.catch(t)},t.prototype.then=function(t,e){return this.yd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.Pd.complete&&this.Pd.complete(),this.yd.resolve(t)},t.prototype.jl=function(t){this.gd.taskState="Error",this.Pd.next&&this.Pd.next(this.gd),this.Pd.error&&this.Pd.error(t),this.yd.reject(t)},t.prototype.Ql=function(t){this.gd=t,this.Pd.next&&this.Pd.next(t)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var YP,QP={Firestore:RP,GeoPoint:iO,Timestamp:ub,Blob:Z_,Transaction:NP,WriteBatch:DP,DocumentReference:LP,DocumentSnapshot:UP,Query:qP,QueryDocumentSnapshot:VP,QuerySnapshot:zP,CollectionReference:WP,FieldPath:GP,FieldValue:HP,setLogLevel:function(t){var e;e=t,R_.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(function(t,e){t.INTERNAL.registerComponent(new Rl("firestore",(function(t){return function(t,e){return new RP(t,new GO(t,e),new AP)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},QP)))})(YP=sf),YP.registerVersion("@firebase/firestore","2.1.2"),
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(t){t.prototype.loadBundle=function(t){return function(t,e){var n=new XP;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new Fx(t,e)}(function(t,e){if(t instanceof Uint8Array)return Lx(t,e);if(t instanceof ArrayBuffer)return Lx(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,nS(e));t.fs.ys((function(){return Uh(i,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return e=Ax,[4,qO(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(HO(t._),t.I_,e,n),n}(this,t)},t.prototype.namedQuery=function(t){return function(t,e){return function(t,e){var n=this;return t.fs.enqueue((function(){return Uh(n,void 0,void 0,(function(){var n;return Vh(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=U_(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Eo.$s(t,e)}))},[4,UO(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(HO(t._),e).then((function(e){return e?new qP(t,new Zx(t._,null,e.query)):null}))}(this,t)}}(RP);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var JP={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ZP=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return Fh(e,t),e}(Error);var $P=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Uh(this,void 0,void 0,(function(){var t;return Vh(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]}))}))},t.prototype.getContext=function(){return Uh(this,void 0,void 0,(function(){var t,e;return Vh(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function tA(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var eA=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return tA(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?tA(t,(function(t){return e.decode(t)})):t},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var nA=function(){function t(t,e,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=t,this.fetchImpl=i,this.serializer=new eA,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new $P(e,n),this.cancelAllRequests=new Promise((function(t){o.deleteService=function(){return t()}}));try{var s=new URL(r);this.customDomain=s.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=r}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i;return Vh(this,(function(o){switch(o.label){case 0:n["Content-Type"]="application/json",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}}))}))},t.prototype.call=function(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f,p;return Vh(this,(function(d){switch(d.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(s=d.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),a=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new ZP("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(a),c=u.timer,h=u.promise,[4,Promise.race([rA(c,this.postJSON(r,i,o)),h,rA(c,this.cancelAllRequests)])];case 2:if(!(l=d.sent()))throw new ZP("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!JP[a])return new ZP("internal","internal");r=JP[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new ZP(r,i,o)}(l.status,l.json,this.serializer))throw f;if(!l.json)throw new ZP("internal","Response is not valid JSON object.");if(void 0===(p=l.json.data)&&(p=l.json.result),void 0===p)throw new ZP("internal","Response is missing data field.");return[2,{data:this.serializer.decode(p)}]}}))}))},t}();function rA(t,e){return Uh(this,void 0,void 0,(function(){var n;return Vh(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
!function(t,e){var n={Functions:nA};t.INTERNAL.registerComponent(new Rl("functions",(function(t,n){var r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("messaging");return new nA(r,i,o,n,e)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}(sf,fetch.bind(self)),sf.registerVersion("@firebase/functions","0.6.1");var iA,oA=bo((function(t,e){!function(t){function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,s){n(i=t[e].apply(t,r)).then(o,s)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new h(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function s(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function a(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function p(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function d(t){this._db=t}function v(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new p(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new d(t)}))}function g(t){return r(indexedDB,"deleteDatabase",[t])}o(c,"_index",["name","keyPath","multiEntry","unique"]),s(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(h,"_cursor",["direction","key","primaryKey","value"]),s(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new h(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(l,"_store",["name","keyPath","indexNames","autoIncrement"]),s(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(l,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),a(f,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),a(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=v,t.deleteDb=g,Object.defineProperty(t,"__esModule",{value:!0})}(e)})),sA="0.4.19",aA=1e4,uA="w:0.4.19",cA="FIS_v2",hA=36e5,lA=((iA={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',iA["not-registered"]="Firebase Installation is not registered.",iA["installation-not-found"]="Firebase Installation not found.",iA["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',iA["app-offline"]="Could not process request. Application offline.",iA["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",iA),fA=new ll("installations","Installations",lA);function pA(t){return t instanceof hl&&t.code.includes("request-failed")}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function dA(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function vA(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function gA(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,fA.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function yA(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function mA(t,e){var n=e.refreshToken,r=yA(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(n)),r}function _A(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function bA(t,e){var n=e.fid;return Uh(this,void 0,void 0,(function(){var e,r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return e=dA(t),r=yA(t),i={fid:n,authVersion:cA,appId:t.appId,sdkVersion:uA},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,_A((function(){return fetch(e,o)}))];case 1:return(s=u.sent()).ok?[4,s.json()]:[3,3];case 2:return a=u.sent(),[2,{fid:a.fid||n,registrationStatus:2,refreshToken:a.refreshToken,authToken:vA(a.authToken)}];case 3:return[4,gA("Create Installation",s)];case 4:throw u.sent()}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function wA(t){return new Promise((function(e){setTimeout(e,t)}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var EA=/^[cdef][\w-]{21}$/;function IA(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,zh(e))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t);return EA.test(e)?e:""}catch(t){return""}}function TA(t){return t.appName+"!"+t.appId}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var CA=new Map;function SA(t,e){var n=TA(t);xA(n,e),function(t,e){var n=PA();n&&n.postMessage({key:t,fid:e});AA()}(n,e)}function xA(t,e){var n,r,i=CA.get(t);if(i)try{for(var o=qh(i),s=o.next();!s.done;s=o.next()){(0,s.value)(e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var OA=null;function PA(){return!OA&&"BroadcastChannel"in self&&((OA=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){xA(t.data.key,t.data.fid)}),OA}function AA(){0===CA.size&&OA&&(OA.close(),OA=null)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var RA,kA="firebase-installations-store",NA=null;function DA(){return NA||(NA=oA.openDb("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(kA)}}))),NA}function LA(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s;return Vh(this,(function(a){switch(a.label){case 0:return n=TA(t),[4,DA()];case 1:return r=a.sent(),i=r.transaction(kA,"readwrite"),[4,(o=i.objectStore(kA)).get(n)];case 2:return s=a.sent(),[4,o.put(e,n)];case 3:return a.sent(),[4,i.complete];case 4:return a.sent(),s&&s.fid===e.fid||SA(t,e.fid),[2,e]}}))}))}function MA(t){return Uh(this,void 0,void 0,(function(){var e,n,r;return Vh(this,(function(i){switch(i.label){case 0:return e=TA(t),[4,DA()];case 1:return n=i.sent(),[4,(r=n.transaction(kA,"readwrite")).objectStore(kA).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function FA(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return n=TA(t),[4,DA()];case 1:return r=u.sent(),i=r.transaction(kA,"readwrite"),[4,(o=i.objectStore(kA)).get(n)];case 2:return s=u.sent(),void 0!==(a=e(s))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(a,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!a||s&&s.fid===a.fid||SA(t,a.fid),[2,a]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function jA(t){return Uh(this,void 0,void 0,(function(){var e,n,r;return Vh(this,(function(i){switch(i.label){case 0:return[4,FA(t,(function(n){var r=function(t){return qA(t||{fid:IA(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(fA.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,bA(t,e)];case 1:return n=i.sent(),[2,LA(t,n)];case 2:return pA(r=i.sent())&&409===r.customData.serverCode?[4,MA(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,LA(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:UA(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function UA(t){return Uh(this,void 0,void 0,(function(){var e,n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return[4,VA(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,wA(100)];case 3:return o.sent(),[4,VA(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,jA(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function VA(t){return FA(t,(function(t){if(!t)throw fA.create("installation-not-found");return qA(t)}))}function qA(t){return 1===(e=t).registrationStatus&&e.registrationTime+aA<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}function BA(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return Uh(this,void 0,void 0,(function(){var t,i,o,s,a,u,c;return Vh(this,(function(h){switch(h.label){case 0:return t=function(t,e){var n=e.fid;return dA(t)+"/"+n+"/authTokens:generate"}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(n,e),i=mA(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),s={installation:{sdkVersion:uA}},a={method:"POST",headers:i,body:JSON.stringify(s)},[4,_A((function(){return fetch(t,a)}))];case 1:return(u=h.sent()).ok?[4,u.json()]:[3,3];case 2:return c=h.sent(),[2,vA(c)];case 3:return[4,gA("Generate Auth Token",u)];case 4:throw h.sent()}}))}))}function zA(t,e){return void 0===e&&(e=!1),Uh(this,void 0,void 0,(function(){var n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return[4,FA(t.appConfig,(function(r){if(!KA(r))throw fA.create("not-registered");var i=r.authToken;if(!e&&function(t){return 2===t.requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+hA}(t)}(i))return r;if(1===i.requestStatus)return n=function(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return[4,WA(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,wA(100)];case 3:return i.sent(),[4,WA(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,zA(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw fA.create("app-offline");var o=function(t){var e={requestStatus:1,requestTime:Date.now()};return jh(jh({},t),{authToken:e})}(r);return n=function(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,BA(t,e)];case 1:return n=o.sent(),i=jh(jh({},e),{authToken:n}),[4,LA(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!pA(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,MA(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=jh(jh({},e),{authToken:{requestStatus:0}}),[4,LA(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,o),o}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function WA(t){return FA(t,(function(t){if(!KA(t))throw fA.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+aA<Date.now()?jh(jh({},t),{authToken:{requestStatus:0}}):t}))}function KA(t){return void 0!==t&&2===t.registrationStatus}function GA(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return[4,jA(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function HA(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o;return Vh(this,(function(s){switch(s.label){case 0:return n=function(t,e){var n=e.fid;return dA(t)+"/"+n}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e),r=mA(t,e),i={method:"DELETE",headers:r},[4,_A((function(){return fetch(n,i)}))];case 1:return(o=s.sent()).ok?[3,3]:[4,gA("Delete Installation",o)];case 2:throw s.sent();case 3:return[2]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function XA(t,e){var n=t.appConfig;return function(t,e){PA();var n=TA(t),r=CA.get(n);r||(r=new Set,CA.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=TA(t),r=CA.get(n);r&&(r.delete(e),0===r.size&&CA.delete(n),AA())}(n,e)}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function YA(t){return fA.create("missing-app-config-values",{valueName:t})}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(t){t.INTERNAL.registerComponent(new Rl("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw YA("App Configuration");if(!t.name)throw YA("App Name");try{for(var r=qh(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw YA(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */return function(t){return Uh(this,void 0,void 0,(function(){var e,n,r;return Vh(this,(function(i){switch(i.label){case 0:return[4,jA(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):zA(t).catch(console.error),[2,n.fid]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),Uh(this,void 0,void 0,(function(){return Vh(this,(function(n){switch(n.label){case 0:return[4,GA(t.appConfig)];case 1:return n.sent(),[4,zA(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return Uh(this,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:return[4,FA(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw fA.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw fA.create("app-offline");case 3:return[4,HA(e,n)];case 4:return r.sent(),[4,MA(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return XA(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations",sA)}(sf);var QA,JA=((RA={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',RA["only-available-in-window"]="This method is available in a Window context.",RA["only-available-in-sw"]="This method is available in a service worker context.",RA["permission-default"]="The notification permission was not granted and dismissed instead.",RA["permission-blocked"]="The notification permission was not granted and blocked instead.",RA["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",RA["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",RA["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",RA["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",RA["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",RA["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",RA["token-update-no-token"]="FCM returned no token when updating the user to push.",RA["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",RA["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",RA["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",RA["invalid-vapid-key"]="The public VAPID key must be a string.",RA["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",RA),ZA=new ll("messaging","Messaging",JA),$A="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",tR="google.c.a.c_id";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function eR(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,zh(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nR(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(QA||(QA={}));var rR="fcm_token_details_db",iR="fcm_token_object_Store";function oR(t){return Uh(this,void 0,void 0,(function(){var e,n,r=this;return Vh(this,(function(i){switch(i.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(e=i.sent(),!e.map((function(t){return t.name})).includes(rR))return[2,null];i.label=2;case 2:return n=null,[4,oA.openDb(rR,5,(function(e){return Uh(r,void 0,void 0,(function(){var r,i,o,s;return Vh(this,(function(a){switch(a.label){case 0:return e.oldVersion<2?[2]:e.objectStoreNames.contains(iR)?[4,(r=e.transaction.objectStore(iR)).index("fcmSenderId").get(t)]:[2];case 1:return i=a.sent(),[4,r.clear()];case 2:if(a.sent(),!i)return[2];if(2===e.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];n={token:o.fcmToken,createTime:null!==(s=o.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:eR(o.vapidKey)}}}else(3===e.oldVersion||4===e.oldVersion)&&(n={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:eR(o.auth),p256dh:eR(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:eR(o.vapidKey)}});return[2]}}))}))}))];case 3:return i.sent().close(),[4,oA.deleteDb(rR)];case 4:return i.sent(),[4,oA.deleteDb("fcm_vapid_details_db")];case 5:return i.sent(),[4,oA.deleteDb("undefined")];case 6:return i.sent(),[2,sR(n)?n:null]}}))}))}function sR(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var aR="firebase-messaging-store",uR=null;function cR(){return uR||(uR=oA.openDb("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(aR)}}))),uR}function hR(t){return Uh(this,void 0,void 0,(function(){var e,n,r;return Vh(this,(function(i){switch(i.label){case 0:return e=pR(t),[4,cR()];case 1:return[4,i.sent().transaction(aR).objectStore(aR).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,oR(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,lR(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function lR(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return n=pR(t),[4,cR()];case 1:return r=o.sent(),[4,(i=r.transaction(aR,"readwrite")).objectStore(aR).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function fR(t){return Uh(this,void 0,void 0,(function(){var e,n,r;return Vh(this,(function(i){switch(i.label){case 0:return e=pR(t),[4,cR()];case 1:return n=i.sent(),[4,(r=n.transaction(aR,"readwrite")).objectStore(aR).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function pR(t){return t.appConfig.appId}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function dR(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return[4,mR(t)];case 1:n=u.sent(),r=_R(e),i={method:"POST",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(yR(t.appConfig),i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw s=u.sent(),ZA.create("token-subscribe-failed",{errorInfo:s});case 6:if(o.error)throw a=o.error.message,ZA.create("token-subscribe-failed",{errorInfo:a});if(!o.token)throw ZA.create("token-subscribe-no-token");return[2,o.token]}}))}))}function vR(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return[4,mR(t)];case 1:n=u.sent(),r=_R(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(yR(t.appConfig)+"/"+e.token,i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw s=u.sent(),ZA.create("token-update-failed",{errorInfo:s});case 6:if(o.error)throw a=o.error.message,ZA.create("token-update-failed",{errorInfo:a});if(!o.token)throw ZA.create("token-update-no-token");return[2,o.token]}}))}))}function gR(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i,o,s;return Vh(this,(function(a){switch(a.label){case 0:return[4,mR(t)];case 1:n=a.sent(),r={method:"DELETE",headers:n},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(yR(t.appConfig)+"/"+e,r)];case 3:return[4,a.sent().json()];case 4:if((i=a.sent()).error)throw o=i.error.message,ZA.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw s=a.sent(),ZA.create("token-unsubscribe-failed",{errorInfo:s});case 6:return[2]}}))}))}function yR(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function mR(t){var e=t.appConfig,n=t.installations;return Uh(this,void 0,void 0,(function(){var t;return Vh(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function _R(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==$A&&(o.web.applicationPubKey=i),o}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bR(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o,s;return Vh(this,(function(a){switch(a.label){case 0:if("granted"!==Notification.permission)throw ZA.create("permission-blocked");return[4,TR(e,n)];case 1:return r=a.sent(),[4,hR(t)];case 2:return i=a.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:eR(r.getKey("auth")),p256dh:eR(r.getKey("p256dh"))},i?[3,3]:[2,IR(t,o)];case 3:if(u=i.subscriptionOptions,h=(c=o).vapidKey===u.vapidKey,l=c.endpoint===u.endpoint,f=c.auth===u.auth,p=c.p256dh===u.p256dh,h&&l&&f&&p)return[3,8];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,gR(t,i.token)];case 5:return a.sent(),[3,7];case 6:return s=a.sent(),console.warn(s),[3,7];case 7:return[2,IR(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,ER({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,h,l,f,p;
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}))}))}function wR(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return[4,hR(t)];case 1:return(n=i.sent())?[4,gR(t,n.token)]:[3,4];case 2:return i.sent(),[4,fR(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function ER(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o;return Vh(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,5]),[4,vR(e,t)];case 1:return r=s.sent(),i=jh(jh({},t),{token:r,createTime:Date.now()}),[4,lR(e,i)];case 2:return s.sent(),[2,r];case 3:return o=s.sent(),[4,wR(e,n)];case 4:throw s.sent(),o;case 5:return[2]}}))}))}function IR(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return[4,dR(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,lR(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function TR(t,e){return Uh(this,void 0,void 0,(function(){var n;return Vh(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:nR(e)})]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function CR(t){return"object"==typeof t&&!!t&&tR in t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function SR(t){return new Promise((function(e){setTimeout(e,t)}))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xR=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw ZA.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return Uh(this,void 0,void 0,(function(){var n;return Vh(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,hR(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:$A,r.label=2;case 2:return[2,bR(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return wR(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw ZA.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw ZA.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw ZA.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw ZA.create("only-available-in-window")},t.prototype.onMessage=function(){throw ZA.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw ZA.create("only-available-in-window")},t.prototype.onPush=function(t){return Uh(this,void 0,void 0,(function(){var e,n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t))?[4,RR()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,AR(n,e)]:(r=!1,e.notification?[4,kR(OR(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,SR(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return Uh(this,void 0,void 0,(function(){var r;return Vh(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,wR(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,hR(this.firebaseDependencies)];case 3:return r=i.sent(),[4,wR(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,bR(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:$A)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return Uh(this,void 0,void 0,(function(){var r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;if(i)return i;return CR(t.data)?self.location.origin:null}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(r))?(o=new URL(i,self.location.href),s=new URL(self.location.origin),o.host!==s.host?[2]:[4,PR(o)]):[2]):[2];case 1:return(a=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return a=u.sent(),[4,SR(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,a.focus()];case 5:a=u.sent(),u.label=6;case 6:return a?(r.messageType=QA.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,a.postMessage(r)]):[2]}}))}))},t}();function OR(t){var e,n=jh({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function PR(t){return Uh(this,void 0,void 0,(function(){var e,n,r,i,o,s,a;return Vh(this,(function(u){switch(u.label){case 0:return[4,RR()];case 1:e=u.sent();try{for(n=qh(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(t){s={error:t}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}}return[2,null]}}))}))}function AR(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=QA.PUSH_RECEIVED;try{for(var i=qh(t),o=i.next();!o.done;o=i.next()){o.value.postMessage(e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function RR(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function kR(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var NR=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return Uh(this,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===QA.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),CR(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw ZA.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,bR(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=$A),[2]}))}))},t.prototype.updateSwReg=function(t){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw ZA.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return Uh(this,void 0,void 0,(function(){var t,e;return Vh(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),ZA.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,wR(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return Uh(this,void 0,void 0,(function(){var t;return Vh(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?ZA.create("permission-blocked"):ZA.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw ZA.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw ZA.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw ZA.create("invalid-sw-registration");if(this.swRegistration)throw ZA.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw ZA.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw ZA.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return Uh(this,void 0,void 0,(function(){var n;return Vh(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case QA.NOTIFICATION_CLICKED:return"notification_open";case QA.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function DR(t){return ZA.create("missing-app-config-values",{valueName:t})}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var LR={isSupported:MR};function MR(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}sf.INTERNAL.registerComponent(new Rl("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw DR("App Configuration Object");if(!t.name)throw DR("App Name");var r=t.options;try{for(var i=qh(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var s=o.value;if(!r[s])throw DR(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!MR())throw ZA.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new xR(n):new NR(n)}),"PUBLIC").setServiceProps(LR));
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var FR="firebasestorage.googleapis.com",jR=function(t){function e(n,r){var i=t.call(this,ik(n),"Firebase Storage: "+r+" ("+ik(n)+")")||this;return i.customData={serverResponse:null},Object.setPrototypeOf(i,e.prototype),i}return Fh(e,t),e.prototype.codeEquals=function(t){return ik(t)===this.code},Object.defineProperty(e.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t},enumerable:!1,configurable:!0}),e}(hl),UR="unknown",VR="object-not-found",qR="quota-exceeded",BR="unauthenticated",zR="unauthorized",WR="retry-limit-exceeded",KR="canceled",GR="invalid-url",HR="invalid-default-bucket",XR="no-default-bucket",YR="cannot-slice-blob",QR="server-file-wrong-size",JR="no-download-url",ZR="invalid-argument",$R="app-deleted",tk="invalid-root-operation",ek="invalid-format",nk="internal-error",rk="unsupported-environment";function ik(t){return"storage/"+t}function ok(){return new jR(UR,"An unknown error occurred, please check the error payload for server response.")}function sk(){return new jR(KR,"User canceled the upload/download.")}function ak(){return new jR(YR,"Cannot slice blob for upload. Please retry the upload.")}function uk(t){return new jR(ZR,t)}function ck(){return new jR($R,"The Firebase app was deleted.")}function hk(t){return new jR(tk,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lk(t,e){return new jR(ek,"String does not match format '"+t+"': "+e)}function fk(t){throw new jR(nk,"Internal error: "+t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var pk={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},dk=function(t,e){this.data=t,this.contentType=e||null};function vk(t,e){switch(t){case pk.RAW:return new dk(gk(e));case pk.BASE64:case pk.BASE64URL:return new dk(yk(t,e));case pk.DATA_URL:return new dk((n=new mk(e)).base64?yk(pk.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw lk(pk.DATA_URL,"Malformed data URL.")}return gk(e)}(n.rest),function(t){return new mk(t).contentType}(e))}var n;throw ok()}function gk(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function yk(t,e){switch(t){case pk.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw lk(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case pk.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw lk(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(e)}catch(e){throw lk(t,"Invalid character found")}for(var a=new Uint8Array(s.length),u=0;u<s.length;u++)a[u]=s.charCodeAt(u);return a}var mk=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw lk(pk.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var r,i;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */};var _k,bk={STATE_CHANGED:"state_changed"},wk="running",Ek="pausing",Ik="paused",Tk="success",Ck="canceling",Sk="canceled",xk="error",Ok={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Pk(t){switch(t){case wk:case Ek:case Ck:return Ok.RUNNING;case Ik:return Ok.PAUSED;case Tk:return Ok.SUCCESS;case Sk:return Ok.CANCELED;case xk:default:return Ok.ERROR}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(_k||(_k={}));
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ak=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=_k.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=_k.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=_k.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw fk("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw fk("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw fk("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw fk("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Rk=function(){function t(){}return t.prototype.createXhrIo=function(){return new Ak},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kk(t){return"string"==typeof t||t instanceof String}function Nk(t){return Dk()&&t instanceof Blob}function Dk(){return"undefined"!=typeof Blob}function Lk(t,e,n,r){if(r<e)throw new jR(ZR,"Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw new jR(ZR,"Invalid value for '"+t+"'. Expected "+n+" or less.")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Mk(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Fk(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Mk();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(Dk())return new Blob(t);throw new jR(rk,"This browser doesn't seem to support creating Blobs")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var jk=function(){function t(t,e){var n=0,r="";Nk(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(Nk(this.data_)){var r=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===r?null:new t(r)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Dk()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(Fk.apply(null,r))}var i=e.map((function(t){return kk(t)?vk(pk.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var s=new Uint8Array(o),a=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)s[a++]=t[e]})),new t(s,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Uk=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw new jR(HR,"Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e){var n=null,r="([A-Za-z0-9.\\-_]+)";var i=new RegExp("^gs://"+r+"(/(.*))?$","i");function o(t){t.path_=decodeURIComponent(t.path)}for(var s=FR.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+r+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/"+r+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:o}],u=0;u<a.length;u++){var c=a[u],h=c.regex.exec(e);if(h){var l=h[c.indices.bucket],f=h[c.indices.path];f||(f=""),n=new t(l,f),c.postModify(n);break}}if(null==n)throw function(t){return new jR(GR,"Invalid URL '"+t+"'.")}(e);return n},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Vk(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function qk(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Bk(t){return"https://"+FR+"/v0"+t}function zk(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wk(t,e){return e}var Kk=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Wk},Gk=null;function Hk(){if(Gk)return Gk;var t=[];t.push(new Kk("bucket")),t.push(new Kk("generation")),t.push(new Kk("metageneration")),t.push(new Kk("name","fullPath",!0));var e=new Kk("name");e.xform=function(t,e){return function(t){return!kk(t)||t.length<2?t:qk(t)}(e)},t.push(e);var n=new Kk("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new Kk("timeCreated")),t.push(new Kk("updated")),t.push(new Kk("md5Hash",null,!0)),t.push(new Kk("cacheControl",null,!0)),t.push(new Kk("contentDisposition",null,!0)),t.push(new Kk("contentEncoding",null,!0)),t.push(new Kk("contentLanguage",null,!0)),t.push(new Kk("contentType",null,!0)),t.push(new Kk("metadata","customMetadata",!0)),Gk=t}function Xk(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var s=n[o];r[s.local]=s.xform(r,e[s.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new Uk(n,r);return e.makeStorageReference(i)}})}(r,t),r}function Yk(t,e,n){var r=Vk(e);return null===r?null:Xk(t,r,n)}function Qk(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Jk(t,e,n){var r=Vk(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var s=o[i].replace(/\/$/,""),a=t.makeStorageReference(new Uk(e,s));r.prefixes.push(a)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var h=c[u];a=t.makeStorageReference(new Uk(e,h.name)),r.items.push(a)}return r}(t,e,r)}var Zk=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $k(t){if(!t)throw ok()}function tN(t,e){return function(n,r){var i=Yk(t,r,e);return $k(null!==i),i}}function eN(t,e){return function(n,r){var i=Yk(t,r,e);return $k(null!==i),function(t,e){var n=Vk(e);if(null===n)return null;if(!kk(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map((function(e){var n=t.bucket,r=t.fullPath;return Bk("/b/"+i(n)+"/o/"+i(r))+zk({alt:"media",token:e})}))[0]}(i,r)}}function nN(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=new jR(BR,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new jR(qR,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new jR(zR,"User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function rN(t){var e=nN(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new jR(VR,"Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function iN(t,e,n){var r=Bk(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new Zk(r,"GET",tN(t,n),i);return o.errorHandler=rN(e),o}function oN(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var s=Bk(e.bucketOnlyServerUrl()),a=t.maxOperationRetryTime,u=new Zk(s,"GET",function(t,e){return function(n,r){var i=Jk(t,e,r);return $k(null!==i),i}}(t,e.bucket),a);return u.urlParams=o,u.errorHandler=nN(e),u}function sN(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}var aN=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function uN(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){$k(!1)}return $k(!!n&&-1!==(e||["active"]).indexOf(n)),n}var cN=262144;function hN(t,e,n,r,i,o,s,a){var u=new aN(0,0);if(s?(u.current=s.current,u.total=s.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new jR(QR,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,f=l+h,p={"X-Goog-Upload-Command":h===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(l,f);if(null===d)throw ak();var v=e.maxUploadRetryTime,g=new Zk(n,"POST",(function(t,n){var i,s=uN(t,["active","final"]),a=u.current+h,c=r.size();return i="final"===s?tN(e,o)(t,n):null,new aN(a,c,"final"===s,i)}),v);return g.headers=p,g.body=d.uploadData(),g.progressCallback=a||null,g.errorHandler=nN(t),g}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var lN=function(t,e,n){if(function(t){return"function"==typeof t}(t)||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}},fN=function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function pN(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var dN=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Hk(),this._resumable=this._shouldDoResumable(this._blob),this._state=wk,this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t.codeEquals(KR)?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition(xk))},this._metadataErrorHandler=function(t){r._request=void 0,t.codeEquals(KR)?r.completeTransitions_():(r._error=t,r._transition(xk))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){this._state===wk&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;this._ref.storage.getAuthToken().then((function(n){switch(e._state){case wk:t(n);break;case Ck:e._transition(Sk);break;case Ek:e._transition(Ik)}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s=sN(e,r,i),a={name:s.fullPath},u=Bk(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},h=Qk(s,n),l=t.maxUploadRetryTime,f=new Zk(u,"POST",(function(t){var e;uN(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){$k(!1)}return $k(kk(e)),e}),l);return f.urlParams=a,f.headers=c,f.body=h,f.errorHandler=nN(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new Zk(n,"POST",(function(t){var e=uN(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){$k(!1)}n||$k(!1);var i=Number(n);return $k(!isNaN(i)),new aN(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=nN(e),o}(t._ref.storage,t._ref._location,e,t._blob),i=t._ref.storage.makeRequest(r,n);t._request=i,i.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=cN*this._chunkMultiplier,n=new aN(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i){var o;try{o=hN(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition(xk)}var s=t._ref.storage.makeRequest(o,i);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition(Tk)):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){cN*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e){var n=iN(t._ref.storage,t._ref._location,t._mappings),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition(Tk)}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},a=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();s["Content-Type"]="multipart/related; boundary="+a;var u=sN(e,r,i),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Qk(u,n)+"\r\n--"+a+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+a+"--",l=jk.getBlob(c,r,h);if(null===l)throw ak();var f={name:u.fullPath},p=Bk(o),d=t.maxUploadRetryTime,v=new Zk(p,"POST",tN(t,n),d);return v.urlParams=f,v.headers=s,v.body=l.uploadData(),v.errorHandler=nN(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition(Tk)}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case Ck:case Ek:this._state=t,void 0!==this._request&&this._request.cancel();break;case wk:var e=this._state===Ik;this._state=t,e&&(this._notifyObservers(),this._start());break;case Ik:this._state=t,this._notifyObservers();break;case Sk:this._error=sk(),this._state=t,this._notifyObservers();break;case xk:case Tk:this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case Ek:this._transition(Ik);break;case Ck:this._transition(Sk);break;case wk:this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=Pk(this._state);return new fN(this._transferred,this._blob.size(),t,this._metadata,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new lN(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(Pk(this._state)){case Ok.SUCCESS:pN(this._resolve.bind(null,this.snapshot))();break;case Ok.CANCELED:case Ok.ERROR:pN(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(Pk(this._state)){case Ok.RUNNING:case Ok.PAUSED:t.next&&pN(t.next.bind(t,this.snapshot))();break;case Ok.SUCCESS:t.complete&&pN(t.complete.bind(t))();break;case Ok.CANCELED:case Ok.ERROR:t.error&&pN(t.error.bind(t,this._error))();break;default:t.error&&pN(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t=this._state===Ik||this._state===Ek;return t&&this._transition(wk),t},t.prototype.pause=function(){var t=this._state===wk;return t&&this._transition(Ek),t},t.prototype.cancel=function(){var t=this._state===wk||this._state===Ek;return t&&this._transition(Ck),t},t}(),vN=function(){function t(t,e){this._service=t,this._location=e instanceof Uk?e:Uk.makeFromUrl(e)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype.newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new Uk(this._location.bucket,"");return this.newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return qk(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new Uk(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw hk(t)},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function gN(t){var e={prefixes:[],items:[]};return yN(t,e).then((function(){return e}))}function yN(t,e,n){return Uh(this,void 0,void 0,(function(){var r,i,o;return Vh(this,(function(s){switch(s.label){case 0:return[4,mN(t,{pageToken:n})];case 1:return r=s.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(o=e.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,yN(t,e,r.nextPageToken)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function mN(t,e){return Uh(this,void 0,void 0,(function(){var n,r,i;return Vh(this,(function(o){switch(o.label){case 0:return null!=e&&"number"==typeof e.maxResults&&Lk("options.maxResults",1,1e3,e.maxResults),[4,t.storage.getAuthToken()];case 1:return n=o.sent(),r=e||{},i=oN(t.storage,t._location,"/",r.pageToken,r.maxResults),[2,t.storage.makeRequest(i,n).getPromise()]}}))}))}function _N(t,e){return Uh(this,void 0,void 0,(function(){var n,r;return Vh(this,(function(i){switch(i.label){case 0:return t._throwIfRoot("updateMetadata"),[4,t.storage.getAuthToken()];case 1:return n=i.sent(),r=function(t,e,n,r){var i=Bk(e.fullServerUrl()),o=Qk(n,r),s=t.maxOperationRetryTime,a=new Zk(i,"PATCH",tN(t,r),s);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=o,a.errorHandler=rN(e),a}(t.storage,t._location,e,Hk()),[2,t.storage.makeRequest(r,n).getPromise()]}}))}))}function bN(t){return Uh(this,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("getDownloadURL"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=function(t,e,n){var r=Bk(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new Zk(r,"GET",eN(t,n),i);return o.errorHandler=rN(e),o}(t.storage,t._location,Hk()),[2,t.storage.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new jR(JR,"The given file does not have any download URLs.");return t}))]}}))}))}function wN(t){return Uh(this,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("deleteObject"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=function(t,e){var n=Bk(e.fullServerUrl()),r=t.maxOperationRetryTime,i=new Zk(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=rN(e),i}(t.storage,t._location),[2,t.storage.makeRequest(n,e).getPromise()]}}))}))}function EN(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new Uk(t._location.bucket,n);return new vN(t.storage,r)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var IN=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),TN=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate),this._snapshot=new IN(this._delegate.snapshot,this,this._ref)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return this._snapshot},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new IN(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new IN(t,i,i._ref))}:{next:e.next?function(t){return e.next(new IN(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),CN=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new SN(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new SN(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),SN=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(EN(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new TN(function(t,e,n){return void 0===n&&(n=null),t._throwIfRoot("uploadBytesResumable"),new dN(t,new jk(e),n)}(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){return void 0===e&&(e=pk.RAW),this._throwIfRoot("putString"),new TN(function(t,e,n,r){void 0===n&&(n=pk.RAW),t._throwIfRoot("putString");var i=vk(n,e),o=jh({},r);return null==o.contentType&&null!=i.contentType&&(o.contentType=i.contentType),new dN(t,new jk(i.data,!0),o)}(this._delegate,t,e,n),this)},t.prototype.listAll=function(){var t=this;return gN(this._delegate).then((function(e){return new CN(e,t.storage)}))},t.prototype.list=function(t){var e=this;return mN(this._delegate,t).then((function(t){return new CN(t,e.storage)}))},t.prototype.getMetadata=function(){return function(t){return Uh(this,void 0,void 0,(function(){var e,n;return Vh(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("getMetadata"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=iN(t.storage,t._location,Hk()),[2,t.storage.makeRequest(n,e).getPromise()]}}))}))}(this._delegate)},t.prototype.updateMetadata=function(t){return _N(this._delegate,t)},t.prototype.getDownloadURL=function(){return bN(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),wN(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw hk(t)},t}(),xN=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var ON=function(){function t(t,e,n,r,i,o,s,a,u,c,h){var l=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=s,this.errorCallback_=a,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise((function(t,e){l.resolve_=t,l.reject_=e,l.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,s=n.xhr;if(n.wasSuccessCode)try{var a=t.callback_(s,s.getResponseText());!
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(t){return void 0!==t}(a)?i():i(a)}catch(t){o(t)}else null!==s?((r=ok()).serverResponse=s.getResponseText(),t.errorCallback_?o(t.errorCallback_(s,r)):o(r)):n.canceled?o(r=t.appDelete_?ck():sk()):o(r=new jR(WR,"Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new PN(!1,null,!0)):this.backoffId_=
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(t,e,n){var r=1,i=null,o=!1,s=0;function a(){return 2===s}var u=!1;function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u||(u=!0,e.apply(null,t))}function h(e){i=setTimeout((function(){i=null,t(l,a())}),e)}function l(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!u)if(t)c.call.apply(c,Wh([null,t],e));else{var i;a()||o?c.call.apply(c,Wh([null,t],e)):(r<64&&(r*=2),1===s?(s=2,i=0):i=1e3*(r+Math.random()),h(i))}}var f=!1;function p(t){f||(f=!0,u||(null!==i?(t||(s=2),clearTimeout(i),h(0)):t||(s=1)))}return h(0),setTimeout((function(){o=!0,p(!0)}),n),p}((function(e,n){if(n)e(!1,new PN(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===_k.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var s=-1!==t.successCodes_.indexOf(o);e(!0,new PN(s,n))}else{var a=n.getErrorCode()===_k.ABORT;e(!1,new PN(!1,null,a))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}),e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),PN=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function AN(t,e,n,r){var i=zk(t.urlParams),o=t.url+i,s=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(s,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(s,n),function(t){var e=void 0!==sf?sf.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(s),new ON(o,t.method,s,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function RN(t){return/^[A-Za-z]+:\/\//.test(t)}function kN(t,e){if(t instanceof DN){var n=t;if(null==n._bucket)throw new jR(XR,"No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new vN(n,n._bucket);return null!=e?kN(r,e):r}if(void 0!==e){if(e.includes(".."))throw uk('`path` param cannot contain ".."');return EN(t,e)}return t}function NN(t,e){if(e&&RN(e)){if(t instanceof DN)return new vN(t,e);throw uk("To use ref(service, url), the first argument must be a Storage instance.")}return kN(t,e)}var DN=function(){function t(t,e,n,r){var i,o;this.app=t,this._authProvider=e,this._pool=n,this._url=r,this._bucket=null,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Uk.makeFromBucketSpec(r):(i=this.app.options,null==(o=null==i?void 0:i.storageBucket)?null:Uk.makeFromBucketSpec(o))}return Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){Lk("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){Lk("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype.getAuthToken=function(){return Uh(this,void 0,void 0,(function(){var t,e;return Vh(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype.makeStorageReference=function(t){return new vN(this,t)},t.prototype.makeRequest=function(t,e){var n=this;if(this._deleted)return new xN(ck());var r=AN(t,this._appId,e,this._pool);return this._requests.add(r),r.getPromise().then((function(){return n._requests.delete(r)}),(function(){return n._requests.delete(r)})),r},t}(),LN=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(RN(t))throw uk("ref() expected a child path but got a URL, use refFromURL instead.");return new SN(NN(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!RN(t))throw uk("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Uk.makeFromUrl(t)}catch(t){throw uk("refFromUrl() expected a valid full URL but got an invalid one.")}return new SN(NN(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function MN(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new LN(n,new DN(n,r,new Rk,e))}!function(t){var e={TaskState:Ok,TaskEvent:bk,StringFormat:pk,Storage:DN,Reference:SN};t.INTERNAL.registerComponent(new Rl("storage",MN,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.4.2")}(sf);var FN,jN,UN,VN="0.4.5",qN=VN,BN="FB-PERF-TRACE-MEASURE",zN="_wt_",WN="_fcp",KN="_fid",GN="@firebase/performance/config",HN="@firebase/performance/configexpire",XN="Performance",YN=((FN={})["trace started"]="Trace {$traceName} was started before.",FN["trace stopped"]="Trace {$traceName} is not running.",FN["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",FN["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",FN["no window"]="Window is not available.",FN["no app id"]="App id is not available.",FN["no project id"]="Project id is not available.",FN["no api key"]="Api key is not available.",FN["invalid cc log"]="Attempted to queue invalid cc event",FN["FB not default"]="Performance can only start when Firebase app instance is the default one.",FN["RC response not ok"]="RC response is not ok",FN["invalid attribute name"]="Attribute name {$attributeName} is invalid.",FN["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",FN["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",FN["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",FN),QN=new ll("performance",XN,YN),JN=new Wl(XN);JN.logLevel=Fl.INFO;var ZN,$N=function(){function t(t){if(this.window=t,!t)throw QN.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!al()||(JN.info("IndexedDB is not supported by current browswer"),!1):(JN.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===jN&&(jN=new t(UN)),jN},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function tD(t,e){var n=t.length-e.length;if(n<0||n>1)throw QN.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var eD,nD,rD=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=tD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=tD("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw QN.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw QN.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw QN.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===ZN&&(ZN=new t),ZN},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function iD(){return eD}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(nD||(nD={}));var oD=["firebase_","google_","ga_"],sD=new RegExp("^[a-zA-Z]\\w*$");function aD(){var t=$N.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function uD(){switch($N.getInstance().document.visibilityState){case"visible":return nD.VISIBLE;case"hidden":return nD.HIDDEN;default:return nD.UNKNOWN}}function cD(){var t=$N.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var hD="0.0.1",lD=!0,fD="FIREBASE_INSTALLATIONS_AUTH";function pD(t){var e=function(){var t=$N.getInstance().localStorage;if(!t)return;var e=t.getItem(HN);if(!(e&&(n=e,Number(n)>Date.now())))return;var n;var r=t.getItem(GN);if(!r)return;try{return JSON.parse(r)}catch(t){return}}();return e?(vD(e),Promise.resolve()):function(t){return(e=rD.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+rD.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+rD.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:fD+" "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:rD.getInstance().getAppId(),app_version:qN,sdk_version:hD})});return fetch(r).then((function(t){if(t.ok)return t.json();throw QN.create("RC response not ok")}))})).catch((function(){JN.info(dD)}));var e;
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}(t).then(vD).then((function(t){return function(t){var e=$N.getInstance().localStorage;if(!t||!e)return;e.setItem(GN,JSON.stringify(t)),e.setItem(HN,String(Date.now()+60*rD.getInstance().configTimeToLive*60*1e3))}(t)}),(function(){}))}var dD="Could not fetch config, will use default configs";function vD(t){if(!t)return t;var e=rD.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=lD,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=gD(e.tracesSamplingRate),e.logNetworkAfterSampling=gD(e.networkRequestsSamplingRate),t}function gD(t){return Math.random()<=t}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yD,mD=1;function _D(){return mD=2,yD=yD||function(){var t=$N.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=rD.getInstance().installationsService.getId()).then((function(t){eD=t})),t;var t})).then((function(t){return pD(t)})).then((function(){return bD()}),(function(){return bD()}))}function bD(){mD=3}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wD,ED=1e4,ID=3,TD=[],CD=!1;function SD(t){setTimeout((function(){var t,e;if(0!==ID)return TD.length?(t=TD.splice(0,1e3),e=t.map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(t,e){return function(t){var e=rD.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||JN.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=ED;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(TD=Wh(e,TD),JN.info("Retry transport request later.")),ID=3,SD(r)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:rD.getInstance().logSource,log_event:e},t).catch((function(){TD=Wh(t,TD),ID--,JN.info("Tries left: "+ID+"."),SD(ED)}))):SD(ED)}),t)}function xD(t){if(!t.eventTime||!t.message)throw QN.create("invalid cc log");TD=Wh(TD,[t])}function OD(t,e){wD||(wD=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];xD({message:t.apply(void 0,e),eventTime:Date.now()})}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(RD)),wD(t,e)}function PD(t){var e=rD.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&$N.getInstance().requiredApisAvailable()&&(t.isAuto&&uD()!==nD.VISIBLE||(3===mD?AD(t):_D().then((function(){return AD(t)}),(function(){return AD(t)}))))}function AD(t){if(iD()){var e=rD.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return OD(t,1)}),0)}}function RD(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:kD(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:kD(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function kD(){return{google_app_id:rD.getInstance().getAppId(),app_instance_id:iD(),web_app_info:{sdk_version:qN,page_url:$N.getInstance().getUrl(),service_worker_status:aD(),visibility_state:uD(),effective_connection_type:cD()},application_process_state:0}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ND=["_fp",WN,KN];
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var DD=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=$N.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw QN.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw QN.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),PD(this)},t.prototype.record=function(t,e,n){if(t<=0)throw QN.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw QN.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=jh({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}PD(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(!function(t,e){return!(0===t.length||t.length>100)&&(e&&e.startsWith(zN)&&ND.indexOf(t)>-1||!t.startsWith("_"))}(t,this.name))throw QN.create("invalid custom metric name",{customMetricName:t});var n,r;this.counters[t]=(n=e,(r=Math.floor(n))<n&&JN.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n=function(t){return!(0===t.length||t.length>40||oD.some((function(e){return t.startsWith(e)}))||!t.match(sD))}(t),r=function(t){return 0!==t.length&&t.length<=100}(e);if(n&&r)this.customAttributes[t]=e;else{if(!n)throw QN.create("invalid attribute name",{attributeName:t});if(!r)throw QN.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return jh({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=$N.getInstance().getUrl();if(i){var o=new t(zN+i,!0),s=Math.floor(1e3*$N.getInstance().getTimeOrigin());o.setStartTime(s),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));if(n){var a=n.find((function(t){return"first-paint"===t.name}));a&&a.startTime&&o.putMetric("_fp",Math.floor(1e3*a.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(WN,Math.floor(1e3*u.startTime)),r&&o.putMetric(KN,Math.floor(1e3*r))}PD(o)}},t.createUserTimingTrace=function(e){PD(new t(e,!1,e))},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function LD(t){var e=t;if(e&&void 0!==e.responseStart){var n=$N.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=rD.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return OD(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function MD(){iD()&&(setTimeout((function(){return function(){var t=$N.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){DD.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),DD.createOobTrace(e,n,t))}))}else DD.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=$N.getInstance(),e=t.getEntriesByType("resource"),n=0,r=e;n<r.length;n++){LD(r[n])}t.setupObserver("resource",LD)}()}),0),setTimeout((function(){return function(){for(var t=$N.getInstance(),e=t.getEntriesByType("measure"),n=0,r=e;n<r.length;n++){FD(r[n])}t.setupObserver("measure",FD)}()}),0))}function FD(t){var e=t.name;e.substring(0,BN.length)!==BN&&DD.createUserTimingTrace(e)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var jD=function(){function t(t){this.app=t,$N.getInstance().requiredApisAvailable()&&ul().then((function(t){t&&(CD||(SD(5500),CD=!0),_D().then(MD,MD))})).catch((function(t){JN.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new DD(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return rD.getInstance().instrumentationEnabled},set:function(t){rD.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return rD.getInstance().dataCollectionEnabled},set:function(t){rD.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(t){var e=function(t,e){if("[DEFAULT]"!==t.name)throw QN.create("FB not default");if("undefined"==typeof window)throw QN.create("no window");return function(t){UN=t}(window),rD.getInstance().firebaseAppInstance=t,rD.getInstance().installationsService=e,new jD(t)};t.INTERNAL.registerComponent(new Rl("performance",(function(t){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();return e(n,r)}),"PUBLIC")),t.registerVersion("@firebase/performance",VN)}(sf);
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var UD,VD,qD="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(UD||(UD={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(VD||(VD={}));
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var BD,zD=new Wl("@firebase/analytics");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function WD(t,e,n,r,i,o){return Uh(this,void 0,void 0,(function(){var s,a,u,c;return Vh(this,(function(h){switch(h.label){case 0:s=r[i],h.label=1;case 1:return h.trys.push([1,7,,8]),s?[4,e[s]]:[3,3];case 2:return h.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return a=h.sent(),(u=a.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:h.sent(),h.label=6;case 6:return[3,8];case 7:return c=h.sent(),zD.error(c),[3,8];case 8:return t(UD.CONFIG,i,o),[2]}}))}))}function KD(t,e,n,r,i){return Uh(this,void 0,void 0,(function(){var o,s,a,u,c,h,l,f;return Vh(this,(function(p){switch(p.label){case 0:return p.trys.push([0,4,,5]),o=[],i&&i.send_to?(s=i.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(n)]):[3,2];case 1:for(a=p.sent(),u=function(t){var n=a.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,h=s;c<h.length&&(l=h[c],"break"!==u(l));c++);p.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return p.sent(),t(UD.EVENT,r,i||{}),[3,5];case 4:return f=p.sent(),zD.error(f),[3,5];case 5:return[2]}}))}))}function GD(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,s){return Uh(this,void 0,void 0,(function(){var a;return Vh(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==UD.EVENT?[3,2]:[4,KD(t,e,n,o,s)];case 1:return u.sent(),[3,5];case 2:return i!==UD.CONFIG?[3,4]:[4,WD(t,e,n,r,o,s)];case 3:return u.sent(),[3,5];case 4:t(UD.SET,o),u.label=5;case 5:return[3,7];case 6:return a=u.sent(),zD.error(a),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}var HD=((BD={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",BD["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",BD["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",BD["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",BD["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",BD["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",BD["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",BD["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',BD["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',BD),XD=new ll("analytics","Analytics",HD),YD=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function QD(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function JD(t){var e;return Uh(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Vh(this,(function(c){switch(c.label){case 0:return n=t.appId,r=t.apiKey,i={method:"GET",headers:QD(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(s=c.sent()).status||304===s.status)return[3,6];a="",c.label=2;case 2:return c.trys.push([2,4,,5]),[4,s.json()];case 3:return u=c.sent(),(null===(e=u.error)||void 0===e?void 0:e.message)&&(a=u.error.message),[3,5];case 4:return c.sent(),[3,5];case 5:throw XD.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a});case 6:return[2,s.json()]}}))}))}function ZD(t,e,n,r){var i=e.throttleEndTimeMillis,o=e.backoffCount;return void 0===r&&(r=YD),Uh(this,void 0,void 0,(function(){var e,s,a,u,c,h,l;return Vh(this,(function(f){switch(f.label){case 0:e=t.appId,s=t.measurementId,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,$D(n,i)];case 2:return f.sent(),[3,4];case 3:if(a=f.sent(),s)return zD.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+a.message+"]"),[2,{appId:e,measurementId:s}];throw a;case 4:return f.trys.push([4,6,,7]),[4,JD(t)];case 5:return u=f.sent(),r.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof hl&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c=f.sent())){if(r.deleteThrottleMetadata(e),s)return zD.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:e,measurementId:s}];throw c}return h=503===Number(c.customData.httpStatus)?Al(o,r.intervalMillis,30):Al(o,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+h,backoffCount:o+1},r.setThrottleMetadata(e,l),zD.debug("Calling attemptFetch again in "+h+" millis"),[2,ZD(t,l,n,r)];case 7:return[2]}}))}))}function $D(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(XD.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var tL=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function eL(t,e,n,r,i){return Uh(this,void 0,void 0,(function(){var o,s,a,u,c,h,l;return Vh(this,(function(f){switch(f.label){case 0:return(o=function(t,e,n){return void 0===e&&(e=YD),Uh(this,void 0,void 0,(function(){var r,i,o,s,a,u,c=this;return Vh(this,(function(h){if(r=t.options,i=r.appId,o=r.apiKey,s=r.measurementId,!i)throw XD.create("no-app-id");if(!o){if(s)return[2,{measurementId:s,appId:i}];throw XD.create("no-api-key")}return a=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new tL,setTimeout((function(){return Uh(c,void 0,void 0,(function(){return Vh(this,(function(t){return u.abort(),[2]}))}))}),void 0!==n?n:6e4),[2,ZD({appId:i,apiKey:o,measurementId:s},a,u,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&zD.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return zD.error(t)})),e.push(o),s=function(){return Uh(this,void 0,void 0,(function(){var t;return Vh(this,(function(e){switch(e.label){case 0:return al()?[3,1]:(zD.warn(XD.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,ul()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),zD.warn(XD.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([o,s])];case 1:return a=f.sent(),u=a[0],c=a[1],i("js",new Date),(l={}).origin="firebase",l.update=!0,h=l,null!=c&&(h.firebase_id=c),i(UD.CONFIG,u.measurementId,h),[2,u.measurementId]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var nL,rL,iL={},oL=[],sL={},aL="dataLayer",uL="gtag",cL=!1;function hL(t){if(cL)throw XD.create("already-initialized");t.dataLayerName&&(aL=t.dataLayerName),t.gtagName&&(uL=t.gtagName)}function lL(t,e){!function(){var t=[];if(il()&&t.push("This is a browser extension environment."),cl()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=XD.create("invalid-analytics-context",{errorInfo:e});zD.warn(n.message)}}();var n=t.options.appId;if(!n)throw XD.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw XD.create("no-api-key");zD.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=iL[n])throw XD.create("already-exists",{id:n});if(!cL){(function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(qD))return r}return null}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)()||function(t){var e=document.createElement("script");e.src=qD+"?l="+t,e.async=!0,document.head.appendChild(e)}(aL),function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(aL);var r=GD(iL,oL,sL,aL,uL),i=r.wrappedGtag,o=r.gtagCore;rL=i,nL=o,cL=!0}return iL[n]=eL(t,oL,sL,e,nL),{app:t,logEvent:function(t,e,r){(
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(t,e,n,r,i){return Uh(this,void 0,void 0,(function(){var o,s;return Vh(this,(function(a){switch(a.label){case 0:return i&&i.global?(t(UD.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=a.sent(),s=jh(jh({},r),{send_to:o}),t(UD.EVENT,n,s),a.label=3;case 3:return[2]}}))}))})(rL,iL[n],t,e,r).catch((function(t){return zD.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i;return Vh(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(UD.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(UD.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(rL,iL[n],t,e).catch((function(t){return zD.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i;return Vh(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(UD.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(UD.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(rL,iL[n],t,e).catch((function(t){return zD.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return Uh(this,void 0,void 0,(function(){var i,o,s,a,u;return Vh(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,s=Object.keys(n);o<s.length;o++)a=s[o],i["user_properties."+a]=n[a];return t(UD.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(UD.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(rL,iL[n],t,e).catch((function(t){return zD.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return Uh(this,void 0,void 0,(function(){var n;return Vh(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(iL[n],t).catch((function(t){return zD.error(t)}))},INTERNAL:{delete:function(){return delete iL[n],Promise.resolve()}}}}var fL="analytics";function pL(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:if(il())return[2,!1];if(!cl())return[2,!1];if(!al())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,ul()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */!function(t){t.INTERNAL.registerComponent(new Rl(fL,(function(t){return lL(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:hL,EventName:VD,isSupported:pL})),t.INTERNAL.registerComponent(new Rl("analytics-internal",(function(t){try{return{logEvent:t.getProvider(fL).getImmediate().logEvent}}catch(t){throw XD.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.2")}(sf);var dL,vL=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return Uh(this,void 0,void 0,(function(){var e,n,r,i,o;return Vh(this,(function(s){switch(s.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=s.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=s.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return s.sent(),[2,i]}}))}))},t}(),gL=((dL={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",dL["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",dL["registration-api-key"]="Undefined API key. Check Firebase app initialization.",dL["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",dL["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",dL["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",dL["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",dL["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",dL["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",dL["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',dL["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',dL["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",dL["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",dL),yL=new ll("remoteconfig","Remote Config",gL);
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var mL=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return Uh(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c,h,l,f,p,d,v,g,y,m,_;return Vh(this,(function(b){switch(b.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=b.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},u={method:"POST",headers:s,body:JSON.stringify(a)},c=fetch(o,u),h=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),b.label=2;case 2:return b.trys.push([2,5,,6]),[4,Promise.race([c,h])];case 3:return b.sent(),[4,c];case 4:return l=b.sent(),[3,6];case 5:throw f=b.sent(),p="fetch-client-network","AbortError"===f.name&&(p="fetch-timeout"),yL.create(p,{originalErrorMessage:f.message});case 6:if(d=l.status,v=l.headers.get("ETag")||void 0,200!==l.status)return[3,11];m=void 0,b.label=7;case 7:return b.trys.push([7,9,,10]),[4,l.json()];case 8:return m=b.sent(),[3,10];case 9:throw _=b.sent(),yL.create("fetch-client-parse",{originalErrorMessage:_.message});case 10:g=m.entries,y=m.state,b.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===y?d=500:"NO_CHANGE"===y?d=304:"NO_TEMPLATE"!==y&&"EMPTY_CONFIG"!==y||(g={}),304!==d&&200!==d)throw yL.create("fetch-status",{httpStatus:d});return[2,{status:d,eTag:v,config:g}]}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var w}))}))},t}(),_L=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),bL=["1","true","t","yes","y","on"],wL=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&bL.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),EL=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=Fl.DEBUG;break;case"silent":this._logger.logLevel=Fl.SILENT;break;default:this._logger.logLevel=Fl.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return Uh(this,void 0,void 0,(function(){var t,e,n;return Vh(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return Uh(this,void 0,void 0,(function(){var t,e,n,r=this;return Vh(this,(function(i){switch(i.label){case 0:t=new _L,setTimeout((function(){return Uh(r,void 0,void 0,(function(){return Vh(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),n=function(t,e){return t instanceof hl&&-1!==t.code.indexOf(e)}(e,"fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return Uh(this,void 0,void 0,(function(){return Vh(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t=this;return function(t,e){void 0===t&&(t={});void 0===e&&(e={});return Object.keys(jh(jh({},t),e))}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(e,n){return e[n]=t.getValue(n),e}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new wL("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new wL("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new wL("static"))},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function IL(t,e){var n=t.target.error||void 0;return yL.create(e,{originalErrorMessage:n&&n.message})}var TL="app_namespace_store";var CL=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(IL(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(TL,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return Uh(this,void 0,void 0,(function(){var e,n=this;return Vh(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([TL],"readonly").objectStore(TL),s=n.createCompositeKey(t);try{var a=o.get(s);a.onerror=function(t){i(IL(t,"storage-get"))},a.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(yL.create("storage-get",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.set=function(t,e){return Uh(this,void 0,void 0,(function(){var n,r=this;return Vh(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var s=n.transaction([TL],"readwrite").objectStore(TL),a=r.createCompositeKey(t);try{var u=s.put({compositeKey:a,value:e});u.onerror=function(t){o(IL(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){o(yL.create("storage-set",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.delete=function(t){return Uh(this,void 0,void 0,(function(){var e,n=this;return Vh(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([TL],"readwrite").objectStore(TL),s=n.createCompositeKey(t);try{var a=o.delete(s);a.onerror=function(t){i(IL(t,"storage-delete"))},a.onsuccess=function(){r()}}catch(t){i(yL.create("storage-delete",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),SL=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return Uh(this,void 0,void 0,(function(){var t,e,n,r,i,o;return Vh(this,(function(s){switch(s.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=s.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=s.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=s.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function xL(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(yL.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var OL,PL=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return Uh(this,void 0,void 0,(function(){var e;return Vh(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return Uh(this,void 0,void 0,(function(){var e,i,o;return Vh(this,(function(s){switch(s.label){case 0:return[4,xL(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof hl&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=s.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+Al(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return s.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}(),AL="@firebase/remote-config";(OL=sf).INTERNAL.registerComponent(new Rl("remoteConfig",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw yL.create("registration-window");var i=n.options,o=i.projectId,s=i.apiKey,a=i.appId;if(!o)throw yL.create("registration-project-id");if(!s)throw yL.create("registration-api-key");if(!a)throw yL.create("registration-app-id");e=e||"firebase";var u=new CL(a,n.name,e),c=new SL(u),h=new Wl(AL);h.logLevel=Fl.ERROR;var l=new mL(r,OL.SDK_VERSION,e,o,s,a),f=new PL(l,u),p=new vL(f,u,c,h),d=new EL(n,p,c,u,h);return d.ensureInitialized(),d}),"PUBLIC").setMultipleInstances(!0)),OL.registerVersion(AL,"0.1.30");
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
sf.registerVersion("firebase","8.2.3","app");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),sf.registerVersion("firebase","8.2.3");let RL=null;const kL=j(RL);kL.subscribe((t=>{RL=t}));const NL={projectId:"trilhos-2d2ef",measurementId:"G-EN5WT801KX",messagingSenderId:"457658473177",storageBucket:"trilhos-2d2ef.appspot.com",databaseURL:"https://trilhos-2d2ef-default-rtdb.europe-west1.firebasedatabase.app/",authDomain:"trilhos-2d2ef.firebaseapp.com",apiKey:"AIzaSyD-SYWfNzMuLdMS4ITKrXyVkk32MDGNKU8",appId:"1:457658473177:web:e6b1cf14d16ebab90bbcc8"},DL=({code:t,message:e})=>{console.error(t,e)},LL=t=>{t?console.log("user:",t.email):console.log("Not signed in :("),kL.set(t)};let ML={},FL=null;const jL=j(ML);jL.subscribe((t=>ML=t));const UL=({code:t,message:e})=>{console.error(t,e)},VL=t=>{if(FL)return jL.subscribe(t);FL=sf.database().ref("tracks"),jL.subscribe(t),FL.on("value",(t=>jL.set(t.val())))};function qL(e){let n;return{c(){n=c("div"),p(n,"id","map"),p(n,"class","map svelte-ajr6kj")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&u(n)}}}function BL(t,e,n){let{recording:r}=e,i=null,o=0,s=null;const a=new Hr([],"XYZM"),u=new Mt,c=new Mt,h=new Iu({center:[0,0],zoom:18,tilePixelRatio:2}),l=new Oh({source:new _h({tilePixelRatio:2})}),f=new Oh({source:new yh({url:"https://tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey=f22952a25e0249e8995aac2c056e0f1d",tilePixelRatio:2})}),p=new na({source:new Ea({features:[u,c]})});c.setStyle(new Zi({image:new Ji({radius:6,fill:new zr({color:"#3399CC"}),stroke:new Xr({color:"#fff",width:2})})}));const d=(t,e)=>{let n=t-(t=>(t%(2*Math.PI)+2*Math.PI)%(2*Math.PI))(e);if(Math.abs(n)>Math.PI){n=-(n>=0?1:-1)*(2*Math.PI-Math.abs(n))}return e+n},v=(t,e,n,i,o,s)=>{const u=t[0],c=t[1],h=a.getCoordinates(),l=h[h.length-1],f=l&&l[2],p=f?d(n,f):n;if(a.appendCoordinate([u,c,p,s]),a.setCoordinates(a.getCoordinates().slice(-20)),r){const a=[...t,e,n,i,o,s];console.log("saving:",a),((t,e)=>{sf.database().ref(`tracks/${t}`).push(e).catch(UL)})(r,a)}},y=()=>{const t=s.getSpeed()||0,e=s.getHeading()||0,n=s.getPosition(),r=s.getAltitude(),i=s.getAccuracy();v(n,r,e,t,i,Date.now())},m=()=>{u.setGeometry(s.getAccuracyGeometry())},_=()=>{const t=Math.max(Date.now()-750,o);o=t;const e=h.getResolution(),n=a.getCoordinateAtM(t,!0);if(!n)return;const[,,r]=n;h.setRotation(-r),h.setCenter((([t,e],n,r)=>{const[,o]=i.getSize();return[t-Math.sin(n)*o*r*1/4,e+Math.cos(n)*o*r*1/4]})(n,-r,e)),c.setGeometry(new fr(n))};return g((()=>{i=new Dc({view:h,layers:[l,f,p],target:"map"}),s=new Fr({projection:h.getProjection(),trackingOptions:{enableHighAccuracy:!0}}),s.setTracking(!0),s.on("change:position",y),s.on("change:accuracyGeometry",m),l.on("prerender",_)})),t.$$set=t=>{"recording"in t&&n(0,r=t.recording)},[r]}class zL extends M{constructor(t){super(),L(this,t,BL,qL,o,{recording:0})}}function WL(e){let n,i,o,h,d,v,g,y,m,_,b,w,E,I,T;return{c(){n=c("form"),i=c("label"),i.textContent="Email",o=l(),h=c("input"),d=l(),v=c("label"),v.textContent="Password",g=l(),y=c("input"),m=l(),_=c("div"),b=c("button"),b.textContent="Sign In",w=l(),E=c("button"),E.textContent="Sign Up",p(i,"for","email"),p(h,"type","email"),p(h,"name","email"),p(h,"placeholder","Email"),p(v,"for","password"),p(y,"type","password"),p(y,"name","password"),p(b,"type","button"),p(E,"type","button")},m(t,r){a(t,n,r),s(n,i),s(n,o),s(n,h),s(n,d),s(n,v),s(n,g),s(n,y),s(n,m),s(n,_),s(_,b),s(_,w),s(_,E),I||(T=[f(b,"click",e[3]),f(E,"click",e[4]),f(n,"submit",e[1]),f(n,"change",e[2])],I=!0)},p:t,i:t,o:t,d(t){t&&u(n),I=!1,r(T)}}}function KL(t,e,n){let r={};const i=j(r);i.subscribe((t=>n(0,r=t)));return[r,t=>t.preventDefault(),t=>{const{name:e,value:n}=t.target;i.set({...r,[e]:n})},()=>(({email:t,password:e})=>{sf.auth().signInWithEmailAndPassword(t,e).then(LL).catch(DL)})(r),()=>(({email:t,password:e})=>{sf.auth().createUserWithEmailAndPassword(t,e).then(LL).catch(DL)})(r)]}class GL extends M{constructor(t){super(),L(this,t,KL,WL,o,{})}}function HL(t,e,n){const r=t.slice();return r[6]=e[n],r}function XL(e){let n,r;return n=new GL({}),{c(){R(n.$$.fragment)},m(t,e){k(n,t,e),r=!0},p:t,i(t){r||(P(n.$$.fragment,t),r=!0)},o(t){A(n.$$.fragment,t),r=!1},d(t){N(n,t)}}}function YL(t){let e,n,r,i,o;function s(t,e){return t[1]?JL:QL}let h=s(t),f=h(t),p=Object.keys(t[0]),d=[];for(let e=0;e<p.length;e+=1)d[e]=ZL(HL(t,p,e));return i=new zL({props:{recording:t[1]}}),{c(){f.c(),e=l(),n=c("div");for(let t=0;t<d.length;t+=1)d[t].c();r=l(),R(i.$$.fragment)},m(t,s){f.m(t,s),a(t,e,s),a(t,n,s);for(let t=0;t<d.length;t+=1)d[t].m(n,null);a(t,r,s),k(i,t,s),o=!0},p(t,r){if(h===(h=s(t))&&f?f.p(t,r):(f.d(1),f=h(t),f&&(f.c(),f.m(e.parentNode,e))),1&r){let e;for(p=Object.keys(t[0]),e=0;e<p.length;e+=1){const i=HL(t,p,e);d[e]?d[e].p(i,r):(d[e]=ZL(i),d[e].c(),d[e].m(n,null))}for(;e<d.length;e+=1)d[e].d(1);d.length=p.length}const o={};2&r&&(o.recording=t[1]),i.$set(o)},i(t){o||(P(i.$$.fragment,t),o=!0)},o(t){A(i.$$.fragment,t),o=!1},d(t){f.d(t),t&&u(e),t&&u(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(d,t),t&&u(r),N(i,t)}}}function QL(e){let n,r,i;return{c(){n=c("button"),n.textContent="New"},m(t,o){a(t,n,o),r||(i=f(n,"click",e[2]),r=!0)},p:t,d(t){t&&u(n),r=!1,i()}}}function JL(e){let n,r,i;return{c(){n=c("button"),n.textContent="Stop"},m(t,o){a(t,n,o),r||(i=f(n,"click",e[3]),r=!0)},p:t,d(t){t&&u(n),r=!1,i()}}}function ZL(t){let e,n,r=t[6]+"";return{c(){e=c("p"),n=h(r)},m(t,r){a(t,e,r),s(e,n)},p(t,e){1&e&&r!==(r=t[6]+"")&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(n,r)},d(t){t&&u(e)}}}function $L(t){let e,n,r,i,o;const h=[YL,XL],l=[];return r=RL?1:0,i=l[r]=h[r](t),{c(){e=c("main"),n=c("section"),i.c(),p(e,"class","svelte-1osdl1z")},m(t,i){a(t,e,i),s(e,n),l[r].m(n,null),o=!0},p(t,[e]){i.p(t,e)},i(t){o||(P(i),o=!0)},o(t){A(i),o=!1},d(t){t&&u(e),l[r].d()}}}function tM(t,e,n){let r={},i=!1;const o=j(i);o.subscribe((t=>n(1,i=t)));const s=t=>n(0,r=t);return g((()=>{sf.initializeApp(NL),sf.analytics(),sf.auth().onAuthStateChanged(LL),VL(s)})),[r,i,()=>o.set((()=>{const t=Lh();return sf.database().ref(`tracks/${t}`).set([]).catch(UL),t})()),()=>o.set(null)]}return new class extends M{constructor(t){super(),L(this,t,tM,$L,o,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
